!function e(t, i) {
    "object" == typeof exports && "object" == typeof module ? module.exports = i() : "function" == typeof define && define.amd ? define([], i) : "object" == typeof exports ? exports.designerUI = i() : (t.GC = t.GC || {},
        t.GC.Spread = t.GC.Spread || {},
        t.GC.Spread.Sheets = t.GC.Spread.Sheets || {},
        t.GC.Spread.Sheets.Designer = t.GC.Spread.Sheets.Designer || {},
        t.GC.Spread.Sheets.Designer.designerUI = i())
}(this, function() {
    return function(e) {
        var t = {};
        function i(o) {
            if (t[o])
                return t[o].exports;
            var n = t[o] = {
                i: o,
                l: !1,
                exports: {}
            };
            return e[o].call(n.exports, n, n.exports, i),
                n.l = !0,
                n.exports
        }
        return i.m = e,
            i.c = t,
            i.i = function(e) {
                return e
            }
            ,
            i.d = function(e, t, o) {
                i.o(e, t) || Object.defineProperty(e, t, {
                    configurable: !1,
                    enumerable: !0,
                    get: o
                })
            }
            ,
            i.n = function(e) {
                var t = e && e.h ? function t() {
                        return e.default
                    }
                    : function t() {
                        return e
                    }
                ;
                return i.d(t, "a", t),
                    t
            }
            ,
            i.o = function(e, t) {
                return Object.prototype.hasOwnProperty.call(e, t)
            }
            ,
            i.p = "",
            i(i.s = 42)
    }([function(e, t) {
        var i = function() {
            var e, t, i = !1;
            function o(e, t, i, o) {
                if (e) {
                    var n = {
                        status: "success",
                        file: e
                    };
                    switch (t) {
                        case "insertPicture":
                            a(n, "dataurl", i);
                            break;
                        default:
                            a(n, "", i, o)
                    }
                }
            }
            function n(e) {
                var t, i, o = {
                    dir: "",
                    fileName: ""
                };
                return e && (t = !1,
                    ["\\", "/"].forEach(function(o) {
                        t || -1 === (i = e.lastIndexOf(o)) || (t = !0)
                    }),
                    o.fileName = e.substr(i + 1),
                t && (o.dir = e.substr(0, i))),
                    o
            }
            function r(e, t) {
                var i = e.lastIndexOf(".");
                return t && (t.pos = i,
                    t.name = e.substr(0, i)),
                    -1 === i ? "" : e.substring(i + 1).toLowerCase()
            }
            function a(e, t, i, o) {
                var n, a;
                if (e && e.file)
                    switch (n = e.file,
                    t || (t = r(n.name)),
                        a = new FileReader,
                        a.onload = function() {
                            "xlsx" === t ? l(this.result, o, i, n) : (e.data = this.result,
                                i(e))
                        }
                        ,
                        t) {
                        case "dataurl":
                            a.readAsDataURL(n);
                            break;
                        case "xlsx":
                            a.readAsArrayBuffer(n);
                            break;
                        default:
                            a.readAsText(n)
                    }
            }
            function s(e) {
                function t(e) {
                    var t = e.split("(")
                        , i = t[0].trim()
                        , o = t[1].trim().replace(")", "")
                        , n = o.split(" ").map(function(e) {
                        return e.replace("*.", ".")
                    });
                    return {
                        name: i,
                        extensions: n
                    }
                }
                return e && e.map(t) || []
            }
            function l(e, t, i, o) {
                var n = new GC.Spread.Excel.IO;
                n.open(e, function(e) {
                    i && i({
                        status: "success",
                        data: e,
                        file: o
                    })
                }, function(e) {
                    i && i({
                        status: "failed",
                        errorData: e,
                        file: o
                    })
                }, t)
            }
            function c(e, t, i) {
                var o = {
                    password: t.password
                }
                    , n = new GC.Spread.Excel.IO;
                n.save(e, function(e) {
                    i && i({
                        status: "success",
                        data: e
                    })
                }, function(e) {
                    i && i({
                        status: "failed",
                        errorData: e
                    })
                }, o)
            }
            return {
                showSaveDialog: function(e, i) {
                    t || (t = new GC.Spread.Sheets.Designer.SaveAsDialog);
                    var o = e.fileExtension || s(e.nameFilters)[0].extensions[0];
                    t.open({
                        fileExtension: o,
                        done: function(e) {
                            var t = e && e.fileName
                                , n = e && e.cancelled;
                            i(n || !t ? {
                                status: "cancelled"
                            } : {
                                status: "success",
                                fileName: t + o
                            })
                        }
                    })
                },
                showOpenDialog: function(t, n, r) {
                    var a, l;
                    e ? $("#fileSelector").replaceWith(e.clone()) : e = $("#fileSelector").clone(),
                    i || ($(document.body).on("change", "#fileSelector", function() {
                        var e = this.files
                            , t = e && e[0]
                            , i = $(this).data("action")
                            , n = $(this).data("callback")
                            , r = $(this).data("importOptions");
                        if (!t)
                            return !1;
                        o(t, i, n, r)
                    }),
                        i = !0),
                        a = $("#fileSelector"),
                        a.data("action", t.action),
                        a.data("callback", n),
                        a.data("importOptions", r),
                        l = t.filters || s(t.nameFilters)[0].extensions.join(" "),
                        a.attr("accept", l || ""),
                        a.click()
                },
                save: function(e, t, i, o) {
                    var n, a, s, l, d;
                    function p(e) {
                        var t, i = {};
                        return r(e, i),
                            t = i.name,
                            /^[_a-zA-Z\$]{1}[_a-zA-Z0-9\$]*$/.test(t) ? t : "_" + t.replace(/[ \.]/g, "_")
                    }
                    function u(e, t, i, o, n) {
                        try {
                            var r = {
                                type: i
                            };
                            n && (r.encoding = n),
                                saveAs(new Blob([t],r), e),
                                o({
                                    status: "success"
                                })
                        } catch (e) {
                            o({
                                status: "failed",
                                message: e
                            })
                        }
                    }
                    switch (n = t.spread || t,
                        a = o && o.saveAsJS,
                    a && (n = "var " + p(e) + " = " + n),
                        s = t.exportFileType,
                        l = "text/plain;charset=utf-8",
                        d = null,
                        s) {
                        case "xlsx":
                            return l = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                                void c(n, o, function(t) {
                                    "success" === t.status ? u(e, t.data, l, i) : i({
                                        status: "failed",
                                        message: t.errorData
                                    })
                                });
                        case "pdf":
                            return void t.spread.savePDF(function(t) {
                                saveAs(t, e),
                                    i({
                                        status: "success"
                                    })
                            }, function(e) {
                                i({
                                    status: "failed",
                                    message: e
                                })
                            }, o.setting, o.sheetIndex);
                        case "csv":
                            l = "text/csv;charset=utf-8",
                                d = o && o.encoding
                    }
                    u(e, n, l, i, d)
                },
                notify: function() {
                    return ""
                },
                openUrl: function() {
                    return !1
                },
                notifyReady: function() {},
                getFileInfo: n,
                getExtension: r
            }
        }();
        e.exports.app = i
    }
        , function(e, t) {
            e.exports = {
                chartColors: {
                    colorful: {
                        name: "Colorful",
                        colors: [{
                            tip: "Blue, Orange, Gray, Gold, Blue, Green",
                            items: ["accent 1", "accent 2", "accent 3", "accent 4", "accent 5", "accent 6"]
                        }, {
                            tip: "Blue, Orange, Gray, Gold, Blue, Green",
                            items: ["accent 1", "accent 3", "accent 5", "accent 1 -40", "accent 3 -40", "accent 5 -40"]
                        }, {
                            tip: "Blue, Orange, Gray, Gold, Blue, Green",
                            items: ["accent 2", "accent 4", "accent 6", "accent 2 -40", "accent 4 -40", "accent 6 -40"]
                        }, {
                            tip: "Blue, Orange, Gray, Gold, Blue, Green",
                            items: ["accent 6", "accent 5", "accent 4", "accent 6 -40", "accent 5 -40", "accent 4 -40"]
                        }]
                    },
                    monochromatic: {
                        name: "Monochromatic",
                        colors: [{
                            tip: "Blue gradient, dark to light",
                            items: {
                                startColor: "accent 1 -50",
                                stopColor: "accent 1 50"
                            }
                        }, {
                            tip: "Orange gradient, dark to light",
                            items: {
                                startColor: "accent 2 -50",
                                stopColor: "accent 2 50"
                            }
                        }, {
                            tip: "Gray gradient, dark to light",
                            items: {
                                startColor: "accent 3 -50",
                                stopColor: "accent 3 50"
                            }
                        }, {
                            tip: "Gold gradient, dark to light",
                            items: {
                                startColor: "accent 4 -50",
                                stopColor: "accent 4 50"
                            }
                        }, {
                            tip: "Blue gradient, dark to light",
                            items: {
                                startColor: "accent 5 -50",
                                stopColor: "accent 5 50"
                            }
                        }, {
                            tip: "Green gradient, dark to light",
                            items: {
                                startColor: "accent 6 -50",
                                stopColor: "accent 6 50"
                            }
                        }, {
                            tip: "Dark Gray, Light Gray, Gray, Dark Gray, Light Gray, Gray",
                            items: ["text 1 11.5", "text 1 45", "text 1 25", "text 1 1.5", "text 1 70", "text 1 40"]
                        }, {
                            tip: "Blue gradient, light to dark",
                            items: {
                                startColor: "accent 1 50",
                                stopColor: "accent 1 -50"
                            }
                        }, {
                            tip: "Orange gradient, light to dark",
                            items: {
                                startColor: "accent 2 50",
                                stopColor: "accent 2 -50"
                            }
                        }, {
                            tip: "Gray gradient, light to dark",
                            items: {
                                startColor: "accent 3 50",
                                stopColor: "accent 3 -50"
                            }
                        }, {
                            tip: "Gold gradient, light to dark",
                            items: {
                                startColor: "accent 4 50",
                                stopColor: "accent 4 -50"
                            }
                        }, {
                            tip: "Blue gradient, light to dark",
                            items: {
                                startColor: "accent 5 50",
                                stopColor: "accent 5 -50"
                            }
                        }, {
                            tip: "Green gradient, light to dark",
                            items: {
                                startColor: "accent 6 50",
                                stopColor: "accent 6 -50"
                            }
                        }]
                    }
                },
                chartStyles: {
                    columnClustered: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    columnStacked: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    columnStacked100: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    line: [null, {
                        dataLabels: {
                            showValue: !0
                        }
                    }, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    lineStacked: [null, {
                        dataLabels: {
                            showValue: !0
                        }
                    }, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    lineStacked100: [null, {
                        dataLabels: {
                            showValue: !0
                        }
                    }, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    lineMarkers: [null, {
                        dataLabels: {
                            showValue: !0
                        }
                    }, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    lineMarkersStacked: [null, {
                        dataLabels: {
                            showValue: !0
                        }
                    }, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    lineMarkersStacked100: [null, {
                        dataLabels: {
                            showValue: !0
                        }
                    }, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    pie: [null, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(187,255,255,1)"
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    doughnut: [null, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }],
                    barClustered: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    barStacked: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    barStacked100: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    area: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    areaStacked: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    areaStacked100: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    xyScatter: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    xyScatterSmooth: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    xyScatterSmoothNoMarkers: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    xyScatterLines: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    xyScatterLinesNoMarkers: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    bubble: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }],
                    stockHLC: [null, {
                        axes: {
                            primaryValue: {
                                minorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(91,155,213,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }],
                    stockOHLC: [null, {
                        axes: {
                            primaryValue: {
                                minorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(91,155,213,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }],
                    stockVHLC: [null, {
                        axes: {
                            primaryValue: {
                                minorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(91,155,213,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }],
                    stockVOHLC: [null, {
                        axes: {
                            primaryValue: {
                                minorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(91,155,213,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }],
                    combo: [null, {
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        }
                    }, {
                        legend: {
                            position: 1
                        }
                    }, {
                        chartArea: {
                            backColor: "rgba(93,93,93,1)",
                            color: "rgba(255,255,255,1)"
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            }
                        }
                    }, {
                        legend: {
                            position: 1
                        },
                        axes: {
                            primaryCategory: {
                                majorGridLine: {
                                    visible: !0
                                }
                            },
                            primaryValue: {
                                majorGridLine: {
                                    visible: !1
                                },
                                style: {
                                    color: "rgba(0,0,0,0)"
                                }
                            }
                        },
                        dataLabels: {
                            showValue: !0
                        }
                    }]
                }
            }
        }
        , function(e, t, i) {
            var o = GC.Spread.Sheets.Designer
                , n = o.util.chartHelper
                , r = void 0
                , a = o.ColorHelper
                , s = i(1);
            !function() {
                "use strict";
                var t, i, l, c, d, p, u;
                function h(e) {
                    var t, i = e.split(" ");
                    if (i.length > 0)
                        for (e = i[0].toLocaleLowerCase(),
                                 t = 1; t < i.length; t++)
                            e = e + " " + i[t].toLocaleLowerCase();
                    return e
                }
                function f(e) {
                    var t, i = e.split("And"), o = "";
                    if (i.length > 0)
                        for (o = i[0].toLocaleLowerCase(),
                                 t = 1; t < i.length; t++)
                            o = o + "-" + i[t].toLocaleLowerCase();
                    return o
                }
                function g() {
                    var e = $(".slider-panel");
                    e.sliderpanel("close", "panel2")
                }
                function m(e) {
                    return !e || "object" == typeof e && 0 === Object.keys(e).length
                }
                t = "rgba(91,155,213,1)",
                    i = {
                        baseChart: {
                            series: {
                                fillAndLine: {
                                    Line: ["fill", "border"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            },
                            chartArea: {
                                fillAndLine: {
                                    Line: ["fill"]
                                },
                                sizeAndProperties: {
                                    Size: ["size"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                }
                            },
                            chartTitle: {
                                textFill: {
                                    Text: ["textFill", "font", "textElement"]
                                }
                            },
                            legend: {
                                legendPosition: {
                                    Legend: ["position"]
                                }
                            },
                            dataLabels: {
                                textFill: {
                                    Text: ["textFill"]
                                }
                            },
                            primaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            primaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            primaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            primaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            secondaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            secondaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            }
                        },
                        columnClustered: {},
                        columnStacked: {},
                        columnStacked100: {},
                        line: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        lineStacked: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        lineStacked100: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            },
                            chartArea: {
                                fillAndLine: {
                                    Line: ["fill"]
                                },
                                sizeAndProperties: {
                                    Size: ["size"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                }
                            },
                            chartTitle: {
                                textFill: {
                                    Text: ["textFill", "font", "textElement"]
                                }
                            },
                            legend: {
                                legendPosition: {
                                    Legend: ["position"]
                                }
                            },
                            dataLabels: {
                                textFill: {
                                    Text: ["textFill"]
                                }
                            },
                            primaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            primaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            primaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            primaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            secondaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            secondaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            }
                        },
                        lineMarkers: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            },
                            chartArea: {
                                fillAndLine: {
                                    Line: ["fill"]
                                },
                                sizeAndProperties: {
                                    Size: ["size"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                }
                            },
                            chartTitle: {
                                textFill: {
                                    Text: ["textFill", "font", "textElement"]
                                }
                            },
                            legend: {
                                legendPosition: {
                                    Legend: ["position"]
                                }
                            },
                            dataLabels: {
                                textFill: {
                                    Text: ["textFill"]
                                }
                            },
                            primaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            primaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            primaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            primaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            secondaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            secondaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            }
                        },
                        lineMarkersStacked: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            },
                            chartArea: {
                                fillAndLine: {
                                    Line: ["fill"]
                                },
                                sizeAndProperties: {
                                    Size: ["size"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                }
                            },
                            chartTitle: {
                                textFill: {
                                    Text: ["textFill", "font", "textElement"]
                                }
                            },
                            legend: {
                                legendPosition: {
                                    Legend: ["position"]
                                }
                            },
                            dataLabels: {
                                textFill: {
                                    Text: ["textFill"]
                                }
                            },
                            primaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            primaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            primaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            primaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            secondaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            secondaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            }
                        },
                        lineMarkersStacked100: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            },
                            chartArea: {
                                fillAndLine: {
                                    Line: ["fill"]
                                },
                                sizeAndProperties: {
                                    Size: ["size"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                }
                            },
                            chartTitle: {
                                textFill: {
                                    Text: ["textFill", "font", "textElement"]
                                }
                            },
                            legend: {
                                legendPosition: {
                                    Legend: ["position"]
                                }
                            },
                            dataLabels: {
                                textFill: {
                                    Text: ["textFill"]
                                }
                            },
                            primaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            primaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            primaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            primaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            primaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            primaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryCategory: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisCategory", "tick"]
                                }
                            },
                            secondaryValue: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                textFill: {
                                    Text: ["textFill", "font"]
                                },
                                axisOptions: {
                                    Axis: ["axisValue", "tick"]
                                }
                            },
                            secondaryCategoryTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryValueTitle: {
                                textFill: {
                                    Text: ["titleTextFill", "titleFont", "titleTextElement"]
                                }
                            },
                            secondaryCategoryMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryValueMajorGridLine: {
                                fillAndLine: {
                                    MajorLine: ["majorLine"]
                                }
                            },
                            secondaryCategoryMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            },
                            secondaryValueMinorGridLine: {
                                fillAndLine: {
                                    MinorLine: ["minorLine"]
                                }
                            }
                        },
                        pie: {
                            series: {
                                fillAndLine: {
                                    Line: ["fillPie", "border"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        doughnut: {
                            series: {
                                fillAndLine: {
                                    Line: ["fillPie", "border"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        barClustered: {},
                        barStacked: {},
                        barStacked100: {},
                        area: {},
                        areaStacked: {},
                        areaStacked100: {},
                        xyScatter: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        xyScatterSmooth: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        xyScatterSmoothNoMarkers: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        xyScatterLines: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        xyScatterLinesNoMarkers: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        bubble: {
                            series: {
                                fillAndLine: {
                                    Line: ["line"]
                                },
                                seriesOptions: {
                                    SeriesOptions: ["seriesOptions"]
                                }
                            }
                        },
                        combo: {},
                        stockHLC: {},
                        stockOHLC: {},
                        stockVHLC: {},
                        stockVOHLC: {}
                    };
                function b(e, t, i, n) {
                    var r, a = v(), s = e.backColor;
                    return e && t && null !== i && (!0 === n ? (r = y(e.backColor)) && (s = o.res.chartSliderPanel.automatic) : s = x(e.backColor, t, i, a)),
                        s ? {
                            text: s,
                            color: e.backColor
                        } : e.backColor
                }
                function v() {
                    var e = o.wrapper.spread.getActiveSheet()
                        , t = null;
                    return e.charts.all().forEach(function(e) {
                        e.isSelected() && (t = e)
                    }),
                        t
                }
                function y(e) {
                    var t, i = n.getPieColorArray(e);
                    for (t = 1; t < i.length; t++)
                        if (i[t] !== i[t - 1])
                            return !0;
                    return !1
                }
                function x(e, t, i, r) {
                    var a, l, c, d, p, u;
                    return null === e || void 0 === e ? e : (a = s.chartColors.colorful.colors[0].items,
                    r && r.colorAndStyle && r.colorAndStyle.color && r.colorAndStyle.color.group && r.colorAndStyle.color.index && (l = r.colorAndStyle.color,
                        c = l.group,
                        d = l.index,
                        a = s.chartColors[c].colors[d].items),
                        p = n.generateColor(a, t, i),
                        u = e.split(" "),
                    "0" === u[u.length - 1] && (u.pop(),
                        e = u.join(" ")),
                        p === e ? o.res.chartSliderPanel.automatic : void 0)
                }
                function w(e, t, r) {
                    var a, l, c, d, p, u, h, f, g, m, v = e.series(), y = v.Count, x = n.getChartTypeString(e.chartType());
                    function w(e, t, i) {
                        var n = b(e, i, t, !0);
                        return {
                            name: o.res.chartSliderPanel.fill,
                            data: {
                                backColor: n
                            },
                            type: "fill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill,
                                automaticColorText: o.res.chartSliderPanel.automatic
                            }
                        }
                    }
                    function C(e, t, i) {
                        var n = b(e, i, t, !1);
                        return {
                            name: o.res.chartSliderPanel.fill,
                            data: {
                                backColor: n
                            },
                            type: "fill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill,
                                automaticColorText: o.res.chartSliderPanel.automatic
                            }
                        }
                    }
                    function S(e) {
                        return {
                            name: o.res.chartSliderPanel.border,
                            data: {
                                borderWidth: e.border.width,
                                borderColor: e.border.color || "rgba(0, 0, 0, 0)"
                            },
                            type: "border",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noLine,
                                solidColorText: o.res.chartSliderPanel.solidLine,
                                widthText: o.res.chartSliderPanel.width
                            }
                        }
                    }
                    function k(e) {
                        return {
                            name: o.res.chartSliderPanel.seriesOptions,
                            data: {
                                axisGroup: e.axisGroup
                            },
                            type: "series",
                            resources: {
                                primaryAxisText: o.res.chartSliderPanel.primaryAxis,
                                secondaryAxisText: o.res.chartSliderPanel.secondaryAxis
                            }
                        }
                    }
                    function T(e, t, i) {
                        var r = s.chartColors.colorful.colors[0].items
                            , a = n.generateColor(r, i, t);
                        return e.border.color = e.border.color || a,
                            {
                                name: o.res.chartSliderPanel.line,
                                data: {
                                    borderWidth: e.border.width,
                                    borderColor: e.border.color || "rgba(0,0,0,0)"
                                },
                                type: "line",
                                resources: {
                                    noColorText: o.res.chartSliderPanel.noLine,
                                    solidColorText: o.res.chartSliderPanel.solidLine,
                                    widthText: o.res.chartSliderPanel.width
                                }
                            }
                    }
                    if ("stockHLC" !== x && "stockOHLC" !== x && "stockVHLC" !== x && "stockVOHLC" !== x)
                        for ("pie" !== x && "doughnut" !== x || (y = 1),
                                 l = {
                                     fill: C,
                                     fillPie: w,
                                     border: S,
                                     seriesOptions: k,
                                     line: T
                                 },
                                 c = 0; c < y; c++) {
                            d = t["series " + r[c]] = {},
                                p = v.get(c),
                            1 !== p.chartType && 33 !== p.chartType && 34 !== p.chartType && 35 !== p.chartType && 36 !== p.chartType || (p.border.width = null),
                                x = n.getChartTypeString(p.chartType),
                                a = i[x].series || i.baseChart.series;
                            for (u in a) {
                                d[u] = {
                                    type: u
                                },
                                    h = d[u];
                                for (f in a[u])
                                    g = [],
                                        a[u][f].forEach(function(e) {
                                            var t = l[e](p, c, y);
                                            g.push(t)
                                        }),
                                        m = {},
                                        m[f] = g,
                                        h.content = [],
                                        h.content.push(m)
                            }
                        }
                }
                function C(e, t) {
                    var n, r, a, s, l, c, d, p = o.util.chartHelper.getChartTypeString(e.chartType()), u = i[p].legend || i.baseChart.legend, h = {
                        position: f
                    };
                    function f(e) {
                        return {
                            name: o.res.chartSliderPanel.legendPosition,
                            data: {
                                position: e.position
                            },
                            type: "legend",
                            resources: {
                                topText: o.res.chartSliderPanel.top,
                                bottomText: o.res.chartSliderPanel.bottom,
                                leftText: o.res.chartSliderPanel.left,
                                rightText: o.res.chartSliderPanel.right
                            }
                        }
                    }
                    if ("stockHLC" !== p && "stockOHLC" !== p && "stockVHLC" !== p && "stockVOHLC" !== p) {
                        n = t.legend = {},
                            r = e.legend();
                        for (a in u) {
                            n[a] = {
                                type: a
                            },
                                s = n[a];
                            for (l in u[a])
                                c = [],
                                    u[a][l].forEach(function(e) {
                                        var t = h[e](r);
                                        c.push(t)
                                    }),
                                    d = {},
                                    d[l] = c,
                                    s.content = [],
                                    s.content.push(d)
                        }
                    }
                }
                function S(e, t) {
                    var n, r, a, s, l, c, d = o.util.chartHelper.getChartTypeString(e.chartType()), p = i[d].dataLabels || i.baseChart.dataLabels, u = {
                        textFill: f
                    }, h = e.dataLabels();
                    function f(e) {
                        return {
                            name: o.res.chartSliderPanel.textFill,
                            data: {
                                color: e.color
                            },
                            type: "textFill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill
                            }
                        }
                    }
                    if (!(m(h) || !1 === h.showValue && !1 === h.showSeriesName && !1 === h.showCategoryName)) {
                        n = t.dataLabels = {};
                        for (r in p) {
                            n[r] = {
                                type: r
                            },
                                a = n[r];
                            for (s in p[r])
                                l = [],
                                    p[r][s].forEach(function(e) {
                                        var t = u[e](h);
                                        l.push(t)
                                    }),
                                    c = {},
                                    c[s] = l,
                                    a.content = [],
                                    a.content.push(c)
                        }
                    }
                }
                function k(e, t) {
                    var n, r, a, s, l, c, d = o.util.chartHelper.getChartTypeString(e.chartType()), p = i[d].chartTitle || i.baseChart.chartTitle, u = {
                        textFill: f,
                        font: g,
                        textElement: b
                    }, h = e.title();
                    function f(e) {
                        return {
                            name: o.res.chartSliderPanel.textFill,
                            data: {
                                color: e.color
                            },
                            type: "textFill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill
                            }
                        }
                    }
                    function g(e) {
                        return {
                            name: o.res.chartSliderPanel.textFill,
                            data: {
                                fontFamily: e.fontFamily,
                                fontSize: e.fontSize
                            },
                            type: "font",
                            resources: {
                                fontFamily: o.res.chartSliderPanel.fontFamily,
                                fontSize: o.res.chartSliderPanel.fontSize
                            }
                        }
                    }
                    function b(e) {
                        return {
                            name: o.res.chartSliderPanel.textEditor,
                            data: {
                                text: e.text
                            },
                            type: "textElement",
                            resources: {
                                textElement: o.res.chartSliderPanel.text
                            }
                        }
                    }
                    if (!m(h)) {
                        n = t.chartTitle = {};
                        for (r in p) {
                            n[r] = {
                                type: r
                            },
                                a = n[r];
                            for (s in p[r])
                                l = [],
                                    p[r][s].forEach(function(e) {
                                        var t = u[e](h);
                                        l.push(t)
                                    }),
                                    c = {},
                                    c[s] = l,
                                    a.content = [],
                                    a.content.push(c)
                        }
                    }
                }
                function T(e, t) {
                    var n, r, a, s, l, c = o.util.chartHelper.getChartTypeString(e.chartType()), d = i[c].chartArea || i.baseChart.chartArea, p = {
                        fill: f,
                        size: g,
                        textFill: m,
                        font: b
                    }, u = t.chartArea = {}, h = e.chartArea();
                    for (n in d) {
                        u[n] = {
                            type: n
                        },
                            r = u[n];
                        for (a in d[n])
                            s = [],
                                d[n][a].forEach(function(t) {
                                    var i = p[t]("size" === t ? e : h);
                                    s.push(i)
                                }),
                                l = {},
                                l[a] = s,
                                r.content = [],
                                r.content.push(l)
                    }
                    function f(e) {
                        return {
                            name: o.res.chartSliderPanel.fill,
                            data: {
                                backColor: e.backColor
                            },
                            type: "fill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill
                            }
                        }
                    }
                    function g(e) {
                        return {
                            name: o.res.chartSliderPanel.size,
                            data: {
                                xOffset: e.x(),
                                yOffset: e.y(),
                                width: e.width(),
                                height: e.height()
                            },
                            type: "size",
                            resources: {
                                widthText: o.res.chartSliderPanel.width,
                                heightText: o.res.chartSliderPanel.height
                            }
                        }
                    }
                    function m(e) {
                        return {
                            name: o.res.chartSliderPanel.textFill,
                            data: {
                                color: e.color
                            },
                            type: "textFill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill
                            }
                        }
                    }
                    function b(e) {
                        return {
                            name: o.res.chartSliderPanel.font,
                            data: {
                                fontFamily: e.fontFamily || "Calibri",
                                fontSize: e.fontSize || "10"
                            },
                            type: "font",
                            resources: {
                                fontFamily: o.res.chartSliderPanel.fontFamily,
                                fontSize: o.res.chartSliderPanel.fontSize
                            }
                        }
                    }
                }
                function A(e, t) {
                    var n, r, a, s, l = e.axes();
                    function c(e, i) {
                        var o, n, r, c, d, p = t[i] = {}, u = l[s];
                        for (o in e) {
                            p[o] = {
                                type: o
                            },
                                n = p[o];
                            for (r in e[o])
                                c = [],
                                    e[o][r].forEach(function(e) {
                                        var t = a[e](u);
                                        c.push(t)
                                    }),
                                    d = {},
                                    d[r] = c,
                                    n.content = [],
                                    n.content.push(d)
                        }
                    }
                    function d(e) {
                        return {
                            name: o.res.chartSliderPanel.line,
                            data: {
                                majorGridLineWidth: e.majorGridLine.width,
                                majorGridLineColor: e.majorGridLine.color
                            },
                            type: "line",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noLine,
                                solidColorText: o.res.chartSliderPanel.solidLine,
                                widthText: o.res.chartSliderPanel.width
                            }
                        }
                    }
                    function p(e) {
                        return {
                            name: o.res.chartSliderPanel.line,
                            data: {
                                minorGridLineWidth: e.minorGridLine.width,
                                minorGridLineColor: e.minorGridLine.color
                            },
                            type: "line",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noLine,
                                solidColorText: o.res.chartSliderPanel.solidLine,
                                widthText: o.res.chartSliderPanel.width
                            }
                        }
                    }
                    function u(e) {
                        return {
                            name: o.res.chartSliderPanel.font,
                            data: {
                                fontFamilyTitle: e.title.fontFamily,
                                fontSizeTitle: e.title.fontSize
                            },
                            type: "font",
                            resources: {
                                fontFamily: o.res.chartSliderPanel.fontFamily,
                                fontSize: o.res.chartSliderPanel.fontSize
                            }
                        }
                    }
                    function h(e) {
                        return {
                            name: o.res.chartSliderPanel.textFill,
                            data: {
                                colorTitle: e.title.color
                            },
                            type: "textFill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill
                            }
                        }
                    }
                    function f(e) {
                        return {
                            name: o.res.chartSliderPanel.textEditor,
                            data: {
                                textTitle: e.title.text
                            },
                            type: "textElement",
                            resources: {
                                textElement: o.res.chartSliderPanel.text
                            }
                        }
                    }
                    function g(e) {
                        return {
                            name: o.res.chartSliderPanel.textFill,
                            data: {
                                color: e.style.color
                            },
                            type: "textFill",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noFill,
                                solidColorText: o.res.chartSliderPanel.solidFill
                            }
                        }
                    }
                    function b(e) {
                        return {
                            name: o.res.chartSliderPanel.font,
                            data: {
                                fontFamily: e.style.fontFamily,
                                fontSize: e.style.fontSize
                            },
                            type: "font",
                            resources: {
                                fontFamily: o.res.chartSliderPanel.fontFamily,
                                fontSize: o.res.chartSliderPanel.fontSize
                            }
                        }
                    }
                    function v(e) {
                        return {
                            name: o.res.chartSliderPanel.line,
                            data: {
                                borderWidth: e.lineStyle.width,
                                borderColor: e.lineStyle.color
                            },
                            type: "line",
                            resources: {
                                noColorText: o.res.chartSliderPanel.noLine,
                                solidColorText: o.res.chartSliderPanel.solidLine,
                                widthText: o.res.chartSliderPanel.width
                            }
                        }
                    }
                    function y(e) {
                        return {
                            name: o.res.chartSliderPanel.tickMarks,
                            data: {
                                majorTickPosition: e.majorTickPosition,
                                minorTickPosition: e.minorTickPosition
                            },
                            type: "tick",
                            resources: {
                                majorText: o.res.chartSliderPanel.majorType,
                                minorText: o.res.chartSliderPanel.minorType
                            }
                        }
                    }
                    function x(e) {
                        return 3 === e.categoryType ? {
                            name: o.res.chartSliderPanel.axisOptions,
                            data: {
                                majorUnit: e.majorUnit,
                                minorUnit: e.minorUnit,
                                maxValue: e.max,
                                minValue: e.min
                            },
                            type: "axisValue",
                            resources: {
                                majorUnitText: o.res.chartSliderPanel.unitsMajor,
                                minorUnitText: o.res.chartSliderPanel.unitsMinor,
                                maxValueText: o.res.chartSliderPanel.maximum,
                                minValueText: o.res.chartSliderPanel.minimum
                            }
                        } : {
                            name: o.res.chartSliderPanel.axisOptions,
                            data: {
                                categoryType: e.categoryType,
                                maxValue: 2 === e.categoryType ? e.max && e.max.toLocaleDateString() : e.max,
                                minValue: 2 === e.categoryType ? e.min && e.min.toLocaleDateString() : e.min
                            },
                            type: "axisCategory",
                            resources: {
                                textText: o.res.chartSliderPanel.textAxis,
                                dateText: o.res.chartSliderPanel.dateAxis,
                                maxValueText: o.res.chartSliderPanel.maximum,
                                minValueText: o.res.chartSliderPanel.minimum
                            }
                        }
                    }
                    function w(e) {
                        return {
                            name: o.res.chartSliderPanel.axisOptions,
                            data: {
                                majorUnit: e.majorUnit,
                                minorUnit: e.minorUnit,
                                maxValue: e.max,
                                minValue: e.min
                            },
                            type: "axisValue",
                            resources: {
                                majorUnitText: o.res.chartSliderPanel.unitsMajor,
                                minorUnitText: o.res.chartSliderPanel.unitsMinor,
                                maxValueText: o.res.chartSliderPanel.maximum,
                                minValueText: o.res.chartSliderPanel.minimum
                            }
                        }
                    }
                    if (!m(l)) {
                        n = o.util.chartHelper.getChartTypeString(e.chartType()),
                            a = {
                                line: v,
                                textFill: g,
                                font: b,
                                tick: y,
                                axisCategory: x,
                                axisValue: w,
                                titleTextFill: h,
                                titleFont: u,
                                titleTextElement: f,
                                majorLine: d,
                                minorLine: p
                            };
                        for (s in l)
                            !0 === l[s].visible && (r = i[n][s] || i.baseChart[s],
                            0 !== l[s].lineStyle.width && "rgba(0, 0, 0, 0)" !== l[s].lineStyle.color && c(r, s),
                            "" !== l[s].title.text && (r = i[n][s + "Title"] || i.baseChart[s + "Title"],
                                c(r, s + "Title")),
                            !0 === l[s].majorGridLine.visible && (r = i[n][s + "MajorGridLine"] || i.baseChart[s + "MajorGridLine"],
                                c(r, s + "MajorGridLine")),
                            !0 === l[s].minorGridLine.visible && (r = i[n][s + "MinorGridLine"] || i.baseChart[s + "MinorGridLine"],
                                c(r, s + "MinorGridLine")))
                    }
                }
                function I() {}
                I.prototype.setCurrentChart = function(e) {
                    this.j = e
                }
                    ,
                    I.prototype.setAllData = function(e) {
                        this.k = e
                    }
                    ,
                    I.prototype.setSelectedElement = function(e) {
                        this.q = e.chartElement,
                            this.u = e.selectedItem
                    }
                    ,
                    I.prototype.setChartCategories = function(e) {
                        this.v = e
                    }
                    ,
                    I.prototype.getHeaderData = function() {
                        var e = this.q;
                        switch (e) {
                            case "series":
                                return {
                                    title: o.res.chart.formatChartArea + o.res.chart.formatChart.dataSeries
                                };
                            case "axis":
                                return {
                                    title: o.res.chart.formatChartArea + o.res.chart.formatChart.axis
                                };
                            case "legend":
                                return {
                                    title: o.res.chart.formatChartArea + o.res.chart.formatChart.legend
                                };
                            case "label":
                                return {
                                    title: o.res.chart.formatChartArea + o.res.chart.formatChart.dataLable
                                };
                            case "chartTitle":
                                return {
                                    title: o.res.chart.formatChartArea + o.res.chart.formatChart.chartTitle
                                };
                            case "plotArea":
                                return {
                                    title: o.res.chart.formatChartArea + o.res.chart.formatChart.plotArea
                                };
                            case "chartArea":
                                return {
                                    title: o.res.chart.formatChartArea + o.res.chart.formatChart.chartArea
                                };
                            default:
                                return {
                                    title: o.res.chart.formatChartArea
                                }
                        }
                    }
                    ,
                    I.prototype.updateData = function(e, t, i, a) {
                        var s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T = this.q, A = this.A, I = this.v, D = this.k, $ = D[this.u || T], F = i.split("."), L = this, R = o.wrapper.spread, B = L.j;
                        switch (T) {
                            case "series":
                                for (g = this.u.slice(7, this.u.length),
                                         m = 0; m < I.length; m++)
                                    if (I[m] + "" === g) {
                                        if (B) {
                                            if (c = F[F.length - 1],
                                                    l = B.series().get(m),
                                                "borderColor" === c)
                                                l.border.color = a;
                                            else if ("borderWidth" === c)
                                                l.border.width = a;
                                            else if (a === o.res.chartSliderPanel.automatic)
                                                v = B.colorAndStyle && B.colorAndStyle.color && (B.colorAndStyle && B.colorAndStyle.color).group,
                                                    y = B.colorAndStyle && B.colorAndStyle.color && (B.colorAndStyle && B.colorAndStyle.color).index,
                                                    o.actions.doAction("changeChartSeriesColor", o.wrapper.spread, {
                                                        group: v,
                                                        index: y,
                                                        type: c,
                                                        ignoreEvent: !0
                                                    }, B),
                                                    b = {
                                                        text: o.res.chartSliderPanel.automatic
                                                    };
                                            else if ("pie" !== n.getChartTypeString(B.chartType()) && "doughnut" !== n.getChartTypeString(B.chartType()) || "backColor" !== c)
                                                l[c] = a;
                                            else
                                                for (x = n.getPieColorArray(l[c]),
                                                         d = 1,
                                                         l[c] = a; d < x.length; )
                                                    l[c] += "," + a,
                                                        d++;
                                            for (a !== o.res.chartSliderPanel.automatic && o.actions.doAction("updateChartSeries", R, {
                                                chart: B,
                                                element: {
                                                    index: m,
                                                    value: l
                                                }
                                            }),
                                                     p = B.series().get(m),
                                                     h = e.split("."),
                                                     u = 0; u < h.length; u++)
                                                $ = $[h[u]];
                                            for (f = t,
                                                     u = 0; u < f.length; )
                                                $ = $[f[u]][f[u + 1]],
                                                    u += 2;
                                            for (u = 0; u < F.length - 1; u++)
                                                $ = $[F[u]];
                                            a = "borderColor" === c ? p.border.color : "borderWidth" === c ? p.border.width : p[c],
                                                s = $[c] = a
                                        }
                                        return b ? (b.color = s,
                                            b) : s
                                    }
                                break;
                            case "axis":
                                if (B) {
                                    for (c = F[F.length - 1],
                                             w = A || T && L.u,
                                             l = B.axes()[w],
                                             "fontSize" === c ? l.style.fontSize = a : "fontFamily" === c ? l.style.fontFamily = a : "color" === c ? l.style.color = a : "borderColor" === c ? l.lineStyle.color = a : "borderWidth" === c ? l.lineStyle.width = a : "colorTitle" === c ? l.title.color = a : "fontSizeTitle" === c ? l.title.fontSize = a : "fontFamilyTitle" === c ? l.title.fontFamily = a : "textTitle" === c ? l.title.text = a : "majorGridLineColor" === c ? l.majorGridLine.color = a : "minorGridLineColor" === c ? l.minorGridLine.color = a : "majorGridLineWidth" === c ? l.majorGridLine.width = a : "minorGridLineWidth" === c ? l.minorGridLine.width = a : (2 !== l.categoryType || "max" !== c && "min" !== c ? l.categoryType && (3 !== l.categoryType || "max" !== c && "min" !== c) || (a = a && +a) : a = null === a || a === r ? a && new Date(a).getTime() : a && new Date(a).getTime() || l[c] && new Date(l[c]).getTime(),
                                                 l[c] = a),
                                             C = {},
                                             C[w] = l,
                                             o.actions.doAction("changeChartFormatProperty", R, {
                                                 chart: B,
                                                 element: {
                                                     axes: C
                                                 }
                                             }),
                                             p = B.axes()[A || T && L.u],
                                             h = e.split("."),
                                             u = 0; u < h.length; u++)
                                        $ = $[h[u]];
                                    for (f = t,
                                             u = 0; u < f.length; )
                                        $ = $[f[u]][f[u + 1]],
                                            u += 2;
                                    for (u = 0; u < F.length - 1; u++)
                                        $ = $[F[u]];
                                    a = "fontSize" === c ? p.style.fontSize : "fontFamily" === c ? p.style.fontFamily : "color" === c ? p.style.color : "borderColor" === c ? p.lineStyle.color : "borderWidth" === c ? p.lineStyle.width : "colorTitle" === c ? p.title.color : "fontSizeTitle" === c ? p.title.fontSize : "fontFamilyTitle" === c ? p.title.fontFamily : "textTitle" === c ? p.title.text : "majorGridLineColor" === c ? p.majorGridLine.color : "minorGridLineColor" === c ? p.minorGridLine.color : "majorGridLineWidth" === c ? p.majorGridLine.width : "minorGridLineWidth" === c ? p.minorGridLine.width : "categoryType" === c ? {
                                        categoryType: p.categoryType,
                                        minValue: p.minValue,
                                        maxValue: p.maxValue
                                    } : 2 !== l.categoryType || "max" !== c && "min" !== c ? p[c] : p[c] && p[c].toLocaleDateString(),
                                        s = $[c] = a
                                }
                                return s;
                            case "legend":
                                if (B) {
                                    for (S = {},
                                             S[o.res.chartSliderPanel.top] = 1,
                                             S[o.res.chartSliderPanel.right] = 2,
                                             S[o.res.chartSliderPanel.left] = 3,
                                             S[o.res.chartSliderPanel.bottom] = 4,
                                             c = F[F.length - 1],
                                             l = B.legend(),
                                             l[c] = S[a],
                                             o.actions.doAction("changeChartFormatProperty", R, {
                                                 chart: B,
                                                 element: {
                                                     legend: l
                                                 }
                                             }),
                                             p = B.legend(),
                                             a = p[c],
                                             h = e.split("."),
                                             u = 0; u < h.length; u++)
                                        $ = $[h[u]];
                                    for (f = t,
                                             u = 0; u < f.length; )
                                        $ = $[f[u]][f[u + 1]],
                                            u += 2;
                                    for (u = 0; u < F.length - 1; u++)
                                        $ = $[F[u]];
                                    s = $[c] = a
                                }
                                return s;
                            case "dataLabels":
                                if (B) {
                                    for (c = F[F.length - 1],
                                             l = B.dataLabels(),
                                             l[c] = a,
                                             o.actions.doAction("changeChartFormatProperty", R, {
                                                 chart: B,
                                                 element: {
                                                     dataLabels: l
                                                 }
                                             }),
                                             p = B.dataLabels(),
                                             a = p[c],
                                             h = e.split("."),
                                             u = 0; u < h.length; u++)
                                        $ = $[h[u]];
                                    for (f = t,
                                             u = 0; u < f.length; )
                                        $ = $[f[u]][f[u + 1]],
                                            u += 2;
                                    for (u = 0; u < F.length - 1; u++)
                                        $ = $[F[u]];
                                    s = $[c] = a
                                }
                                return s;
                            case "chartTitle":
                                if (B) {
                                    for (c = F[F.length - 1],
                                             l = B.title(),
                                         l || (l = {
                                             text: ""
                                         }),
                                             l[c] = a,
                                             o.actions.doAction("changeChartFormatProperty", R, {
                                                 chart: B,
                                                 element: {
                                                     title: l
                                                 }
                                             }),
                                             p = B.title(),
                                         p || (p = {
                                             text: ""
                                         }),
                                             a = p[c],
                                             h = e.split("."),
                                             u = 0; u < h.length; u++)
                                        $ = $[h[u]];
                                    for (f = t,
                                             u = 0; u < f.length; )
                                        $ = $[f[u]][f[u + 1]],
                                            u += 2;
                                    for (u = 0; u < F.length - 1; u++)
                                        $ = $[F[u]];
                                    s = $[c] = a
                                }
                                return s;
                            case "plotArea":
                                break;
                            case "chartArea":
                                if (B) {
                                    if ("sizeAndProperties" === e)
                                        l = {
                                            name: [B.name()],
                                            x: 0,
                                            y: 0,
                                            width: 0,
                                            height: 0
                                        },
                                            c = F[F.length - 1],
                                            l[c] = "width" === c ? +a - B.width() : +a - B.height(),
                                            o.actions.doAction("updateChartSize", R, l),
                                            k = {
                                                name: [B.name()],
                                                x: B.x(),
                                                y: B.y(),
                                                width: B.width(),
                                                height: B.height()
                                            },
                                            a = k[c];
                                    else if (c = F[F.length - 1],
                                            l = {},
                                            l[c] = a,
                                            o.actions.doAction("changeChartFormatProperty", R, {
                                                chart: B,
                                                element: {
                                                    chartArea: l
                                                }
                                            }),
                                            p = B.chartArea(),
                                            a = p[c],
                                        "color" === c)
                                        for (d in D)
                                            D[d].textFill && (D[d].textFill.content[0].Text[0].data.color = a);
                                    for (h = e.split("."),
                                             u = 0; u < h.length; u++)
                                        $ = $[h[u]];
                                    for (f = t,
                                             u = 0; u < f.length; )
                                        $ = $[f[u]][f[u + 1]],
                                            u += 2;
                                    for (u = 0; u < F.length - 1; u++)
                                        $ = $[F[u]];
                                    s = $[c] = a
                                }
                                return s;
                            default:
                                return null
                        }
                    }
                    ,
                    I.prototype.getDatas = function() {
                        var e, t, i, o = [], n = this.k[this.u || this.q];
                        this.syncSelectedElement();
                        for (e in n) {
                            t = {
                                name: n[e].type,
                                properties: []
                            };
                            for (i in n[e])
                                "type" !== i && n[e][i].forEach(function(e) {
                                    var i, o, n = {};
                                    for (i in e)
                                        n.aggregate = i,
                                            o = n.editors = [],
                                            e[i].forEach(function(e) {
                                                o.push({
                                                    name: e.name,
                                                    data: e.data,
                                                    type: e.type,
                                                    resources: e.resources
                                                })
                                            });
                                    t.properties.push(n)
                                });
                            o.push(t)
                        }
                        return o
                    }
                    ,
                    I.prototype.getElements = function() {
                        var e, t, i, r = this.k, a = this.u, s = this.q, l = o.res.chart.selectedOption[s] || o.res.chart.selectedOption[a], c = {
                            currentElement: {
                                element: l,
                                item: a || s
                            }
                        };
                        c.elements = [];
                        for (e in r)
                            "series" !== e.split(" ")[0] ? (t = o.res.chart.selectedText[e],
                            n.isBarGroup(this.j) && (t = o.res.chart.selectedBarChartText[e] || t),
                                c.elements.push({
                                    element: o.res.chart.selectedOption[e],
                                    text: t,
                                    selectedElement: e
                                })) : (i = e.split(" "),
                                i.shift(),
                                c.elements.push({
                                    element: o.res.chart.selectedOption.series,
                                    text: o.res.chart.selectedText.series + " " + i.join(" "),
                                    selectedElement: e
                                }));
                        return c
                    }
                    ,
                    I.prototype.syncSelectedElement = function() {
                        this.A = void 0,
                            "series" === this.u.split(" ")[0] ? this.q = "series" : "primaryCategory" === this.u || "primaryValue" === this.u || "secondaryCategory" === this.u || "secondaryValue" === this.u ? this.q = "axis" : "primaryCategoryTitle" === this.u || "primaryCategoryMajorGridLine" === this.u || "primaryCategoryMinorGridLine" === this.u ? (this.q = "axis",
                                this.A = "primaryCategory") : "secondaryCategoryTitle" === this.u || "secondaryCategoryMajorGridLine" === this.u || "secondaryCategoryMinorGridLine" === this.u ? (this.q = "axis",
                                this.A = "secondaryCategory") : "secondaryValueTitle" === this.u || "secondaryValueMajorGridLine" === this.u || "secondaryValueMinorGridLine" === this.u ? (this.q = "axis",
                                this.A = "secondaryValue") : "primaryValueTitle" === this.u || "primaryValueMajorGridLine" === this.u || "primaryValueMinorGridLine" === this.u ? (this.q = "axis",
                                this.A = "primaryValue") : this.q = this.u
                    }
                ;
                function D(e, t, i) {
                    var o, n = this;
                    this.tabChanged = i,
                        o = $("<div></div>").addClass("panel-content-header"),
                        t.forEach(function(e) {
                            o.append(n.addTabHeader(e.name))
                        }),
                        this.activePropertyTabHeader = $(o.children()[0]),
                        this.activePropertyTabHeader.children().remove(),
                        this.activePropertyTabHeader.append($("<span></span>").addClass("selected-" + f(this.activePropertyTabHeader.attr("title"))).addClass("format-chart-panel")),
                        this.propertyTabHeaders = o,
                        e.append(o)
                }
                D.prototype.addTabHeader = function(e) {
                    var t = this
                        , i = $("<span></span>").addClass(f(e)).addClass("format-chart-panel")
                        , o = $("<div></div>").append(i).attr("title", e).addClass("format-chart-panel-background");
                    return o.click(function(e) {
                        t.tabChanged($(e.currentTarget).attr("title"))
                    }),
                        o
                }
                    ,
                    l = {
                        fill: q,
                        border: X,
                        series: _,
                        line: W,
                        size: U,
                        textFill: H,
                        legend: G,
                        font: j,
                        tick: z,
                        axisValue: P,
                        axisCategory: V,
                        textElement: E
                    };
                function F(e, t) {
                    var i, o, n, r, a = this;
                    for (this.owner = t,
                             this.propertyHeaderData = [],
                             this.propertyGroupPanels = [],
                             i = $("<div></div>"),
                             o = 0; o < e.length; o++)
                        this.propertyHeaderData.push({
                            name: e[o].name
                        });
                    for (this.propertyHeaderPanel = new D(i,this.propertyHeaderData,function(e) {
                            a.activeTabChanged(e)
                        }
                    ),
                             n = 0; n < e.length; n++)
                        r = new L(e[n].name,e[n].properties,function(e, t, i, o) {
                                return a.activePanelValueChanged(e, t, i, o)
                            }
                        ),
                            i.append(r),
                            this.propertyGroupPanels.push({
                                name: e[n].name,
                                propertyGroupPanel: r
                            });
                    return this.activePropertyGroupPanel = this.propertyGroupPanels[0].propertyGroupPanel,
                        this.showPropertyGroupPanel(this.activePropertyGroupPanel),
                        i
                }
                F.prototype.activePanelValueChanged = function(e, t, i, o) {
                    return this.owner.updateData(e, t, i, o)
                }
                    ,
                    F.prototype.activeTabChanged = function(e) {
                        for (var t = 0; t < this.propertyGroupPanels.length; t++)
                            this.propertyGroupPanels[t].name === e && (this.hidePropertyGroupPanel(this.activePropertyGroupPanel),
                                this.activePropertyGroupPanel = this.propertyGroupPanels[t].propertyGroupPanel,
                                this.showPropertyGroupPanel(this.activePropertyGroupPanel, e))
                    }
                    ,
                    F.prototype.hidePropertyGroupPanel = function(e) {
                        e.hide(),
                            this.propertyHeaderPanel.activePropertyTabHeader.children().remove(),
                            this.propertyHeaderPanel.activePropertyTabHeader.append($("<span></span>").addClass(f(this.propertyHeaderPanel.activePropertyTabHeader.attr("title"))).addClass("format-chart-panel"))
                    }
                    ,
                    F.prototype.showPropertyGroupPanel = function(e, t) {
                        var i, o;
                        for (e.show(),
                                 i = this.propertyHeaderPanel.propertyTabHeaders.children(),
                                 o = 0; o < i.length; o++)
                            $(i[o]).attr("title") === t && (this.propertyHeaderPanel.activePropertyTabHeader = $(i[o]),
                                this.propertyHeaderPanel.activePropertyTabHeader.children().remove(),
                                this.propertyHeaderPanel.activePropertyTabHeader.append($("<span></span>").addClass("selected-" + f(this.propertyHeaderPanel.activePropertyTabHeader.attr("title"))).addClass("format-chart-panel")))
                    }
                ;
                function L(e, t, i) {
                    var o, n, r, a;
                    for (t.length,
                             this.changedValue = i,
                             o = this,
                             o.name = e,
                             n = $("<div></div>").hide(),
                             r = 0; r < t.length; ) {
                        for (a = 0; a < t[r].editors.length; a++)
                            n.append(new R(t[r].editors[a],t[r].aggregate,r,a,function(e, t, i) {
                                    return o.groupContainerValueChanged(e, t, i)
                                }
                            ));
                        r++
                    }
                    return n
                }
                L.prototype.groupContainerValueChanged = function(e, t, i) {
                    return this.changedValue(this.name, e, t, i)
                }
                ;
                function R(e, t, i, o, n) {
                    var r, a, s = this;
                    return s.aggregate = t,
                        s.contentIndex = i,
                        s.index = o,
                        this.changedValue = n,
                        r = $("<div></div>"),
                        a = new B(e.name,function(e) {
                                s.updateEditorContainer(e)
                            }
                        ),
                        r.append(a),
                        this.editorContainer = new N(e,function(e, t) {
                                return s.editorContainerValueChanged(e, t)
                            }
                        ),
                        r.append(this.editorContainer),
                        r
                }
                R.prototype.editorContainerValueChanged = function(e, t) {
                    return this.changedValue(["content", this.contentIndex, this.aggregate, this.index], e, t)
                }
                    ,
                    R.prototype.updateEditorContainer = function(e) {
                        "extend" === e ? this.editorContainer.hide() : this.editorContainer.show()
                    }
                ;
                function B(e, t) {
                    return this.changedEditorStatus = t,
                        this.addEditorTitle(e)
                }
                B.prototype.addEditorTitle = function(e) {
                    var t = this
                        , i = $("<label>").text(e).css({
                        font: "Bold 12pt Calibri"
                    });
                    return t.triangleExtend = $("<div><div").css({
                        width: "0",
                        height: "0",
                        "margin-right": "6px",
                        "margin-bottom": "3px",
                        "border-right": "8px solid rgba(0, 0, 0, 0.8)",
                        "border-top": "8px solid transparent",
                        display: "inline-block"
                    }).attr("name", "extend").click(function(e) {
                        t.triangleCollapse.show(),
                            $(this).hide();
                        var i = $(e.target).attr("name");
                        t.changedEditorStatus(i)
                    }),
                        t.triangleCollapse = $("<div><div").css({
                            width: "0",
                            height: "0",
                            "margin-right": "6px",
                            "border-top": "5px solid transparent",
                            "border-left": "8px solid rgba(0, 0, 0, 0.8)",
                            "border-bottom": "5px solid transparent",
                            display: "inline-block"
                        }).attr("name", "collapse").hide().click(function(e) {
                            t.triangleExtend.show(),
                                $(this).hide();
                            var i = $(e.target).attr("name");
                            t.changedEditorStatus(i)
                        }),
                        $("<p></p>").css({
                            margin: "2px 0px 0px 15px"
                        }).append(t.triangleExtend).append(t.triangleCollapse).append(i)
                }
                    ,
                    B.prototype.changedEditorStatus = function(e) {
                        this.changedEditorStatus(e)
                    }
                ;
                function N(e, t) {
                    var i, o, n = this;
                    return this.changedValue = t,
                        i = $("<ul></ul>").css("padding-left", "30px"),
                        o = l[e.type],
                        this.editorType = new o(i,e.data,e.name,e.resources,function(e, t) {
                                return n.editorValueChanged(e, t)
                            }
                        ),
                        i
                }
                N.prototype.editorValueChanged = function(e, t) {
                    return this.changedValue("data." + e, t)
                }
                ;
                function E(e, t, i, o, n) {
                    this.textChanged = n;
                    var r = this;
                    this.textEditor = new Q(e,o.textElement,function(e) {
                            var i = r.textChanged(t.textTitle ? "textTitle" : "text", e);
                            i && r.updateUI(i)
                        }
                    ),
                        this.updateUI(t.textTitle || t.text)
                }
                E.prototype.updateUI = function(e) {
                    this.textEditor.text = e,
                        this.textEditor.updateValue()
                }
                ;
                function V(e, t, i, o, n) {
                    this.categoryTypeChanged = n;
                    var r = this;
                    this.textText = o.textText,
                        this.dateText = o.dateText,
                        this.radiogroup = new Z(e,[this.textText, this.dateText],i,function(e) {
                                return r.radioGroupSelectionChanged(e)
                            }
                        ),
                        this.settingValueEditor = new P(e,{
                                maxValue: t.maxValue,
                                minValue: t.minValue
                            },i,{
                                maxValueText: o.maxValueText,
                                minValueText: o.minValueText
                            },function(e, t) {
                                return r.categoryTypeChanged(e, t)
                            }
                        ),
                        this.updateUI(t)
                }
                V.prototype.radioGroupSelectionChanged = function(e) {
                    var t = this.categoryTypeChanged("categoryType", e.toLocaleLowerCase() === this.textText.toLocaleLowerCase() ? 1 : 2);
                    t && this.updateUI(t)
                }
                    ,
                    V.prototype.updateUI = function(e) {
                        e.categoryType && this.updateRadiogroup(e.categoryType),
                            this.updateSettingValueEditor(e)
                    }
                    ,
                    V.prototype.updateRadiogroup = function(e) {
                        var t;
                        t = 1 === e ? this.textText : this.dateText,
                            this.radiogroup.setSelectedItem(t)
                    }
                    ,
                    V.prototype.updateSettingValueEditor = function(e) {
                        1 !== e.categoryType ? this.settingValueEditor.showEditor() : this.settingValueEditor.hideEditor()
                    }
                ;
                function P(e, t, i, o, n) {
                    var r, a;
                    this.valueChanged = n,
                        r = this,
                        a = !0,
                    (o.majorUnitText || o.minorUnitText) && (this.majorUnitEditor = new Q(e,o.majorUnitText,function(e) {
                            null !== e && void 0 !== e && (e = +e);
                            var t = r.valueChanged("majorUnit", e);
                            r.updateMajorUI(t)
                        }
                        ,a),
                        this.minorUnitEditor = new Q(e,o.minorUnitText,function(e) {
                                null !== e && void 0 !== e && (e = +e);
                                var t = r.valueChanged("minorUnit", e);
                                r.updateMinorUI(t)
                            }
                            ,a),
                        this.updateMajorUI(t.majorUnit),
                        this.updateMinorUI(t.minorUnit)),
                        this.maxValueEditor = new Q(e,o.maxValueText,function(e) {
                                var t = r.valueChanged("max", e);
                                r.updateMaxUI(t)
                            }
                            ,a),
                        this.minValueEditor = new Q(e,o.minValueText,function(e) {
                                var t = r.valueChanged("min", e);
                                r.updateMinUI(t)
                            }
                            ,a),
                        this.updateMaxUI(t.maxValue),
                        this.updateMinUI(t.minValue)
                }
                P.prototype.updateMajorUI = function(e) {
                    this.majorUnitEditor.text = e,
                        this.majorUnitEditor.updateValue()
                }
                    ,
                    P.prototype.updateMinorUI = function(e) {
                        this.minorUnitEditor.text = e,
                            this.minorUnitEditor.updateValue()
                    }
                    ,
                    P.prototype.updateMaxUI = function(e) {
                        this.maxValueEditor.text = e,
                            this.maxValueEditor.updateValue()
                    }
                    ,
                    P.prototype.updateMinUI = function(e) {
                        this.minValueEditor.text = e,
                            this.minValueEditor.updateValue()
                    }
                    ,
                    P.prototype.showEditor = function() {
                        this.minValueEditor.domInput.show(),
                            this.maxValueEditor.domInput.show()
                    }
                    ,
                    P.prototype.hideEditor = function() {
                        this.minValueEditor.domInput.hide(),
                            this.maxValueEditor.domInput.hide()
                    }
                ;
                function z(e, t, i, n, r) {
                    var a, s, l;
                    this.changedTickOption = r,
                        a = this,
                        this.majorText = n.majorText,
                        this.minorText = n.minorText,
                        s = [o.res.chartSliderPanel.tick.cross, o.res.chartSliderPanel.tick.inside, o.res.chartSliderPanel.tick.none, o.res.chartSliderPanel.tick.outSide],
                        l = {},
                        l[o.res.chartSliderPanel.tick.cross] = 0,
                        l[o.res.chartSliderPanel.tick.inside] = 1,
                        l[o.res.chartSliderPanel.tick.none] = 2,
                        l[o.res.chartSliderPanel.tick.outSide] = 3,
                        this.tickCollection1 = s,
                        this.dropEditor1 = new M(e,s[t.majorTickPosition],"majorTickPosition",this.majorText,s,function(e) {
                                return a.tickCollection1[a.changedTickOption("majorTickPosition", l[e])]
                            }
                        ),
                        this.dropEditor2 = new M(e,s[t.minorTickPosition],"minorTickPosition",this.minorText,s,function(e) {
                                return a.tickCollection1[a.changedTickOption("minorTickPosition", l[e])]
                            }
                        )
                }
                c = o.res.ribbon.fontFamilies,
                    d = [c.ff1.name, c.ff2.name, c.ff3.name, c.ff4.name, c.ff5.name, c.ff6.name, c.ff7.name, c.ff8.name, c.ff9.name, c.ff10.name, c.ff11.name, c.ff12.name, c.ff13.name, c.ff14.name, c.ff15.name, c.ff16.name, c.ff17.name, c.ff18.name, c.ff19.name, c.ff20.name, c.ff21.name, c.ff22.name, c.ff23.name],
                    p = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72];
                function j(e, t, i, o, n) {
                    var r, a;
                    this.changedFontOption = n,
                        r = this,
                        this.fontFamily = o.fontFamily,
                        this.fontSize = o.fontSize,
                        a = Math.round(3 * +t.fontSize / 4) || Math.round(3 * +t.fontSizeTitle / 4),
                        this.dropEditor1 = new M(e,a,"fontSize",this.fontSize,p,function(e) {
                                return 3 * r.changedFontOption(t.fontSize ? "fontSize" : "fontSizeTitle", 4 * e / 3) / 4
                            }
                        ),
                        this.dropEditor2 = new M(e,t.fontFamily || t.fontFamilyTitle,"fontFamily",this.fontFamily,d,function(e) {
                                return r.changedFontOption(t.fontFamily ? "fontFamily" : "fontFamilyTitle", e)
                            }
                        )
                }
                function M(e, t, i, o, n, r) {
                    var a, s = this;
                    s.listChanged = r,
                        a = $("<li></li>").css({
                            margin: "4px 1px",
                            "list-style-type": "none",
                            "line-height": "28px"
                        }).append($("<lable></lable>").css({
                            "margin-left": "6px"
                        }).text(o)),
                        this.defauleItem = this.B(i),
                        a.append(this.defauleItem).appendTo(e),
                        this.itemsList = new O(n,i,function(e) {
                                s.changedValue(e)
                            }
                        ),
                        a.append(this.itemsList),
                        this.updateUI(t)
                }
                M.prototype.B = function(e) {
                    var t = this
                        , i = $("<button></button>").addClass("ui-button ui-widget ui-state-default ui-button-text-icon-secondary ui-corner-left").addClass("chart-format-panel-drop-default-button-" + e)
                        , o = $("<span></span>").addClass("panel-button-text").addClass("chart-format-panel-drop-default-span-" + e)
                        , n = $("<span></span>").addClass("ui-button-icon-secondary ui-icon ui-icon-triangle-1-s");
                    return i.append(o).append(n),
                        i.click(function() {
                            t.itemsList && t.itemsList.gcuipopup("show", {
                                of: $(this),
                                my: "left+0 top+22",
                                at: "left top"
                            })
                        }),
                        i
                }
                    ,
                    M.prototype.changedValue = function(e) {
                        var t = this.listChanged(e);
                        t && this.updateUI(t)
                    }
                    ,
                    M.prototype.updateUI = function(e) {
                        $("span:first", this.defauleItem).text(e)
                    }
                ;
                function O(e, t, i) {
                    var o = this;
                    return o.updateSelectedElement = i,
                        o.selectedElementListDom = o.addItems(e, t),
                        o.selectedElementListDom
                }
                O.prototype.addItems = function(e, t) {
                    var i, o = this, n = $("<ul></ul>").css({
                        background: "white",
                        "z-index": "10",
                        "padding-left": "0px"
                    });
                    return e.forEach(function(e) {
                        var t = $("<li></li>").attr("name", e).append($("<label></label>").text(e).css({
                            "margin-left": "2px"
                        })).css({
                            "list-style-type": "none",
                            "line-height": "25px"
                        });
                        t.click(function(e) {
                            var t = $(e.currentTarget).attr("name");
                            o.changedSelectedElement(t)
                        }).mouseenter(function() {
                            $(this).css("background", "#DBDBDB")
                        }).mouseleave(function() {
                            $(this).css("background", "white")
                        }),
                            n.append(t)
                    }),
                        i = $("<div></div>").addClass("chart-format-panel-drop-list-common chart-format-panel-drop-list-" + t).append(n),
                        i.gcuipopup({
                            autoHide: !0
                        }),
                        i
                }
                    ,
                    O.prototype.changedSelectedElement = function(e) {
                        this.updateSelectedElement(e),
                            this.selectedElementListDom.hide()
                    }
                ;
                function G(e, t, i, o, n) {
                    this.changedPosition = n;
                    var r = this;
                    this.topText = o.topText,
                        this.bottomText = o.bottomText,
                        this.leftText = o.leftText,
                        this.rightText = o.rightText,
                        this.radiogroup = new Z(e,[this.topText, this.bottomText, this.leftText, this.rightText],i,function(e) {
                                r.radioGroupSelectionChanged(e)
                            }
                        ),
                        this.updateUI(t.position)
                }
                G.prototype.radioGroupSelectionChanged = function(e) {
                    var t = this.changedPosition("position", e);
                    t && this.updateUI(t)
                }
                    ,
                    G.prototype.updateUI = function(e) {
                        var t = [, this.topText, this.rightText, this.leftText, this.bottomText];
                        this.radiogroup.setSelectedItem(t[e])
                    }
                ;
                function H(e, t, i, o, n) {
                    this.colorChanged = n;
                    var r = this;
                    this.colorEditor = new K(e,t.color || t.colorTitle,i,{
                            noColorText: o.noColorText,
                            solidColorText: o.solidColorText
                        },function(e) {
                            return r.colorChanged(t.color ? "color" : "colorTitle", e)
                        }
                    )
                }
                function U(e, t, i, n, r) {
                    var a = this;
                    a.sizeChanged = r,
                        this.widthEditor = new J(e,n.widthText,function(e) {
                                a.sizeChanged("width", e) && a.updateWidthUI(t.width)
                            }
                        ),
                        this.heightEditor = new J(e,n.heightText,function(e) {
                                a.sizeChanged("height", e) && a.updateHeightUI(t.height)
                            }
                        ),
                        a.updateWidthUI(t.width),
                        a.updateHeightUI(t.height),
                        o.wrapper.spread.getActiveSheet().bind(GC.Spread.Sheets.Events.FloatingObjectChanged, function(e, i) {
                            var o = i.floatingObject.width()
                                , n = i.floatingObject.height();
                            t.width === o && t.height === n || (a.updateWidthUI(o),
                                a.updateHeightUI(n))
                        })
                }
                U.prototype.updateWidthUI = function(e) {
                    this.widthEditor.value = e,
                        this.widthEditor.updateValue()
                }
                    ,
                    U.prototype.updateHeightUI = function(e) {
                        this.heightEditor.value = e,
                            this.heightEditor.updateValue()
                    }
                ;
                function W(e, t, i, o, n) {
                    X.call(this, e, t, i, o, n)
                }
                W.prototype = X.prototype,
                    W.prototype.constructor = X;
                function _(e, t, i, o, n) {
                    var r = this;
                    r.seriesOptionsChanged = n,
                        this.primaryAxisText = o.primaryAxisText,
                        this.secondaryAxisText = o.secondaryAxisText,
                        this.radiogroup = new Z(e,[this.primaryAxisText, this.secondaryAxisText],i,function(e) {
                                r.radioGroupSelectionChanged(e)
                            }
                        ),
                        this.updateUI(t.axisGroup)
                }
                _.prototype.radioGroupSelectionChanged = function(e) {
                    var t = this.seriesOptionsChanged("axisGroup", e.toLocaleLowerCase() === o.res.chartSliderPanel.secondaryAxis.toLocaleLowerCase() ? 1 : 0);
                    0 !== t && 1 !== t || this.updateUI(t)
                }
                    ,
                    _.prototype.updateUI = function(e) {
                        var t = e ? this.secondaryAxisText : this.primaryAxisText;
                        this.radiogroup.setSelectedItem(t)
                    }
                ;
                function q(e, t, i, o, n) {
                    this.colorChanged = n;
                    var r = this;
                    this.colorEditor = new K(e,t.backColor,i,{
                            noColorText: o.noColorText,
                            solidColorText: o.solidColorText,
                            automaticColorText: o.automaticColorText
                        },function(e) {
                            return r.colorChanged("backColor", e)
                        }
                    )
                }
                function K(e, t, i, o, n) {
                    this.changedValue = n;
                    var r = this;
                    this.noColorText = o.noColorText,
                        this.solidColorText = o.solidColorText,
                        this.automaticColorText = o.automaticColorText,
                        this.radiogroup = new Z(e,[this.noColorText, this.solidColorText, this.automaticColorText],i,function(e) {
                                return r.radioGroupSelectionChanged(e)
                            }
                        ),
                        this.colorpicker = new te(e,function(e) {
                                r.colorPicked(e)
                            }
                        ),
                        this.updateUI(t)
                }
                K.prototype.radioGroupSelectionChanged = function(e) {
                    var t;
                    e === (this.noColorText && this.noColorText.toLocaleLowerCase()) ? (t = this.changedValue("rgba(0,0,0,0)")) && this.updateUI(t) : e === (this.automaticColorText && this.automaticColorText.toLocaleLowerCase()) ? (t = this.changedValue(o.res.chartSliderPanel.automatic)) && this.updateUI(t) : (t = this.changedValue(this.colorpicker.color)) && this.updateUI(t)
                }
                    ,
                    K.prototype.colorPicked = function(e) {
                        var t = this.changedValue(e);
                        t && this.updateUI(t)
                    }
                    ,
                    K.prototype.updateUI = function(e) {
                        e ? this.updateRadiogroup(e.text || e.color || e) : this.updateRadiogroup(r),
                            e ? this.updateColorPicker(e.color || e) : this.updateColorPicker(r)
                    }
                    ,
                    K.prototype.updateRadiogroup = function(e) {
                        var t, i, n, r;
                        if (e.toLocaleLowerCase() === o.res.chartSliderPanel.automatic.toLocaleLowerCase())
                            t = this.automaticColorText;
                        else {
                            for (i = Y(e),
                                     n = e,
                                     r = i; -1 !== n.indexOf(" "); )
                                n = n.replace(" ", "");
                            for (; -1 !== r.indexOf(" "); )
                                r = r.replace(" ", "");
                            t = !0 === r ? this.automaticColorText : e && "rgba(0,0,0,0)" !== e && "rgba(0,0,0,0)" !== r ? this.solidColorText : this.noColorText
                        }
                        this.radiogroup.setSelectedItem(t)
                    }
                ;
                function Y(e) {
                    var t, i, r, s = n.getPieColorArray(e), l = a.parse(s[0], o.wrapper.spread.getActiveSheet().currentTheme()).color;
                    if (s.length > 1) {
                        for (r = 1; r < s.length - 1; r++)
                            if (t = a.parse(s[r], o.wrapper.spread.getActiveSheet().currentTheme()).color,
                                    i = a.parse(s[r - 1], o.wrapper.spread.getActiveSheet().currentTheme()).color,
                                t !== i)
                                return !0;
                        return t = a.parse(s[s.length - 1], o.wrapper.spread.getActiveSheet().currentTheme()).color,
                            i = a.parse(s[s.length - 2], o.wrapper.spread.getActiveSheet().currentTheme()).color,
                        t !== i || l
                    }
                    return l
                }
                K.prototype.updateColorPicker = function(e) {
                    for (var t = Y(e), i = e, o = t; -1 !== i.indexOf(" "); )
                        i = i.replace(" ", "");
                    for (; !0 !== o && -1 !== o.indexOf(" "); )
                        o = o.replace(" ", "");
                    i && "rgba(0,0,0,0)" !== i && !0 !== o && "rgba(0,0,0,0)" !== o ? (this.colorpicker.showColorPicker(),
                        this.colorpicker.color = t || e,
                        this.colorpicker.updateColor()) : this.colorpicker.hideColorPicker()
                }
                ;
                function X(e, t, i, o, n) {
                    this.borderChanged = n;
                    var a = this;
                    this.colorEditor = new K(e,t.majorGridLineColor || t.minorGridLineColor || t.borderColor,i,{
                            noColorText: o.noColorText,
                            solidColorText: o.solidColorText,
                            automaticColorText: o.automaticColorText
                        },function(e) {
                            var i = t.minorGridLineColor ? "minorGridLineColor" : "borderColor";
                            return a.borderChanged(t.majorGridLineColor ? "majorGridLineColor" : i, e)
                        }
                    ),
                    (null !== t.borderWidth && t.borderWidth !== r || t.majorGridLineWidth || t.minorGridLineWidth) && (this.widthEditor = new J(e,o.widthText,function(e) {
                            var i = t.minorGridLineWidth ? "minorGridLineWidth" : "borderWidth"
                                , o = a.borderChanged(t.majorGridLineWidth ? "majorGridLineWidth" : i, e);
                            o && a.updateUI(o)
                        }
                    ),
                        this.updateUI(t.majorGridLineWidth || t.minorGridLineWidth || t.borderWidth))
                }
                X.prototype.updateUI = function(e) {
                    this.widthEditor.value = e,
                        this.widthEditor.updateValue()
                }
                ;
                function J(e, t, i) {
                    this.valueChanged = i,
                        this.domInput = this.addInputNumberEditor(t),
                        e.append(this.domInput)
                }
                J.prototype.addInputNumberEditor = function(e) {
                    var t, i, o, n, r, a = this;
                    return this.value = 0,
                        t = $("<span></span>").addClass("ui-spinner ui-widget ui-widget-content ui-corner-all").css({
                            width: "85px",
                            float: "right",
                            "margin-right": "3px",
                            height: "23px"
                        }),
                        i = $("<input />", {
                            type: "input"
                        }).addClass("label-top-padding numeric column1 ui-spinner-input").css({
                            position: "absolute",
                            left: "1px",
                            top: "1px"
                        }).change(function(e) {
                            a.valueChanged(+$(e.target).val())
                        }),
                        o = $("<a />").addClass("ui-spinner-button ui-spinner-up ui-corner-tr ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({
                            width: "0",
                            height: "0",
                            "margin-left": "-1px",
                            "margin-bottom": "3px",
                            "border-left": "4px solid transparent",
                            "border-right": "4px solid transparent",
                            "border-bottom": "6px solid rgba(0, 0, 0, 0.4)",
                            display: "inline-block"
                        })).click(function(e) {
                            var t = +$(i).val();
                            t += 1,
                                $(i).val(t),
                                a.valueChanged(t)
                        }),
                        n = $("<a />").addClass("ui-spinner-button ui-spinner-down ui-corner-br ui-button ui-widget ui-state-default ui-button-text-only").append($("<div></div>").css({
                            width: "0",
                            height: "0",
                            "margin-left": "-1px",
                            "margin-top": "3px",
                            "border-width": "6px 4px 6px",
                            "border-style": "solid",
                            "border-color": "rgba(0, 0, 0, 0.4) transparent transparent",
                            display: "inline-block"
                        })).click(function(e) {
                            var t = +$(i).val();
                            t = t - 1 < 0 ? 0 : t - 1,
                                $(i).val(t),
                                a.valueChanged(t)
                        }),
                        t.append(i).append(o).append(n),
                        r = $("<label></label>").css({
                            "margin-left": "6px"
                        }).text(e),
                        $("<li></li>").append(r).append(t).css({
                            margin: "1px",
                            "list-style-type": "none",
                            "line-height": "25px"
                        })
                }
                    ,
                    J.prototype.updateValue = function() {
                        $("input", this.domInput).val(this.value)
                    }
                ;
                function Q(e, t, i, o) {
                    this.valueChanged = i,
                        this.isShowAuto = o || !1,
                        this.domInput = this.addInputTextEditor(t),
                        e.append(this.domInput)
                }
                Q.prototype.addInputTextEditor = function(e) {
                    var t, i, o = this;
                    return this.text = "",
                        this.isShowAuto ? (this.autoDescLabel = $("<div></div>").addClass("input-auto-desc").text("Auto"),
                            this.resetBtn = $("<div></div>").addClass("input-reset-btn").text("Reset").click(function() {
                                o.valueChanged(null)
                            }),
                            t = $("<input />", {
                                type: "input"
                            }).addClass("input-number-editor-auto").change(function(e) {
                                o.valueChanged($(e.target).val())
                            })) : t = $("<input />", {
                            type: "input"
                        }).addClass("input-number-editor").change(function(e) {
                            o.valueChanged($(e.target).val())
                        }),
                        i = $("<label></label>").css({
                            "margin-left": "6px",
                            float: "left",
                            width: "70px"
                        }).text(e),
                        $("<li></li>").append(i).append(t).append(this.resetBtn).append(this.autoDescLabel).css({
                            margin: "1px",
                            "list-style-type": "none",
                            "line-height": "28px",
                            height: "28px"
                        })
                }
                    ,
                    Q.prototype.updateValue = function() {
                        this.isShowAuto && (void 0 === this.text || null === this.text ? (this.resetBtn.css({
                            display: "none"
                        }),
                            this.autoDescLabel.css({
                                display: "inline-block"
                            })) : (this.autoDescLabel.css({
                            display: "none"
                        }),
                            this.resetBtn.css({
                                display: "inline-block"
                            }))),
                            $("input", this.domInput).val(this.text)
                    }
                ;
                function Z(e, t, i, o) {
                    var n = this;
                    n.updateRaidoSelectedItem = o,
                        n.domRadio = e,
                        t.forEach(function(t) {
                            t && e.append(n.addRadioItem(i, t))
                        })
                }
                Z.prototype.addRadioItem = function(e, t) {
                    var i = this
                        , o = ee(e, t);
                    return $(o.children()[0]).click(function(e) {
                        i.updateRaidoSelectedItem($(e.currentTarget).data("name"))
                    }),
                        o
                }
                    ,
                    Z.prototype.setSelectedItem = function(e) {
                        var t = e.toLocaleLowerCase();
                        $("[data-name='" + t + "']", this.domRadio).prop("checked", !0)
                    }
                ;
                function ee(e, t) {
                    var i = $("<input />", {
                        type: "radio",
                        name: e
                    }).attr("data-name", h(t)).attr("id", h(t))
                        , o = $("<label></label>").text(t).attr("for", h(t))
                        , n = $("<span></span>").append(i).append(o).attr("data-name", h(t)).attr("id", h(t));
                    return $("<li></li>").append(n).css({
                        "list-style-type": "none",
                        "line-height": "25px"
                    })
                }
                function te(e, t) {
                    this.colorChanged = t,
                        this.domColor = this.createColorElement(),
                        e.append(this.domColor)
                }
                te.prototype.createColorElement = function(e) {
                    var i, n, r, a, s = this;
                    return s.color = t || "transparent",
                        i = $("<div></div>").css({
                            width: "143px",
                            margin: "3px",
                            float: "right",
                            display: "inline-block"
                        }),
                        n = $("<span></span>").appendTo(i),
                        $("<span></span>").addClass("color-picker-span").appendTo(n),
                        r = $("<div></div>").appendTo(i),
                    s.C || (s.C = $("<div></div>").addClass("forecolor-picker").colorpicker({
                        valueChanged: function(e, t) {
                            s.colorChanged(t.name || t.color)
                        },
                        choosedColor: function(e, t) {
                            i.comboframe("close")
                        },
                        openColorDialog: function(e, t) {
                            i.comboframe("close")
                        },
                        showNoFill: !1,
                        themeColors: o.wrapper.getThemeColors()
                    }).appendTo(r)),
                        r.gcuipopup({
                            autoHide: !0,
                            showing: function(e, t) {
                                var i = s.C;
                                i.colorpicker("option", "value", s.color),
                                    i.colorpicker("option", "themeColors", o.wrapper.getThemeColors())
                            }
                        }),
                        i.comboframe().click(function() {
                            i.comboframe("open")
                        }),
                        a = $("<label></label>").css({
                            "margin-left": "6px"
                        }).text(o.res.chartSliderPanel.color),
                        $("<li></li>").append(a).append(i).addClass("format-chart-panel-color").hide()
                }
                    ,
                    te.prototype.colorChanged = function(e, t) {
                        this.colorChanged(e.target, t)
                    }
                    ,
                    te.prototype.showColorPicker = function() {
                        this.domColor.show()
                    }
                    ,
                    te.prototype.hideColorPicker = function() {
                        this.domColor.hide()
                    }
                    ,
                    te.prototype.updateColor = function() {
                        $(".color-picker-span", this.domColor).css({
                            "background-color": this.color
                        })
                    }
                ;
                function ie(e, t) {
                    return this.updateSelectedElement = t,
                        this.selectedElementListDom = this.createSlectedElementEditor(e),
                        this.selectedElementListDom
                }
                ie.prototype.createSlectedElementEditor = function(e) {
                    var t = this
                        , i = $("<ul></ul>").addClass("chart-selected-element")
                        , o = $("<div>").addClass("select-element-popup").append(i);
                    return o.gcuipopup({
                        autoHide: !0
                    }),
                        e.elements.forEach(function(e) {
                            var o = $("<li></li>").attr("data-name", e.selectedElement).append($("<label></label>").text(e.text).css({
                                "margin-left": "2px"
                            })).css({
                                "list-style-type": "none",
                                "line-height": "25px",
                                "text-overflow": "ellipsis",
                                "white-space": "nowrap",
                                overflow: "hidden",
                                width: "220px"
                            })
                                , n = "white";
                            o.click(function(e) {
                                var i = $(e.currentTarget).attr("data-name");
                                t.changedSlectedElement(i)
                            }).mouseenter(function() {
                                n = $(this).css("background-color"),
                                    $(this).css("background", "#cfeadb")
                            }).mouseleave(function() {
                                var e, t;
                                for ($(this).css("background", n),
                                         e = this.parentElement.childNodes,
                                         t = 0; t < e.length; t++)
                                    e[t] !== this && $("<div></div>").css("background", n).css("background-color") === $(e[t]).css("background-color") && "rgba(0, 0, 0, 0)" !== n && $(e[t]).css("background", "white")
                            }),
                                i.append(o)
                        }),
                        o
                }
                    ,
                    ie.prototype.changedSlectedElement = function(e) {
                        this.updateSelectedElement(e),
                            this.selectedElementListDom.hide()
                    }
                ;
                function oe(e, t) {
                    var i = this;
                    return this.selectedElementsText = [],
                        this.updateSelectedChartElement = t,
                        this.selectedElement = this.createSelectedChartElement(e),
                        e.elements.forEach(function(e) {
                            i.selectedElementsText.push({
                                key: e.selectedElement,
                                text: e.element
                            })
                        }),
                        this.selectedElement
                }
                oe.prototype.createSelectedChartElement = function(e) {
                    var t, i = this;
                    return i.elements = e,
                        t = $("<div><div").addClass("triangle-chart-selected-element").attr("name", "triangle-chart").click(function(e) {
                            var t, o, n;
                            if (e.target === e.currentTarget) {
                                if (!$(e.target).children()[0])
                                    return;
                                if (t = i.selectedItem || i.elements.currentElement.item,
                                    i.element === t)
                                    return void (i.element = r);
                                for (o = $(".select-element-popup", $(e.target)).children()[0].children,
                                         n = 0; n < o.length; n++)
                                    $(o[n]).css("background", "white");
                                $("[data-name='" + t + "']", $(e.target.children[0])).css("background", "#92d3af"),
                                    $(".select-element-popup", $(e.target)).gcuipopup("show", {
                                        of: $(".this-class"),
                                        my: "left+6 top+22",
                                        at: "left top"
                                    }),
                                    i.element = t
                            }
                        }),
                        t.append(new ie(e,function(e) {
                                i.selectedItem = e,
                                    i.changedSelectedChartElement(e)
                            }
                        )),
                        $("<div></div>").css({
                            color: "rgba(0, 0, 0, 0.7)",
                            height: "25px"
                        }).append($("<div>").addClass("this-class").css({
                            padding: "2px 15px"
                        }).append($("<label>").text(e.currentElement.element).css({
                            "font-weight": "bold",
                            "font-size": "10pt"
                        })).append(t))
                }
                    ,
                    oe.prototype.changedSelectedChartElement = function(e) {
                        var t, i = this.selectedElementsText;
                        for (t = 0; t < i.length; t++)
                            if (i[t].key === e) {
                                this.updateSelectedChartElementText(i[t].text);
                                break
                            }
                        this.updateSelectedChartElement(e)
                    }
                    ,
                    oe.prototype.updateSelectedChartElementText = function(e) {
                        $("label:first", this.selectedElement).text(e)
                    }
                ;
                function ne(e, t) {
                    var i, o = $("<div>").css({
                        color: "rgba(0, 0, 0, 0.8)",
                        height: "40px"
                    }).appendTo(e), n = t.getHeaderData().title;
                    o.children().remove(),
                        i = $("<div>").css({
                            padding: "0px 10px",
                            "padding-top": "10px"
                        }).appendTo(o),
                        $("<label>").text(n).css({
                            "font-size": "17pt",
                            "font-weight": "lighter",
                            color: "#08892c"
                        }).appendTo(i),
                        $("<span>").addClass("slider-panel-close-button").appendTo(i).click(g)
                }
                function re(e, t) {
                    var i = $("<div>").css({
                        width: "100%",
                        position: "absolute",
                        top: "40px",
                        bottom: "0"
                    }).addClass("slider-panel-content").appendTo(e);
                    return new ae(i,t)
                }
                function ae(e, t) {
                    var i = this;
                    this.owner = t,
                        this.container = e,
                        this.container.append(new oe(this.owner.getElements(),function(e) {
                                i.updateChartPanelTab(e)
                            }
                        )),
                        this.initChartPanelContent()
                }
                ae.prototype.initChartPanelContent = function() {
                    var e = this.owner.getDatas();
                    this.chartPanelContentDom = new F(e,this.owner),
                        this.container.append(this.chartPanelContentDom)
                }
                    ,
                    ae.prototype.updateChartPanelTab = function(e) {
                        this.owner.u = e,
                            this.chartPanelContentDom.remove(),
                            this.initChartPanelContent()
                    }
                ;
                function se(e, t) {
                    e.sliderpanel();
                    var i = e.sliderpanel("getContainer", "panel2");
                    i.children().remove(),
                        ne(i, t),
                        re(i, t)
                }
                function le(e, t, i) {
                    u.setCurrentChart(e),
                        u.setAllData(i.data),
                        u.setSelectedElement(i.selectedElement),
                        u.setChartCategories(i.categories),
                        se(t, u)
                }
                function ce(e, t, i) {
                    var o = {
                        chart: e,
                        selectedElement: t,
                        data: {},
                        categories: i
                    };
                    return w(e, o.data, i),
                        C(e, o.data),
                        S(e, o.data),
                        k(e, o.data),
                        T(e, o.data),
                        A(e, o.data),
                        o
                }
                function de(e, t, i, o) {
                    var r = $(".slider-panel");
                    u = new I,
                        he(e, t, i, o || n.getChartSeriesNames(e), r),
                        r.sliderpanel("open", "panel2")
                }
                function pe(e) {
                    var t, i = $(".slider-panel");
                    u && i.is(":visible") && (t = ce(e, {
                        chartElement: u.q,
                        selectedItem: u.u
                    }, u.v),
                        ue(t),
                        le(e, i, t))
                }
                function ue(e) {
                    for (var t in e.data)
                        if ("" + t === e.selectedElement.selectedItem)
                            return;
                    e.selectedElement.selectedItem = "chartArea",
                        e.selectedElement.chartElement = "chartArea"
                }
                function he(e, t, i, o, n) {
                    var r = ce(e, {
                        chartElement: t,
                        selectedItem: i
                    }, o);
                    ue(r),
                        le(e, n, r)
                }
                e.exports = {
                    initChartSliderPanel: de,
                    refreshSliderPanel: pe
                }
            }()
        }
        , function(e, t) {
            !function() {
                "use strict";
                var e, t = GC.Spread.Sheets.Charts.Chart.prototype.toJSON;
                GC.Spread.Sheets.Charts.Chart.prototype.toJSON = function() {
                    var e = this
                        , i = t.call(e)
                        , o = this.colorAndStyle;
                    return o && (i.colorAndStyle = o),
                        i
                }
                    ,
                    e = GC.Spread.Sheets.Charts.Chart.prototype.fromJSON,
                    GC.Spread.Sheets.Charts.Chart.prototype.fromJSON = function(t, i) {
                        var o, n = this;
                        e.call(n, t, i),
                        (o = t.colorAndStyle) && (n.colorAndStyle = o)
                    }
            }()
        }
        , function(e, t, i) {
            !function() {
                "use strict";
                i(0),
                    i(16),
                    i(18),
                    i(15),
                    i(17)
            }()
        }
        , function(e, t, i) {
            !function() {
                "use strict";
                i(20),
                    i(22),
                    i(23),
                    i(21),
                    i(25)
            }()
        }
        , function(e, t, i) {
            !function() {
                "use strict";
                i(29),
                    i(26),
                    i(36),
                    i(10),
                    i(19),
                    i(24),
                    i(28),
                    i(27)
            }()
        }
        , function(e, t, i) {
            !function() {
                "use strict";
                i(33),
                    i(35),
                    i(32),
                    i(30),
                    i(31),
                    i(34)
            }()
        }
        , function(module, exports) {
            var __extends, gcui, designer = GC.Spread.Sheets.Designer;
            !function(e, t) {
                var i, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T;
                i = function(e) {
                    return new i.prototype.init(e)
                }
                    ,
                    e.Globalize = i,
                    i.cultures = {},
                    i.prototype = {
                        constructor: i,
                        init: function(e) {
                            return this.cultures = i.cultures,
                                this.cultureSelector = e,
                                this
                        }
                    },
                    i.prototype.init.prototype = i.prototype,
                    i.cultures.default = {
                        name: "en",
                        englishName: "English",
                        nativeName: "English",
                        isRTL: !1,
                        language: "en",
                        numberFormat: {
                            pattern: ["-n"],
                            decimals: 2,
                            ",": ",",
                            ".": ".",
                            groupSizes: [3],
                            "+": "+",
                            "-": "-",
                            NaN: "NaN",
                            negativeInfinity: "-Infinity",
                            positiveInfinity: "Infinity",
                            percent: {
                                pattern: ["-n %", "n %"],
                                decimals: 2,
                                groupSizes: [3],
                                ",": ",",
                                ".": ".",
                                symbol: "%"
                            },
                            currency: {
                                pattern: ["($n)", "$n"],
                                decimals: 2,
                                groupSizes: [3],
                                ",": ",",
                                ".": ".",
                                symbol: "$"
                            }
                        },
                        calendars: {
                            standard: {
                                name: "Gregorian_USEnglish",
                                "/": "/",
                                ":": ":",
                                firstDay: 0,
                                days: {
                                    names: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
                                    namesAbbr: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
                                    namesShort: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"]
                                },
                                months: {
                                    names: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December", ""],
                                    namesAbbr: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec", ""]
                                },
                                AM: ["AM", "am", "AM"],
                                PM: ["PM", "pm", "PM"],
                                eras: [{
                                    name: "A.D.",
                                    start: null,
                                    offset: 0
                                }],
                                twoDigitYearMax: 2029,
                                patterns: {
                                    d: "M/d/yyyy",
                                    D: "dddd, MMMM dd, yyyy",
                                    t: "h:mm tt",
                                    T: "h:mm:ss tt",
                                    f: "dddd, MMMM dd, yyyy h:mm tt",
                                    F: "dddd, MMMM dd, yyyy h:mm:ss tt",
                                    M: "MMMM dd",
                                    Y: "yyyy MMMM",
                                    S: "yyyy'-'MM'-'dd'T'HH':'mm':'ss"
                                }
                            }
                        },
                        messages: {}
                    },
                    i.cultures.default.calendar = i.cultures.default.calendars.standard,
                    i.cultures.en = i.cultures.default,
                    i.cultureSelector = "en",
                    o = /^0x[a-f0-9]+$/i,
                    n = /^[+-]?infinity$/i,
                    r = /^[+-]?\d*\.?\d*(e[+-]?\d+)?$/,
                    a = /^\s+|\s+$/g,
                    s = function(e, t) {
                        if (e.indexOf)
                            return e.indexOf(t);
                        for (var i = 0, o = e.length; i < o; i++)
                            if (e[i] === t)
                                return i;
                        return -1
                    }
                    ,
                    l = function(e, t) {
                        return e.substr(e.length - t.length) === t
                    }
                    ,
                    c = function(e) {
                        var i, o, n, r, a, s, l = arguments[0] || {}, h = 1, f = arguments.length, e = !1;
                        for ("boolean" == typeof l && (e = l,
                            l = arguments[1] || {},
                            h = 2),
                             "object" == typeof l || p(l) || (l = {}); h < f; h++)
                            if (null != (i = arguments[h]))
                                for (o in i)
                                    n = l[o],
                                        r = i[o],
                                    l !== r && (e && r && (u(r) || (a = d(r))) ? (a ? (a = !1,
                                        s = n && d(n) ? n : []) : s = n && u(n) ? n : {},
                                        l[o] = c(e, s, r)) : r !== t && (l[o] = r));
                        return l
                    }
                    ,
                    d = Array.isArray || function(e) {
                        return "[object Array]" === Object.prototype.toString.call(e)
                    }
                    ,
                    p = function(e) {
                        return "[object Function]" === Object.prototype.toString.call(e)
                    }
                    ,
                    u = function(e) {
                        return "[object Object]" === Object.prototype.toString.call(e)
                    }
                    ,
                    h = function(e, t) {
                        return 0 === e.indexOf(t)
                    }
                    ,
                    f = function(e) {
                        return (e + "").replace(a, "")
                    }
                    ,
                    g = function(e) {
                        return isNaN(e) ? NaN : 0 | e
                    }
                    ,
                    m = function(e, t, i) {
                        for (var o = e.length; o < t; o += 1)
                            e = i ? "0" + e : e + "0";
                        return e
                    }
                    ,
                    b = function(e, t) {
                        var i, o, n, r, a;
                        for (i = 0,
                                 o = !1,
                                 n = 0,
                                 r = e.length; n < r; n++)
                            switch (a = e.charAt(n)) {
                                case "'":
                                    o ? t.push("'") : i++,
                                        o = !1;
                                    break;
                                case "\\":
                                    o && t.push("\\"),
                                        o = !o;
                                    break;
                                default:
                                    t.push(a),
                                        o = !1
                            }
                        return i
                    }
                    ,
                    v = function(e, t) {
                        t = t || "F";
                        var i, o = e.patterns, n = t.length;
                        if (1 === n) {
                            if (!(i = o[t]))
                                throw "Invalid date format string '" + t + "'.";
                            t = i
                        } else
                            2 === n && "%" === t.charAt(0) && (t = t.charAt(1));
                        return t
                    }
                    ,
                    y = function(e, t, i) {
                        var o, n, r, a, s, l, c, d, p, u, h, f, g, m, x, k, T, A, I, D, $ = i.calendar, F = $.convert;
                        if (!t || !t.length || "i" === t)
                            return i && i.name.length ? F ? o = y(e, $.patterns.F, i) : (n = new Date(e.getTime()),
                                r = C(e, $.eras),
                                n.setFullYear(S(e, $, r)),
                                o = n.toLocaleString()) : o = "" + e,
                                o;
                        a = $.eras,
                            s = "s" === t,
                            t = v($, t),
                            o = [],
                            c = ["0", "00", "000"],
                            u = /([^d]|^)(d|dd)([^d]|$)/g,
                            h = 0,
                            f = w();
                        function L(e, t) {
                            var i, o = e + "";
                            return t > 1 && o.length < t ? (i = c[t - 2] + o,
                                i.substr(i.length - t, t)) : i = o
                        }
                        function R() {
                            return d || p ? d : (d = u.test(t),
                                p = !0,
                                d)
                        }
                        function B(e, t) {
                            if (g)
                                return g[t];
                            switch (t) {
                                case 0:
                                    return e.getFullYear();
                                case 1:
                                    return e.getMonth();
                                case 2:
                                    return e.getDate()
                            }
                        }
                        for (!s && F && (g = F.fromGregorian(e)); m = f.lastIndex,
                            x = f.exec(t),
                            k = t.slice(m, x ? x.index : t.length),
                            h += b(k, o),
                            x; )
                            if (h % 2)
                                o.push(x[0]);
                            else
                                switch (T = x[0],
                                    A = T.length,
                                    T) {
                                    case "ddd":
                                    case "dddd":
                                        I = 3 === A ? $.days.namesAbbr : $.days.names,
                                            o.push(I[e.getDay()]);
                                        break;
                                    case "d":
                                    case "dd":
                                        d = !0,
                                            o.push(L(B(e, 2), A));
                                        break;
                                    case "MMM":
                                    case "MMMM":
                                        D = B(e, 1),
                                            o.push($.monthsGenitive && R() ? $.monthsGenitive[3 === A ? "namesAbbr" : "names"][D] : $.months[3 === A ? "namesAbbr" : "names"][D]);
                                        break;
                                    case "M":
                                    case "MM":
                                        o.push(L(B(e, 1) + 1, A));
                                        break;
                                    case "y":
                                    case "yy":
                                    case "yyyy":
                                        D = g ? g[0] : S(e, $, C(e, a), s),
                                        A < 4 && (D %= 100),
                                            o.push(L(D, A));
                                        break;
                                    case "h":
                                    case "hh":
                                        l = e.getHours() % 12,
                                        0 === l && (l = 12),
                                            o.push(L(l, A));
                                        break;
                                    case "H":
                                    case "HH":
                                        o.push(L(e.getHours(), A));
                                        break;
                                    case "m":
                                    case "mm":
                                        o.push(L(e.getMinutes(), A));
                                        break;
                                    case "s":
                                    case "ss":
                                        o.push(L(e.getSeconds(), A));
                                        break;
                                    case "t":
                                    case "tt":
                                        D = e.getHours() < 12 ? $.AM ? $.AM[0] : " " : $.PM ? $.PM[0] : " ",
                                            o.push(1 === A ? D.charAt(0) : D);
                                        break;
                                    case "f":
                                    case "ff":
                                    case "fff":
                                        o.push(L(e.getMilliseconds(), 3).substr(0, A));
                                        break;
                                    case "z":
                                    case "zz":
                                        l = e.getTimezoneOffset() / 60,
                                            o.push((l <= 0 ? "+" : "-") + L(Math.floor(Math.abs(l)), A));
                                        break;
                                    case "zzz":
                                        l = e.getTimezoneOffset() / 60,
                                            o.push((l <= 0 ? "+" : "-") + L(Math.floor(Math.abs(l)), 2) + ":" + L(Math.abs(e.getTimezoneOffset() % 60), 2));
                                        break;
                                    case "g":
                                    case "gg":
                                        $.eras && o.push($.eras[C(e, a)].name);
                                        break;
                                    case "/":
                                        o.push($["/"]);
                                        break;
                                    default:
                                        throw "Invalid date format pattern '" + T + "'."
                                }
                        return o.join("")
                    }
                    ,
                    function() {
                        var e;
                        e = function(e, t, i) {
                            var o, n, r, a, s, l, c, d, p = i.groupSizes, u = p[0], h = 1, f = Math.pow(10, t), g = Math.round(e * f) / f;
                            for (isFinite(g) || (g = e),
                                     e = g,
                                     o = e + "",
                                     n = "",
                                     r = o.split(/e/i),
                                     a = r.length > 1 ? parseInt(r[1], 10) : 0,
                                     o = r[0],
                                     r = o.split("."),
                                     o = r[0],
                                     n = r.length > 1 ? r[1] : "",
                                     a > 0 ? (n = m(n, a, !1),
                                         o += n.slice(0, a),
                                         n = n.substr(a)) : a < 0 && (a = -a,
                                         o = m(o, a + 1),
                                         n = o.slice(-a, o.length) + n,
                                         o = o.slice(0, -a)),
                                     n = t > 0 ? i["."] + (n.length > t ? n.slice(0, t) : m(n, t)) : "",
                                     l = o.length - 1,
                                     c = i[","],
                                     d = ""; l >= 0; ) {
                                if (0 === u || u > l)
                                    return o.slice(0, l + 1) + (d.length ? c + d + n : n);
                                d = o.slice(l - u + 1, l + 1) + (d.length ? c + d : ""),
                                    l -= u,
                                h < p.length && (u = p[h],
                                    h++)
                            }
                            return o.slice(0, l + 1) + c + d + n
                        }
                            ,
                            x = function(t, i, o) {
                                var n, r, a, s, l, c, d, p, u, h;
                                if (!isFinite(t))
                                    return t === 1 / 0 ? o.numberFormat.positiveInfinity : t === -1 / 0 ? o.numberFormat.negativeInfinity : o.numberFormat.NaN;
                                if (!i || "i" === i)
                                    return o.name.length ? t.toLocaleString() : "" + t;
                                switch (i = i || "D",
                                    n = o.numberFormat,
                                    r = Math.abs(t),
                                    a = -1,
                                i.length > 1 && (a = parseInt(i.slice(1), 10)),
                                    l = i.charAt(0).toUpperCase()) {
                                    case "D":
                                        s = "n",
                                            r = g(r),
                                        -1 !== a && (r = m("" + r, a, !0)),
                                        t < 0 && (r = "-" + r);
                                        break;
                                    case "N":
                                        c = n;
                                    case "C":
                                        c = c || n.currency;
                                    case "P":
                                        c = c || n.percent,
                                            s = t < 0 ? c.pattern[0] : c.pattern[1] || "n",
                                        -1 === a && (a = c.decimals),
                                            r = e(r * ("P" === l ? 100 : 1), a, c);
                                        break;
                                    default:
                                        throw "Bad number format specifier: " + l
                                }
                                for (d = /n|\$|-|%/g,
                                         p = ""; u = d.lastIndex,
                                         h = d.exec(s),
                                         p += s.slice(u, h ? h.index : s.length),
                                         h; )
                                    switch (h[0]) {
                                        case "n":
                                            p += r;
                                            break;
                                        case "$":
                                            p += n.currency.symbol;
                                            break;
                                        case "-":
                                            /[1-9]/.test(r) && (p += n["-"]);
                                            break;
                                        case "%":
                                            p += n.percent.symbol
                                    }
                                return p
                            }
                    }(),
                    w = function() {
                        return /\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g
                    }
                    ,
                    C = function(e, t) {
                        if (!t)
                            return 0;
                        for (var i, o = e.getTime(), n = 0, r = t.length; n < r; n++)
                            if (null === (i = t[n].start) || o >= i)
                                return n;
                        return 0
                    }
                    ,
                    S = function(e, t, i, o) {
                        var n = e.getFullYear();
                        return !o && t.eras && (n -= t.eras[i].offset),
                            n
                    }
                    ,
                    function() {
                        var e, t, i, o, n, r, a;
                        e = function(e, t) {
                            if (t < 100) {
                                var i = new Date
                                    , o = C(i)
                                    , n = S(i, e, o)
                                    , r = e.twoDigitYearMax;
                                r = "string" == typeof r ? (new Date).getFullYear() % 100 + parseInt(r, 10) : r,
                                    t += n - n % 100,
                                t > r && (t -= 100)
                            }
                            return t
                        }
                            ,
                            t = function(e, t, i) {
                                var o, n = e.days, l = e.G;
                                return l || (e.G = l = [a(n.names), a(n.namesAbbr), a(n.namesShort)]),
                                    t = r(t),
                                    i ? -1 === (o = s(l[1], t)) && (o = s(l[2], t)) : o = s(l[0], t),
                                    o
                            }
                            ,
                            i = function(e, t, i) {
                                var o, n = e.months, l = e.monthsGenitive || e.months, c = e.H, d = e.I;
                                return c || (e.H = c = [a(n.names), a(n.namesAbbr)],
                                    e.I = d = [a(l.names), a(l.namesAbbr)]),
                                    t = r(t),
                                    o = s(i ? c[1] : c[0], t),
                                o < 0 && (o = s(i ? d[1] : d[0], t)),
                                    o
                            }
                            ,
                            o = function(e, t) {
                                var i, o, n, r, a, s, l, c, d, p, u, h, f, g, m = e.J;
                                if (m) {
                                    if (i = m[t])
                                        return i
                                } else
                                    e.J = m = {};
                                for (o = v(e, t).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g, "\\\\$1"),
                                         n = ["^"],
                                         r = [],
                                         a = 0,
                                         s = 0,
                                         l = w(); null !== (c = l.exec(o)); )
                                    if (d = o.slice(a, c.index),
                                            a = l.lastIndex,
                                        (s += b(d, n)) % 2)
                                        n.push(c[0]);
                                    else {
                                        switch (p = c[0],
                                            u = p.length,
                                            p) {
                                            case "dddd":
                                            case "ddd":
                                            case "MMMM":
                                            case "MMM":
                                            case "gg":
                                            case "g":
                                                h = "(\\D+)";
                                                break;
                                            case "tt":
                                            case "t":
                                                h = "(\\D*)";
                                                break;
                                            case "yyyy":
                                            case "fff":
                                            case "ff":
                                            case "f":
                                                h = "(\\d{" + u + "})";
                                                break;
                                            case "dd":
                                            case "d":
                                            case "MM":
                                            case "M":
                                            case "yy":
                                            case "y":
                                            case "HH":
                                            case "H":
                                            case "hh":
                                            case "h":
                                            case "mm":
                                            case "m":
                                            case "ss":
                                            case "s":
                                                h = "(\\d\\d?)";
                                                break;
                                            case "zzz":
                                                h = "([+-]?\\d\\d?:\\d{2})";
                                                break;
                                            case "zz":
                                            case "z":
                                                h = "([+-]?\\d\\d?)";
                                                break;
                                            case "/":
                                                h = "(\\" + e["/"] + ")";
                                                break;
                                            default:
                                                throw "Invalid date format pattern '" + p + "'."
                                        }
                                        h && n.push(h),
                                            r.push(c[0])
                                    }
                                return b(o.slice(a), n),
                                    n.push("$"),
                                    f = n.join("").replace(/\s+/g, "\\s+"),
                                    g = {
                                        regExp: f,
                                        groups: r
                                    },
                                    m[t] = g
                            }
                            ,
                            n = function(e, t, i) {
                                return e < t || e > i
                            }
                            ,
                            r = function(e) {
                                return e.split("\xa0").join(" ").toUpperCase()
                            }
                            ,
                            a = function(e) {
                                for (var t = [], i = 0, o = e.length; i < o; i++)
                                    t[i] = r(e[i]);
                                return t
                            }
                            ,
                            k = function(r, a, s) {
                                var l, c, d, p, u, g, m, b, v, y, x, w, C, S, k, T, A, I, D, $, F, L, R, B, N, E, V, P, z, j, M;
                                if (r = f(r),
                                        l = s.calendar,
                                        c = o(l, a),
                                        d = RegExp(c.regExp).exec(r),
                                    null === d)
                                    return null;
                                for (p = c.groups,
                                         u = null,
                                         g = null,
                                         m = null,
                                         b = null,
                                         v = null,
                                         y = 0,
                                         w = 0,
                                         C = 0,
                                         S = 0,
                                         k = null,
                                         T = !1,
                                         A = 0,
                                         I = p.length; A < I; A++)
                                    if (D = d[A + 1])
                                        switch ($ = p[A],
                                            F = $.length,
                                            L = parseInt(D, 10),
                                            $) {
                                            case "dd":
                                            case "d":
                                                if (b = L,
                                                        n(b, 1, 31))
                                                    return null;
                                                break;
                                            case "MMM":
                                            case "MMMM":
                                                if (m = i(l, D, 3 === F),
                                                        n(m, 0, 11))
                                                    return null;
                                                break;
                                            case "M":
                                            case "MM":
                                                if (m = L - 1,
                                                        n(m, 0, 11))
                                                    return null;
                                                break;
                                            case "y":
                                            case "yy":
                                            case "yyyy":
                                                if (g = F < 4 ? e(l, L) : L,
                                                        n(g, 0, 9999))
                                                    return null;
                                                break;
                                            case "h":
                                            case "hh":
                                                if (y = L,
                                                    12 === y && (y = 0),
                                                        n(y, 0, 11))
                                                    return null;
                                                break;
                                            case "H":
                                            case "HH":
                                                if (y = L,
                                                        n(y, 0, 23))
                                                    return null;
                                                break;
                                            case "m":
                                            case "mm":
                                                if (w = L,
                                                        n(w, 0, 59))
                                                    return null;
                                                break;
                                            case "s":
                                            case "ss":
                                                if (C = L,
                                                        n(C, 0, 59))
                                                    return null;
                                                break;
                                            case "tt":
                                            case "t":
                                                if (!(T = l.PM && (D === l.PM[0] || D === l.PM[1] || D === l.PM[2])) && (!l.AM || D !== l.AM[0] && D !== l.AM[1] && D !== l.AM[2]))
                                                    return null;
                                                break;
                                            case "f":
                                            case "ff":
                                            case "fff":
                                                if (S = L * Math.pow(10, 3 - F),
                                                        n(S, 0, 999))
                                                    return null;
                                                break;
                                            case "ddd":
                                            case "dddd":
                                                if (v = t(l, D, 3 === F),
                                                        n(v, 0, 6))
                                                    return null;
                                                break;
                                            case "zzz":
                                                if (R = D.split(/:/),
                                                    2 !== R.length)
                                                    return null;
                                                if (x = parseInt(R[0], 10),
                                                        n(x, -12, 13))
                                                    return null;
                                                if (B = parseInt(R[1], 10),
                                                        n(B, 0, 59))
                                                    return null;
                                                k = 60 * x + (h(D, "-") ? -B : B);
                                                break;
                                            case "z":
                                            case "zz":
                                                if (x = L,
                                                        n(x, -12, 13))
                                                    return null;
                                                k = 60 * x;
                                                break;
                                            case "g":
                                            case "gg":
                                                if (!(N = D) || !l.eras)
                                                    return null;
                                                for (N = f(N.toLowerCase()),
                                                         E = 0,
                                                         V = l.eras.length; E < V; E++)
                                                    if (N === l.eras[E].name.toLowerCase()) {
                                                        u = E;
                                                        break
                                                    }
                                                if (null === u)
                                                    return null
                                        }
                                if (P = new Date,
                                        j = l.convert,
                                        z = j ? j.fromGregorian(P)[0] : P.getFullYear(),
                                        null === g ? g = z : l.eras && (g += l.eras[u || 0].offset),
                                    null === m && (m = 0),
                                    null === b && (b = 1),
                                        j) {
                                    if (null === (P = j.toGregorian(g, m, b)))
                                        return null
                                } else {
                                    if (P.setFullYear(g, m, b),
                                        P.getDate() !== b)
                                        return null;
                                    if (null !== v && P.getDay() !== v)
                                        return null
                                }
                                return T && y < 12 && (y += 12),
                                    P.setHours(y, w, C, S),
                                null !== k && (M = P.getMinutes() - (k + P.getTimezoneOffset()),
                                    P.setHours(P.getHours() + parseInt(M / 60, 10), M % 60)),
                                    P
                            }
                    }(),
                    T = function(e, t, i) {
                        var o = t["-"], n = t["+"], r;
                        switch (i) {
                            case "n -":
                                o = " " + o,
                                    n = " " + n;
                            case "n-":
                                l(e, o) ? r = ["-", e.substr(0, e.length - o.length)] : l(e, n) && (r = ["+", e.substr(0, e.length - n.length)]);
                                break;
                            case "- n":
                                o += " ",
                                    n += " ";
                            case "-n":
                                h(e, o) ? r = ["-", e.substr(o.length)] : h(e, n) && (r = ["+", e.substr(n.length)]);
                                break;
                            case "(n)":
                                h(e, "(") && l(e, ")") && (r = ["-", e.substr(1, e.length - 2)])
                        }
                        return r || ["", e]
                    }
                    ,
                    i.prototype.findClosestCulture = function(e) {
                        return i.findClosestCulture.call(this, e)
                    }
                    ,
                    i.prototype.format = function(e, t, o) {
                        return i.format.call(this, e, t, o)
                    }
                    ,
                    i.prototype.localize = function(e, t) {
                        return i.localize.call(this, e, t)
                    }
                    ,
                    i.prototype.parseInt = function(e, t, o) {
                        return i.parseInt.call(this, e, t, o)
                    }
                    ,
                    i.prototype.parseFloat = function(e, t, o) {
                        return i.parseFloat.call(this, e, t, o)
                    }
                    ,
                    i.prototype.culture = function(e) {
                        return i.culture.call(this, e)
                    }
                    ,
                    i.addCultureInfo = function(e, t, i) {
                        var o = {}
                            , n = !1;
                        "string" != typeof e ? (i = e,
                            e = this.culture().name,
                            o = this.cultures[e]) : "string" != typeof t ? (i = t,
                            n = null == this.cultures[e],
                            o = this.cultures[e] || this.cultures.default) : (n = !0,
                            o = this.cultures[t]),
                            this.cultures[e] = c(!0, {}, o, i),
                        n && (this.cultures[e].calendar = this.cultures[e].calendars.standard)
                    }
                    ,
                    i.findClosestCulture = function(e) {
                        var t, i, o, n, r, a, s, l, c, p, u, h;
                        if (!e)
                            return this.cultures[this.cultureSelector] || this.cultures.default;
                        if ("string" == typeof e && (e = e.split(",")),
                                d(e)) {
                            for (o = this.cultures,
                                     n = e,
                                     r = n.length,
                                     a = [],
                                     s = 0; s < r; s++)
                                e = f(n[s]),
                                    c = e.split(";"),
                                    i = f(c[0]),
                                    1 === c.length ? l = 1 : (e = f(c[1]),
                                        0 === e.indexOf("q=") ? (e = e.substr(2),
                                            l = parseFloat(e),
                                            l = isNaN(l) ? 0 : l) : l = 1),
                                    a.push({
                                        lang: i,
                                        pri: l
                                    });
                            for (a.sort(function(e, t) {
                                return e.pri < t.pri ? 1 : -1
                            }),
                                     s = 0; s < r; s++)
                                if (i = a[s].lang,
                                        t = o[i])
                                    return t;
                            for (s = 0; s < r; s++)
                                for (i = a[s].lang; ; ) {
                                    if (-1 === (p = i.lastIndexOf("-")))
                                        break;
                                    if (i = i.substr(0, p),
                                            t = o[i])
                                        return t
                                }
                            for (s = 0; s < r; s++) {
                                i = a[s].lang;
                                for (u in o)
                                    if (h = o[u],
                                        h.language == i)
                                        return h
                            }
                        } else if ("object" == typeof e)
                            return e;
                        return t || null
                    }
                    ,
                    i.format = function(e, t, i) {
                        return culture = this.findClosestCulture(i),
                            e instanceof Date ? e = y(e, t, culture) : "number" == typeof e && (e = x(e, t, culture)),
                            e
                    }
                    ,
                    i.localize = function(e, t) {
                        return this.findClosestCulture(t).messages[e] || this.cultures.default.messages[e]
                    }
                    ,
                    i.parseDate = function(e, t, i) {
                        var o, n, r, a, s, l;
                        if (i = this.findClosestCulture(i),
                                t) {
                            if ("string" == typeof t && (t = [t]),
                                    t.length)
                                for (a = 0,
                                         s = t.length; a < s && (!(l = t[a]) || !(o = k(e, l, i))); a++)
                                    ;
                        } else {
                            r = i.calendar.patterns;
                            for (n in r)
                                if (o = k(e, r[n], i))
                                    break
                        }
                        return o || null
                    }
                    ,
                    i.parseInt = function(e, t, o) {
                        return g(i.parseFloat(e, t, o))
                    }
                    ,
                    i.parseFloat = function(e, t, i) {
                        var a, s, l, c, d, p, u, h, g, m, b, v, y, x, w, C, S;
                        return "number" != typeof t && (i = t,
                            t = 10),
                            a = this.findClosestCulture(i),
                            s = NaN,
                            l = a.numberFormat,
                        e.indexOf(a.numberFormat.currency.symbol) > -1 && (e = e.replace(a.numberFormat.currency.symbol, ""),
                            e = e.replace(a.numberFormat.currency["."], a.numberFormat["."])),
                            e = f(e),
                            n.test(e) ? s = parseFloat(e) : !t && o.test(e) ? s = parseInt(e, 16) : (c = T(e, l, l.pattern[0]),
                                d = c[0],
                                p = c[1],
                            "" === d && "(n)" !== l.pattern[0] && (c = T(e, l, "(n)"),
                                d = c[0],
                                p = c[1]),
                            "" === d && "-n" !== l.pattern[0] && (c = T(e, l, "-n"),
                                d = c[0],
                                p = c[1]),
                                d = d || "+",
                                g = p.indexOf("e"),
                            g < 0 && (g = p.indexOf("E")),
                                g < 0 ? (h = p,
                                    u = null) : (h = p.substr(0, g),
                                    u = p.substr(g + 1)),
                                v = l["."],
                                y = h.indexOf(v),
                                y < 0 ? (m = h,
                                    b = null) : (m = h.substr(0, y),
                                    b = h.substr(y + v.length)),
                                x = l[","],
                                m = m.split(x).join(""),
                                w = x.replace(/\u00A0/g, " "),
                            x !== w && (m = m.split(w).join("")),
                                C = d + m,
                            null !== b && (C += "." + b),
                            null !== u && (S = T(u, l, "-n"),
                                C += "e" + (S[0] || "+") + S[1]),
                            r.test(C) && (s = parseFloat(C))),
                            s
                    }
                    ,
                    i.culture = function(e) {
                        return void 0 !== e && (this.cultureSelector = e),
                        this.findClosestCulture(e) || this.culture.default
                    }
            }(window),
                __extends = this.K || function(e, t) {
                    function i() {
                        this.constructor = e
                    }
                    i.prototype = t.prototype,
                        e.prototype = new i
                }
                ,
                function(e) {
                    var t, i, o, n = jQuery, r = {
                        autoMobilize: !0,
                        uiCSS: {
                            widget: "ui-widget",
                            overlay: "ui-widget-overlay",
                            content: "ui-widget-content",
                            header: "ui-widget-header",
                            stateDisabled: "ui-state-disabled",
                            stateFocus: "ui-state-focus",
                            stateActive: "ui-state-active",
                            stateDefault: "ui-state-default",
                            stateHightlight: "ui-state-highlight",
                            stateHover: "ui-state-hover",
                            stateChecked: "ui-state-checked",
                            stateError: "ui-state-error",
                            getState: function(e) {
                                return e = e.charAt(0).toUpperCase() + e.substr(1),
                                    n.gcui.uiCSS["state" + e]
                            },
                            icon: "ui-icon",
                            iconCheck: "ui-icon-check",
                            iconRadioOn: "ui-icon-radio-on",
                            iconRadioOff: "ui-icon-radio-off",
                            iconClose: "ui-icon-close",
                            iconArrow4Diag: "ui-icon-arrow-4-diag",
                            iconNewWin: "ui-icon-newwin",
                            iconVGripSolid: "ui-icon-grip-solid-vertical",
                            iconHGripSolid: "ui-icon-grip-solid-horizontal",
                            iconPlay: "ui-icon-play",
                            iconPause: "ui-icon-pause",
                            iconStop: "ui-icon-stop",
                            iconArrowUp: "ui-icon-triangle-1-n",
                            iconArrowRight: "ui-icon-triangle-1-e",
                            iconArrowDown: "ui-icon-triangle-1-s",
                            iconArrowLeft: "ui-icon-triangle-1-w",
                            iconArrowRightDown: "ui-icon-triangle-1-se",
                            iconCaratUp: "ui-icon-carat-1-n",
                            iconCaratRight: "ui-icon-carat-1-e",
                            iconCaratDown: "ui-icon-carat-1-s",
                            iconCaratLeft: "ui-icon-carat-1-w",
                            iconSeekFirst: "ui-icon-seek-first",
                            iconSeekEnd: "ui-icon-seek-end",
                            iconSeekNext: "ui-icon-seek-next",
                            iconSeekPrev: "ui-icon-seek-prev",
                            inputSpinnerLeft: "ui-input-spinner-left",
                            inputSpinnerRight: "ui-input-spinner-right",
                            inputTriggerLeft: "ui-input-trigger-left",
                            inputTriggerRight: "ui-input-trigger-right",
                            inputSpinnerTriggerLeft: "ui-input-spinner-trigger-left",
                            inputSpinnerTriggerRight: "ui-input-spinner-trigger-right",
                            cornerAll: "ui-corner-all",
                            cornerLeft: "ui-corner-left",
                            cornerRight: "ui-corner-right",
                            cornerBottom: "ui-corner-bottom",
                            cornerBL: "ui-corner-bl",
                            cornerBR: "ui-corner-br",
                            cornerTop: "ui-corner-top",
                            cornerTL: "ui-corner-tl",
                            cornerTR: "ui-corner-tr",
                            helperClearFix: "ui-helper-clearfix",
                            helperReset: "ui-helper-reset",
                            helperHidden: "ui-helper-hidden",
                            priorityPrimary: "ui-priority-primary",
                            prioritySecondary: "ui-priority-secondary",
                            button: "ui-button",
                            buttonText: "ui-button-text",
                            buttonTextOnly: "ui-button-text-only",
                            tabs: "ui-tabs",
                            tabsTop: "ui-tabs-top",
                            tabsBottom: "ui-tabs-bottom",
                            tabsLeft: "ui-tabs-left",
                            tabsRight: "ui-tabs-right",
                            tabsLoading: "ui-tabs-loading",
                            tabsActive: "ui-tabs-active",
                            tabsPanel: "ui-tabs-panel",
                            tabsNav: "ui-tabs-nav",
                            tabsHide: "ui-tabs-hide",
                            tabsCollapsible: "ui-tabs-collapsible",
                            activeMenuitem: "ui-active-menuitem"
                        },
                        mobileCSS: {
                            content: "ui-content",
                            header: "ui-header",
                            overlay: "ui-overlay",
                            stateDisabled: "ui-disabled",
                            stateFocus: "ui-focus",
                            stateActive: "ui-btn-active",
                            stateDefault: "ui-btn-up-a",
                            iconArrowUp: "ui-icon-arrow-u",
                            iconArrowRight: "ui-icon-arrow-r",
                            iconArrowDown: "ui-icon-arrow-d",
                            iconArrowLeft: "ui-icon-arrow-l",
                            iconArrowRightDown: "ui-icon-arrow-d",
                            iconSeekFirst: "ui-icon-arrow-l",
                            iconSeekEnd: "ui-icon-arrow-r",
                            iconSeekNext: "ui-icon-arrow-r",
                            iconSeekPrev: "ui-icon-arrow-l",
                            iconClose: "ui-icon-delete",
                            iconStop: "ui-icon-grid",
                            iconCheck: "ui-icon-checkbox-on"
                        },
                        mobileThemePrefix: ["ui-bar", "ui-body", "ui-overlay", "ui-btn-up", "ui-btn-hover", "ui-btn-down"],
                        autoInit: function(e, t) {
                            if (n.mobile && n.mobile.page && t) {
                                var i = n.mobile.page.prototype.options.keepNative;
                                i = i && i.length && -1 === i.indexOf(t) ? [i, t].join(", ") : t,
                                    n.mobile.page.prototype.options.keepNative = i
                            }
                            n.mobile && n.gcui[e] && n.gcui[e].prototype && n.gcui[e].prototype.enhanceWithin && n(document).bind("pagecreate create", function(t) {
                                n.gcui[e].prototype.enhanceWithin(t.target)
                            })
                        },
                        registerWidget: function(e, t, i, o) {
                            var r = "gcui." + e, a;
                            "function" == typeof i && (a = i,
                                i = null),
                            null !== i && void 0 !== i || (i = n.extend(!0, {}, t),
                                t = n.gcui.widget),
                                i.options = i.options || {},
                                i.options.initSelector = i.options.initSelector || ":jqmData(role='" + e + "')",
                            n.mobile && i.options && i.options.mobileCSS && (i.options.uiCSS = i.options.uiCSS || {},
                                n.extend(i.options.uiCSS, i.options.mobileCSS)),
                                n.widget(r, t, i),
                                a ? a.call() : this.autoInit && this.autoInit(e, i.options.initSelector)
                        },
                        addThemeToMobileCSS: function(e, t) {
                            n.each(t, function(i, o) {
                                "string" == typeof o ? n.each(jQueryGCUI.mobileThemePrefix, function(n, r) {
                                    var a = RegExp("\\b" + r);
                                    a.test(o) && (t[i] = o + " " + r + "-" + e)
                                }) : jQueryGCUI.addThemeToMobileCSS(e, o)
                            })
                        },
                        replaceClassName: function(e) {
                            return e.replace(/\s/g, "")
                        },
                        getTextAutoWidth: function(e) {
                            var t, i, o, r;
                            if (e.children()) {
                                for (t = e.children().length,
                                         i = 0,
                                         o = n("#measureWidth"),
                                         r = 0; r < t; r++)
                                    o.css("font", e.find(".ui-button-text").css("font")).text(n(e.children()[r]).find(".ui-button-text").text()),
                                        i = o.innerWidth() > i ? o.innerWidth() : i;
                                return o.addClass("update-width"),
                                    i
                            }
                        }
                    };
                    n.gcui = r,
                        t = function() {
                            function e() {}
                            return e.prototype.options = {
                                uiCSS: n.gcui.uiCSS
                            },
                                e.prototype.widget = function() {
                                    return this.element
                                }
                                ,
                                ["destory", "_setOption", "_create", "_init"].forEach(function(t) {
                                    e.prototype[t] = function() {
                                        n.Widget.prototype[t].apply(this, arguments)
                                    }
                                }),
                                e
                        }(),
                        e.GCUIWidget = t,
                        i = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments)
                            }
                            return t
                        }(t),
                        e.GCUIMobileWidget = i,
                        n(window.document).trigger("gcuiinit"),
                        o = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments),
                                    this.L = !1
                            }
                            return t.prototype.N = function() {
                                return this.O ? n.mobile.widget : n.Widget
                            }
                                ,
                                t.prototype.P = function(e, t) {
                                    this.L = !0,
                                    this.R && (this.widgetEventPrefix = this.widgetName),
                                    window.applyTouchUtilEvents && (n = window.applyTouchUtilEvents(n)),
                                        this.N().prototype.P.apply(this, arguments)
                                }
                                ,
                                t.prototype._create = function() {
                                    this.N().prototype._create.apply(this, arguments)
                                }
                                ,
                                t.prototype._init = function() {
                                    this.N().prototype._init.apply(this, arguments)
                                }
                                ,
                                t.prototype.destroy = function() {
                                    this.N().prototype.destroy.apply(this, arguments)
                                }
                                ,
                                t.prototype._setOption = function(e, t) {
                                    this.N().prototype._setOption.apply(this, arguments),
                                    "disabled" === e && t && this.O && this.element.removeClass("ui-state-disabled").addClass(this.options.uiCSS.stateDisabled)
                                }
                                ,
                                t
                        }(i),
                        e.gcuiWidget = o,
                        o.prototype.R = !0,
                        o.prototype.O = !1,
                        null != n.mobile && !0 === n.gcui.autoMobilize ? (n.extend(!0, o.prototype.options.uiCSS, n.gcui.mobileCSS),
                            o.prototype.O = !0,
                            o.prototype.options = n.extend(!0, {}, o.prototype.options, o.prototype.N().prototype.options),
                            o.prototype.enhanceWithin = function(e, t) {
                                this.L || n.mobile.widget.prototype.enhanceWithin.apply(this, arguments)
                            }
                            ,
                            o.prototype.U = function() {
                                var e = this.element, t, i = function(e) {
                                    if (void 0 === e)
                                        return {};
                                    if (null === e)
                                        return {};
                                    var t = /(?:(?:\{[\n\r\t\s]*(.+?)\s*\:[\n\r\t\s]*)|(?:,[\n\r\t\s]*(.+?)\s*\:[\n\r\t\s]*))('(.*?[^\\])')?/gi
                                        , i = /\[.*?(?=[\]\[])|[\]\[].*?(?=[\]])/gi
                                        , o = e.replace(t, function(e, t, i, o) {
                                        var n, r = /[\n\r\t\s]*['"]?([^\{,\s]+?)['"]?\s*:[\n\r\t\s]*/i, a = /\:[\n\r\t\s]*(?:'(.*)')?/i;
                                        return n = e.replace(r, '"$1":'),
                                            o ? n.replace(a, ':"$1"') : n
                                    }).replace(i, function(e) {
                                        var t = /'(.*?[^\\])'/g;
                                        return e.replace(t, '"$1"')
                                    });
                                    return n.parseJSON(o)
                                }, o = i(e.attr("data-" + n.mobile.nsNormalize("options"))), r;
                                return t = n.mobile.widget.prototype.U.apply(this, arguments),
                                    r = n.extend(!0, {}, this.options.uiCSS),
                                    this.theme = void 0 !== this.options.theme ? this.options.theme : this.element.jqmData("theme"),
                                this.theme && n.gcui.addThemeToMobileCSS(this.theme, r),
                                    n.extend(t, {
                                        uiCSS: r
                                    }, o)
                            }
                            ,
                            n.widget("gcui.widget", n.mobile.widget, o.prototype),
                            n(document).on("pageshow", function(e, t) {
                                if (null != e.target) {
                                    var i = n(e.target);
                                    i.gcuiTriggerVisibility && i.gcuiTriggerVisibility()
                                }
                            })) : (o.prototype.options = n.extend(!0, {}, o.prototype.options, o.prototype.N().prototype.options),
                            n.widget("gcui.widget", o.prototype))
                }(gcui || (gcui = {})),
                function(e) {
                    var t, i, o, n, r, a, s;
                    $.fn.extend({
                        getTextSelection: function() {
                            var e, t, i, o, n, r, a, s, l, c, d, p = this[0], u = this.val();
                            if (0 === arguments.length) {
                                if (a = GC.Spread.Sheets.util.browser,
                                    a.msie && parseInt(a.version) < 9)
                                    try {
                                        s = document.selection,
                                            "textarea" != p.tagName.toLowerCase() ? (i = s.createRange().duplicate(),
                                                i.moveEnd("character", u.length),
                                                n = "" === i.text ? u.length : u.lastIndexOf(i.text),
                                                i = s.createRange().duplicate(),
                                                i.moveStart("character", -u.length),
                                                r = i.text.length) : (i = s.createRange(),
                                                o = i.duplicate(),
                                                o.moveToElementText(p),
                                                o.setEndPoint("EndToEnd", i),
                                                n = o.text.length - i.text.length,
                                                r = n + i.text.length)
                                    } catch (r) {}
                                else
                                    n = p.selectionStart,
                                        r = p.selectionEnd;
                                return l = u.substring(n, r),
                                    {
                                        start: n,
                                        end: r,
                                        text: l,
                                        replace: function(e) {
                                            return u.substring(0, n) + e + u.substring(r, u.length)
                                        }
                                    }
                            }
                            1 === arguments.length ? "object" == typeof arguments[0] && "number" == typeof arguments[0].start && "number" == typeof arguments[0].end ? (e = arguments[0].start,
                                t = arguments[0].end) : "string" == typeof arguments[0] ? (e = u.indexOf(arguments[0])) > -1 && (t = e + arguments[0].length) : "[object RegExp]" === Object.prototype.toString.call(arguments[0]) && null != (c = arguments[0].exec(u)) && (e = c.index,
                                t = e + c[0].length) : 2 === arguments.length && "number" == typeof arguments[0] && "number" == typeof arguments[1] && (e = arguments[0],
                                t = arguments[1]),
                            void 0 === e && (e = 0,
                                t = u.length),
                                a.msie ? (d = p.createTextRange(),
                                    d.collapse(!0),
                                    d.moveStart("character", e),
                                    d.moveEnd("character", t - e),
                                    d.select()) : (p.selectionStart = e,
                                    p.selectionEnd = t)
                        },
                        getContent: function(e) {
                            return this.each(function() {
                                this.innerHTML = '<iframe frameborder="0" style="width: 100%; height: 100%;" src="' + e + '">"'
                            })
                        },
                        addVisibilityObserver: function(e, t) {
                            return this.each(function() {
                                var i = this;
                                $(this).addClass("gcui-observer-visibility"),
                                    $(this).bind("gcuimovisibilitychanged" + (t ? "." + t : ""), function(t) {
                                        e.apply(i, arguments),
                                            t.stopPropagation()
                                    })
                            })
                        },
                        removeVisibilityObserver: function(e) {
                            return this.each(function() {
                                $(this).removeClass("gcui-observer-visibility"),
                                    e ? jQuery.isFunction(e) ? $(this).unbind("gcuimovisibilitychanged", e) : $(this).unbind("gcuimovisibilitychanged." + e) : $(this).unbind("gcuimovisibilitychanged")
                            })
                        },
                        triggerVisibility: function() {
                            return this.each(function() {
                                var e = $(this);
                                e.hasClass("gcui-observer-visibility") && e.trigger("gcuimovisibilitychanged"),
                                    e.find(".gcui-observer-visibility").trigger("gcuimovisibilitychanged")
                            })
                        },
                        leftBorderWidth: function() {
                            var e = parseFloat($(this).css("borderLeftWidth"))
                                , t = parseFloat($(this).css("padding-left"))
                                , i = 0;
                            return "auto" !== $(this).css("margin-left") && (i = parseFloat($(this).css("margin-left"))),
                            l(e) + l(t) + l(i)
                        },
                        rightBorderWidth: function() {
                            var e = parseFloat($(this).css("borderRightWidth"))
                                , t = parseFloat($(this).css("padding-right"))
                                , i = 0;
                            return "auto" !== $(this).css("margin-right") && (i = parseFloat($(this).css("margin-right"))),
                            l(e) + l(t) + l(i)
                        },
                        topBorderWidth: function() {
                            var e = parseFloat($(this).css("borderTopWidth"))
                                , t = parseFloat($(this).css("padding-top"))
                                , i = 0;
                            return "auto" !== $(this).css("margin-top") && (i = parseFloat($(this).css("margin-top"))),
                            l(e) + l(t) + l(i)
                        },
                        bottomBorderWidth: function() {
                            var e = parseFloat($(this).css("borderBottomWidth"))
                                , t = parseFloat($(this).css("padding-bottom"))
                                , i = 0;
                            return "auto" !== $(this).css("margin-bottom") && (i = parseFloat($(this).css("margin-bottom"))),
                            l(e) + l(t) + l(i)
                        },
                        borderSize: function() {
                            var e = $(this).leftBorderWidth() + $(this).rightBorderWidth()
                                , t = $(this).topBorderWidth() + $(this).bottomBorderWidth()
                                , i = {
                                width: e,
                                height: t
                            };
                            return i
                        },
                        setOutWidth: function(e) {
                            var t = $(this).leftBorderWidth() + $(this).rightBorderWidth();
                            return $(this).width(e - t),
                                this
                        },
                        setOutHeight: function(e) {
                            var t = $(this).topBorderWidth() + $(this).bottomBorderWidth();
                            return $(this).height(e - t),
                                this
                        },
                        getWidget: function() {
                            var e = this.data("widgetName");
                            return e && "" !== e ? this.data(e) : null
                        },
                        gcuishow: function(e, t, i, o, n) {
                            var r = e.animated || !1
                                , a = e.duration || 400
                                , s = e.easing
                                , l = e.option || {};
                            if (o && $.isFunction(o) && o.call(this),
                                    r) {
                                if (t && t[r])
                                    return void t[r](e, $.extend(i, {
                                        complete: n
                                    }));
                                if ($.effects && ($.effects[r] || $.effects.effect && $.effects.effect[r]))
                                    return void this.show(r, $.extend(l, {
                                        easing: s
                                    }), a, n)
                            }
                            this.show(),
                            n && $.isFunction(n) && n.call(this)
                        },
                        gcuihide: function(e, t, i, o, n) {
                            var r = e.animated || !1
                                , a = e.duration || 400
                                , s = e.easing
                                , l = e.option || {};
                            if (o && $.isFunction(o) && o.call(this),
                                    r) {
                                if (t && t[r])
                                    return void t[r](e, $.extend(i, {
                                        complete: n
                                    }));
                                if ($.effects && ($.effects[r] || $.effects.effect && $.effects.effect[r]))
                                    return void this.stop().hide(r, $.extend(l, {
                                        easing: s
                                    }), a, n)
                            }
                            this.hide(),
                            n && $.isFunction(n) && n.call(this)
                        }
                    });
                    function l(e) {
                        return isNaN(e) ? 0 : e
                    }
                    $.save = function(e, t) {
                        if ($.effects)
                            return $.effects.save(e, t);
                        for (var i = 0; i < t.length; i++)
                            null !== t[i] && e.data("ec.storage." + t[i], e[0].style[t[i]])
                    }
                        ,
                        $.restore = function(e, t) {
                            if ($.effects)
                                return $.effects.restore(e, t);
                            for (var i = 0; i < t.length; i++)
                                null !== t[i] && e.css(t[i], e.data("ec.storage." + t[i]))
                        }
                        ,
                        $.createWrapper = function(e) {
                            if ($.effects)
                                return $.effects.createWrapper(e);
                            if (e.parent().is(".ui-effects-wrapper"))
                                return e.parent();
                            var t = {
                                width: e.outerWidth(!0),
                                height: e.outerHeight(!0),
                                float: e.css("float")
                            }
                                , i = $("<div></div>").addClass("ui-effects-wrapper").css({
                                fontSize: "100%",
                                background: "transparent",
                                border: "none",
                                margin: 0,
                                padding: 0
                            })
                                , o = document.activeElement;
                            return e.wrap(i),
                            (e[0] === o || $.contains(e[0], o)) && $(o).focus(),
                                i = e.parent(),
                                "static" == e.css("position") ? (i.css({
                                    position: "relative"
                                }),
                                    e.css({
                                        position: "relative"
                                    })) : ($.extend(t, {
                                    position: e.css("position"),
                                    zIndex: e.css("z-index")
                                }),
                                    $.each(["top", "left", "bottom", "right"], function(i, o) {
                                        t[o] = e.css(o),
                                        isNaN(parseInt(t[o], 10)) && (t[o] = "auto")
                                    }),
                                    e.css({
                                        position: "relative",
                                        top: 0,
                                        left: 0,
                                        right: "auto",
                                        bottom: "auto"
                                    })),
                                i.css(t).show()
                        }
                        ,
                        $.removeWrapper = function(e) {
                            if ($.effects)
                                return $.effects.removeWrapper(e);
                            var t, i = document.activeElement;
                            return e.parent().is(".ui-effects-wrapper") ? (t = e.parent().replaceWith(e),
                            (e[0] === i || $.contains(e[0], i)) && $(i).focus(),
                                t) : e
                        }
                        ,
                        $.setMode = function(e, t) {
                            return $.effects ? $.effects.setMode(e, t) : ("toggle" === t && (t = e.is(":hidden") ? "show" : "hide"),
                                t)
                        }
                        ,
                        t = function() {}
                        ,
                        $.extend(t.prototype, {
                            V: " ! \" # % & ' ( ) * , - . / : ; ? @ [ \\ ] { } \xa1 \xab \xad \xb7 \xbb \xbf \u037e \u0387 \u055a \u055b \u055c \u055d \u055e \u055f \u0589 \u058a \u05be \u05c0 \u05c3 \u05f3 \u05f4 \u060c \u061b \u061f \u066a \u066b \u066c \u066d \u06d4 \u0700 \u0701 \u0702 \u0703 \u0704 \u0705 \u0706 \u0707 \u0708 \u0709 \u070a \u070b \u070c \u070d \u0964 \u0965 \u0970 \u0df4 \u0e4f \u0e5a \u0e5b \u0f04 \u0f05 \u0f06 \u0f07 \u0f08 \u0f09 \u0f0a \u0f0b \u0f0c \u0f0d \u0f0e \u0f0f \u0f10 \u0f11 \u0f12 \u0f3a \u0f3b \u0f3c \u0f3d \u0f85 \u104a \u104b \u104c \u104d \u104e \u104f \u10fb \u1361 \u1362 \u1363 \u1364 \u1365 \u1366 \u1367 \u1368 \u166d \u166e \u169b \u169c \u16eb \u16ec \u16ed \u17d4 \u17d5 \u17d6 \u17d7 \u17d8 \u17d9 \u17da \u17dc \u1800 \u1801 \u1802 \u1803 \u1804 \u1805 \u1806 \u1807 \u1808 \u1809 \u180a \u2010 \u2011 \u2012 \u2013 \u2014 \u2015 \u2016 \u2017 \u2018 \u2019 \u201a \u201b \u201c \u201d \u201e \u201f \u2020 \u2021 \u2022 \u2023 \u2024 \u2025 \u2026 \u2027 \u2030 \u2031 \u2032 \u2033 \u2034 \u2035 \u2036 \u2037 \u2038 \u2039 \u203a \u203b \u203c \u203d \u203e \u2041 \u2042 \u2043 \u2045 \u2046 \u2048 \u2049 \u204a \u204b \u204c \u204d \u207d \u207e \u208d \u208e \u2329 \u232a \u3001 \u3002 \u3003 \u3008 \u3009 \u300a \u300b \u300c \u300d \u300e \u300f \u3010 \u3011 \u3014 \u3015 \u3016 \u3017 \u3018 \u3019 \u301a \u301b \u301c \u301d \u301e \u301f \u3030 \ufd3e \ufd3f \ufe30 \ufe31 \ufe32 \ufe35 \ufe36 \ufe37 \ufe38 \ufe39 \ufe3a \ufe3b \ufe3c \ufe3d \ufe3e \ufe3f \ufe40 \ufe41 \ufe42 \ufe43 \ufe44 \ufe49 \ufe4a \ufe4b \ufe4c \ufe50 \ufe51 \ufe52 \ufe54 \ufe55 \ufe56 \ufe57 \ufe58 \ufe59 \ufe5a \ufe5b \ufe5c \ufe5d \ufe5e \ufe5f \ufe60 \ufe61 \ufe63 \ufe68 \ufe6a \ufe6b \uff01 \uff02 \uff03 \uff05 \uff06 \uff07 \uff08 \uff09 \uff0a \uff0c \uff0d \uff0e \uff0f \uff1a \uff1b \uff1f \uff20 \uff3b \uff3c \uff3d \uff5b \uff5d \uff61 \uff62 \uff63 \uff64';this.UTFWhitespacesString_='\t \v \f \x1f   \xa0 \u1680 \u2000 \u2001 \u2002 \u2003 \u2004 \u2005 \u2006 \u2007 \u2008 \u2009 \u200a \u200b \u2028 \u202f \u3000",
                            isDigit: function(e) {
                                var t = e.charCodeAt(0);
                                return t >= 48 && t < 58
                            },
                            isLetter: function(e) {
                                return !!(e + "").match(RegExp("[A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u021f\u0222-\u0233\u0250-\u02ad\u02b0-\u02b8\u02bb-\u02c1\u02d0\u02d1\u02e0-\u02e4\u02ee\u037a\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03d7\u03da-\u03f3\u0400-\u0481\u048c-\u04c4\u04c7\u04c8\u04cb\u04cc\u04d0-\u04f5\u04f8\u04f9\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0640-\u064a\u0671-\u06d3\u06d5\u06e5\u06e6\u06fa-\u06fc\u0710\u0712-\u072c\u0780-\u07a5\u0905-\u0939\u093d\u0950\u0958-\u0961\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8b\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b36-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb5\u0bb7-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cde\u0ce0\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60\u0d61\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6a\u0f88-\u0f8b\u1000-\u1021\u1023-\u1027\u1029\u102a\u1050-\u1055\u10a0-\u10c5\u10d0-\u10f6\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1206\u1208-\u1246\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1286\u1288\u128a-\u128d\u1290-\u12ae\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12ce\u12d0-\u12d6\u12d8-\u12ee\u12f0-\u130e\u1310\u1312-\u1315\u1318-\u131e\u1320-\u1346\u1348-\u135a\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1780-\u17b3\u1820-\u1877\u1880-\u18a8\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u207f\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2131\u2133-\u2139\u3005\u3006\u3031-\u3035\u3041-\u3094\u309d\u309e\u30a1-\u30fa\u30fc-\u30fe\u3105-\u312c\u3131-\u318e\u31a0-\u31b7\u3400-\u4db5\u4e00-\u9fa5\ua000-\ua48c\uac00-\ud7a3\uf900-\ufa2d\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe72\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"))
                            },
                            isLetterOrDigit: function(e) {
                                return this.isLetter(e) || this.isDigit(e)
                            },
                            isDoubleByteNumber: function(e) {
                                var t = e.charCodeAt(0);
                                return t >= 65296 && t < 65306
                            },
                            isSymbol: function(e) {
                                var t = RegExp("[$+<->^`|~\xa2-\xa9\xac\xae-\xb1\xb4\xb6\xb8\xd7\xf7\u02b9\u02ba\u02c2-\u02cf\u02d2-\u02df\u02e5-\u02ed\u0374\u0375\u0384\u0385\u0482\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0b70\u0e3f\u0f01-\u0f03\u0f13-\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fcf\u17db\u1fbd\u1fbf-\u1fc1\u1fcd-\u1fcf\u1fdd-\u1fdf\u1fed-\u1fef\u1ffd\u1ffe\u2044\u207a-\u207c\u208a-\u208c\u20a0-\u20af\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211e-\u2123\u2125\u2127\u2129\u212e\u2132\u213a\u2190-\u21f3\u2200-\u22f1\u2300-\u2328\u232b-\u237b\u237d-\u239a\u2400-\u2426\u2440-\u244a\u249c-\u24e9\u2500-\u2595\u25a0-\u25f7\u2600-\u2613\u2619-\u2671\u2701-\u2704\u2706-\u2709\u270c-\u2727\u2729-\u274b\u274d\u274f-\u2752\u2756\u2758-\u275e\u2761-\u2767\u2794\u2798-\u27af\u27b1-\u27be\u2800-\u28ff\u2e80-\u2e99\u2e9b-\u2ef3\u2f00-\u2fd5\u2ff0-\u2ffb\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\u3190\u3191\u3196-\u319f\u3200-\u321c\u322a-\u3243\u3260-\u327b\u327f\u328a-\u32b0\u32c0-\u32cb\u32d0-\u32fe\u3300-\u3376\u337b-\u33dd\u33e0-\u33fe\ua490-\ua4a1\ua4a4-\ua4b3\ua4b5-\ua4c0\ua4c2-\ua4c4\ua4c6\ufb29\ufe62\ufe64-\ufe66\ufe69\uff04\uff0b\uff1c-\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee\ufffc\ufffd]");
                                return t.test(e + "")
                            },
                            isPunctuation: function(e) {
                                return this.V.indexOf(e) >= 0
                            },
                            isPrintableChar: function(e) {
                                return !!(this.isLetterOrDigit(e) || this.isPunctuation(e) || this.isSymbol(e) || this.isDoubleByteNumber(e)) || " " === e
                            },
                            isAscii: function(e) {
                                return e >= "!" && e <= "~"
                            },
                            isAsciiLetter: function(e) {
                                return e >= "A" && e <= "Z" || e >= "a" && e <= "z"
                            },
                            isUpper: function(e) {
                                return e.toUpperCase() === e
                            },
                            isLower: function(e) {
                                return e.toLowerCase() === e
                            },
                            isAlphanumeric: function(e) {
                                return !!this.isLetter(e) || this.isDigit(e)
                            },
                            isAciiAlphanumeric: function(e) {
                                return !(e < "0" || e > "9") || !(e < "A" || e > "Z") || e >= "a" && e <= "z"
                            },
                            setChar: function(e, t, i) {
                                return i >= e.length || i < 0 ? e : e.substr(0, i) + t + e.substr(i + 1)
                            }
                        }),
                    $.fn.zIndex || ($.fn.zIndex = function(e) {
                            if (void 0 !== e)
                                return this.css("zIndex", e);
                            if (this.length)
                                for (var t = $(this[0]), i, o; t.length && t[0] !== document; ) {
                                    if (("absolute" === (i = t.css("position")) || "relative" === i || "fixed" === i) && (o = parseInt(t.css("zIndex"), 10),
                                        !isNaN(o) && 0 !== o))
                                        return o;
                                    t = t.parent()
                                }
                            return 0
                        }
                    ),
                        i = ["\n", "\r", '"', "@", "+", "'", "<", ">", "%", "{", "}"],
                        o = ["!ESC!NN!", "!ESC!RR!", "!ESC!01!", "!ESC!02!", "!ESC!03!", "!ESC!04!", "!ESC!05!", "!ESC!06!", "!ESC!07!", "!ESC!08!", "!ESC!09!"],
                        n = ["(\n)", "(\r)", '(")', "(@)", "(\\+)", "(')", "(\\<)", "(\\>)", "(%)", "(\\{)", "(\\})"],
                    $.gcuiutil || $.extend({
                        gcuiutil: {
                            charValidator: new t,
                            encodeString: function(e) {
                                var t, r;
                                for (t = 0; t < i.length; t++)
                                    r = RegExp(n[t], "g"),
                                        e = e.replace(r, o[t]);
                                return e
                            },
                            decodeString: function(e) {
                                var t, n;
                                if ("" !== e) {
                                    for (t = 0; t < o.length; t++)
                                        n = RegExp(o[t], "g"),
                                            e = e.replace(n, i[t]);
                                    return e
                                }
                            }
                        }
                    }),
                    jQuery.uaMatch || (jQuery.uaMatch = function(e) {
                            e = e.toLowerCase();
                            var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || [];
                            return {
                                browser: t[1] || "",
                                version: t[2] || "0"
                            }
                        }
                    ),
                    jQuery.browser || (r = jQuery.uaMatch(navigator.userAgent),
                        a = {
                            version: "0",
                            msie: !1,
                            opera: !1,
                            safari: !1,
                            mozilla: !1,
                            webkit: !1,
                            chrome: !1
                        },
                    r.browser && (a[r.browser] = !0,
                        a.version = r.version),
                        a.chrome ? a.webkit = !0 : a.webkit && (a.safari = !0),
                        jQuery.browser = a),
                    $.ui && $.ui.position && $.ui.position.flipfit && ($.ui.position.flip.top = function(e, t) {
                            var i = t.within, o = i.offset.top + i.scrollTop, n = i.height, r = i.isWindow ? i.scrollTop : i.offset.top, a = e.top - t.collisionPosition.marginTop, s = a - r, l = a + t.collisionHeight - n - r, c = "top" === t.my[1], d = c ? -t.elemHeight : "bottom" === t.my[1] ? t.elemHeight : 0, p = "top" === t.at[1] ? t.targetHeight : "bottom" === t.at[1] ? -t.targetHeight : 0, u = -2 * t.offset[1], h, f;
                            s < 0 ? (f = e.top + d + p + u + t.collisionHeight - n - o,
                            e.top + d + p + u > s && (f < 0 || f < Math.abs(s)) && (e.top += d + p + u)) : l > 0 && (h = e.top - t.collisionPosition.marginTop + d + p + u - r,
                            e.top + d + p + u + t.collisionHeight - n - r < l && (h > 0 || Math.abs(h) < l) && (e.top += d + p + u))
                        }
                    ),
                        s = $.fn.position,
                        $.fn.position = function(e) {
                            if (e && $.isPlainObject(e) && e.offset) {
                                var t = (e.my || "").split(" ")
                                    , i = /left|center|right/
                                    , o = /top|center|bottom/
                                    , n = (e.offset || "").split(" ");
                                1 === t.length && (i.test(t[0]) ? t.concat(["center"]) : o.test(t[0]) && ["center"].concat(t)),
                                1 === n.length && n.concat(n[0]),
                                    $.each(t, function(e, i) {
                                        /\+|-/.test(n[e]) ? t[e] = t[e] + n[e] : t[e] = t[e] + "+" + n[e]
                                    }),
                                    e.my = t.join(" ")
                            }
                            return s.apply(this, arguments)
                        }
                    ;
                    function c() {
                        if ($.ui && $.ui.keyCode)
                            return $.ui.keyCode;
                        if ($.mobile && $.mobile.keyCode)
                            return $.mobile.keyCode;
                        throw "keyCode object is not found"
                    }
                    e.getKeyCodeEnum = c
                }(gcui || (gcui = {}));
            function __gcuiReadOptionEvents(e, t) {
                var i, o, n;
                for (i = 0; i < e.length; i++)
                    null !== t.options[e[i]] && t.element.bind(e[i], t.options[e[i]]);
                for (i in t.options)
                    if (-1 !== i.indexOf(" "))
                        for (o = i.split(" "),
                                 n = 0; n < o.length; n++)
                            o[n].length > 0 && t.element.bind(o[n], t.options[i])
            }
            function gcuiASPNetParseOptionsReviewer(o, k) {
                var a, v = o[k], d;
                if (v)
                    switch (typeof v) {
                        case "string":
                            a = /^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?):(\d{3})Z$/.exec(v),
                            a && (d = new Date(+a[1],+a[2] - 1,+a[3],+a[4],+a[5],+a[6],+a[7]),
                                d.setFullYear(+a[1]),
                                o[k] = d);
                            break;
                        case "object":
                            if (void 0 !== v.needQuotes && void 0 !== v.valueString)
                                v.needQuotes ? o[k] = v.valueString : o[k] = eval(v.valueString);
                            else
                                for (k in v)
                                    gcuiASPNetParseOptionsReviewer(v, k)
                    }
            }
            function gcuiASPNetParseOptions(e) {
                var t;
                if (!e)
                    return e;
                for (t in e)
                    gcuiASPNetParseOptionsReviewer(e, t);
                return e
            }
            !function(e) {
                var t, i;
                e.expando = ".gcui",
                    t = function() {
                        function e(e) {
                            this.message = e,
                                this.stack = "gcui" + Error().stack,
                                this.name = "GCUIError"
                        }
                        return e
                    }(),
                    e.GCUIError = t,
                    i = t,
                    i.prototype = Error(),
                    i.prototype.constructor = i
            }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        var i = function() {
                            function t(e) {
                                this.object = e
                            }
                            return t.getFrom = function i(o, n) {
                                void 0 === n && (n = !0);
                                var r = e.expando, a;
                                if (Object(o) !== o)
                                    return null;
                                if (a = o[r],
                                    a && a.object !== o && (a = null),
                                    n && !(a instanceof t && Object.prototype.hasOwnProperty.call(o, r))) {
                                    a = new t(o);
                                    try {
                                        Object.defineProperty(o, r, {
                                            value: a,
                                            configurable: !1,
                                            enumerable: !1,
                                            writable: !1
                                        })
                                    } catch (e) {
                                        o[r] = a
                                    }
                                }
                                return a
                            }
                                ,
                                t
                        }();
                        t.Expando = i
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        !function(e) {
                            function t(e) {
                                return function() {
                                    var t = function() {
                                        return e.prototype.W.apply(t, arguments)
                                    };
                                    return $.extend(t, e.prototype),
                                        e.apply(t, arguments),
                                        t
                                }
                            }
                            e.funcClass = t
                        }(e.util || (e.util = {}));
                        var t = e.util
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        var t, i, o, n, r, a, s = jQuery, l = function() {
                            function e(e, t) {
                                this.handler = e,
                                    this.context = t
                            }
                            return e.prototype.trigger = function(e) {
                                return this.handler.apply(this.context, e)
                            }
                                ,
                                e
                        }();
                        e.SubscriberEntry = l,
                            t = function() {
                                function t(e) {
                                    this.defaultContext = e,
                                        this.Z = []
                                }
                                return t.prototype.subscribe = function(t, i) {
                                    var o, n;
                                    return void 0 === i && (i = this.defaultContext),
                                        o = this,
                                        n = new l(t,i),
                                        this.Z.push(n),
                                        {
                                            dispose: function() {
                                                return e.util.remove(o.Z, n)
                                            }
                                        }
                                }
                                    ,
                                    t.prototype.trigger = function() {
                                        var t, i = [];
                                        for (t = 0; t < arguments.length - 0; t++)
                                            i[t] = arguments[t + 0];
                                        e.util.each(this.Z, function(e, t) {
                                            return t.trigger(i)
                                        })
                                    }
                                    ,
                                    t.makeSubscribable = function e(i) {
                                        var o = new t(i);
                                        return i.subscribe = s.proxy(o.subscribe, o),
                                            o
                                    }
                                    ,
                                    t
                            }(),
                            e.Subscribable = t;
                        function c(e) {
                            return s.isFunction(e.subscribe)
                        }
                        e.isSubscriptable = c,
                            i = function() {
                                function e() {}
                                return e.prototype.subscribe = function(e, i) {
                                    return this.$ = this.$ || new t(this),
                                        this.$.subscribe(e, i)
                                }
                                    ,
                                    e.prototype._trigger = function() {
                                        var e, t = [];
                                        for (e = 0; e < arguments.length - 0; e++)
                                            t[e] = arguments[e + 0];
                                        this.$ && this.$.trigger.apply(this.$, arguments)
                                    }
                                    ,
                                    e
                            }(),
                            e.BaseObservable = i,
                            o = function(e) {
                                __extends(t, e);
                                function t(t) {
                                    e.call(this),
                                        this.mutable = t
                                }
                                return t.prototype.W = function() {
                                    return this.mutable.value
                                }
                                    ,
                                    t
                            }(i),
                            e._ = o,
                            n = e.util.funcClass(o),
                            r = function(e) {
                                __extends(t, e);
                                function t(t, i) {
                                    void 0 === i && (i = !1),
                                        e.call(this),
                                        this.value = t,
                                        this.checkNewValue = i
                                }
                                return t.prototype.W = function(e) {
                                    return arguments.length > 0 && (!this.checkNewValue || e !== this.value) && (this.value = e,
                                        this._trigger(e),
                                    this.aa && this.aa._trigger(e)),
                                        this.value
                                }
                                    ,
                                    t.prototype.read = function() {
                                        return this.aa = this.aa || new n(this),
                                            this.aa
                                    }
                                    ,
                                    t
                            }(i),
                            e.ba = r,
                            a = e.util.funcClass(r);
                        function d(e) {
                            return void 0 === e && (e = null),
                                new a(e)
                        }
                        e.observable = d;
                        function p(e) {
                            return void 0 === e && (e = null),
                                new a(e,!0)
                        }
                        e.observableWithNewValueCheck = p;
                        function u(e) {
                            return s.isFunction(e) && c(e)
                        }
                        e.isObservable = u
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        !function(i) {
                            var o, n, r = jQuery;
                            function a(e, t) {
                                return void 0 === t && (t = !1),
                                    r.isArray(e) ? e = e.slice(0) : r.isPlainObject(e) && (e = r.extend(!!t, {}, e)),
                                    e
                            }
                            i.clone = a;
                            function s(e) {
                                return "string" == typeof e || e instanceof String
                            }
                            i.isString = s;
                            function l(e) {
                                return "number" == typeof e
                            }
                            i.isNumeric = l;
                            function c(t) {
                                return t === e.expando || t === r.expando
                            }
                            i.isInternalProperty = c;
                            function d(e, t) {
                                var i = this;
                                r.each(e, function(e, o) {
                                    if (!c(e))
                                        return t.call(i, e, o)
                                })
                            }
                            i.each = d;
                            function p(t, i) {
                                var o = r.map(t, i);
                                return delete o[e.expando],
                                    o
                            }
                            i.map = p;
                            function u(e) {
                                var t;
                                return t = e && r.isFunction(e.toString) && e.toString !== Object.prototype.toString ? "" + e : JSON.stringify(e),
                                null != t && t.length > 2 && '"' === t[0] && '"' === t[t.length - 1] && (t = t.substr(1, t.length - 2)),
                                    t
                            }
                            i.toStr = u;
                            function h(e) {
                                var t, i = [];
                                for (t = 0; t < arguments.length - 1; t++)
                                    i[t] = arguments[t + 1];
                                return e.replace(/{(\d+)}/g, function(e, t) {
                                    return u(i[parseInt(t, 10)])
                                })
                            }
                            i.format = h;
                            function f(e, t) {
                                var i = !0;
                                return d(e, function(e, o) {
                                    if (i = o,
                                        t && (i = t.call(i, i, e)),
                                            !i)
                                        return !1
                                }),
                                    i
                            }
                            i.every = f;
                            function g(e, t) {
                                var i = !1;
                                return d(e, function(e, o) {
                                    if (i = o,
                                        t && (i = t.call(i, i, e)),
                                            i)
                                        return !1
                                }),
                                    i
                            }
                            i.some = g;
                            function m(e, t) {
                                var i, o, n;
                                if (null == e)
                                    return null == t ? 0 : -1;
                                if (null == t)
                                    return 1;
                                if (r.isArray(e) && r.isArray(t)) {
                                    for (o = Math.min(e.length, t.length),
                                             i = 0; i < o; i++)
                                        if (0 !== (n = m(e[i], t[i])))
                                            return n;
                                    return e.length - t.length
                                }
                                return s(e) && s(t) ? (e = e.toLowerCase(),
                                    t = t.toLowerCase(),
                                    e < t ? -1 : e > t ? 1 : 0) : (n = e - t,
                                    isNaN(n) ? 0 : n)
                            }
                            i.compare = m;
                            function b(e, t) {
                                return r.inArray(t, e) >= 0
                            }
                            i.contains = b;
                            function v(e, t) {
                                var i = 0, o;
                                for (o = 0; o < e.length; )
                                    e[o] !== t ? o++ : (e.splice(o, 1),
                                        i++);
                                return i
                            }
                            i.remove = v;
                            function y(e, t) {
                                return -1 == e ? -1 : 0 == e ? 0 : t ? Math.ceil(e / t) : 1
                            }
                            i.pageCount = y;
                            function x(e, t) {
                                var i, o = [];
                                for (i = 0; i < arguments.length - 2; i++)
                                    o[i] = arguments[i + 2];
                                function n() {
                                    return e.apply(t, o)
                                }
                                if ("undefined" == typeof setTimeout)
                                    return n();
                                setTimeout(n, 10)
                            }
                            i.executeDelayed = x;
                            function w(e) {
                                "undefined" != typeof console && (console.error ? console.error(e) : console.log && console.log(e))
                            }
                            i.logError = w;
                            function C(e, i) {
                                for (var o, n, r = 0, a = e; ; )
                                    if (n = i.indexOf(".", r),
                                            n >= 0 ? (o = i.substring(r, n),
                                                r = n + 1) : o = r > 0 ? i.substring(r) : i,
                                            a = a[o],
                                        t.isObservable(a) && (a = a()),
                                        n < 0)
                                        break;
                                return a
                            }
                            i.getProperty = C;
                            function S(e, i, o) {
                                for (var n, r, a, s = 0; ; ) {
                                    if (r = i.indexOf(".", s),
                                            r >= 0 ? (n = i.substring(s, r),
                                                s = r + 1) : n = s > 0 ? i.substring(s) : i,
                                            a = e[n],
                                            !(r >= 0)) {
                                        t.isObservable(a) ? a(o) : e[n] = o;
                                        break
                                    }
                                    t.isObservable(a) && (a = a()),
                                        e = a
                                }
                            }
                            i.setProperty = S;
                            function k(e) {
                                return "object" == typeof e && !r.isArray(e) && !r.isPlainObject(e) && e.constructor !== Object.prototype.constructor
                            }
                            i.isClassInstance = k;
                            function T(e) {
                                t.util.each(e, function(e, i) {
                                    i && "object" == typeof i && t.util.each(i, function(e, o) {
                                        var n;
                                        t.util.isString(o) && (n = /\/Date\((-?\d+)\)\//.exec(o)) && (i[e] = new Date(parseInt(n[1], 10)))
                                    })
                                })
                            }
                            i.convertDateProperties = T,
                                o = function() {
                                    function e(e) {
                                        this.key = e
                                    }
                                    return e
                                }(),
                                i.HashMapEntry = o,
                                n = function() {
                                    function e() {
                                        this.hash = {}
                                    }
                                    return e.prototype.getEntry = function(e, t) {
                                        var i, n, r, a;
                                        if (void 0 === t && (t = !1),
                                            null === e)
                                            return !this.nullEntry && t && (this.nullEntry = new o(e)),
                                                this.nullEntry;
                                        if (i = e + "",
                                            null == (n = this.hash[i])) {
                                            if (!t)
                                                return null;
                                            n = [],
                                                this.hash[i] = n
                                        }
                                        for (a = 0; a < n.length; a++)
                                            if (n[a].key === e)
                                                return n[a];
                                        return t && (r = new o(e),
                                            n.push(r)),
                                            null
                                    }
                                        ,
                                        e.prototype.containsKey = function(e) {
                                            return !!this.getEntry(e)
                                        }
                                        ,
                                        e.prototype.get = function(e, t) {
                                            void 0 === t && (t = null);
                                            var i = this.getEntry(e);
                                            return i ? i.value : t
                                        }
                                        ,
                                        e.prototype.put = function(e, t) {
                                            this.getEntry(e, !0).value = t
                                        }
                                        ,
                                        e
                                }(),
                                i.HashMap = n
                        }(t.util || (t.util = {}));
                        var i = t.util
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        t.errors = {},
                            t.errors.ca = function(i) {
                                t.util.each(i, function(i, o) {
                                    function n() {
                                        var i, n, r = [];
                                        for (i = 0; i < arguments.length - 0; i++)
                                            r[i] = arguments[i + 0];
                                        return $.isFunction(o) ? o = o.apply(this, arguments) : arguments.length > 0 && (r.unshift(o),
                                            o = t.util.format.apply(this, r)),
                                            o = $.trim(o),
                                            n = o[o.length - 1],
                                        "." !== n && "!" !== n && "?" !== n && (o += "."),
                                            new e.GCUIError(o)
                                    }
                                    t.errors[i] = function() {
                                        throw n.apply(this, arguments)
                                    }
                                        ,
                                        t.errors[i].create = n
                                })
                            }
                            ,
                            t.errors.ca({
                                indexOutOfBounds: "Index is outside the bounds of the array.",
                                notImplemented: "The operation is not implemented",
                                unsupprtedOperation: "Unsupported operation",
                                unsupportedFilterOperator: "Unsupported filter operator: {0}",
                                unsupportedDataSource: "Unsupported data source",
                                argument: function(e) {
                                    var t = "Unexpected argument value.";
                                    return e && (t += "\nParameter name: " + e),
                                        t
                                },
                                argumentNull: "Argument '{0}' is null/undefined",
                                noParser: "There is no parser for type '{0}'",
                                noUrl: "Url is not specified",
                                cantConvert: "Value can't be converted to type '{0}': '{1}'",
                                noGlobalize: "Globalize is not defined. Make sure you include globalize.js"/*tpa=Globalize is not defined. Make sure you include globalize.js*/
                                ,
                                itemNotInView: "Item {0} is not in the data view",
                                unsupportedFilterFormat: "The filter format is not supported",
                                multiPropertyKeysNotSupported: "Entities with multiple properties in the primary key are not supported. Entity type: {0}",
                                keyPropertyNotFound: "Key property not found in {0} entity type"
                            })
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        !function(t) {
                            var i = jQuery;
                            t.opMap = {
                                "==": "equals",
                                doesnotcontain: "notcontain",
                                "!=": "notequal",
                                ">": "greater",
                                "<": "less",
                                ">=": "greaterorequal",
                                "<=": "lessorequal",
                                isnotempty: "notisempty",
                                isnotnull: "notisnull"
                            };
                            function o(i, o) {
                                var n, r;
                                return void 0 === o && (o = !1),
                                    i = i.toLowerCase(),
                                    n = t.ops[i],
                                n || (r = t.opMap[i]) && (n = t.ops[r]),
                                !n && o && e.errors.unsupportedOperator(i),
                                    n
                            }
                            function n(n) {
                                var r, a;
                                if (!i.isPlainObject(n))
                                    return {
                                        operator: "==",
                                        op: t.ops.equals,
                                        value: n
                                    };
                                if (a = n.operator || t.ops.equals,
                                        e.util.isString(n.operator)) {
                                    if ("nofilter" === n.operator.toLowerCase())
                                        return null;
                                    a = o(n.operator, !0)
                                } else
                                    i.isFunction(a.apply) || e.errors.unsupportedOperator(a);
                                return {
                                    operator: n.operator,
                                    op: a,
                                    value: n.value
                                }
                            }
                            t.normalizeCondition = n;
                            function r(t) {
                                var o, r = {
                                    original: t,
                                    func: null,
                                    normalized: null
                                };
                                return i.isFunction(t) ? r.func = t : i.isArray(t) ? e.errors.unsupportedFilterFormat(t) : t && (r.normalized = {},
                                    o = !1,
                                    e.util.each(t, function(t, a) {
                                        i.isArray(a) && e.errors.unsupportedFilterFormat(),
                                        (a = n(a)) && (r.normalized[t] = a,
                                            o = !0)
                                    }),
                                    o ? r.func = function(t) {
                                            return e.util.every(r.normalized, function(i, o) {
                                                var n = e.util.getProperty(t, o);
                                                return i.op.apply(n, i.value)
                                            })
                                        }
                                        : r.normalized = null),
                                r.normalized || r.func || (r.func = function(e) {
                                        return !0
                                    }
                                ),
                                    r
                            }
                            t.compile = r,
                                t.ops = function() {
                                    var t = {}
                                        , i = {
                                        str: ["string"],
                                        prim: ["string", "number", "datetime", "currency", "boolean"]
                                    };
                                    function o(e, i, o, n, r) {
                                        return t[e.toLowerCase()] = {
                                            name: e,
                                            displayName: i,
                                            arity: o,
                                            applicableTo: n,
                                            apply: r
                                        }
                                    }
                                    function n(t) {
                                        return t instanceof Date && (t = t.getTime()),
                                        e.util.isString(t) && (t = t.toLowerCase()),
                                            t
                                    }
                                    function r(e, t, i, r) {
                                        o(e, t, 2, i, function(e, t) {
                                            return r(n(e), n(t))
                                        })
                                    }
                                    function a(e, t, i, n) {
                                        o(e, t, 1, i, n)
                                    }
                                    function s(e, t, o) {
                                        r(e, t, i.prim, o)
                                    }
                                    function l(e, t, o) {
                                        r(e, t, i.str, o)
                                    }
                                    return s("Equals", "Equals", function(e, t) {
                                        return e == t
                                    }),
                                        s("NotEqual", "Not equal", function(e, t) {
                                            return e != t
                                        }),
                                        s("Greater", "Greater than", function(e, t) {
                                            return e > t
                                        }),
                                        s("Less", "Less than", function(e, t) {
                                            return e < t
                                        }),
                                        s("GreaterOrEqual", "Greater or equal", function(e, t) {
                                            return e >= t
                                        }),
                                        s("LessOrEqual", "Less or equal", function(e, t) {
                                            return e <= t
                                        }),
                                        l("Contains", "Contains", function(e, t) {
                                            return e == t || e && e.indexOf && e.indexOf(t) >= 0
                                        }),
                                        l("NotContain", "Does not contain", function(e, t) {
                                            return e != t && (!e || !e.indexOf || e.indexOf(t) < 0)
                                        }),
                                        l("BeginsWith", "Begins with", function(e, t) {
                                            return e == t || e && e.indexOf && 0 == e.indexOf(t)
                                        }),
                                        l("EndsWith", "Ends with", function(t, i) {
                                            var o;
                                            return !(!e.util.isString(t) || !e.util.isString(i)) && ((o = t.lastIndexOf(i)) >= 0 && t.length - o === i.length)
                                        }),
                                        a("IsEmpty", "Is empty", i.str, function(e) {
                                            return !e && 0 !== e && !1 !== e
                                        }),
                                        a("NotIsEmpty", "Is not empty", i.str, function(e) {
                                            return !!e || 0 === e || !1 === e
                                        }),
                                        a("IsNull", "Is null", i.prim, function(e) {
                                            return null == e
                                        }),
                                        a("NotIsNull", "Is not null", i.prim, function(e) {
                                            return null != e
                                        }),
                                        t
                                }()
                        }(e.filtering || (e.filtering = {}));
                        var t = e.filtering
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        !function(t) {
                            function i(t) {
                                var i = [];
                                return t = e.util.isString(t) ? t.split(/,\s*/) : $.isArray(t) ? t.slice(0) : [t],
                                    t = $.isArray(t) ? t.slice(0) : [t],
                                    e.util.each(t, function(t, o) {
                                        var n, r, a = !0;
                                        if (null != o) {
                                            if (!e.util.isString(o))
                                                return void (null != o.property && i.push(o));
                                            "-" === o[0] ? (a = !1,
                                                o = o.substr(1)) : (r = /\s(asc|desc)\s*$/.exec(o)) && (o = o.substr(0, r.index),
                                                a = !("desc" === r[1])),
                                                i.push({
                                                    property: o,
                                                    asc: a
                                                })
                                        }
                                    }),
                                    i
                            }
                            function o(t, o) {
                                var n, r;
                                return void 0 === o && (o = e.util.compare),
                                    n = i(t),
                                    r = {
                                        original: t,
                                        propertyCompareTo: o,
                                        compare: null,
                                        normalized: n
                                    },
                                null != n && (r.compare = function(t, i) {
                                        var r = 0, a, s;
                                        for (r = 0; r < n.length; r++)
                                            if (s = n[r],
                                                0 !== (a = o(e.util.getProperty(t, s.property), e.util.getProperty(i, s.property))))
                                                return s.asc || (a = -a),
                                                    a;
                                        return 0
                                    }
                                ),
                                    r
                            }
                            t.compile = o
                        }(e.sorting || (e.sorting = {}));
                        var t = e.sorting
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        var t = jQuery
                            , i = [];
                        function o(o) {
                            return t.isFunction(o) || e.errors.argument("factory"),
                                i.push(o),
                                {
                                    dispose: function() {
                                        e.util.remove(i, o)
                                    }
                                }
                        }
                        e.registerDataViewFactory = o,
                            o(function(e) {
                                return r(e) && e
                            }),
                            o(function(i) {
                                return t.isArray(i) && new e.ArrayDataView(i)
                            });
                        function n(t) {
                            if (r(t))
                                return t;
                            var o = e.util.some(i, function(e) {
                                return e(t)
                            });
                            return o || e.errors.unsupportedDataSource()
                        }
                        e.asDataView = n;
                        function r(e) {
                            return e && t.isFunction(e.count) && t.isFunction(e.item) && t.isFunction(e.getProperty)
                        }
                        e.isDataView = r
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        var t = jQuery
                            , i = function() {
                            function i(i) {
                                this.array = i,
                                    this.currentItem = e.observableWithNewValueCheck(null),
                                    this.currentPosition = e.observableWithNewValueCheck(-1);
                                var o = !1;
                                function n(e) {
                                    return function() {
                                        if (!o) {
                                            o = !0;
                                            try {
                                                e.apply(this, arguments)
                                            } finally {
                                                o = !1
                                            }
                                        }
                                    }
                                }
                                this.currentItem.subscribe(n(function(e) {
                                    this.currentPosition(null == e ? -1 : t.inArray(e, this.array))
                                }), this),
                                    this.currentPosition.subscribe(n(function(t) {
                                        e.util.isNumeric(t) || e.errors.argument("value"),
                                        (t < -1 || t >= this.array.length) && e.errors.indexOutOfBounds(),
                                            this.currentItem(t < 0 ? null : this.array[t])
                                    }), this)
                            }
                            return i.prototype.update = function() {
                                var e = this.currentItem()
                                    , i = this.currentPosition()
                                    , o = t.inArray(e, this.array);
                                o < 0 && null == e && null != this.da && (o = t.inArray(this.da, this.array)),
                                    o >= 0 ? (e && (this.da = e),
                                        this.currentPosition(o)) : i >= 0 && i < this.array.length ? this.currentItem(this.array[i]) : i == this.array.length && this.array.length > 0 ? (i = this.array.length - 1,
                                        this.currentPosition(i),
                                        this.currentItem(this.array[i])) : (this.currentPosition(-1),
                                        this.currentItem(null))
                            }
                                ,
                                i.prototype.updateDelayed = function() {
                                    e.util.executeDelayed(this.update, this)
                                }
                                ,
                                i
                        }();
                        e.CurrencyManager = i
                    }(e.data || (e.data = {}));
                    var t = e.data
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        var t, i, o = jQuery, n = function() {
                            function t(t) {
                                this.onChanged = t,
                                    this.filter = e.observable(),
                                    this.sort = e.observable(),
                                    this.pageIndex = e.observable(0),
                                    this.pageSize = e.observable(0),
                                    this.ea = 0,
                                    this.fa = -1,
                                    this.filter.subscribe(function(e) {
                                        this.onFilterChanged(e),
                                            t()
                                    }, this),
                                    this.sort.subscribe(function() {
                                        this.ga = e.sorting.compile(this.sort()),
                                            t()
                                    }, this);
                                function i() {
                                    this.pageSize() > 0 && this.pageIndex() >= 0 ? (this.ea = this.pageSize() * this.pageIndex(),
                                        this.fa = this.pageSize()) : (this.ea = 0,
                                        this.fa = -1),
                                        t(!0)
                                }
                                this.pageIndex.subscribe(i, this),
                                    this.pageSize.subscribe(i, this)
                            }
                            return t.prototype.onFilterChanged = function(t) {
                                this.ha = e.filtering.compile(t)
                            }
                                ,
                                t.prototype.setFilter = function(e) {
                                    this.filter(e)
                                }
                                ,
                                t.prototype.update = function(e) {
                                    "filter"in e && this.setFilter(e.filter),
                                    "sort"in e && this.sort(e.sort),
                                    "pageSize"in e && this.pageSize(e.pageSize),
                                    "pageIndex"in e && this.pageIndex(e.pageIndex)
                                }
                                ,
                                t.prototype.apply = function(t, i) {
                                    var o, n, r;
                                    return void 0 === i && (i = !0),
                                        o = this,
                                        n = [],
                                        e.util.each(t, function(e, t) {
                                            o.ha && !o.ha.func(t) || n.push(t)
                                        }),
                                    this.ga && n.sort(this.ga.compare),
                                        r = n.length,
                                    i && this.fa > 0 && (this.ea > 0 && n.splice(0, Math.min(this.ea, n.length)),
                                    this.fa < n.length && (n.length = this.fa)),
                                        {
                                            results: n,
                                            totalCount: r
                                        }
                                }
                                ,
                                t.prototype.toObj = function() {
                                    return {
                                        filter: this.ha && this.ha.normalized,
                                        sort: this.ga && this.ga.normalized,
                                        pageSize: this.pageSize(),
                                        pageIndex: this.pageIndex()
                                    }
                                }
                                ,
                                t
                        }();
                        e.Shape = n,
                            t = function() {
                                function t(t) {
                                    this.isRemote = !1,
                                        this.localPaging = !0,
                                        this.local = [],
                                        this.ia = !1,
                                        this.ja = e.observable(1),
                                        this.ka = e.observable(0),
                                        this.la = e.observable(!1),
                                        this.ma = e.observable(!1),
                                        this.na = e.observable(),
                                        this.oa = !1,
                                        this.pa = null,
                                        this.isLoading = this.ma.read(),
                                        this.isLoaded = this.la.read(),
                                        this.qa = new e.Subscribable(this),
                                        this.currentEditItem = this.na.read(),
                                        this.ra(),
                                        this.sa(t)
                                }
                                return t.prototype.dispose = function() {}
                                    ,
                                    t.prototype.count = function() {
                                        return this.local.length
                                    }
                                    ,
                                    t.prototype.item = function(t) {
                                        return (t < 0 || t >= this.local.length) && e.errors.indexOutOfBounds(),
                                            this.local[t]
                                    }
                                    ,
                                    t.prototype.indexOf = function(e) {
                                        return o.inArray(e, this.local)
                                    }
                                    ,
                                    t.prototype.getSource = function() {
                                        return this.sourceArray
                                    }
                                    ,
                                    t.prototype.toObservableArray = function() {
                                        return this.ta || (this.ta = ko.observableArray(this.local)),
                                            this.ta
                                    }
                                    ,
                                    t.ua = function t(i) {
                                        var n = [];
                                        return e.util.each(i, function(e, t) {
                                            e += "",
                                            e.match(/^_/) || o.isFunction(t) && !t.subscribe || n.push({
                                                name: e
                                            })
                                        }),
                                            n
                                    }
                                    ,
                                    t.prototype.getProperties = function() {
                                        return this.count() ? t.ua(this.item(0)) : []
                                    }
                                    ,
                                    t.prototype.va = function(t, i) {
                                        return e.util.getProperty(t, i)
                                    }
                                    ,
                                    t.prototype.getProperty = function(e, t) {
                                        var i = this.wa(e);
                                        return this.va(i, t)
                                    }
                                    ,
                                    t.prototype.xa = function(t, i, o) {
                                        e.util.setProperty(t, i, o)
                                    }
                                    ,
                                    t.prototype.setProperty = function(e, t, i) {
                                        var o = this.wa(e);
                                        return o !== this.currentEditItem() || !this.pa || t in this.pa || (this.pa[t] = this.getProperty(e, t)),
                                            this.xa(o, t, i),
                                            this
                                    }
                                    ,
                                    t.prototype.subscribe = function(e, t) {
                                        return this.qa.subscribe(e, t)
                                    }
                                    ,
                                    t.prototype.trigger = function() {
                                        this.ya.update(),
                                            this.qa.trigger(this.local),
                                        this.ta && this.ta.notifySubscribers(this.local)
                                    }
                                    ,
                                    t.prototype.canFilter = function() {
                                        return !0
                                    }
                                    ,
                                    t.prototype.canSort = function() {
                                        return !0
                                    }
                                    ,
                                    t.prototype.za = function(e) {
                                        this.ia = !0;
                                        try {
                                            this.Aa.update(e)
                                        } finally {
                                            this.ia = !1
                                        }
                                    }
                                    ,
                                    t.prototype.prevPage = function() {
                                        return !(this.pageIndex() < 1) && (this.pageIndex(this.pageIndex() - 1),
                                            !0)
                                    }
                                    ,
                                    t.prototype.nextPage = function() {
                                        return !(this.pageCount() > 0 && this.pageIndex() + 1 >= this.pageCount()) && (this.pageIndex(this.pageIndex() + 1),
                                            !0)
                                    }
                                    ,
                                    t.prototype.Ba = function(e) {
                                        return new n(e)
                                    }
                                    ,
                                    t.prototype.sa = function(e) {
                                        var t = this
                                            , i = function(e) {
                                            void 0 === e && (e = !1),
                                            t.ia || t.refresh(null, e && t.localPaging)
                                        };
                                        this.Aa = this.Ba(i),
                                        e && this.za(e),
                                            this.filter = this.Aa.filter,
                                            this.sort = this.Aa.sort,
                                            this.pageIndex = this.Aa.pageIndex,
                                            this.pageSize = this.Aa.pageSize,
                                            this.pageCount = this.ja.read(),
                                            this.totalItemCount = this.ka.read()
                                    }
                                    ,
                                    t.prototype.Ca = function(t) {
                                        var i, n;
                                        return void 0 === t && (t = this.localPaging),
                                            i = this,
                                            n = this.Aa.apply(this.sourceArray, t),
                                            this.local.length = 0,
                                            o.each(n.results, function(e, t) {
                                                return i.local.push(t)
                                            }),
                                        t && this.ka(n.totalCount),
                                            this.ja(e.util.pageCount(this.totalItemCount(), this.pageSize())),
                                            this.trigger(),
                                            o.Deferred().resolve().promise()
                                    }
                                    ,
                                    t.prototype.Da = function() {
                                        return this.Ca()
                                    }
                                    ,
                                    t.prototype.refresh = function(e, t) {
                                        var i, o;
                                        return void 0 === t && (t = !1),
                                            i = this,
                                            this.cancelRefresh(),
                                        e && this.za(e),
                                            this.ma(!0),
                                            o = t ? this.Ca() : this.Da(),
                                            o.then(function() {
                                                i.la(!0),
                                                    i.ma(!1)
                                            })
                                    }
                                    ,
                                    t.prototype.cancelRefresh = function() {}
                                    ,
                                    t.prototype.ra = function() {
                                        this.ya = new e.CurrencyManager(this.local),
                                            this.currentItem = this.ya.currentItem,
                                            this.currentPosition = this.ya.currentPosition
                                    }
                                    ,
                                    t.prototype.isCurrentEditItemNew = function() {
                                        return this.oa
                                    }
                                    ,
                                    t.prototype.Ea = function(e, t) {
                                        this.commitEdit(),
                                            this.pa = {},
                                            this.oa = t,
                                            this.na(e)
                                    }
                                    ,
                                    t.prototype.canAdd = function() {
                                        return !0
                                    }
                                    ,
                                    t.prototype.add = function(t) {
                                        t || e.errors.argument("item"),
                                            this.commitEdit(),
                                            this.local.push(t),
                                            this.Ea(t, !0),
                                            this.trigger()
                                    }
                                    ,
                                    t.prototype.canAddNew = function() {
                                        return !1
                                    }
                                    ,
                                    t.prototype.addNew = function() {
                                        return e.errors.unsupportedOperation()
                                    }
                                    ,
                                    t.prototype.editItem = function(e) {
                                        void 0 === e && (e = this.currentItem()),
                                            this.commitEdit(),
                                        (e = this.wa(e)) && this.Ea(e, !1)
                                    }
                                    ,
                                    t.prototype.canRemove = function() {
                                        return !0
                                    }
                                    ,
                                    t.prototype.Fa = function(t) {
                                        this.local.splice(t.index, 1),
                                            e.util.remove(this.sourceArray, t.item),
                                            this.trigger()
                                    }
                                    ,
                                    t.prototype.remove = function(e) {
                                        void 0 === e && (e = this.currentItem()),
                                            this.commitEdit();
                                        var t = this.Ga(e);
                                        return !!t && (this.Fa(t),
                                            !0)
                                    }
                                    ,
                                    t.prototype.canCancelEdit = function() {
                                        return !0
                                    }
                                    ,
                                    t.prototype.cancelEdit = function() {
                                        var t, i, n = this;
                                        this.currentEditItem() && (i = this.currentEditItem(),
                                            this.na(null),
                                            this.oa ? e.util.remove(this.local, this.item) : this.pa && o.each(this.pa, function(e, t) {
                                                return n.xa(i, e, t)
                                            }),
                                            this.trigger())
                                    }
                                    ,
                                    t.prototype.canCommitEdit = function() {
                                        return !0
                                    }
                                    ,
                                    t.prototype.commitEdit = function() {
                                        var t, i;
                                        this.currentEditItem() && (t = this.currentEditItem,
                                            this.na(null),
                                        this.oa && this.sourceArray.push(t),
                                            i = this.Aa.ha && this.Aa.ha.func,
                                        i && !i(t) && e.util.remove(this.local, t),
                                            this.trigger())
                                    }
                                    ,
                                    t.prototype.wa = function(t) {
                                        var i;
                                        return e.util.isNumeric(t) ? this.item(t) : t
                                    }
                                    ,
                                    t.prototype.Ga = function(t, i) {
                                        void 0 === i && (i = !1);
                                        var o;
                                        return e.util.isNumeric(t) ? {
                                            index: t,
                                            item: this.item(t)
                                        } : (o = this.indexOf(t),
                                            o < 0 ? (i && e.errors.itemNotInView(t),
                                                null) : {
                                                index: o,
                                                item: t
                                            })
                                    }
                                    ,
                                    t
                            }(),
                            e.ArrayDataViewBase = t,
                            i = function(e) {
                                __extends(t, e);
                                function t(t, i) {
                                    e.call(this, i),
                                        this.sourceArray = t,
                                        this.refresh()
                                }
                                return t
                            }(t),
                            e.ArrayDataView = i
                    }(e.data || (e.data = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        var t = jQuery
                            , i = function(e) {
                            __extends(i, e);
                            function i(t) {
                                e.call(this),
                                    this.isRemote = !0,
                                    this.sourceArray = [],
                                t && this.Ha(t)
                            }
                            return i.prototype.Ha = function(e) {
                                this.options = e = t.extend({
                                    localPaging: !1
                                }, e),
                                    this.localPaging = e.localPaging,
                                    this.za(e)
                            }
                                ,
                                i
                        }(e.ArrayDataViewBase);
                        e.RemoteDataView = i
                    }(e.data || (e.data = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        var t = jQuery
                            , i = function() {
                            function e(e) {
                                this.Ia = e
                            }
                            return e.prototype.read = function(e) {
                                if (e.items = null,
                                    this.Ia && t.isFunction(this.Ia.read) && this.Ia.read(e),
                                    t.isArray(e.items) || (t.isArray(e.data) ? e.items = e.data : e.data && t.isArray(e.data.rows) ? e.items = e.data.rows : e.items = []),
                                    e.dynamic && (!e.data || isNaN(e.data.totalRows)))
                                    throw "totalRows value is missing"
                            }
                                ,
                                e
                        }()
                            , o = function(o) {
                            __extends(n, o);
                            function n(e) {
                                var n, r = this;
                                o.call(this),
                                    this.dataSource = e,
                                    this.isRemote = !0,
                                    this.localPaging = !0,
                                    this.Ja = e.loaded,
                                    this.Ka = e.reader,
                                    e.loaded = function(e, i) {
                                        r.La(),
                                        t.isFunction(r.Ja) && r.Ja.apply(r, arguments)
                                    }
                                    ,
                                    e.reader = new i(e.reader),
                                    n = e.items && e.items.length > 0,
                                t.isArray(e.data) && !n && e.read(),
                                e.items && this.La()
                            }
                            return n.prototype.dispose = function() {
                                this.dataSource.loaded = this.Ja,
                                    this.dataSource.reader = this.Ka,
                                    o.prototype.dispose.call(this)
                            }
                                ,
                                n.prototype.getProperties = function() {
                                    return this.sourceArray && this.sourceArray.length ? e.ArrayDataViewBase.ua(this.sourceArray[0]) : []
                                }
                                ,
                                n.prototype.La = function() {
                                    this.sourceArray = this.dataSource.items,
                                    this.dataSource.data && e.util.isNumeric(this.dataSource.data.totalRows) && this.ka(this.dataSource.data.totalRows);
                                    var t = o.prototype.Ca.call(this, !this.dataSource.dynamic);
                                    this.Ma && t.then(this.Ma.resolve)
                                }
                                ,
                                n.prototype.Da = function() {
                                    this.Ma && "pending" === this.Ma.state() && this.Ma.fail(),
                                        this.Ma = t.Deferred();
                                    var e = {}
                                        , i = !1;
                                    return this.dataSource.dynamic && (i = !0,
                                        e.data = this.Na(),
                                    this.dataSource.proxy && (this.Oa || (this.Oa = t.extend({}, this.dataSource.proxy.options.data)),
                                        this.dataSource.proxy.options.data = t.extend({}, this.Oa, e.data))),
                                        this.dataSource.load(e, i),
                                        this.Ma
                                }
                                ,
                                n.prototype.Na = function() {
                                    return {
                                        filtering: this.Pa(),
                                        paging: this.Qa(),
                                        sorting: this.Ra()
                                    }
                                }
                                ,
                                n.prototype.Pa = function() {
                                    var e = [];
                                    return this.Aa.ha && this.Aa.ha.normalized && t.each(this.Aa.ha.normalized, function(t, i) {
                                        e.push({
                                            dataKey: t,
                                            filterOperator: i.op.Name,
                                            filterValue: i.value
                                        })
                                    }),
                                        e
                                }
                                ,
                                n.prototype.Qa = function() {
                                    return {
                                        pageIndex: this.Aa.pageIndex(),
                                        pageSize: this.Aa.pageSize()
                                    }
                                }
                                ,
                                n.prototype.Ra = function() {
                                    return this.Aa.ga && this.Aa.ga.normalized && 0 != this.Aa.ga.normalized.length ? t.map(this.Aa.ga.normalized, function(e) {
                                        return {
                                            dataKey: e.property,
                                            sortDirection: e.asc ? "ascending" : "descending"
                                        }
                                    }) : []
                                }
                                ,
                                n
                        }(e.ArrayDataViewBase);
                        e.registerDataViewFactory(function(e) {
                            if ("function" == typeof gcuidatasource && e instanceof gcuidatasource)
                                return new o(e)
                        })
                    }(e.data || (e.data = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments)
                            }
                            return t.prototype._create = function() {
                                window.applyTouchUtilEvents && (o = window.applyTouchUtilEvents(o)),
                                    this.element.addClass(this.options.uiCSS.widget + " gcui-pager " + this.options.uiCSS.helperClearFix),
                                this.options.disabled && this.disable(),
                                    this.Sa()
                            }
                                ,
                                t.prototype.Ta = function() {
                                    this.element.removeClass(this.options.uiCSS.widget + " gcui-pager " + this.options.uiCSS.helperClearFix),
                                        this.$ul.remove()
                                }
                                ,
                                t.prototype._setOption = function(e, t) {
                                    this.Ua(e, t),
                                        this.Sa()
                                }
                                ,
                                t.prototype.Sa = function() {
                                    switch (this.Va(),
                                    this.$ul && this.$ul.remove(),
                                        this.element.append(this.$ul = o('<ul class="ui-list ' + this.options.uiCSS.cornerAll + " " + this.options.uiCSS.content + " " + this.options.uiCSS.helperClearFix + '" role="tablist"></ul>')),
                                        (this.options.mode || "").toLowerCase()) {
                                        case "nextprevious":
                                            this.Wa(!1);
                                            break;
                                        case "nextpreviousfirstlast":
                                            this.Wa(!0);
                                            break;
                                        case "numeric":
                                            this.Xa(!1);
                                            break;
                                        case "numericfirstlast":
                                            this.Xa(!0)
                                    }
                                }
                                ,
                                t.prototype.Va = function() {
                                    var e = this.options;
                                    (isNaN(e.pageCount) || e.pageCount < 1) && (e.pageCount = 1),
                                        isNaN(e.pageIndex) || e.pageIndex < 0 ? e.pageIndex = 0 : e.pageIndex >= e.pageCount && (e.pageIndex = e.pageCount - 1),
                                    (isNaN(e.pageButtonCount) || e.pageButtonCount < 1) && (e.pageButtonCount = 1)
                                }
                                ,
                                t.prototype.Wa = function(e) {
                                    var t = this.options;
                                    e && t.pageIndex && this.$ul.append(this.Ya(!1, t.firstPageText, 1, t.firstPageClass)),
                                    t.pageIndex && this.$ul.append(this.Ya(!1, t.previousPageText, t.pageIndex, t.previousPageClass)),
                                    t.pageIndex + 1 < t.pageCount && this.$ul.append(this.Ya(!1, t.nextPageText, t.pageIndex + 2, t.nextPageClass)),
                                    e && t.pageIndex + 1 < t.pageCount && this.$ul.append(this.Ya(!1, t.lastPageText, t.pageCount, t.lastPageClass))
                                }
                                ,
                                t.prototype.Xa = function(e) {
                                    var t = this.options, i = t.pageIndex + 1, o = 1, n = Math.min(t.pageCount, t.pageButtonCount), r;
                                    for (i > n && (o = Math.floor(t.pageIndex / t.pageButtonCount) * t.pageButtonCount + 1,
                                        n = o + t.pageButtonCount - 1,
                                    (n = Math.min(n, t.pageCount)) - o + 1 < t.pageButtonCount && (o = Math.max(1, n - t.pageButtonCount + 1))),
                                         1 !== o && (e && this.$ul.append(this.Ya(!1, t.firstPageText, 1, t.firstPageClass)),
                                             this.$ul.append(this.Ya(!1, "...", o - 1, ""))),
                                             r = o; r <= n; r++)
                                        this.$ul.append(this.Ya(r === i, "" + r, r, ""));
                                    t.pageCount > n && (this.$ul.append(this.Ya(!1, "...", n + 1, "")),
                                    e && this.$ul.append(this.Ya(!1, t.lastPageText, t.pageCount, t.lastPageClass)))
                                }
                                ,
                                t.prototype.Ya = function(e, t, i, n) {
                                    var r, a = this.options.uiCSS, s = this, l = o("<li />").addClass("gcui-pager-button " + a.cornerAll).attr({
                                        role: "tab",
                                        "aria-label": t,
                                        title: t
                                    });
                                    return e ? l.addClass(a.stateActive).attr("aria-selected", "true") : l.addClass(a.stateDefault).hover(function() {
                                        s.options.disabled || o(this).addClass(a.stateHover)
                                    }, function() {
                                        s.options.disabled || o(this).removeClass(a.stateHover)
                                    }).bind("click." + this.widgetName, {
                                        newPageIndex: i - 1
                                    }, o.proxy(this.Za, this)),
                                        r = e ? o("<span />") : n ? o("<span />").addClass(a.icon + " " + n) : o("<a/>").attr("href", "#"),
                                        r.text(t),
                                        l.append(r),
                                        l
                                }
                                ,
                                t.prototype.Za = function(e) {
                                    var t, i;
                                    return !this.options.disabled && (t = {
                                        newPageIndex: e.data.newPageIndex,
                                        handled: !1
                                    },
                                    !1 !== this._trigger("pageIndexChanging", null, t) && this.options.pageIndex !== t.newPageIndex && (this.options.pageIndex = t.newPageIndex,
                                    t.handled || this.Sa(),
                                        i = {
                                            newPageIndex: t.newPageIndex
                                        },
                                        this._trigger("pageIndexChanged", null, i)),
                                        !1)
                                }
                                ,
                                t
                        }(e.gcuiWidget);
                        t.gcuipager = n,
                            n.prototype.widgetEventPrefix = "gcuipager",
                            i = function() {
                                function e() {
                                    this.mobileCSS = {
                                        header: "ui-header ui-bar-a",
                                        content: "ui-body-c",
                                        stateDefault: "ui-btn-up-c",
                                        stateHover: "ui-btn-down-b",
                                        stateActive: "ui-btn-down-c"
                                    },
                                        this.firstPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekFirst,
                                        this.firstPageText = "First",
                                        this.lastPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekEnd,
                                        this.lastPageText = "Last",
                                        this.mode = "numeric",
                                        this.nextPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekNext,
                                        this.nextPageText = "Next",
                                        this.pageButtonCount = 10,
                                        this.previousPageClass = o.gcui.widget.prototype.options.uiCSS.iconSeekPrev,
                                        this.previousPageText = "Previous",
                                        this.pageCount = 1,
                                        this.pageIndex = 0,
                                        this.pageIndexChanging = null,
                                        this.pageIndexChanged = null
                                }
                                return e
                            }(),
                            n.prototype.options = o.extend(!0, {}, e.gcuiWidget.prototype.options, new i),
                            o.gcui.registerWidget("gcuipager", n.prototype)
                    }(e.pager || (e.pager = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = 0, r = 0, a = o.effects ? o.effects : o, s = a.save, l = a.restore, c = a.createWrapper, d = a.removeWrapper, p = function() {
                            return ++n
                        }, u = function() {
                            return ++r
                        }, h = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments)
                            }
                            return t.prototype._setOption = function(t, i) {
                                switch (e.prototype._setOption.call(this, t, i),
                                    t) {
                                    case "selected":
                                        if (this.options.collapsible && i === this.options.selected)
                                            return;
                                        this.select(i);
                                        break;
                                    case "alignment":
                                        this.$a(!0),
                                            this._a(!0);
                                        break;
                                    default:
                                        this._a(!1)
                                }
                            }
                                ,
                                t.prototype._create = function() {
                                    var t = this
                                        , i = this.options;
                                    this.element.is(":hidden") && this.element.addVisibilityObserver && this.element.addVisibilityObserver(function() {
                                        t.element.removeVisibilityObserver && t.element.removeVisibilityObserver();
                                        var e = t.element.data("gcuitabs")
                                            , i = t.element.data("gcuiUITabs");
                                        t.$a(!0),
                                            t.element.data("gcuitabs", e),
                                            t.element.data("gcuiUITabs", i),
                                            t._a(!0)
                                    }, "gcuitabs"),
                                        this._a(!0),
                                    (i.disabledstate || i.disabled) && this.disable(),
                                        e.prototype._create.call(this)
                                }
                                ,
                                t.prototype.destroy = function() {
                                    this.$a(),
                                        e.prototype.destroy.call(this)
                                }
                                ,
                                t.prototype._a = function(e) {
                                    this.list = this.element.children("ol,ul").eq(0),
                                        this.lis = o("li:has(a)", this.list),
                                        this.anchors = this.lis.map(function() {
                                            return o("a", this)[0]
                                        }),
                                        this.panels = o([]);
                                    var t = this, i = t.options, n = /^#.+/, r, a, s, l, c, d, p, u, h;
                                    if (o.each(t.anchors, function(e, r) {
                                            var a = o(r).attr("href") || "", s = a.split("#")[0], l, c, d;
                                            s && (s === ("" + location).split("#")[0] || (l = o("base")[0]) && s === l.href) && (a = r.hash,
                                                r.href = a),
                                                n.test(a) ? t.panels = t.panels.add(t.ab(a), t.element) : "#" !== a ? (o.data(r, "href.tabs", a),
                                                    o.data(r, "load.tabs", a.replace(/#.*$/, "")),
                                                    c = t.bb(r),
                                                    r.href = "#" + c,
                                                    d = o("#" + c),
                                                d.length || (d = o(i.panelTemplate || t.cb.panelTemplate).attr("id", c).addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS.content).addClass(i.uiCSS.cornerBottom).insertAfter(t.panels[e - 1] || t.list),
                                                    d.data("destroy.tabs", !0)),
                                                    t.panels = t.panels.add(d)) : i.disabledIndexes.push(e)
                                        }),
                                            r = this.eb(!0),
                                            a = this.eb(!1),
                                            e) {
                                        switch (this.list.attr("role", "tablist"),
                                            this.lis.attr("role", "tab"),
                                            this.panels.attr("role", "tabpanel"),
                                            this.element.addClass(i.uiCSS.tabs).addClass(i.uiCSS.gcuitabs).addClass(i.uiCSS.widget).addClass(i.uiCSS.content).addClass(i.uiCSS.cornerAll).addClass(i.uiCSS.helperClearFix).addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS["tabs" + r]),
                                            this.list.addClass(i.uiCSS.tabsNav).addClass(i.uiCSS.helperReset).addClass(i.uiCSS.helperClearFix).addClass(i.uiCSS.header).addClass(i.uiCSS.cornerAll),
                                            this.lis.addClass(i.uiCSS.stateDefault).addClass(i.uiCSS["corner" + r]),
                                            this.panels.addClass(i.uiCSS.tabsPanel).addClass(i.uiCSS.content).addClass(i.uiCSS["corner" + a]),
                                            r) {
                                            case "Bottom":
                                                this.list.appendTo(this.element);
                                                break;
                                            case "Left":
                                                s = o("<div/>").addClass(i.uiCSS.tabsContent).appendTo(this.element),
                                                    this.panels.appendTo(s);
                                                break;
                                            case "Right":
                                                s = o("<div/>").addClass(i.uiCSS.tabsContent).insertBefore(this.list),
                                                    this.panels.appendTo(s);
                                                break;
                                            case "Top":
                                                this.list.prependTo(this.element)
                                        }
                                        i.sortable && this.list.sortable && this.list.sortable({
                                            axis: "Top" === r || "Bottom" === r ? "x" : "y"
                                        }),
                                            void 0 === i.selected ? (location.hash && o.each(this.anchors, function(e, t) {
                                                if (t.hash === location.hash)
                                                    return i.selected = e,
                                                        !1
                                            }),
                                            "number" != typeof i.selected && i.cookie && (i.selected = parseInt(t.fb(void 0, void 0), 10)),
                                            "number" != typeof i.selected && this.lis.filter("." + i.uiCSS.tabsActive).length && (i.selected = this.lis.index(this.lis.filter("." + i.uiCSS.tabsActive))),
                                                i.selected = i.selected || (this.lis.length ? 0 : -1)) : null === i.selected && (i.selected = -1),
                                            i.selected = i.selected >= 0 && this.anchors[i.selected] || i.selected < 0 ? i.selected : 0,
                                            i.disabledIndexes = o.unique(i.disabledIndexes.concat(o.map(this.lis.filter("." + i.uiCSS.stateDisabled), function(e, i) {
                                                return t.lis.index(e)
                                            }))).sort(),
                                        -1 !== o.inArray(i.selected, i.disabledIndexes) && i.disabledIndexes.splice(o.inArray(i.selected, i.disabledIndexes), 1),
                                            this.panels.addClass(i.uiCSS.tabsHide).attr("aria-hidden", !0),
                                            this.lis.removeClass(i.uiCSS.tabsActive).removeClass(i.uiCSS.stateActive).attr("aria-selected", !1),
                                        i.selected >= 0 && this.anchors.length && (this.panels.eq(i.selected).removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1),
                                            this.lis.eq(i.selected).addClass(i.uiCSS.tabsActive).addClass(i.uiCSS.stateActive).attr("aria-selected", !0),
                                            t.element.queue("tabs", function() {
                                                t.element.triggerVisibility && o(t.panels[i.selected]).triggerVisibility(),
                                                    t._trigger("show", null, t.gb(t.anchors[i.selected], t.panels[i.selected]))
                                            }),
                                            this.load(i.selected)),
                                            o(window).bind("unload", function() {
                                                t.lis && t.lis.add(t.anchors).unbind(".tabs"),
                                                    t.lis = t.anchors = t.panels = null
                                            })
                                    } else
                                        i.selected = this.lis.index(this.lis.filter("." + i.uiCSS.tabsActive));
                                    for (this.element[i.collapsible ? "addClass" : "removeClass"](i.uiCSS.tabsCollapsible),
                                         i.cookie && this.fb(i.selected, i.cookie),
                                             l = 0; l < this.lis.length; l++)
                                        c = this.lis[l],
                                            o(c)[-1 === o.inArray(l, i.disabledIndexes) || o(c).hasClass(i.uiCSS.tabsActive) ? "removeClass" : "addClass"](i.uiCSS.stateDisabled),
                                        o(c).hasClass(i.uiCSS.stateDisabled) && o(c).attr("aria-disabled", !0);
                                    !1 === i.cache && this.anchors.removeData("cache.tabs"),
                                        this.lis.add(this.anchors).unbind(".tabs"),
                                    i.disabledState || i.disabled || "mouseover" === i.event || (d = function(e, t) {
                                        t.is(":not(." + i.uiCSS.stateDisabled + ")") && t.addClass(e)
                                    }
                                        ,
                                        p = function(e, t) {
                                            t.removeClass(e)
                                        }
                                        ,
                                        this.lis.bind("mouseover.tabs", function() {
                                            d(i.uiCSS.stateHover, o(this))
                                        }),
                                        this.lis.bind("mouseout.tabs", function() {
                                            p(i.uiCSS.stateHover, o(this))
                                        }),
                                        this.anchors.bind("focus.tabs", function() {
                                            t.lis.filter("." + i.uiCSS.stateFocus).removeClass(i.uiCSS.stateFocus),
                                                d(i.uiCSS.stateFocus, o(this).closest("li"))
                                        }),
                                        this.anchors.bind("blur.tabs", function() {
                                            p(i.uiCSS.stateFocus, o(this).closest("li"))
                                        })),
                                    void 0 !== i.showOption && null !== i.showOption || (i.showOption = {}),
                                        this.hb(i.showOption),
                                    void 0 !== i.hideOption && null !== i.hideOption || (i.hideOption = {}),
                                        this.hb(i.hideOption),
                                        u = (i.showOption.blind || i.showOption.fade) && i.showOption.duration > 0 ? function(e, n) {
                                                if (o(e).closest("li").addClass(i.uiCSS.tabsActive).addClass(i.uiCSS.stateActive).attr("aria-selected", !0),
                                                        t.ib(),
                                                        n.removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1),
                                                    "Top" === r || "Bottom" === r) {
                                                    var a = {
                                                        duration: i.showOption.duration,
                                                        height: "toggle",
                                                        opacity: "toggle"
                                                    };
                                                    i.showOption.blind || delete a.height,
                                                    i.showOption.fade || delete a.opacity,
                                                        n.hide().removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1).animate(a, i.showOption.duration || "normal", function() {
                                                            t.jb(n),
                                                            n.triggerVisibility && n.triggerVisibility(),
                                                                t._trigger("show", null, t.gb(e, n[0]))
                                                        })
                                                } else
                                                    t.ib(),
                                                        t.kb(n, "show")
                                            }
                                            : function(e, n) {
                                                o(e).closest("li").addClass(i.uiCSS.tabsActive).addClass(i.uiCSS.stateActive).attr("aria-selected", !0),
                                                    t.ib(),
                                                    n.removeClass(i.uiCSS.tabsHide).attr("aria-hidden", !1),
                                                n.triggerVisibility && n.triggerVisibility(),
                                                    t._trigger("show", null, t.gb(e, n[0]))
                                            }
                                        ,
                                        h = (i.hideOption.blind || i.hideOption.fade) && i.hideOption.duration > 0 ? function(e, o) {
                                                if ("Top" === r || "Bottom" === r) {
                                                    var n = {
                                                        duration: i.hideOption.duration,
                                                        height: "toggle",
                                                        opacity: "toggle"
                                                    };
                                                    i.hideOption.blind || delete n.height,
                                                    i.hideOption.fade || delete n.opacity,
                                                        o.animate(n, i.hideOption.duration || "normal", function() {
                                                            t.lis.removeClass(i.uiCSS.tabsActive).removeClass(i.uiCSS.stateActive).attr("aria-selected", !1),
                                                                o.addClass(i.uiCSS.tabsHide).attr("aria-hidden", !0),
                                                                t.jb(o),
                                                                t.element.dequeue("tabs")
                                                        })
                                                } else
                                                    t.lb(),
                                                        t.kb(o, "hide")
                                            }
                                            : function(e, o, n) {
                                                t.lis.removeClass(i.uiCSS.tabsActive).removeClass(i.uiCSS.stateActive).attr("aria-selected", !1),
                                                    t.mb(),
                                                    o.addClass(i.uiCSS.tabsHide).attr("aria-hidden", !0),
                                                    t.element.dequeue("tabs")
                                            }
                                        ,
                                    i.disabledState || i.disabled || this.anchors.bind(i.event + ".tabs", function() {
                                        var e = this
                                            , n = o(this).closest("li")
                                            , r = t.panels.filter(":not(." + i.uiCSS.tabsHide + ")")
                                            , a = o(t.ab(this.hash), t.element);
                                        if (n.hasClass(i.uiCSS.tabsActive) && !i.collapsible || n.hasClass(i.uiCSS.stateDisabled) || n.hasClass(i.uiCSS.tabsLoading) || !1 === t._trigger("select", null, t.gb(this, a[0])))
                                            return this.blur(),
                                                !1;
                                        if (i.selected = t.anchors.index(this),
                                                t.abort(),
                                                i.collapsible) {
                                            if (n.hasClass(i.uiCSS.tabsActive))
                                                return i.selected = -1,
                                                i.cookie && t.fb(i.selected, i.cookie),
                                                    t.element.queue("tabs", function() {
                                                        h(e, r)
                                                    }).dequeue("tabs"),
                                                    this.blur(),
                                                    !1;
                                            if (!r.length)
                                                return i.cookie && t.fb(i.selected, i.cookie),
                                                    t.element.queue("tabs", function() {
                                                        u(e, a)
                                                    }),
                                                    t.load(t.anchors.index(this)),
                                                    this.blur(),
                                                    !1
                                        }
                                        if (i.cookie && t.fb(i.selected, i.cookie),
                                                !a.length)
                                            throw "jQuery UI Tabs: Mismatching fragment identifier.";
                                        r.length && t.element.queue("tabs", function() {
                                            h(e, r)
                                        }),
                                            t.element.queue("tabs", function() {
                                                u(e, a)
                                            }),
                                            t.load(t.anchors.index(this)),
                                        GC.Spread.Sheets.util.browser.msie && this.blur()
                                    }),
                                        this.nb(),
                                        this.anchors.bind("click.tabs", function() {
                                            return !1
                                        })
                                }
                                ,
                                t.prototype.kb = function(e, t) {
                                    var i = this, n = i.options, r = e.parent("." + n.uiCSS.tabsContent), a = ["position", "top", "left", "width"], l = "show" === t ? n.showOption : n.hideOption, p, u, h;
                                    r.length && (i.list.width(i.list.width()),
                                    s && s(e, a),
                                        e.show(),
                                        "show" === t ? (e.removeClass(n.uiCSS.tabsHide).attr("aria-hidden", !1),
                                            e.width(i.element.data("panel.width"))) : e.width(e.width()),
                                        p = c ? c(e).css({
                                            overflow: "hidden"
                                        }) : o("<div></div>"),
                                    "show" === t && p.css(o.extend({
                                        width: 0
                                    }, l.fade ? {
                                        opacity: 0
                                    } : {})),
                                        u = o.extend({
                                            width: "show" === t ? i.element.data("panel.outerWidth") : 0
                                        }, l.fade ? {
                                            opacity: "show" === t ? 1 : 0
                                        } : {}),
                                        h = i.list.outerWidth(!0),
                                        p.animate(u, {
                                            duration: l.duration,
                                            step: function() {
                                                var e = p.outerWidth(!0);
                                                i.element.width(h + e),
                                                    r.width(Math.max(0, i.element.innerWidth() - h - 6))
                                            },
                                            complete: function() {
                                                "hide" === t ? (i.lis.removeClass(n.uiCSS.tabsActive).removeClass(n.uiCSS.stateActive).attr("aria-selected", !1),
                                                    e.addClass(n.uiCSS.tabsHide).attr("aria-hidden", !0)) : e.css("width", ""),
                                                d && d(e),
                                                "show" === t && i.ob(),
                                                    i.jb(e),
                                                    e.dequeue(),
                                                    i.element.dequeue("tabs")
                                            }
                                        }))
                                }
                                ,
                                t.prototype.mb = function() {
                                    var e = this.options.uiCSS
                                        , t = this.element.find("." + e.tabsContent);
                                    t.length && (this.lb(),
                                        t.addClass(e.tabsHide).attr("aria-hidden", !0),
                                        this.element.width(this.list.outerWidth(!0)))
                                }
                                ,
                                t.prototype.ib = function() {
                                    var e = this.options.uiCSS
                                        , t = this.element.find("." + e.tabsContent);
                                    t.length && (this.ob(),
                                        t.removeClass(e.tabsHide).attr("aria-hidden", !1))
                                }
                                ,
                                t.prototype.lb = function() {
                                    var e = this.options.uiCSS
                                        , t = ["width", "height", "overflow"]
                                        , i = this.panels.filter(":not(." + e.tabsHide + ")");
                                    s && (s(this.element, t),
                                        s(this.list, t),
                                        s(this.element.find("." + e.tabsContent), t)),
                                        this.list.width(this.list.width()),
                                        this.element.data("panel.width", i.width()),
                                        this.element.data("panel.outerWidth", i.outerWidth(!0))
                                }
                                ,
                                t.prototype.ob = function() {
                                    var e = this.options.uiCSS
                                        , t = ["width", "height", "overflow"];
                                    l && (l(this.element, t),
                                        l(this.list, t),
                                        l(this.element.find("." + e.tabsContent), t))
                                }
                                ,
                                t.prototype.jb = function(e) {
                                    e.css({
                                        display: ""
                                    }),
                                    o.support.opacity || e[0].style.removeAttribute("filter")
                                }
                                ,
                                t.prototype.hb = function(e) {
                                    if (void 0 === e.blind && (e.blind = !1),
                                        void 0 === e.fade && (e.fade = !1),
                                        void 0 === e.duration && (e.duration = 200),
                                        "string" == typeof e.duration)
                                        try {
                                            e.duration = parseInt(e.duration, 10)
                                        } catch (t) {
                                            e.duration = 200
                                        }
                                }
                                ,
                                t.prototype.nb = function() {
                                    var e = this
                                        , t = -1 !== o.inArray(this.eb(!0), ["Top", "Bottom"])
                                        , i = 0;
                                    t && (o.each(this.lis, function(t, n) {
                                        var r = o(n), a, s = 0, l = 0;
                                        GC.Spread.Sheets.util.browser.msie && e.options.scrollable && (o.each(r.children(), function(e, t) {
                                            var i = o(t);
                                            i.is("a") && i.width(i.width()),
                                                s += i.outerWidth(!0)
                                        }),
                                            l = s - r.width(),
                                            r.width(s)),
                                            i += e.pb(o(n)) + l
                                    }),
                                        this.options.scrollable && this.element.innerWidth() < i ? (void 0 === this.scrollWrap && (this.list.wrap("<div class='scrollWrap'></div>"),
                                            this.scrollWrap = this.list.parent(),
                                        s && s(this.list, ["width", "height", "overflow"])),
                                            this.list.width(Math.ceil(i) + 2),
                                            this.scrollWrap.height(this.list.outerHeight(!0)),
                                            this.scrollWrap.superpanel({
                                                allowResize: !1,
                                                hScroller: {
                                                    scrollMode: "edge"
                                                },
                                                vScroller: {
                                                    scrollBarVisibility: "hidden"
                                                }
                                            })) : this.qb())
                                }
                                ,
                                t.prototype.gb = function(e, t) {
                                    return {
                                        tab: e,
                                        panel: t,
                                        index: this.anchors.index(e)
                                    }
                                }
                                ,
                                t.prototype.bb = function(e) {
                                    var t = o(e), i, n;
                                    return t.data && t.data("tabid") ? t.data("tabid") : e.href && e.href.length && (n = this.rb(e.href),
                                        n.tabId) ? (i = n.tabId,
                                        t.data("tabid", i),
                                        i) : (i = e.title && e.title.replace(/\s/g, "_").replace(/[^A-Za-z0-9\-_:\.]/g, "") || this.options.idPrefix + p(),
                                        t.data("tabid", i),
                                        i)
                                }
                                ,
                                t.prototype.rb = function(e) {
                                    var t = {}, i, n;
                                    return e.indexOf("?") > -1 && (i = e.split("?")[1],
                                        n = i.split("&"),
                                        o.each(n, function(e, i) {
                                            var o = i.split("=");
                                            o.length > 1 && (t[o[0]] = o[1])
                                        })),
                                        t
                                }
                                ,
                                t.prototype.eb = function(e) {
                                    var t = this.options.alignment || "top";
                                    if (e)
                                        return t.charAt(0).toUpperCase() + t.substr(1);
                                    switch (t) {
                                        case "top":
                                            t = "Bottom";
                                            break;
                                        case "bottom":
                                            t = "Top";
                                            break;
                                        case "left":
                                            t = "Right";
                                            break;
                                        case "right":
                                            t = "Left"
                                    }
                                    return t
                                }
                                ,
                                t.prototype.ab = function(e) {
                                    return e.replace(/:/g, "\\:")
                                }
                                ,
                                t.prototype.$a = function(e) {
                                    var t = this.options
                                        , i = o("." + t.uiCSS.tabsContent);
                                    return this.abort(),
                                        this.qb(),
                                        this.element.unbind(".tabs").removeClass(t.uiCSS.gcuitabs).removeClass(t.uiCSS.tabsTop).removeClass(t.uiCSS.tabsBottom).removeClass(t.uiCSS.tabsLeft).removeClass(t.uiCSS.tabsRight).removeClass(t.uiCSS.tabs).removeClass(t.uiCSS.widget).removeClass(t.uiCSS.content).removeClass(t.uiCSS.cornerAll).removeClass(t.uiCSS.tabsCollapsible).removeClass(t.uiCSS.helperClearFix).removeData("tabs").removeAttr("role"),
                                        this.list.removeClass(t.uiCSS.tabsNav).removeClass(t.uiCSS.helperReset).removeClass(t.uiCSS.helperClearFix).removeClass(t.uiCSS.header).removeClass(t.uiCSS.cornerAll).removeAttr("role"),
                                        o.each(this.anchors, function(e, t) {
                                            var i = o(t)
                                                , n = i.data("href.tabs");
                                            n && (t.href = n),
                                                i.unbind(".tabs"),
                                                o.each(["href", "load", "cache"], function(e, t) {
                                                    i.removeData(t + ".tabs")
                                                })
                                        }),
                                        this.lis.unbind(".tabs").add(this.panels).each(function(i, n) {
                                            var r = o(n);
                                            r.data("destroy.tabs") && !e ? r.remove() : r.removeClass(t.uiCSS.stateDefault).removeClass(t.uiCSS.cornerTop).removeClass(t.uiCSS.cornerBottom).removeClass(t.uiCSS.cornerLeft).removeClass(t.uiCSS.cornerRight).removeClass(t.uiCSS.tabsActive).removeClass(t.uiCSS.stateActive).removeClass(t.uiCSS.stateHover).removeClass(t.uiCSS.stateFocus).removeClass(t.uiCSS.stateDisabled).removeClass(t.uiCSS.tabsPanel).removeClass(t.uiCSS.content).removeClass(t.uiCSS.tabsHide).css({
                                                position: "",
                                                left: "",
                                                top: ""
                                            }).removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-selected").removeAttr("aria-disabled")
                                        }),
                                    i.length && i.replaceWith(i.contents()),
                                    t.cookie && this.fb(null, t.cookie),
                                        this
                                }
                                ,
                                t.prototype.sb = function() {
                                    var e = this.options.uiCSS;
                                    this.lis.filter("." + e.tabsLoading).removeClass(e.tabsLoading).find("span:data(label.tabs)").each(function() {
                                        var e = o(this);
                                        e.html(e.data("label.tabs")).removeData("label.tabs")
                                    })
                                }
                                ,
                                t.prototype.qb = function() {
                                    this.scrollWrap && (this.scrollWrap.superpanel("destroy").replaceWith(this.scrollWrap.contents()),
                                        this.scrollWrap = void 0,
                                    l && l(this.list, ["width", "height", "overflow"]))
                                }
                                ,
                                t.prototype.fb = function(e, t) {
                                    var i = this.cookie || (this.cookie = this.options.cookie.name || "ui-tabs-" + u());
                                    return o.cookie.apply(null, [i].concat(o.makeArray(arguments)))
                                }
                                ,
                                t.prototype.pb = function(e) {
                                    return this.tb(e.css("margin-left")) + this.tb(e.css("border-left-width")) + this.tb(e.css("padding-left")) + this.tb(e.css("width")) + this.tb(e.css("margin-right")) + this.tb(e.css("border-right-width")) + this.tb(e.css("padding-right"))
                                }
                                ,
                                t.prototype.tb = function(e) {
                                    var t = e.indexOf("px");
                                    return t && -1 !== t ? parseFloat(e.substr(0, t)) : 0
                                }
                                ,
                                t.prototype.abort = function() {
                                    return this.element.queue([]),
                                        this.panels.stop(!1, !0),
                                        this.element.queue("tabs", this.element.queue("tabs").splice(-2, 2)),
                                    this.xhr && (this.xhr.abort(),
                                        delete this.xhr),
                                        this.sb(),
                                        this
                                }
                                ,
                                t.prototype.select = function(e) {
                                    return "string" == typeof e ? e = this.anchors.index(this.anchors.filter("[href$=" + e + "]")) : null === e && (e = -1),
                                    -1 === e && this.options.collapsible && (e = this.options.selected),
                                        this.anchors.eq(e).trigger(this.options.event + ".tabs"),
                                        this
                                }
                                ,
                                t.prototype.load = function(e) {
                                    var t = this
                                        , i = t.options
                                        , n = t.anchors.eq(e)[0]
                                        , r = o.data(n, "load.tabs")
                                        , a = o("span", n);
                                    return t.abort(),
                                        !1 === t._trigger("beforeShow", null, t.gb(t.anchors[e], t.panels[e])) ? void t.element.dequeue("tabs") : !r || 0 !== t.element.queue("tabs").length && o.data(n, "cache.tabs") ? void t.element.dequeue("tabs") : (t.lis.eq(e).addClass(i.uiCSS.tabsLoading),
                                        (i.spinner || t.cb.spinner) && a.data("label.tabs", a.html()).html(i.spinner || t.cb.spinner),
                                            t.xhr = o.ajax(o.extend({}, i.ajaxOptions, {
                                                url: r,
                                                success: function(r, a) {
                                                    o(t.ab(n.hash), t.element).html(r),
                                                        t.sb(),
                                                    i.cache && o.data(n, "cache.tabs", !0),
                                                        t._trigger("load", null, t.gb(t.anchors[e], t.panels[e]));
                                                    try {
                                                        i.ajaxOptions.success(r, a)
                                                    } catch (e) {}
                                                },
                                                error: function(o, r, a) {
                                                    t.sb(),
                                                        t._trigger("load", null, t.gb(t.anchors[e], t.panels[e]));
                                                    try {
                                                        i.ajaxOptions.error(o, r, e, n)
                                                    } catch (e) {}
                                                }
                                            })),
                                            t.element.dequeue("tabs"),
                                            t)
                                }
                                ,
                                t.prototype.add = function(e, t, i) {
                                    void 0 === i && (i = this.anchors.length);
                                    var n = this, r = n.options, a = o((r.tabTemplate || n.cb.tabTemplate).replace(/#\{href\}/g, e).replace(/#\{label\}/g, t)), s = e.indexOf("#") ? n.bb(o("a", a)[0]) : e.replace("#", ""), l = n.eb(!0), c = n.eb(!1), d = o("#" + s), p;
                                    return a.addClass(r.uiCSS.stateDefault).addClass(r.uiCSS["corner" + l]).data("destroy.tabs", !0).attr("role", "tab").attr("aria-selected", !1),
                                    d.length || (d = o(r.panelTemplate || n.cb.panelTemplate).attr("id", s).data("destroy.tabs", !0).attr("role", "tabpanel")),
                                        d.addClass(r.uiCSS.tabsPanel).addClass(r.uiCSS.content).addClass(r.uiCSS["corner" + c] + " " + r.uiCSS.tabsHide).attr("aria-hidden", !0),
                                        i >= n.lis.length ? (a.appendTo(n.list),
                                            n.panels.length > 0 ? d.insertAfter(n.panels[n.panels.length - 1]) : (p = n.element.find("." + r.uiCSS.tabsContent),
                                            0 === p.length && (p = n.element),
                                                d.appendTo(p))) : (a.insertBefore(n.lis[i]),
                                            d.insertBefore(n.panels[i])),
                                        r.disabledIndexes = o.map(r.disabledIndexes, function(e, t) {
                                            return e >= i ? ++e : e
                                        }),
                                        n.qb(),
                                        n._a(!1),
                                    1 === n.anchors.length && (r.selected = 0,
                                        a.addClass(r.uiCSS.tabsActive).addClass(r.uiCSS.stateActive).attr("aria-selected", !0),
                                        d.removeClass(r.uiCSS.tabsHide).attr("aria-hidden", !1),
                                        n.element.queue("tabs", function() {
                                            n.element.triggerVisibility && o(n.panels[0]).triggerVisibility(),
                                                n._trigger("show", null, n.gb(n.anchors[0], n.panels[0]))
                                        }),
                                        n.load(0)),
                                        n._trigger("add", null, n.gb(n.anchors[i], n.panels[i])),
                                        n
                                }
                                ,
                                t.prototype.remove = function(e) {
                                    var t = this.options
                                        , i = this.lis.eq(e).remove()
                                        , n = this.panels.eq(e).remove();
                                    return i.hasClass(t.uiCSS.tabsActive) && this.anchors.length > 1 && this.select(e + (e + 1 < this.anchors.length ? 1 : -1)),
                                        t.disabledIndexes = o.map(o.grep(t.disabledIndexes, function(t, i) {
                                            return t !== e
                                        }, !1), function(t, i) {
                                            return t >= e ? --t : t
                                        }),
                                        this.qb(),
                                        this._a(!1),
                                        this._trigger("remove", null, this.gb(i.find("a")[0], n[0])),
                                        this
                                }
                                ,
                                t.prototype.enableTab = function(e) {
                                    var t = this.options;
                                    if (-1 !== o.inArray(e, t.disabledIndexes))
                                        return this.lis.eq(e).removeClass(t.uiCSS.stateDisabled).removeAttr("aria-disabled"),
                                            t.disabledIndexes = o.grep(t.disabledIndexes, function(t, i) {
                                                return t !== e
                                            }, !1),
                                            this._trigger("enable", null, this.gb(this.anchors[e], this.panels[e])),
                                            this
                                }
                                ,
                                t.prototype.disableTab = function(e) {
                                    var t = this.options;
                                    return e !== t.selected && (this.lis.eq(e).addClass(t.uiCSS.stateDisabled).attr("aria-disabled", !0),
                                        t.disabledIndexes.push(e),
                                        t.disabledIndexes.sort(),
                                        this._trigger("disable", null, this.gb(this.anchors[e], this.panels[e]))),
                                        this
                                }
                                ,
                                t.prototype.url = function(e, t) {
                                    return this.anchors.eq(e).removeData("cache.tabs").data("load.tabs", t),
                                        this
                                }
                                ,
                                t.prototype.length = function() {
                                    return this.anchors.length
                                }
                                ,
                                t
                        }(e.gcuiWidget);
                        t.gcuitabs = h,
                            h.prototype.cb = {
                                panelTemplate: "<div></div>",
                                spinner: "<em>Loading&#8230;</em>",
                                tabTemplate: '<li><a href="#{href}"><span>#{label}</span></a></li>'
                            },
                            i = function() {
                                function e() {
                                    this.uiCSS = {
                                        gcuitabs: "gcui-gcuitabs",
                                        tabsContent: "gcui-gcuitabs-content",
                                        tabsHide: "gcui-gcuitabs-hide"
                                    },
                                        this.mobileCSS = {
                                            header: "ui-header ui-bar-c",
                                            content: "ui-content ui-body ui-body-c",
                                            stateDefault: "ui-btn-up-a",
                                            stateActive: "ui-btn-down-b"
                                        },
                                        this.alignment = "top",
                                        this.sortable = !1,
                                        this.scrollable = !1,
                                        this.ajaxOptions = null,
                                        this.cache = !1,
                                        this.cookie = null,
                                        this.collapsible = !1,
                                        this.hideOption = null,
                                        this.showOption = null,
                                        this.disabledIndexes = [],
                                        this.event = "click",
                                        this.idPrefix = "ui-tabs-",
                                        this.panelTemplate = "",
                                        this.spinner = "",
                                        this.tabTemplate = "",
                                        this.add = null,
                                        this.remove = null,
                                        this.select = null,
                                        this.beforeShow = null,
                                        this.show = null,
                                        this.load = null,
                                        this.disable = null,
                                        this.enable = null
                                }
                                return e
                            }(),
                            h.prototype.options = o.extend(!0, {}, e.gcuiWidget.prototype.options, new i),
                            o.gcui.registerWidget("gcuitabs", h.prototype)
                    }(e.tabs || (e.tabs = {}));
                    var t = e.tabs
                }(gcui || (gcui = {})),
                $.fn.extend({
                    getBounds: function() {
                        return $.extend({}, $(this).offset(), {
                            width: $(this).outerWidth(!0),
                            height: $(this).outerHeight(!0)
                        })
                    },
                    setBounds: function(e) {
                        return $(this).css({
                            left: e.left,
                            top: e.top
                        }).width(e.width).height(e.height),
                            this
                    },
                    getMaxZIndex: function() {
                        var e = 1 * ("auto" == $(this).css("z-index") ? 0 : $(this).css("z-index"));
                        return $(this).siblings().each(function(t, i) {
                            e = Math.max(e, 1 * ("auto" == $(i).css("z-index") ? 0 : $(i).css("z-index")))
                        }),
                            Math.max(e, $(this).zIndex())
                    }
                }),
                function(e) {
                    !function(t) {
                        var i, o = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments)
                            }
                            return t.prototype._init = function() {
                                if (this.elementZIndex = this.element.zIndex(),
                                        this.options.ensureOutermost) {
                                    var e = $("form");
                                    0 === e.length && (e = $(document.body)),
                                        this.element.appendTo(e)
                                }
                                this.element.data("visible.gcuipopup", !1),
                                    this.element.css("position", "absolute"),
                                    this.element.position({
                                        of: $(document.body)
                                    }),
                                    this.element.hide(),
                                    this.ub = this.vb.bind(this)
                            }
                                ,
                                t.prototype._setOption = function(t, i) {
                                    if (e.prototype._setOption.call(this, t, i),
                                        "autoHide" === t) {
                                        var o = this.isVisible();
                                        this.hide(),
                                        o && this.show()
                                    }
                                }
                                ,
                                t.prototype.destroy = function() {
                                    var t, i, o;
                                    e.prototype.destroy.call(this),
                                    this.isVisible() && this.hide(),
                                        t = GC.Spread.Sheets.util.browser,
                                    t.msie && parseInt(t.version) < 7 && ((i = this.element.data("backframe.gcuipopup")) || i.remove()),
                                        o = this,
                                        this.element.unbind(".gcuipopup"),
                                        $.each(["visible", "backframe", "animating", "width"], function(e, t) {
                                            o.element.removeData(t + ".gcuipopup")
                                        })
                                }
                                ,
                                t.prototype.isVisible = function() {
                                    return !!this.element.data("visible.gcuipopup") && this.element.is(":visible")
                                }
                                ,
                                t.prototype.isAnimating = function() {
                                    return !!this.element.data("animating.gcuipopup")
                                }
                                ,
                                t.prototype.show = function(e) {
                                    var t, i, o;
                                    this.wb(e),
                                    this.isVisible() || !1 !== this._trigger("showing") && (this.options.autoHide && document.addEventListener("mouseup", this.ub, !0),
                                        t = this.options.showEffect || "show",
                                        i = this.options.showDuration || 300,
                                        o = this.options.showOptions || {},
                                        this.element.data("animating.gcuipopup", !0),
                                        $.effects && $.effects.effect[t] ? this.element.show(t, o, i, $.proxy(this.xb, this)) : this.element[t]("show" === t ? null : i, $.proxy(this.xb, this)),
                                    (!t || !i || "show" === t || i <= 0) && this.xb())
                                }
                                ,
                                t.prototype.xb = function() {
                                    this.element.removeData("animating.gcuipopup"),
                                        this.element.data("visible.gcuipopup", !0),
                                        this._trigger("shown")
                                }
                                ,
                                t.prototype.showAt = function(e, t) {
                                    this.show({
                                        my: "left+" + e + " top+" + t,
                                        at: "left top",
                                        of: document.body
                                    })
                                }
                                ,
                                t.prototype.hide = function() {
                                    var e, t, i;
                                    this.isVisible() && !1 !== this._trigger("hiding") && (document.removeEventListener("mouseup", this.ub, !0),
                                        e = this.options.hideEffect || "hide",
                                        t = this.options.hideDuration || 300,
                                        i = this.options.hideOptions || {},
                                        this.element.data("animating.gcuipopup", !0),
                                        $.effects && $.effects.effect[e] ? this.element.hide(e, i, t, $.proxy(this.yb, this)) : this.element[e]("hide" === e ? null : t, $.proxy(this.yb, this)),
                                    (!e || !t || "hide" === e || t <= 0) && this.yb())
                                }
                                ,
                                t.prototype.yb = function() {
                                    var e, t;
                                    void 0 !== this.element.data("width.gcuipopup") && (this.element.width(this.element.data("width.gcuipopup")),
                                        this.element.removeData("width.gcuipopup")),
                                        this.element.unbind("move.gcuipopup"),
                                        this.element.removeData("animating.gcuipopup"),
                                        e = GC.Spread.Sheets.util.browser,
                                    e.msie && parseInt(e.version) < 7 && (t = this.element.data("backframe.gcuipopup")) && t.hide(),
                                        this._trigger("hidden")
                                }
                                ,
                                t.prototype.vb = function(e) {
                                    var t = e.target ? e.target : e.srcElement;
                                    this.isVisible() && this.options.autoHide && t != this.element.get(0) && $(t).parents().index(this.element) < 0 && this.hide()
                                }
                                ,
                                t.prototype.zb = function(e) {
                                    var t = this.element.data("backframe.gcuipopup");
                                    t && (this.element.before(t),
                                        t.css({
                                            top: this.element.css("top"),
                                            left: this.element.css("left")
                                        }))
                                }
                                ,
                                t.prototype.Ab = function() {
                                    var e, t = GC.Spread.Sheets.util.browser;
                                    t.msie && parseInt(t.version) < 7 && (e = this.element.data("backframe.gcuipopup"),
                                    e || (e = jQuery("<iframe/>").css({
                                        position: "absolute",
                                        display: "none",
                                        filter: "progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)"
                                    }).attr({
                                        src: "javascript:'<html></html>';",
                                        scrolling: "no",
                                        frameborder: "0",
                                        "tabIndex ": -1
                                    }),
                                        this.element.before(e),
                                        this.element.data("backframe.gcuipopup", e),
                                        this.element.bind("move.gcuipopup", $.proxy(this.zb, this))),
                                        e.setBounds(this.element.getBounds()),
                                        e.css({
                                            display: "block",
                                            left: this.element.css("left"),
                                            top: this.element.css("top"),
                                            "z-index": this.element.css("z-index") - 1
                                        }))
                                }
                                ,
                                t.prototype.Bb = function(e) {
                                    this.element.css("z-index", e);
                                    var t = this.element.data("backframe.gcuipopup");
                                    t && t.css("z-index", this.element.css("z-index") - 1)
                                }
                                ,
                                t.prototype.wb = function(e) {
                                    var t, i, o = this.element.is(":visible");
                                    this.element.show(),
                                        this.element.position($.extend({}, this.options.position, e || {})),
                                    o || this.element.hide(),
                                    e && (t = e.of),
                                    t || (t = this.options.position.of),
                                        this.Ab(),
                                        i = Math.max(1e3, this.elementZIndex),
                                    t && (i = Math.max(i, $(t).getMaxZIndex())),
                                        this.Bb(i + 10),
                                        this._trigger("posChanged")
                                }
                                ,
                                t
                        }(e.GCUIWidget);
                        t.gcuipopup = o,
                            i = function() {
                                function e() {
                                    this.ensureOutermost = !1,
                                        this.showEffect = "show",
                                        this.showOptions = {},
                                        this.showDuration = 300,
                                        this.hideEffect = "hide",
                                        this.hideOptions = {},
                                        this.hideDuration = 100,
                                        this.autoHide = !1,
                                        this.position = {
                                            at: "left bottom",
                                            my: "left top"
                                        },
                                        this.showing = null,
                                        this.shown = null,
                                        this.hiding = null,
                                        this.hidden = null,
                                        this.posChanged = null
                                }
                                return e
                            }(),
                            o.prototype.options = $.extend(!0, {}, e.gcuiWidget.prototype.options, new i),
                            $.gcui.registerWidget("gcuipopup", o.prototype)
                    }(e.popup || (e.popup = {}));
                    var t = e.popup
                }(gcui || (gcui = {})),
                jQuery.extend(jQuery.support, {
                    isTouchEnabled: function() {
                        return "ontouchstart"in window || "ontouchend"in document || void 0 !== window.navigator.msMaxTouchPoints && window.navigator.msMaxTouchPoints > 0
                    }
                });
            function applyTouchUtilEvents(e) {
                return e
            }
            !function(e) {
                !function(e) {
                    "use strict";
                    var t, i, o, n, r, a, s, l, c, d = jQuery, p = "virtualMouseBindings", u = "virtualTouchID", h = "gcuimouseover gcuimousedown gcuimousemove gcuimouseup gcuiclick gcuitap gcuidoubletap gcuitaphold gcuimouseout gcuimousecancel".split(" "), f = window.navigator.msPointerEnabled, g = {
                        gcuimouseover: f ? "MSPointerOver" : "mouseover",
                        gcuimousedown: f ? "MSPointerDown" : "mousedown",
                        gcuijmousemove: f ? "MSPointerMove" : "mousemove",
                        gcuimouseup: f ? "MSPointerUp" : "mouseup",
                        gcuimouseout: f ? "MSPointerOut" : "mouseout",
                        gcuimousecancel: "mousecancel",
                        gcuiclick: f ? "MSGestureTap" : "click",
                        gcuidoubletap: f ? "MSGestureDoubleTap" : "dblclick",
                        gcuitaphold: f ? "MSGestureHold" : "gesturehold"
                    }, m = "clientX clientY pageX pageY screenX screenY".split(" "), b = "clientX clientY pageX pageY screenX screenY".split(" "), v = d.event.mouseHooks ? d.event.mouseHooks.props : [], y = d.event.props.concat(v), x = {}, w = 0, C = 0, S = 0, k = !1, T = [], A = !1, I = !1, D = "addEventListener"in document, $ = d(document), F = 1, L = 0, R = f ? "MSPointerDown" : "touchstart", B = f ? "MSPointerUp" : "touchend", N = f ? "MSPointerMove" : "touchmove", E = "scroll";
                    d.gcuimouse = {
                        moveDistanceThreshold: 10,
                        clickDistanceThreshold: 10,
                        resetTimerDuration: 1500
                    };
                    function V(e) {
                        for (; e && void 0 !== e.originalEvent; )
                            e = e.originalEvent;
                        return e
                    }
                    function P(e, t) {
                        var i = e.type, o, n, r, a, s, l, c, p, u;
                        if (e = d.Event(e),
                                e.nativeType = e.type,
                                e.type = t,
                                o = e.originalEvent,
                                n = d.event.props,
                            i.search(/^(mouse|click)/) > -1 && (n = y),
                                o)
                            for (c = n.length,
                                     a; c; )
                                a = n[--c],
                                    e[a] = o[a];
                        for (i.search(/mouse(down|up)|click/) > -1 && !e.which && (e.which = 1),
                                 r = V(o),
                                 p = 0,
                                 u = b.length; p < u; p++)
                            a = b[p],
                            void 0 === e[a] && (e[a] = r[a]);
                        if (-1 !== i.search(/^touch/) && (i = r.touches,
                                s = r.changedTouches,
                                l = i && i.length ? i[0] : s && s.length ? s[0] : void 0))
                            for (p = 0,
                                     u = m.length; p < u; p++)
                                a = m[p],
                                    e[a] = l[a];
                        return e
                    }
                    function z(e) {
                        for (var t = {}, i, o; e; ) {
                            i = d.data(e, p);
                            for (o in i)
                                i[o] && (t[o] = t.hasVirtualBinding = !0);
                            e = e.parentNode
                        }
                        return t
                    }
                    function j(e, t) {
                        for (var i; e; ) {
                            if ((i = d.data(e, p)) && (!t || i[t]))
                                return e;
                            e = e.parentNode
                        }
                        return null
                    }
                    function M() {
                        I = !1
                    }
                    function O() {
                        I = !0
                    }
                    function G() {
                        L = 0,
                            T.length = 0,
                            A = !1,
                            O()
                    }
                    function H() {
                        M()
                    }
                    function U() {
                        W(),
                            w = setTimeout(function() {
                                w = 0,
                                    G()
                            }, d.gcuimouse.resetTimerDuration)
                    }
                    function W() {
                        w && (clearTimeout(w),
                            w = 0)
                    }
                    function _(e, t, i) {
                        var o;
                        return (i && i[e] || !i && j(t.target, e)) && (o = P(t, e),
                            d(t.target).trigger(o)),
                            o
                    }
                    function q(e) {
                        var t, i, o, n = d.data(e.target, u);
                        if (!(A || L && L === n)) {
                            t = "gcui" + e.type;
                            for (i in g)
                                g[i] === e.type && (t = i);
                            o = _(t, e),
                            o && (o.isDefaultPrevented() && e.preventDefault(),
                            o.isPropagationStopped() && e.stopPropagation(),
                            o.isImmediatePropagationStopped() && e.stopImmediatePropagation())
                        }
                    }
                    function K(e) {
                        var t, i, o, n, r = V(e).touches;
                        (r && 1 === r.length || f) && (t = e.target,
                            i = z(t),
                        i.hasVirtualBinding && (L = F++,
                            d.data(t, u, L),
                            W(),
                            H(),
                            k = !1,
                            o = V(e),
                            n = o.touches ? o.touches[0] : o,
                            C = n.pageX,
                            S = n.pageY,
                            _("gcuimouseover", e, i),
                            _("gcuimousedown", e, i)))
                    }
                    function Y(e) {
                        I || (k || _("gcuimousecancel", e, z(e.target)),
                            k = !0,
                            U())
                    }
                    function X(e) {
                        var t, i, o, n, r;
                        I || (t = V(e),
                            i = t.touches ? t.touches[0] : t,
                            o = k,
                            n = d.gcuimouse.moveDistanceThreshold,
                            k = k || Math.abs(i.pageX - C) > n || Math.abs(i.pageY - S) > n,
                            r = z(e.target),
                        k && !o && _("gcuimousecancel", e, r),
                            _("gcuimousemove", e, r),
                            U())
                    }
                    function J(e) {
                        var t, i, o, n;
                        I || (O(),
                            t = z(e.target),
                            _("gcuimouseup", e, t),
                        k || (n = _("gcuiclick", e, t)) && n.isDefaultPrevented() && (i = V(e),
                            o = i.changedTouches ? i.changedTouches[0] : i,
                            T.push({
                                touchID: L,
                                x: o.clientX,
                                y: o.clientY
                            }),
                            A = !0),
                            _("gcuimouseout", e, t),
                            k = !1,
                            U())
                    }
                    function Q(e) {
                        var t = d.data(e, p), i;
                        if (t)
                            for (i in t)
                                if (t[i])
                                    return !0;
                        return !1
                    }
                    function Z() {}
                    function ee(e) {
                        var t = g[e];
                        return {
                            setup: function(i, o) {
                                var n, r;
                                Q(this) || d.data(this, p, {}),
                                    n = d.data(this, p),
                                    n[e] = !0,
                                    d(this).bind(t, Z),
                                    r = !1,
                                D && (x[R] = (x[R] || 0) + 1,
                                1 === x[R] && (r = !0,
                                    $.bind(R, K).bind(B, J).bind(N, X).bind(E, Y))),
                                r && R === t || (x[e] = (x[e] || 0) + 1,
                                1 === x[e] && $.bind(t, q))
                            },
                            teardown: function(i, o) {
                                --x[e],
                                x[e] || $.unbind(t, q),
                                D && (--x[R] || $.unbind(R, K).unbind(N, X).unbind(B, J).unbind(E, Y));
                                var n = d(this)
                                    , r = d.data(this, p);
                                r && (r[e] = !1),
                                    n.unbind(t, Z),
                                Q(this) || n.removeData(p)
                            }
                        }
                    }
                    for (t = 0; t < h.length; t++)
                        d.event.special[h[t]] = ee(h[t]);
                    D && document.addEventListener("click", function(e) {
                        var t, i, o, n, r, a, s, l = T.length, c = e.target;
                        if (l)
                            for (t = e.clientX,
                                     i = e.clientY,
                                     s = d.gcuimouse.clickDistanceThreshold,
                                     o = c; o; ) {
                                for (n = 0; n < l; n++)
                                    if (r = T[n],
                                            a = 0,
                                        o === c && Math.abs(r.x - t) < s && Math.abs(r.y - i) < s || d.data(o, u) === r.touchID)
                                        return e.preventDefault(),
                                            void e.stopPropagation();
                                o = o.parentNode
                            }
                    }, !0),
                        d.each("touchstart touchmove touchend orientationchange throttledresize gcuitap gcuitaphold gcuiswipe gcuiswipeleft gcuiswiperight gcuiscrollstart gcuiscrollstop".split(" "), function(e, t) {
                            d.fn[t] = function(e) {
                                return e ? this.bind(t, e) : this.trigger(t)
                            }
                                ,
                            d.attrFn && (d.attrFn[t] = !0)
                        }),
                        i = "ontouchend"in document,
                        o = i ? "touchstart" : "mousedown",
                        n = i ? "touchend" : "mouseup",
                        r = i ? "touchmove" : "mousemove",
                        a = "gesturestart",
                        s = "gesturechange",
                        l = "gestureend",
                    window.navigator.msPointerEnabled && (o = "MSPointerDown",
                        n = "MSPointerUp",
                        r = "MSPointerMove",
                        a = "MSGestureStart",
                        s = "MSGestureChange",
                        l = "MSGestureEnd");
                    function te(e, t, i) {
                        var o = i.type;
                        i.nativeType = i.type,
                            i.type = t;
                        try {
                            d([e]).trigger(i)
                        } finally {
                            i.type = o
                        }
                    }
                    d.event.special.gcuiscrollstart = {
                        enabled: !0,
                        setup: function() {
                            var e = this, t = d(e), i, o;
                            function n(t, o) {
                                i = o,
                                    te(e, i ? "gcuiscrollstart" : "gciscrollstop", t)
                            }
                            t.bind("touchmove scroll", function(e) {
                                d.event.special.gcuiscrollstart.enabled && (i || n(e, !0),
                                    clearTimeout(o),
                                    o = setTimeout(function() {
                                        n(e, !1)
                                    }, 50))
                            })
                        }
                    },
                        d.event.special.gcuitap = {
                            setup: function() {
                                var e = this
                                    , t = d(e);
                                t.bind("gcuimousedown", function(i) {
                                    if (i.which && 1 !== i.which)
                                        return !1;
                                    var o = i.target, n = i.originalEvent, r;
                                    function a() {
                                        clearTimeout(r)
                                    }
                                    function s() {
                                        a(),
                                            t.unbind("gcuiclick", l).unbind("gcuimouseup", a),
                                            d(document).unbind("gcuimousecancel", s)
                                    }
                                    function l(t) {
                                        s(),
                                        o == t.target && te(e, "gcuitap", t)
                                    }
                                    t.bind("gcuimouseup", a).bind("gcuiclick", l),
                                        d(document).bind("gcuimousecancel", s),
                                        r = setTimeout(function() {
                                            te(e, "gcuitaphold", d.Event("gcuitaphold", {
                                                target: o
                                            }))
                                        }, 750)
                                })
                            }
                        },
                        d.event.special.gcuiswipe = {
                            scrollSupressionThreshold: 10,
                            durationThreshold: 1e3,
                            horizontalDistanceThreshold: 30,
                            verticalDistanceThreshold: 75,
                            setup: function() {
                                var e = this
                                    , t = d(e);
                                t.bind(o, function(e) {
                                    var i = e.originalEvent.touches ? e.originalEvent.touches[0] : e, o = {
                                        time: (new Date).getTime(),
                                        coords: [i.pageX, i.pageY],
                                        origin: d(e.target)
                                    }, a;
                                    function s(e) {
                                        if (o) {
                                            var t = e.originalEvent.touches ? e.originalEvent.touches[0] : e;
                                            a = {
                                                time: (new Date).getTime(),
                                                coords: [t.pageX, t.pageY]
                                            },
                                            Math.abs(o.coords[0] - a.coords[0]) > d.event.special.gcuiswipe.scrollSupressionThreshold && e.preventDefault()
                                        }
                                    }
                                    t.bind(r, s).one(n, function(e) {
                                        t.unbind(r, s),
                                        o && a && a.time - o.time < d.event.special.gcuiswipe.durationThreshold && Math.abs(o.coords[0] - a.coords[0]) > d.event.special.gcuiswipe.horizontalDistanceThreshold && Math.abs(o.coords[1] - a.coords[1]) < d.event.special.gcuiswipe.verticalDistanceThreshold && o.origin.trigger("gcuiswipe").trigger(o.coords[0] > a.coords[0] ? "gcuiswipeleft" : "gcuiswiperight"),
                                            o = a = void 0
                                    })
                                })
                            }
                        },
                        c = "altKey ctrlKey metaKey rotation scale shiftKey target velocityX velocityY translationX translationY".split(" ");
                    function ie(e, t) {
                        if (window.navigator.msPointerEnabled && !e.Cb) {
                            e.Cb = !0;
                            var i = new MSGesture;
                            i.target = e,
                                e.addEventListener("MSPointerDown", function(e) {
                                    i.addPointer(e.pointerId)
                                }, !1)
                        }
                    }
                    function oe(e, t) {
                        var i = ne(t, e);
                        return d(t.target).trigger(i),
                            i
                    }
                    function ne(e, t) {
                        var i = e.type, o, n, r, a, s, l, p, u, h;
                        if (o = e.originalEvent,
                                e = d.Event(e),
                                e.nativeType = e.type,
                                e.type = t,
                                n = d.event.props,
                                o)
                            for (p = n.length,
                                     a; p; )
                                a = n[--p],
                                    e[a] = e[a] || o[a];
                        for (u = 0,
                                 h = c.length; u < h; u++)
                            a = c[u],
                                e[a] = e[a] || o[a];
                        return window.navigator.msPointerEnabled && e.rotation && (e.rotation = 360 * e.rotation / Math.PI),
                            e
                    }
                    d.event.special.gcuigesturestart = {
                        setup: function() {
                            var e = this
                                , t = d(e);
                            ie(e, "gcuigesturestart"),
                                t.bind(a, function(e) {
                                    oe("gcuigesturestart", e)
                                })
                        }
                    },
                        d.event.special.gcuigesturechange = {
                            setup: function() {
                                var e = this
                                    , t = d(e);
                                ie(e, "gcuigesturechange"),
                                    t.bind(s, function(e) {
                                        oe("gcuigesturechange", e)
                                    })
                            }
                        },
                        d.event.special.gcuigestureend = {
                            setup: function() {
                                var e = this
                                    , t = d(e);
                                ie(e, "gcuigestureend"),
                                    t.bind(l, function(e) {
                                        oe("gcuigestureend", e)
                                    })
                            }
                        },
                        function(e, t) {
                            var i, o, n, r, a, s, l, c, d = e(t), p = {
                                0: !0,
                                180: !0
                            };
                            "orientation"in t && "onorientationchange"in t && (s = t.innerWidth || e(t).width(),
                                l = t.innerHeight || e(t).height(),
                                c = 50,
                                r = s > l && s - l > c,
                                a = p[t.orientation],
                            (r && a || !r && !a) && (p = {
                                "-90": !0,
                                90: !0
                            })),
                                e.event.special.orientationchange = i = {
                                    setup: function() {
                                        if ("orientation"in t && "onorientationchange"in t && e.mobile.orientationChangeEnabled)
                                            return !1;
                                        n = o(),
                                            d.bind("throttledresize", u)
                                    },
                                    teardown: function() {
                                        if ("orientation"in t && "onorientationchange"in t && e.mobile.orientationChangeEnabled)
                                            return !1;
                                        d.unbind("throttledresize", u)
                                    },
                                    add: function(e) {
                                        var t = e.handler;
                                        e.handler = function(e) {
                                            return e.orientation = o(),
                                                t.apply(this, arguments)
                                        }
                                    }
                                };
                            function u() {
                                var e = o();
                                e !== n && (n = e,
                                    d.trigger("orientationchange"))
                            }
                            e.event.special.orientationchange.orientation = o = function() {
                                var e = !0
                                    , i = document.documentElement;
                                return e = "orientation"in t && "onorientationchange"in t ? p[t.orientation] : i && i.clientWidth / i.clientHeight < 1.1,
                                    e ? "portrait" : "landscape"
                            }
                        }(jQuery, window),
                        function() {
                            d.event.special.throttledresize = {
                                setup: function() {
                                    d(this).bind("resize", t)
                                },
                                teardown: function() {
                                    d(this).unbind("resize", t)
                                }
                            };
                            var e = 250, t = function() {
                                n = (new Date).getTime(),
                                    r = n - i,
                                    r >= e ? (i = n,
                                        d(this).trigger("throttledresize")) : (o && clearTimeout(o),
                                        o = setTimeout(t, e - r))
                            }, i = 0, o, n, r
                        }(),
                        d.each({
                            gcuiscrollstop: "gcuiscrollstart",
                            gcuitaphold: "gcuitap",
                            gcuiswipeleft: "gcuiswipe",
                            gcuiswiperight: "gcuiswipe"
                        }, function(e, t) {
                            d.event.special[e] = {
                                setup: function() {
                                    d(this).bind(t, d.noop)
                                }
                            }
                        })
                }(e.touch || (e.touch = {}))
            }(gcui || (gcui = {})),
                $(document).ready(function() {
                    var e, t, i = window.navigator.userAgent, o = i.match(RegExp("android ((1\\.)|(2\\.([^345]+)))", "i")), n = !!window.WebKitCSSMatrix && !o, r = !("string" != typeof i || !i.match(/applewebkit/)), a = "ontouchend"in document, s = document.createElement("div");
                    s.setAttribute("style", "transition:top 1s ease;-webkit-transition:top 1s ease;-moz-transition:top 1s ease;-o-transition:top 1s ease;"),
                        document.body.appendChild(s),
                        e = !!(s.style.transition || s.style.webkitTransition || s.style.MozTransition || s.style.OTransitionDuration),
                        s.parentNode.removeChild(s),
                        s = null;
                    function l(e, t, i) {
                        var o = "-webkit-transform"
                            , n = "translate3d(0,0,0)"
                            , r = e.css(o)
                            , a = !(r && r.match(/^\s*none\s*$/i));
                        e.css(o, a ? n : r + " " + n);
                        try {
                            return t.apply(this, i)
                        } finally {
                            e.css(o, r)
                        }
                    }
                    t = jQuery.fn.animate,
                        jQuery.fn.animate = function(e, i, o, n) {
                            if (!r || !c.apply(this, arguments))
                                return l.call(this, this, function() {
                                    return t.apply(this, arguments)
                                }, arguments)
                        }
                    ;
                    function c(e, t, i, o) {
                        var n, r, a, s = !1, l = $.speed(t, i, o), c = this;
                        if (!e)
                            return !1;
                        for (a in e)
                            n = e[a],
                                "height" === a ? "hide" === n ? (this.css("display", "none"),
                                    s = !0,
                                    l.complete()) : "show" === n && (this.css("display", ""),
                                    s = !0,
                                    l.complete()) : "width" === a ? "hide" === n ? (this.css("display", "none"),
                                    s = !0,
                                    l.complete()) : "show" === n && (this.css("display", ""),
                                    s = !0,
                                    l.complete()) : "left" === a && (r = 1 * this.css("left").replace("px", ""),
                                "string" == typeof n && (0 === n.indexOf("-=") ? r -= 1 * n.replace("-=", "") : 0 === n.indexOf("+=") && (r += 1 * n.replace("+=", ""))),
                                    s = !0,
                                    this.css("-webkit-perspective", 1e3),
                                    this.css("-webkit-backface-visibility", "hidden"),
                                    u(this[0], r, l.duration, "linear", l.complete));
                        return s
                    }
                    function d(t, i, o, n) {
                        e && (o || (o = "ease"),
                            y(t, "opacity", i, o),
                            h(t, 0),
                            t.addEventListener("webkitTransitionEnd", $.proxy(function() {
                                x(t),
                                    t.style.display = "none",
                                    h(t, 1),
                                n && n()
                            }, this), !1))
                    }
                    function p(t, i, o, n) {
                        e && (o || (o = "ease"),
                            y(t, "opacity", i, o),
                            h(t, 1),
                            t.addEventListener("webkitTransitionEnd", $.proxy(function() {
                                x(t),
                                "none" === t.style.display && (t.style.display = ""),
                                n && n()
                            }, this), !1))
                    }
                    function u(t, i, o, n, r) {
                        e && (v(t, o, n),
                            f(t, i),
                            t.Db = r,
                            t.Eb = $.proxy(w, {}),
                            t.addEventListener("webkitTransitionEnd", t.Eb, !1))
                    }
                    function h(t, i) {
                        var o;
                        e && (o = t.style || t,
                            o.opacity = i)
                    }
                    function f(t, i) {
                        var o;
                        e ? (t.Fb = i,
                            o = t.style || t,
                            o.webkitTransform = "translateX(" + i + "px)") : t.style.left = i + "px"
                    }
                    function g(t, i) {
                        var o;
                        e ? (t.Gb = i,
                            o = t.style || t,
                            o.webkitTransform = "translateY(" + i + "px)") : t.style.top = i + "px"
                    }
                    function m(t) {
                        var i, o, n, r, a;
                        if (!t)
                            return 0;
                        if (e) {
                            if (i = t.style || t,
                                "string" == typeof (o = i.webkitTransform) && (n = RegExp("translate(3d|X|)\\(-*(\\d+)"),
                                (r = n.exec(o)) && (a = parseFloat(r[1]),
                                    isFinite(a))))
                                return a
                        } else if (a = parseInt($(t).css("left")),
                                isFinite(a))
                            return a;
                        return 0
                    }
                    function b(t) {
                        var i, o, n, r, a;
                        if (!t)
                            return 0;
                        if (e) {
                            if (i = t.style || t,
                                "string" == typeof (o = i.webkitTransform) && (n = RegExp("translate(3d|X|)\\(.*,\\s*-*(\\d+)"),
                                (r = n.exec(o)) && (a = parseFloat(r[1]),
                                    isFinite(a))))
                                return a
                        } else if (a = parseInt(jQuery(t).css("top")),
                                isFinite(a))
                            return a;
                        return 0
                    }
                    function v(e, t, i) {
                        i || (i = "ease"),
                            y(e, "-webkit-transform", t, i)
                    }
                    function y(t, i, o, n) {
                        if (e) {
                            var r = t.style;
                            r.webkitTransitionProperty = i,
                                r.webkitTransitionDuration = o + "ms",
                                r.webkitTransitionTimingFunction = n
                        }
                    }
                    function x(t) {
                        var i, o;
                        e && (i = t.style,
                            i.webkitTransitionProperty = "none",
                        (o = t.Eb) && (delete t.Eb,
                            t.removeEventListener("webkitTransitionEnd", o, !1)))
                    }
                    function w(e) {
                        try {
                            var t, i;
                            switch (e.type) {
                                case "webkitTransitionEnd":
                                    t = e.target,
                                    t && (x(t),
                                    t.Db && (i = t.Db,
                                        t.Db = null,
                                        i(e)))
                            }
                        } catch (t) {
                            window.console && window.console.log && window.console.log("[ew219290] error: " + (t.message ? t.message : t) + ", event: " + e)
                        }
                        return !0
                    }
                }),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o, n, r, a, s, l, c, d, p, u = jQuery, h = function() {
                            function e() {
                                this.mobileCSS = {
                                    header: "ui-header ui-bar-a",
                                    content: "ui-body-c",
                                    stateDefault: "ui-btn-up-c",
                                    stateHover: "ui-btn-down-c",
                                    stateActive: "ui-btn-down-c"
                                },
                                    this.initSelector = ":jqmData(role='superpanel')",
                                    this.allowResize = !1,
                                    this.autoRefresh = !1,
                                    this.animationOptions = {
                                        queue: !1,
                                        disabled: !1,
                                        duration: 250,
                                        easing: void 0
                                    },
                                    this.hScrollerActivating = null,
                                    this.hScroller = {
                                        scrollBarPosition: "bottom",
                                        scrollBarVisibility: "auto",
                                        scrollMode: "scrollBar",
                                        scrollValue: null,
                                        scrollMax: 100,
                                        scrollMin: 0,
                                        scrollLargeChange: null,
                                        scrollSmallChange: null,
                                        scrollMinDragLength: 6,
                                        increaseButtonPosition: null,
                                        decreaseButtonPosition: null,
                                        hoverEdgeSpan: 20,
                                        firstStepChangeFix: 0
                                    },
                                    this.keyboardSupport = !1,
                                    this.keyDownInterval = 100,
                                    this.mouseWheelSupport = !0,
                                    this.bubbleScrollingEvent = !0,
                                    this.resizableOptions = {
                                        handles: "all",
                                        helper: "ui-widget-content gcui-superpanel-helper"
                                    },
                                    this.resized = null,
                                    this.dragStop = null,
                                    this.painted = null,
                                    this.scrolling = null,
                                    this.scroll = null,
                                    this.scrolled = null,
                                    this.showRounder = !0,
                                    this.vScrollerActivating = null,
                                    this.vScroller = {
                                        scrollBarPosition: "right",
                                        scrollBarVisibility: "auto",
                                        scrollMode: "scrollBar",
                                        scrollValue: null,
                                        scrollMax: 100,
                                        scrollMin: 0,
                                        scrollLargeChange: null,
                                        scrollSmallChange: null,
                                        scrollMinDragLength: 6,
                                        increaseButtonPosition: null,
                                        decreaseButtonPosition: null,
                                        hoverEdgeSpan: 20,
                                        firstStepChangeFix: 0
                                    },
                                    this.customScrolling = !1,
                                    this.listenContentScroll = !1
                            }
                            return e
                        }();
                        t = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments)
                            }
                            return t
                        }(e.gcuiWidget),
                            t.superpanel = t,
                            u.support.isTouchEnabled && u.support.isTouchEnabled() ? (o = "gcui-superpanel-handle",
                                s = "<div class='gcui-superpanel-statecontainer'><div class='gcui-superpanel-contentwrapper-touch'></div></div>",
                                t.prototype = u.extend(!0, {}, u.Widget.prototype, {
                                    widgetEventPrefix: "gcuisuperpanel",
                                    _setOption: function(e, t) {
                                        var i = this
                                            , o = i.options
                                            , n = i.Hb();
                                        switch ("animationOptions" === e || "resizableOptions" === e ? t = u.extend(o[e], t) : "hScroller" !== e && "vScroller" !== e || (t = u.extend(o[e], t),
                                            i.refresh()),
                                            u.Widget.prototype._setOption.apply(i, arguments),
                                            e) {
                                            case "allowResize":
                                                i.Kb();
                                                break;
                                            case "disabled":
                                                i.ad(t, i.element);
                                                break;
                                            case "mouseWheelSupport":
                                            case "keyboardSupport":
                                                i.Lb(i, n, i.element, o)
                                        }
                                    },
                                    _create: function() {
                                        var e = this
                                            , t = e.options;
                                        t.vScroller.dir = "v",
                                            t.hScroller.dir = "h",
                                            e.bd(),
                                        e.options.disabled && e.disable(),
                                        e.element.is(":hidden") && e.element.addVisibilityObserver && e.element.addVisibilityObserver(function() {
                                            e.refresh(),
                                            e.element.removeVisibilityObserver && e.element.removeVisibilityObserver()
                                        }, "gcuisuperpanel")
                                    },
                                    ad: function(e, t) {
                                        var i = this;
                                        e ? (i.disabledDiv || (i.disabledDiv = i.dd(t)),
                                            i.disabledDiv.appendTo("body")) : i.disabledDiv && (i.disabledDiv.remove(),
                                            i.disabledDiv = null)
                                    },
                                    dd: function(e) {
                                        var t = this
                                            , i = e || t.element
                                            , o = i.offset()
                                            , n = i.outerWidth()
                                            , r = i.outerHeight();
                                        return u("<div></div>").addClass("ui-disabled").css({
                                            "z-index": "99999",
                                            position: "absolute",
                                            width: n,
                                            height: r,
                                            left: o.left,
                                            top: o.top
                                        })
                                    },
                                    bd: function() {
                                        var e = this
                                            , t = e.element;
                                        e.paintPanel(),
                                            e.Kb(),
                                            e.Lb()
                                    },
                                    ed: function(e) {
                                        var t = {}
                                            , i = this.options
                                            , o = i.hScroller.scrollBarVisibility
                                            , n = i.vScroller.scrollBarVisibility;
                                        t["overflow-x"] = o,
                                            t["overflow-y"] = n,
                                        u.support.isTouchEnabled && u.support.isTouchEnabled() && "visible" === o && "visible" === n && (t["overflow-x"] = "auto",
                                            t["overflow-y"] = "auto"),
                                            e.css(t)
                                    },
                                    Oc: function(e, t, i) {
                                        i.attr("tabindex") || (i.attr("tabindex", "-1"),
                                            t.tabindex = !0);
                                        var o = t.stateContainer = u(s), n;
                                        e.ed(t.stateContainer),
                                            t.contentWrapper = o.children(),
                                            i.contents().each(function(e, i) {
                                                var o = u(i);
                                                return o.hasClass("gcui-superpanel-header") ? void (t.header = o) : o.hasClass("gcui-superpanel-footer") ? void (t.footer = o) : void t.contentWrapper[0].appendChild(i)
                                            }),
                                        void 0 !== t.header && i.prepend(t.header),
                                            i[0].appendChild(o[0]),
                                        void 0 !== t.footer && t.footer.insertAfter(o),
                                            e.fd(),
                                            t.contentWrapper.css("float", "left"),
                                            t.contentWidth = t.contentWrapper.width(),
                                            t.contentHeight = t.contentWrapper.height(),
                                            t.contentWrapper.css("float", "")
                                    },
                                    Lb: function() {
                                        var e = this
                                            , t = e.element
                                            , i = e.options
                                            , o = e.widgetName
                                            , n = t.find(".gcui-superpanel-statecontainer")
                                            , r = n.scrollTop();
                                        n.bind("scroll", function(t, i) {
                                            var o = u(this).scrollTop();
                                            o === r ? (e.Sc(u(this).scrollLeft(), "h"),
                                                e.ic(u(this).scrollLeft(), "h")) : (e.Sc(o, "v"),
                                                e.ic(o, "v"),
                                                r = o)
                                        }),
                                            i.keyboardSupport ? void 0 === e.Zb && (e.Zb = !0,
                                                t.bind("keydown." + o, e, e.$b)) : (t.unbind("keydown." + o, e.$b),
                                                e.Zb = void 0),
                                        i.mouseWheelSupport || t.bind("mousewheel", function(e) {
                                            return e.stopPropagation(),
                                                !1
                                        })
                                    },
                                    bc: function(e, t, i, o) {
                                        var n = i.options;
                                        t.length > 0 && (e.internalFuncID = window.setInterval(function() {
                                            i.cc(t, i, o)
                                        }, n.keyDownInterval))
                                    },
                                    Sc: function(e, t) {
                                        var i = {
                                            position: e,
                                            dir: t
                                        };
                                        this._trigger("scroll", null, i)
                                    },
                                    $b: function(t) {
                                        var i = t.data, o = i.options, n, r, a = e.getKeyCodeEnum();
                                        o.keyboardSupport && !o.disabled && (n = t.shiftKey,
                                            r = t.keyCode,
                                            r === a.LEFT ? i.cc("left", i, n) : r === a.RIGHT ? i.cc("right", i, n) : r === a.UP ? i.cc("top", i, n) : r === a.DOWN && i.cc("bottom", i, n),
                                            t.stopPropagation(),
                                            t.preventDefault())
                                    },
                                    cc: function(e, t, i) {
                                        var o, n, r, a = t.Hb(), s = a.stateContainer[0], l = {}, c;
                                        "top" === e || "bottom" === e ? (n = "v",
                                            r = "scrollTop") : "left" !== e && "right" !== e || (n = "h",
                                            r = "scrollLeft"),
                                            o = i ? t.Fc(n) : t.gd(n),
                                            c = s[r],
                                            l[r] = "top" === e || "left" === e ? c - o : c + o,
                                            t.hd(l)
                                    },
                                    Fc: function(e) {
                                        var t = this, i = t.Hb(), o, n = "h" == e ? i.clientWidth : i.clientHeight;
                                        return o = n || i.stateContainer["h" == e ? "width" : "height"]()
                                    },
                                    gd: function() {
                                        return this.Fc() / 2
                                    },
                                    Jc: function(e, t) {
                                        var i, o, n, r, a, s = this.options.uiCSS.cornerAll;
                                        if (this.options.showRounder) {
                                            if (t.addClass(s),
                                                    e._c)
                                                return;
                                            if (i = GC.Spread.Sheets.util.browser,
                                                    i.msie)
                                                return;
                                            o = "",
                                                n = "",
                                                i.webkit ? (n = "WebkitBorderTopLeftRadius",
                                                    o = "WebkitBorderRadius") : i.mozilla ? (n = "MozBorderRadiusBottomleft",
                                                    o = "MozBorderRadius") : (n = "border-top-left-radius",
                                                    o = "border-radius"),
                                                r = t.css(n),
                                                a = parseInt(r, 10),
                                                t.css(o, a + 1),
                                                e._c = !0,
                                                e.Rb = o
                                        } else
                                            t.removeClass(s)
                                    },
                                    Kb: function() {
                                        var e = this, t = e.options, i = e.Hb(), o = i.resizer, n, r;
                                        u.fn.resizable && (!o && t.allowResize && (n = t.resizableOptions,
                                            r = n.stop,
                                            n.stop = function(t) {
                                                e.fd(),
                                                    e._trigger("resized"),
                                                u.isFunction(r) && r(t)
                                            }
                                            ,
                                            i.resizer = o = e.element.resizable(n)),
                                        !t.allowResize && i.resizer && (o.resizable("destroy"),
                                            i.resizer = null))
                                    },
                                    fd: function() {
                                        var e = this
                                            , t = e.options
                                            , i = e.element
                                            , o = e.Hb()
                                            , n = i.width()
                                            , r = i.height();
                                        void 0 !== o.header && (r -= o.header.outerHeight()),
                                        void 0 !== o.footer && (r -= o.footer.outerHeight()),
                                        o.stateContainer.length && (o.stateContainer.css({
                                            width: n,
                                            height: r
                                        }),
                                            o.clientWidth = o.stateContainer[0].clientWidth,
                                            o.clientHeight = o.stateContainer[0].clientHeight)
                                    },
                                    Hb: function() {
                                        var e = this
                                            , t = e.element
                                            , i = e.widgetName + "-fields"
                                            , o = e.Sb;
                                        return void 0 === o && (o = {},
                                            t.data(i, o),
                                            e.Sb = o),
                                            o
                                    },
                                    Ec: function(e) {
                                        var t = u(e), i, o, n, r, a, s, l, c, d, p = {
                                            left: null,
                                            top: null
                                        };
                                        return 0 === t.length ? p : (i = this.Hb(),
                                            o = i.contentWrapper,
                                            n = t.offset(),
                                            n.leftWidth = n.left + t.outerWidth(),
                                            n.topHeight = n.top + t.outerHeight(),
                                            a = o.offset(),
                                            a.leftWidth = a.left + i.clientWidth,
                                            a.topHeight = a.top + i.clientHeight,
                                            c = n.left - a.left,
                                            n.left < a.left ? p.left = c : n.leftWidth > a.leftWidth && (d = n.leftWidth - a.left - i.clientWidth,
                                                p.left = c < d ? c : d),
                                            s = n.top - a.top,
                                            n.top < a.top ? p.top = s : n.topHeight > a.topHeight && (l = n.topHeight - a.top - i.clientHeight,
                                                p.top = s < l ? s : l),
                                            p)
                                    },
                                    Hc: function(e, t, i) {
                                        var o = i.options.uiCSS;
                                        e.initialized = !0,
                                            t.addClass(["gcui-superpanel", o.widget, o.content].join(" ")),
                                            i.Jc(i, t),
                                            i.Oc(i, e, t),
                                            i._trigger("painted"),
                                            i.jd()
                                    },
                                    jd: function() {
                                        var e = this.options
                                            , t = e.hScroller
                                            , i = e.vScroller
                                            , o = t.scrollValue
                                            , n = i.scrollValue
                                            , r = this.Hb()
                                            , a = o ? this.kd(o, "h") : 0
                                            , s = n ? this.kd(n, "v") : 0;
                                        o && r.stateContainer.prop("scrollLeft", a),
                                        n && r.stateContainer.prop("scrollTop", s)
                                    },
                                    ic: function(e, t) {
                                        var i = this.scrollPxToValue(e, t)
                                            , o = this.options
                                            , n = "h" === t ? "hScroller" : "vScroller"
                                            , r = u.Event("scrollValueChanged");
                                        o[n].scrollValue = i,
                                            this._trigger("scrollValueChanged", r, {
                                                dir: t,
                                                value: i
                                            })
                                    },
                                    scrollPxToValue: function(e, t) {
                                        var i = this.options
                                            , o = "h" === t ? "width" : "height"
                                            , n = "h" === t ? "contentWidth" : "contentHeight"
                                            , r = "h" === t ? "hScroller" : "vScroller"
                                            , a = this.Hb()
                                            , s = a.stateContainer
                                            , l = a[n]
                                            , c = s[o]()
                                            , d = i[r].scrollMin
                                            , p = i[r].scrollMax
                                            , u = p - d
                                            , h = u * e / (l - c) + d;
                                        return h
                                    },
                                    kd: function(e, t) {
                                        var i = this.options
                                            , o = "h" === t ? "width" : "height"
                                            , n = "h" === t ? "contentWidth" : "contentHeight"
                                            , r = "h" === t ? "hScroller" : "vScroller"
                                            , a = this.Hb()
                                            , s = a.stateContainer
                                            , l = a[n]
                                            , c = s[o]()
                                            , d = i[r].scrollMin
                                            , p = i[r].scrollMax
                                            , u = p - d
                                            , h = (e - d) * (l - c) / u;
                                        return h
                                    },
                                    hd: function(e) {
                                        var t = this
                                            , i = t.element
                                            , o = t.options
                                            , n = o.animationOptions
                                            , r = t.Hb();
                                        r.stateContainer.animate(e, n)
                                    },
                                    destroy: function() {
                                        var e = this, t = e.element, i = e.options, o = e.Hb(), n, r = i.uiCSS;
                                        e.disabledDiv && (e.disabledDiv.remove(),
                                            e.disabledDiv = null),
                                        void 0 !== o.resizer && o.resizer.resizable("destroy"),
                                            t.unbind("." + e.widgetName),
                                            t.removeClass(["gcui-superpanel", r.widget, r.content, r.cornerAll].join(" ")),
                                            n = o.contentWrapper,
                                            n.contents().each(function(e, i) {
                                                t.append(i)
                                            }),
                                            o.stateContainer.remove(),
                                            u.Widget.prototype.destroy.apply(e, arguments)
                                    },
                                    doScrolling: function(e, t) {
                                        this.cc(e, this, t)
                                    },
                                    paintPanel: function(e) {
                                        var t = this
                                            , i = t.element
                                            , o = t.Hb();
                                        o.initialized || this.Hc(o, i, t)
                                    },
                                    needToScroll: function(e) {
                                        var t = this.Ec(e);
                                        return null !== t.top || null !== t.left
                                    },
                                    scrollChildIntoView: function(e) {
                                        var t = this.Ec(e)
                                            , i = t.left
                                            , o = t.top;
                                        this.scrollTo(i, o)
                                    },
                                    getContentElement: function() {
                                        return this.Hb().contentWrapper
                                    },
                                    hScrollTo: function(e, t) {
                                        var i = t ? this.kd(e) : e;
                                        this.ic(i, "h"),
                                            this.hd({
                                                scrollLeft: i
                                            })
                                    },
                                    vScrollTo: function(e, t) {
                                        var i = t ? this.kd(e) : e;
                                        this.ic(i, "v"),
                                            this.hd({
                                                scrollTop: i
                                            })
                                    },
                                    refresh: function() {
                                        var e = this
                                            , t = e.Hb();
                                        e.ed(t.stateContainer),
                                            e.fd()
                                    },
                                    scrollTo: function(e, t, i) {
                                        var o = i ? this.kd(e) : e
                                            , n = i ? this.kd(t) : t;
                                        this.ic(o, "h"),
                                            this.ic(n, "v"),
                                            this.hd({
                                                scrollTop: n,
                                                scrollLeft: o
                                            })
                                    }
                                }),
                                t.prototype.options = u.extend(!0, {}, e.gcuiWidget.prototype.options, {
                                    mobileCSS: {
                                        header: "ui-header ui-bar-a",
                                        content: "ui-body-c",
                                        stateDefault: "ui-btn-up-c",
                                        stateHover: "ui-btn-down-c",
                                        stateActive: "ui-btn-down-c"
                                    },
                                    initSelector: ":jqmData(role='superpanel')",
                                    allowResize: !1,
                                    animationOptions: {
                                        queue: !1,
                                        disabled: !1,
                                        duration: 250,
                                        easing: void 0
                                    },
                                    hScroller: {
                                        scrollBarVisibility: "auto",
                                        scrollValue: null,
                                        scrollMax: 100,
                                        firstStepChangeFix: 0,
                                        scrollMin: 0,
                                        hoverEdgeSpan: 20
                                    },
                                    keyboardSupport: !1,
                                    keyDownInterval: 100,
                                    mouseWheelSupport: !0,
                                    resizableOptions: {
                                        handles: "all",
                                        helper: "ui-widget-content gcui-superpanel-helper"
                                    },
                                    resized: null,
                                    painted: null,
                                    scroll: null,
                                    showRounder: !0,
                                    vScroller: {
                                        scrollBarVisibility: "auto",
                                        scrollValue: null,
                                        scrollMax: 100,
                                        scrollMin: 0,
                                        firstStepChangeFix: 0,
                                        hoverEdgeSpan: 20
                                    }
                                }),
                                u.gcui.registerWidget("superpanel", t.prototype)) : (s = "<div class='gcui-superpanel-statecontainer'><div class='gcui-superpanel-contentwrapper'><div class='gcui-superpanel-templateouterwrapper'></div></div></div>",
                                l = "<div class='gcui-superpanel-hbarcontainer {header}'><div class='gcui-superpanel-handle {stateDefault} {cornerAll}'><span class='{icon} {iconVGripSolid}'></span></div><div class='gcui-superpanel-hbar-buttonleft {stateDefault} {cornerBL}'><span class='{icon} {iconArrowLeft}'></span></div><div class='gcui-superpanel-hbar-buttonright {stateDefault} {cornerBR}'><span class='{icon} {iconArrowRight}'></span></div></div>",
                                c = "<div class='gcui-superpanel-vbarcontainer {header}'><div class='gcui-superpanel-handle {stateDefault} {cornerAll}'><span class='{icon} {iconHGripSolid}'></span></div><div class='gcui-superpanel-vbar-buttontop {stateDefault} {cornerTR}'><span class='{icon} {iconArrowUp}'></span></div><div class='gcui-superpanel-vbar-buttonbottom {stateDefault} {cornerBR}'><span class='{icon} {iconArrowDown}'></span></div></div>",
                                d = "<div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttonleft'><span class='{icon} {iconCaratLeft}'></span></div><div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttonright'><span class='{icon} {iconCaratRight}'></span></div>",
                                p = "<div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttontop'><span class='{icon} {iconCaratUp}'></span></div><div class='{stateDefault} gcui-superpanel-button gcui-superpanel-buttonbottom'><span class='{icon} {iconCaratDown}'> </span></div>",
                                o = "gcui-superpanel-handle",
                                n = "gcui-superpanel-hbarcontainer",
                                r = "gcui-superpanel-vbarcontainer",
                                a = "",
                                t.prototype = u.extend(!0, {}, u.Widget.prototype, {
                                    widgetEventPrefix: "gcuisuperpanel",
                                    _setOption: function(e, t) {
                                        var i = this
                                            , o = i.options
                                            , n = i.Hb()
                                            , r = n.hbarDrag
                                            , a = n.vbarDrag
                                            , s = n.resizer;
                                        switch ("animationOptions" === e ? t = u.extend(o.animationOptions, t) : "hScroller" === e ? (void 0 !== t.scrollLargeChange && null !== t.scrollLargeChange && (i.Ib = !1),
                                            t = u.extend(o.hScroller, t),
                                            i.refresh()) : "vScroller" === e ? (void 0 !== t.scrollLargeChange && null !== t.scrollLargeChange && (i.Jb = !1),
                                            t = u.extend(o.vScroller, t),
                                            i.refresh()) : "resizableOptions" === e && (t = u.extend(i.resizableOptions, t)),
                                            u.Widget.prototype._setOption.apply(i, arguments),
                                        u.isPlainObject(t) && (i.options[e] = t),
                                            e) {
                                            case "allowResize":
                                                i.Kb();
                                                break;
                                            case "disabled":
                                                t ? (void 0 !== r && r.draggable("disable"),
                                                void 0 !== a && a.draggable("disable"),
                                                void 0 !== s && s.resizable("disable")) : (void 0 !== r && r.draggable("enable"),
                                                void 0 !== a && a.draggable("enable"),
                                                void 0 !== s && s.resizable("enable"));
                                                break;
                                            case "mouseWheelSupport":
                                            case "keyboardSupport":
                                                i.Lb(i, n, i.element, o)
                                        }
                                        return i
                                    },
                                    _create: function() {
                                        var e = this
                                            , t = e.options;
                                        t.vScroller.dir = "v",
                                            t.hScroller.dir = "h",
                                            e.Mb(),
                                            e.paintPanel(),
                                            e.Kb(),
                                        e.options.disabled && e.disable(),
                                            e.Nb(),
                                        t.listenContentScroll && e.Ob(),
                                        e.element.is(":hidden") && e.element.addVisibilityObserver && e.element.addVisibilityObserver(function() {
                                            e.element.removeVisibilityObserver && e.element.removeVisibilityObserver(),
                                                e.refresh()
                                        }, "gcuisuperpanel")
                                    },
                                    Mb: function() {
                                        var e = this.options.uiCSS
                                            , t = /\{(\w+?)\}/gi
                                            , i = function(t, i) {
                                            return e[i]
                                        };
                                        a = e.stateActive,
                                            l = l.replace(t, i),
                                            c = c.replace(t, i),
                                            d = d.replace(t, i),
                                            p = p.replace(t, i)
                                    },
                                    Nb: function() {
                                        var e = this
                                            , t = u.gcui.superpanel.panels;
                                        void 0 === t && (t = [],
                                            u.gcui.superpanel.panels = t),
                                            t.push(e),
                                        e.options.autoRefresh && (u.gcui.superpanel.setAutoRefreshInterval || (u.gcui.superpanel.setAutoRefreshInterval = e.Pb,
                                            u.gcui.superpanel.setAutoRefreshInterval()))
                                    },
                                    Pb: function() {
                                        var e = u.gcui.superpanel.autoRereshInterval, t = u.gcui.superpanel.panels, i;
                                        i = window.setInterval(function() {
                                            window.clearInterval(i);
                                            var e = t.length, o = !1, n, r, a, s, l, c;
                                            for (n = 0; n < e; n++)
                                                r = t[n],
                                                    a = r.element[0],
                                                    s = r.options.autoRefresh,
                                                s && (o = !0),
                                                    l = r.getContentElement(),
                                                    c = r.Qb,
                                                s && l.is(":visible") && (void 0 === c || c.width !== l[0].offsetWidth || c.height !== l[0].offsetHeight || c.mainWidth !== a.offsetWidth || c.mainHeight !== a.offsetHeight) && r.paintPanel();
                                            o && window.setTimeout(u.gcui.superpanel.setAutoRefreshInterval, 0)
                                        }, void 0 === e ? 500 : e)
                                    },
                                    destroy: function() {
                                        var e = this, t = e.Hb(), i = e.element, o, n, r = e.options.uiCSS;
                                        u.gcui.superpanel.panels = u.grep(u.gcui.superpanel.panels, function(t) {
                                            return t !== e
                                        }, !1),
                                        t.initialized && (e.Rb && e.element.css(e.Rb, ""),
                                        void 0 !== t.intervalID && (window.clearInterval(t.intervalID),
                                            t.intervalID = void 0),
                                        void 0 !== t.resizer && t.resizer.resizable("destroy"),
                                        void 0 !== t.hbarContainer && (t.hbarDrag.remove(),
                                            t.hbarContainer.unbind("." + e.widgetName)),
                                        void 0 !== t.vbarContainer && (t.vbarDrag.remove(),
                                            t.vbarContainer.unbind("." + e.widgetName)),
                                            i.unbind("." + e.widgetName),
                                            t.contentWrapper.unbind("." + e.widgetName),
                                            o = t.stateContainer.find(">.gcui-superpanel-button"),
                                            o.unbind("." + e.widgetName),
                                            n = t.templateWrapper,
                                            n.contents().each(function(e, t) {
                                                i.append(t)
                                            }),
                                            t.stateContainer.remove(),
                                        t.tabindex && i.removeAttr("tabindex"),
                                            i.removeClass(["gcui-superpanel", r.widget, r.content, r.cornerAll].join(" ")),
                                            u.Widget.prototype.destroy.apply(e, arguments))
                                    },
                                    Hb: function() {
                                        var e = this
                                            , t = e.element
                                            , i = e.widgetName + "-fields"
                                            , o = e.Sb;
                                        return void 0 === o && (o = {},
                                            t.data(i, o),
                                            e.Sb = o),
                                            o
                                    },
                                    Tb: function(e, t) {
                                        var i = e.scrollMode.split(",");
                                        return i = u.map(i, function(e) {
                                            return u.trim(e).toLowerCase()
                                        }),
                                        u.inArray(t.toLowerCase(), i) > -1
                                    },
                                    Lb: function(e, t, i, o) {
                                        var n = e.Tb(o.hScroller, "edge")
                                            , r = e.Tb(o.vScroller, "edge")
                                            , a = e.widgetName;
                                        n || r ? void 0 === e.Ub && (e.Ub = !0,
                                            i.bind("mousemove." + a, e, e.Vb),
                                            i.bind("mouseleave." + a, null, function() {
                                                e.Wb()
                                            })) : (i.unbind("mousemove", e.Vb),
                                            e.Ub = void 0),
                                            o.mouseWheelSupport ? void 0 === e.Xb && (e.Xb = !0,
                                                i.bind("mousewheel." + a, e, e.Yb)) : (i.unbind("mousewheel", e.Yb),
                                                e.Xb = void 0),
                                            o.keyboardSupport ? void 0 === e.Zb && (e.Zb = !0,
                                                i.bind("keydown." + a, e, e.$b)) : (i.unbind("keydown", e.$b),
                                                e.Zb = void 0)
                                    },
                                    _b: function(e, t, i) {
                                        var o = {
                                            dragHandle: i
                                        };
                                        t._trigger("dragStop", e, o)
                                    },
                                    Vb: function(e) {
                                        if (!e.data.options.disabled) {
                                            var t = e.data
                                                , i = t.options
                                                , o = i.hScroller
                                                , n = i.vScroller
                                                , r = u(e.currentTarget)
                                                , a = t.Hb()
                                                , s = t.Tb(o, "edge")
                                                , l = t.Tb(n, "edge")
                                                , c = {
                                                X: e.pageX,
                                                Y: e.pageY
                                            }
                                                , d = r.offset()
                                                , p = d.left
                                                , h = d.top
                                                , f = o.hoverEdgeSpan
                                                , g = n.hoverEdgeSpan
                                                , m = r.innerHeight()
                                                , b = r.innerWidth()
                                                , v = "";
                                            p = c.X - p,
                                                h = c.Y - h,
                                                t.Wb(),
                                            s && (p < f && (v = "left"),
                                            p > b - f && (v = "right")),
                                            l && (h < g && (v = "top"),
                                            h > m - g && (v = "bottom")),
                                                t.bc(a, v, t, !1)
                                        }
                                    },
                                    bc: function(e, t, i, o) {
                                        var n = i.options;
                                        t.length > 0 && (e.internalFuncID = window.setInterval(function() {
                                            i.cc(t, i, o)
                                        }, n.keyDownInterval))
                                    },
                                    dc: function(e) {
                                        var t = e.data
                                            , i = t.options
                                            , o = u(e.currentTarget);
                                        i.disabled || o.hasClass(i.uiCSS.stateDisabled) || (o.bind("mouseout." + t.widgetName, t, t.ec).bind("mousedown." + t.widgetName, t, t.fc).bind("mouseup." + t.widgetName, t, t.gc).addClass(i.uiCSS.stateHover),
                                            t.hc(o, t, "buttonshover"))
                                    },
                                    hc: function(e, t, i) {
                                        var o = ""
                                            , n = t.options
                                            , r = t.Hb()
                                            , a = t.Tb(n.hScroller, i)
                                            , s = t.Tb(n.vScroller, i);
                                        e.hasClass("gcui-superpanel-buttonleft") && a ? o = "left" : e.hasClass("gcui-superpanel-buttonright") && a ? o = "right" : e.hasClass("gcui-superpanel-buttontop") && s ? o = "top" : e.hasClass("gcui-superpanel-buttonbottom") && s && (o = "bottom"),
                                        o.length > 0 && (t.Wb(),
                                            t.cc(o, t, !0),
                                            t.bc(r, o, t, !0))
                                    },
                                    Ob: function() {
                                        var e = this
                                            , t = e.options
                                            , i = e.Hb()
                                            , o = i.hbarContainer
                                            , n = i.hbarDrag
                                            , r = i.vbarContainer
                                            , a = i.vbarDrag
                                            , s = i.templateWrapper
                                            , l = i.contentWrapper
                                            , c = l.width()
                                            , d = l.height()
                                            , p = s && s.offset()
                                            , u = p && p.left
                                            , h = p && p.top
                                            , f = i.contentWidth
                                            , g = i.contentHeight;
                                        l.bind("scroll", function(i) {
                                            var p = s.position()
                                                , u = p.left
                                                , h = p.top;
                                            l.scrollTop(0).scrollLeft(0),
                                                s.css({
                                                    left: u,
                                                    top: h
                                                }),
                                            u <= 0 && u > c - f && (e.ic(e.scrollPxToValue(-u, "h"), t.hScroller),
                                                e.jc("h", o, n, !0)),
                                            h <= 0 && h > d - g && (e.ic(e.scrollPxToValue(-h, "v"), t.vScroller),
                                                e.jc("v", r, a, !0))
                                        })
                                    },
                                    fc: function(e) {
                                        var t = e.data
                                            , i = u(e.currentTarget)
                                            , o = t.options.uiCSS;
                                        t.options.disabled || i.hasClass(o.stateDisabled) || (i.addClass(o.stateActive),
                                            t.hc(i, t, "buttons"))
                                    },
                                    gc: function(e) {
                                        var t = e.data
                                            , i = u(e.currentTarget);
                                        i.removeClass(t.options.css.stateActive),
                                            t.Wb()
                                    },
                                    ec: function(e) {
                                        var t = e.data
                                            , i = t.options.uiCSS
                                            , o = u(e.currentTarget);
                                        o.unbind("mouseout", t.ec).unbind("mousedown", t.fc).unbind("mouseup", t.gc).removeClass(i.stateHover).removeClass(i.stateActive),
                                            t.Wb()
                                    },
                                    ic: function(e, t) {
                                        var i = u.Event("scrollValueChanged");
                                        t.scrollValue = e,
                                            this._trigger("scrollValueChanged", i, t)
                                    },
                                    $b: function(t) {
                                        var i = t.data
                                            , o = i.options
                                            , n = t.shiftKey
                                            , r = t.keyCode
                                            , a = e.getKeyCodeEnum();
                                        o.keyboardSupport && !o.disabled && (r === a.LEFT ? i.cc("left", i, n) : r === a.RIGHT ? i.cc("right", i, n) : r === a.UP ? i.cc("top", i, n) : r === a.DOWN && i.cc("bottom", i, n),
                                            t.stopPropagation(),
                                            t.preventDefault())
                                    },
                                    kc: function(e, t, i, o) {
                                        var n = i.dir, r = "h" === n, a = r ? "left" : "top", s = e.position[a] - t.lc(a), l = t.oc(n) - o[r ? "outerWidth" : "outerHeight"](!0), c = s / l, d = i.scrollMax - i.scrollLargeChange + 1, p = c * d, u, h, f;
                                        p < i.scrollMin && (p = i.scrollMin),
                                        p > d && (p = d),
                                            u = {
                                                oldValue: i.scrollValue,
                                                newValue: p,
                                                dir: n
                                            },
                                        t.pc(!0, t, u) && (t.customScroll && (f = Math.abs(t.customScroll),
                                            h = t.scrollPxToValue(f, i.dir)),
                                            t.ic(h || p, i),
                                            t.customScroll = void 0,
                                            t.qc(!0, !1, n, "dragging"))
                                    },
                                    rc: function(e, t, i) {
                                        var o = i.options
                                            , r = u(e.target)
                                            , a = r.parent();
                                        a.hasClass(n) ? i.kc(t, i, o.hScroller, r) : i.kc(t, i, o.vScroller, r)
                                    },
                                    Yb: function(e, t) {
                                        var i = e.data, o = i.options, r, a = "", s, l = o.hScroller, c = o.vScroller, d;
                                        o.mouseWheelSupport && !o.disabled && (r = u(e.srcElement || e.originalEvent.target),
                                            s = r.closest("." + n, i.element).size() > 0,
                                            a = t > 0 ? s ? "left" : "top" : s ? "right" : "bottom",
                                        a.length > 0 && i.cc(a, i),
                                            d = !1,
                                        "left" === a && (d = !i.hNeedScrollBar || Math.abs(l.scrollValue - l.scrollMin) < .001),
                                        "right" === a && (d = !i.hNeedScrollBar || Math.abs(l.scrollValue - (l.scrollMax - i.tc() + 1)) < .001),
                                        "top" === a && (d = !i.vNeedScrollBar || Math.abs(c.scrollValue - c.scrollMin) < .001),
                                        "bottom" === a && (d = !i.vNeedScrollBar || Math.abs(c.scrollValue - (c.scrollMax - i.uc() + 1)) < .001),
                                        d && o.bubbleScrollingEvent && "left" !== a && "right" !== a || (e.stopPropagation(),
                                            e.preventDefault()))
                                    },
                                    vc: function(e) {
                                        var t = e.data.self
                                            , i = e.data.ele;
                                        i.removeClass(t.options.uiCSS.stateActive),
                                            t.Wb(),
                                            u(document).unbind("mouseup", t.vc)
                                    },
                                    wc: function(e) {
                                        var t = e.data, i = t.options, o, a = null, s = !1;
                                        i.disabled || (o = u(e.srcElement || e.originalEvent.target || e.originalEvent.srcElement),
                                            o.hasClass(i.uiCSS.stateDefault) ? (a = o,
                                                s = !0) : o.parent().hasClass(i.uiCSS.stateDefault) ? (a = o.parent(),
                                                s = !0) : (o.hasClass(r) || o.hasClass(n)) && (a = o),
                                        a && (s && a.addClass(i.uiCSS.stateHover),
                                            a.bind("mouseout." + t.widgetName, t, t.xc),
                                            a.bind("mousedown." + t.widgetName, t, t.yc),
                                            a.bind("mouseup." + t.widgetName, t, t.zc)))
                                    },
                                    zc: function(e) {
                                        var t = u(e.currentTarget);
                                        t.removeClass(a)
                                    },
                                    yc: function(e) {
                                        var t = u(e.currentTarget), i = e.data, s, l, c = "", d = !1, p = !1, h, f, g;
                                        if (!i.options.disabled && 1 === e.which) {
                                            if (t.hasClass("gcui-superpanel-vbar-buttontop"))
                                                c = "top",
                                                    p = !0;
                                            else if (t.hasClass("gcui-superpanel-vbar-buttonbottom"))
                                                c = "bottom",
                                                    p = !0;
                                            else if (t.hasClass("gcui-superpanel-hbar-buttonleft"))
                                                c = "left",
                                                    p = !0;
                                            else if (t.hasClass("gcui-superpanel-hbar-buttonright"))
                                                c = "right",
                                                    p = !0;
                                            else {
                                                if (t.hasClass(o))
                                                    return void t.addClass(a);
                                                t.hasClass(n) ? (s = t.find("." + o),
                                                    h = s.offset(),
                                                    c = e.pageX < h.left ? "left" : "right",
                                                    d = !0) : t.hasClass(r) && (l = t.find("." + o),
                                                    f = l.offset(),
                                                    c = e.pageY < f.top ? "top" : "bottom",
                                                    d = !0)
                                            }
                                            i.Wb(),
                                                i.cc(c, i, d),
                                                g = i.Hb(),
                                                i.bc(g, c, i, d),
                                            p && t.addClass(a),
                                                u(document).bind("mouseup." + i.widgetName, {
                                                    self: i,
                                                    ele: t
                                                }, i.vc)
                                        }
                                    },
                                    doScrolling: function(e, t) {
                                        this.cc(e, this, t)
                                    },
                                    Ac: function(e, t, i, o, n, r, a) {
                                        var s = t.scrollMin, l = r ? o : i, c = t.scrollValue, d = 0, p, u, h, f, g;
                                        if (c || (c = s),
                                                n) {
                                            if (p = t.scrollMax - o + 1,
                                                Math.abs(c - p) < .001)
                                                return a.Wb(),
                                                    !1;
                                            u = t.firstStepChangeFix,
                                                d = c + l,
                                            !r && Math.abs(c - s) < 1e-4 && !isNaN(u) && (d += u),
                                            d > p && (d = p)
                                        } else {
                                            if (Math.abs(c - s) < .001)
                                                return a.Wb(),
                                                    !1;
                                            d = c - l,
                                            d < 0 && (d = s)
                                        }
                                        return h = {
                                            oldValue: t.scrollValue,
                                            newValue: d,
                                            direction: e,
                                            dir: t.dir
                                        },
                                        !!a.pc(!0, a, h) && (a.customScroll && (g = Math.abs(a.customScroll),
                                            f = a.scrollPxToValue(g, t.dir)),
                                            a.ic(f || d, t),
                                            a.customScroll = void 0,
                                            !0)
                                    },
                                    cc: function(e, t, i) {
                                        var o = t.options
                                            , n = o.vScroller
                                            , r = o.hScroller
                                            , a = t.Bc()
                                            , s = t.uc()
                                            , l = t.tc()
                                            , c = t.Cc();
                                        if ("top" === e || "bottom" === e) {
                                            if (!t.Ac(e, n, a, s, "bottom" === e, i, t))
                                                return;
                                            e = "v"
                                        } else if ("left" === e || "right" === e) {
                                            if (!t.Ac(e, r, c, l, "right" === e, i, t))
                                                return;
                                            e = "h"
                                        }
                                        t.qc(!0, !0, e)
                                    },
                                    Dc: function(e) {
                                        var t = e.Hb(), i = e.options, o = t.buttonLeft, n = t.buttonRight, r = t.buttonTop, a = t.buttonBottom, s, l, c, d, p, u, h, f;
                                        t.intervalID > 0 && window.clearInterval(t.intervalID),
                                        void 0 !== o && (s = e.tc(),
                                            l = i.hScroller.scrollMax - s + 1,
                                            c = i.hScroller.scrollValue,
                                            d = i.hScroller.scrollMin,
                                        void 0 === c && (c = d),
                                            Math.abs(c - d) < .001 || !t.hScrolling ? o.addClass(i.uiCSS.stateDisabled) : o.removeClass(i.uiCSS.stateDisabled),
                                            Math.abs(c - l) < .001 || !t.hScrolling ? n.addClass(i.uiCSS.stateDisabled) : n.removeClass(i.uiCSS.stateDisabled)),
                                        void 0 !== r && (p = e.uc(),
                                            u = i.vScroller.scrollMax - p + 1,
                                            h = i.vScroller.scrollValue,
                                            f = i.vScroller.scrollMin,
                                        void 0 === h && (h = f),
                                            Math.abs(h - f) < .001 || !t.vScrolling ? r.addClass(i.uiCSS.stateDisabled) : r.removeClass(i.uiCSS.stateDisabled),
                                            Math.abs(h - u) < .001 || !t.vScrolling ? a.addClass(i.uiCSS.stateDisabled) : a.removeClass(i.uiCSS.stateDisabled))
                                    },
                                    Wb: function() {
                                        var e = this.Hb()
                                            , t = e.internalFuncID;
                                        t > 0 && (window.clearInterval(t),
                                            e.internalFuncID = -1)
                                    },
                                    xc: function(e) {
                                        var t = u(e.currentTarget)
                                            , i = e.data;
                                        t.unbind("mouseout", i.xc),
                                            t.unbind("mousedown", i.yc),
                                            t.unbind("mouseup", i.zc),
                                            t.removeClass(i.options.uiCSS.stateHover)
                                    },
                                    Ec: function(e) {
                                        var t = u(e), i = this.Hb(), o = i.contentWrapper, n = i.templateWrapper, r, a, s, l, c, d, p, h = {
                                            left: null,
                                            top: null
                                        };
                                        return 0 === t.length ? h : (r = t.offset(),
                                            a = n.offset(),
                                            r.leftWidth = r.left + t.outerWidth(),
                                            r.topHeight = r.top + t.outerHeight(),
                                            s = o.offset(),
                                            s.leftWidth = s.left + o.outerWidth(),
                                            s.topHeight = s.top + o.outerHeight(),
                                            d = r.left - a.left,
                                            r.left < s.left ? h.left = d : r.leftWidth > s.leftWidth && (p = r.leftWidth - a.left - o.innerWidth(),
                                                h.left = d < p ? d : p),
                                            l = r.top - a.top,
                                            r.top < s.top ? h.top = l : r.topHeight > s.topHeight && (c = r.topHeight - a.top - o.innerHeight(),
                                                h.top = l < c ? l : c),
                                            h)
                                    },
                                    jc: function(e, t, i, o) {
                                        var n = this, r = n.options, a = "v" === e, s = a ? r.vScroller : r.hScroller, l = s.scrollMin, c = s.scrollMax, d = void 0 === s.scrollValue ? l : s.scrollValue - l, p = n.Fc(e), u = c - l - p + 1, h = -1, f, g, m;
                                        d > u && (d = u),
                                        void 0 !== t && (f = n.oc(e),
                                            g = i[a ? "outerHeight" : "outerWidth"](),
                                            m = n.lc(a ? "top" : "left"),
                                            h = d / u * (f - g) + m),
                                        h >= 0 && i.css(a ? "top" : "left", h + "px"),
                                            n.Gc(o, n, e)
                                    },
                                    needToScroll: function(e) {
                                        var t = this.Ec(e);
                                        return null !== t.top || null !== t.left
                                    },
                                    scrollChildIntoView: function(e) {
                                        var t = this.Ec(e)
                                            , i = t.left
                                            , o = t.top;
                                        null !== i && this.hScrollTo(i),
                                        null !== o && this.vScrollTo(o)
                                    },
                                    hScrollTo: function(e, t) {
                                        var i = this.options;
                                        this.ic(t ? e : this.scrollPxToValue(e, "h"), i.hScroller),
                                            this.qc(!0, !0, "h", "nonestop")
                                    },
                                    vScrollTo: function(e, t) {
                                        var i = this.options;
                                        this.ic(t ? e : this.scrollPxToValue(e, "v"), i.vScroller),
                                            this.qc(!0, !0, "v", "nonestop")
                                    },
                                    scrollPxToValue: function(e, t) {
                                        var i = this.options
                                            , o = "h" === t ? "outerWidth" : "outerHeight"
                                            , n = "h" === t ? "contentWidth" : "contentHeight"
                                            , r = "h" === t ? "hScroller" : "vScroller"
                                            , a = this.Hb()
                                            , s = a.contentWrapper
                                            , l = a[n]
                                            , c = s[o]()
                                            , d = i[r].scrollMin
                                            , p = i[r].scrollMax
                                            , u = p - d
                                            , h = "h" === t ? this.tc() : this.uc()
                                            , f = u - h + 1
                                            , g = f * (e / (l - c));
                                        return g < d && (g = d),
                                        g > f && (g = f),
                                            g
                                    },
                                    scrollTo: function(e, t, i) {
                                        this.hScrollTo(e, i),
                                            this.vScrollTo(t, i)
                                    },
                                    refresh: function() {
                                        this.paintPanel()
                                    },
                                    paintPanel: function(e) {
                                        var t = this, i = t.element, o, n, r, a;
                                        return !!i.is(":visible") && (o = "unknown" != typeof document.activeElement ? document.activeElement : void 0,
                                            n = t.options,
                                            r = t.Hb(),
                                        r.initialized || t.Hc(r, i, t),
                                            t.Ic(t, r, n),
                                            t.Lb(t, r, i, n),
                                            a = r.templateWrapper,
                                            a.css({
                                                float: "left",
                                                left: "0px",
                                                top: "0px",
                                                width: "auto",
                                                height: "auto"
                                            }),
                                            a.hide(),
                                            a.show(),
                                            r.contentWidth = a.width(),
                                            r.contentHeight = a.height(),
                                            a.css("float", ""),
                                            t.Jc(t, i),
                                            t.Kc(r, i),
                                        !1 !== t.Lc(t, r, n) && (t.Mc(t, r, n),
                                            t.Nc(t, r, n),
                                            t._trigger("painted"),
                                            t.Qb = {
                                                date: new Date,
                                                mainWidth: i[0].offsetWidth,
                                                mainHeight: i[0].offsetHeight,
                                                width: r.contentWidth,
                                                height: r.contentWidth
                                            },
                                        void 0 === o || e || u(o).focus(),
                                            !0))
                                    },
                                    Ic: function(e, t, i) {
                                        var n;
                                        e.Jb && (i.vScroller.scrollLargeChange = null),
                                        e.Ib && (i.hScroller.scrollLargeChange = null),
                                            t.vTrackLen = void 0,
                                            t.hTrackLen = void 0,
                                        t.vbarContainer && (n = t.vbarContainer.children("." + o + ":eq(0)"),
                                            n.detach(),
                                            t.vbarContainer.remove(),
                                            t.vbarContainer = void 0),
                                        t.hbarContainer && (n = t.hbarContainer.children("." + o + ":eq(0)"),
                                            n.detach(),
                                            t.hbarContainer.remove(),
                                            t.hbarContainer = void 0)
                                    },
                                    Hc: function(e, t, i) {
                                        var o, n = i.options.uiCSS;
                                        e.initialized = !0,
                                            t.addClass(["gcui-superpanel", n.widget, n.content].join(" ")),
                                            e.oldHeight = t.css("height"),
                                            o = t.css("overflow"),
                                            t.css("overflow", ""),
                                            t.height(t.height()),
                                            t.css("overflow", o),
                                            i.Oc(i, e, t)
                                    },
                                    getContentElement: function() {
                                        return this.Hb().templateWrapper
                                    },
                                    Pc: function(e, t, i, o, n, r, a) {
                                        var s = "h" === o, l = "mouseover." + e.widgetName, c = s ? "buttonLeft" : "buttonTop", h = s ? "buttonRight" : "buttonBottom", f = r[c], g = r[h], m, b, v;
                                        e.Tb(i, "buttons") || e.Tb(i, "buttonshover") ? (m = s ? d : p,
                                        void 0 === f && (b = u(m).appendTo(a),
                                            b.bind(l, e, e.dc),
                                            r[c] = f = a.children(s ? ".gcui-superpanel-buttonleft" : ".gcui-superpanel-buttontop"),
                                            r[h] = g = a.children(s ? ".gcui-superpanel-buttonright" : ".gcui-superpanel-buttonbottom")),
                                            v = {
                                                my: s ? "left" : "top",
                                                of: n,
                                                at: s ? "left" : "top",
                                                collision: "none"
                                            },
                                            u.extend(v, i.decreaseButtonPosition),
                                            f.position(v),
                                            v = {
                                                my: s ? "right" : "bottom",
                                                of: n,
                                                at: s ? "right" : "bottom",
                                                collision: "none"
                                            },
                                            u.extend(v, i.increaseButtonPosition),
                                            g.position(v)) : void 0 !== f && (f.remove(),
                                            g.remove(),
                                            r[c] = r[h] = void 0)
                                    },
                                    Nc: function(e, t, i) {
                                        var o = t.contentWrapper
                                            , n = t.stateContainer;
                                        e.Pc(e, i, i.hScroller, "h", o, t, n),
                                            e.Pc(e, i, i.vScroller, "v", o, t, n)
                                    },
                                    Bc: function() {
                                        var e = this.options, t;
                                        return e.vScroller.scrollSmallChange || (t = this.uc(),
                                            e.vScroller.scrollSmallChange = t / 2),
                                            e.vScroller.scrollSmallChange
                                    },
                                    uc: function() {
                                        return this.Fc("v")
                                    },
                                    Fc: function(e) {
                                        var t = this, i = t.options, o = t.Hb(), n = "v" === e, r = n ? i.vScroller : i.hScroller, a = n ? "innerHeight" : "innerWidth", s = n ? "contentHeight" : "contentWidth", l = n ? "_autoVLarge" : "_autoHLarge", c, d, p, u, h, f, g, m;
                                        return r.scrollLargeChange ? r.scrollLargeChange : (c = r.scrollMax,
                                            d = r.scrollMin,
                                            p = c - d,
                                            u = o.contentWrapper,
                                            h = u[a](),
                                            f = o[s],
                                            g = h / (f - h),
                                            m = (p + 1) * g / (1 + g),
                                        isNaN(m) && (m = 0),
                                            r.scrollLargeChange = m,
                                            t[l] = !0,
                                            r.scrollLargeChange)
                                    },
                                    Cc: function() {
                                        var e = this.options, t;
                                        return e.hScroller.scrollSmallChange || (t = this.tc(),
                                            e.hScroller.scrollSmallChange = t / 2),
                                            e.hScroller.scrollSmallChange
                                    },
                                    tc: function() {
                                        return this.Fc("h")
                                    },
                                    Mc: function(e, t, i) {
                                        var o = i.hScroller, n = o.scrollMax, r = o.scrollMin, a = n - r, s = i.vScroller, l = s.scrollMax, c = s.scrollMin, d = l - c, p = t.hbarDrag, h = t.vbarDrag, f, g, m, b, v, y, x, w, C, S;
                                        e.hNeedScrollBar && p.is(":visible") && (f = e.tc(),
                                            g = e.oc("h"),
                                            m = e.Qc(a, f, g, i.hScroller.scrollMinDragLength),
                                            p.width(m),
                                            b = p.outerWidth(!0) - p.width(),
                                            p.width(m - b),
                                            v = p.children("span"),
                                            v.css("margin-left", (p.width() - v[0].offsetWidth) / 2),
                                            g <= p.outerWidth(!0) ? p.hide() : p.show(),
                                        1 == e.Rc && (u(document).trigger("mouseup"),
                                            e.Rc = !1)),
                                        e.vNeedScrollBar && h.is(":visible") && (y = e.uc(),
                                            x = e.oc("v"),
                                            w = e.Qc(d, y, x, i.vScroller.scrollMinDragLength),
                                            h.height(w),
                                            C = h.outerHeight(!0) - h.height(),
                                            h.height(w - C),
                                            S = h.children("span"),
                                            S.css("margin-top", (h.height() - S[0].offsetHeight) / 2),
                                            x <= h.outerHeight(!0) ? h.hide() : h.show(),
                                        1 == e.Rc && (u(document).trigger("mouseup"),
                                            e.Rc = !1)),
                                            e.qc(!1, !1, "both")
                                    },
                                    oc: function(e) {
                                        var t = this
                                            , i = t.Hb()
                                            , o = e + "TrackLen"
                                            , n = i.hbarContainer
                                            , r = i.vbarContainer
                                            , a = 0
                                            , s = 0;
                                        return void 0 !== i[o] ? i[o] : ("h" === e && (s = t.lc("h"),
                                            a = n.innerWidth()),
                                        "v" === e && (s = t.lc("v"),
                                            a = r.innerHeight()),
                                            i[o] = a - s,
                                            i[o])
                                    },
                                    lc: function(e) {
                                        var t = this, i = t.Hb(), o = 0, n, r;
                                        if ("h" === e)
                                            o = t.lc("left") + t.lc("right");
                                        else if ("v" === e)
                                            o = t.lc("top") + t.lc("bottom");
                                        else {
                                            if (n = "left" === e || "right" === e ? i.hbarContainer : i.vbarContainer,
                                                    r = e + "Padding",
                                                void 0 !== i[r])
                                                return o = i[r];
                                            n && n.css && (o = parseFloat(n.css("padding-" + e))),
                                                i[r] = o
                                        }
                                        return o
                                    },
                                    Sc: function(e, t, i) {
                                        var o = {
                                            position: e,
                                            dir: t,
                                            animationOptions: i
                                        };
                                        this._trigger("scroll", null, o)
                                    },
                                    Tc: function(e, t, i, o, n, r, a) {
                                        var s = this, l = s.options, c = "v" === e, d = c ? l.vScroller : l.hScroller, p = c ? "outerHeight" : "outerWidth", h = c ? "innerHeight" : "innerWidth", f = c ? "contentHeight" : "contentWidth", g = c ? "top" : "left", m = d.scrollMin, b = d.scrollMax, v = b - m, y = void 0 === d.scrollValue ? m : d.scrollValue - m, x = s.Fc(e), w = v - x + 1, C = s.Hb(), S = C.contentWrapper, k = C.templateWrapper, T, A, I, D, $, F, L, R, B, N, E, V;
                                        y > w && (y = w),
                                            T = (C[f] - S[h]()) * (y / w),
                                        Math.abs(T) < .001 && (T = 0),
                                            T = Math.round(T),
                                            A = -1,
                                        void 0 !== i && (t && o.is(":animated") && "nonestop" !== n && o.stop(!0, !1),
                                            I = s.oc(e),
                                            D = o[p](!0),
                                            $ = I - D,
                                            F = s.lc(g),
                                            A = y / w * $ + F),
                                            t && l.animationOptions && !l.animationOptions.disabled ? (A >= 0 && "dragging" !== a && (L = u.extend({}, l.animationOptions),
                                                L.complete = void 0,
                                                R = c ? {
                                                    top: A
                                                } : {
                                                    left: A
                                                },
                                                o.animate(R, L)),
                                                B = u.extend({}, l.animationOptions),
                                                N = l.animationOptions.complete,
                                                B.complete = function() {
                                                    s.Gc(r, s, e),
                                                    u.isFunction(N) && N(arguments)
                                                }
                                                ,
                                            t && k.is(":animated") && "nonestop" !== n && k.stop(!0, !1),
                                                E = c ? {
                                                    top: -T
                                                } : {
                                                    left: -T
                                                },
                                                l.customScrolling ? s.Gc(r, s, e, y) : k.animate(E, B),
                                                s.Sc(T, e, B)) : "hidden" !== d.scrollBarVisibility && (V = c ? "top" : "left",
                                            A >= 0 && "dragging" !== a && (o[0].style[V] = A + "px"),
                                            l.customScrolling || (k[0].style[V] = -T + "px"),
                                                s.Sc(T, e),
                                                s.Gc(r, s, e, y))
                                    },
                                    qc: function(e, t, i, o, n) {
                                        var r = this
                                            , a = r.Hb()
                                            , s = a.hbarContainer
                                            , l = a.hbarDrag
                                            , c = a.vbarContainer
                                            , d = a.vbarDrag;
                                        "both" !== i && "h" !== i || !a.hScrolling || r.Tc("h", t, s, l, o, e, n),
                                        "both" !== i && "v" !== i || !a.vScrolling || r.Tc("v", t, c, d, o, e, n),
                                        a.intervalID > 0 && window.clearInterval(a.intervalID),
                                            a.intervalID = window.setInterval(function() {
                                                r.Dc(r)
                                            }, 500)
                                    },
                                    pc: function(e, t, i) {
                                        var o = !0;
                                        return e && (i.beforePosition = t.getContentElement().position(),
                                            t.Uc = i.beforePosition,
                                            o = t._trigger("scrolling", null, i),
                                            t.customScroll = i.customScroll),
                                            o
                                    },
                                    Gc: function(e, t, i, o) {
                                        e && window.setTimeout(function() {
                                            var e = t.getContentElement(), n, r;
                                            e.is(":visible") && (n = t.getContentElement().position(),
                                                r = {
                                                    dir: i,
                                                    beforePosition: t.Uc,
                                                    afterPosition: n
                                                },
                                            isNaN(o) || (r.newValue = o),
                                                t._trigger("scrolled", null, r))
                                        }, 0)
                                    },
                                    Qc: function(e, t, i, o) {
                                        var n = e / t
                                            , r = i / n
                                            , a = o;
                                        return r < a ? r = a : r + 1 >= i && (r = i - 1),
                                            Math.round(r)
                                    },
                                    Vc: function(e, t) {
                                        var i = this.Tb(e, "scrollbar")
                                            , o = e.scrollBarVisibility
                                            , n = i && ("visible" === o || "auto" === o && t);
                                        return n
                                    },
                                    Wc: function(e, t, i) {
                                        var o = this;
                                        e.bind("mouseover." + o.widgetName, o, o.wc),
                                        u.fn.draggable && t.draggable({
                                            axis: "h" === i ? "x" : "y",
                                            start: function(e, t) {
                                                if (o.options.disabled)
                                                    return !1;
                                                o.Rc = !0
                                            },
                                            drag: function(e, t) {
                                                o.rc(e, t, o)
                                            },
                                            containment: "parent",
                                            stop: function(e) {
                                                o._b(e, o, i),
                                                    u(e.target).removeClass(a),
                                                    o.Rc = !1
                                            }
                                        })
                                    },
                                    Xc: function(e, t, i, n, r) {
                                        if (e) {
                                            var a = this, s, l = a.Hb(), c = i + "barContainer", d = i + "barDrag", p = "h" === i, h = r[p ? "innerHeight" : "innerWidth"](), f = l[c] = u(n), g, m;
                                            if (t.append(f),
                                                    g = f[0][p ? "offsetHeight" : "offsetWidth"],
                                                    h -= g,
                                                    s = {
                                                        direction: p ? "horizontal" : "vertical",
                                                        targetBarLen: g,
                                                        contentLength: h
                                                    },
                                                !1 === a._trigger(p ? "hScrollerActivating" : "vScrollerActivating", null, s))
                                                return !1;
                                            m = l[d] = f.find("." + o),
                                                a.Wc(f, m, i),
                                                r[p ? "height" : "width"](h)
                                        }
                                    },
                                    Yc: function(e, t, i, o, n, r, a, s, l, c, d) {
                                        var p = "h" === c, u, h, f, g, m, b, v, y, x, w = t.options.uiCSS;
                                        r ? (u = o[0][p ? "offsetHeight" : "offsetWidth"],
                                            h = t.lc(c),
                                            f = p ? "top" : "left",
                                            g = p ? {
                                                top: "0px",
                                                bottom: "auto",
                                                left: "auto",
                                                right: "auto"
                                            } : {
                                                left: "0px",
                                                right: "auto",
                                                top: "auto",
                                                bottom: "auto"
                                            },
                                            m = p ? {
                                                top: u + "px",
                                                left: null
                                            } : {
                                                left: u + "px"
                                            },
                                            b = p ? {
                                                top: "auto",
                                                right: "auto",
                                                left: "auto",
                                                bottom: "0px"
                                            } : {
                                                left: "auto",
                                                right: "0px",
                                                top: "auto",
                                                bottom: "auto"
                                            },
                                            v = p ? {
                                                top: "",
                                                left: null
                                            } : {
                                                left: ""
                                            },
                                            y = i[p ? "innerWidth" : "innerHeight"](),
                                            s === f ? (o.css(g),
                                                i.css(m),
                                                p ? (o.children(".gcui-superpanel-hbar-buttonleft").removeClass(w.cornerBL).addClass(w.cornerTL),
                                                    o.children(".gcui-superpanel-hbar-buttonright").removeClass(w.cornerBR).addClass(w.cornerTR),
                                                    o.removeClass(w.cornerBottom).addClass(w.cornerTop)) : (o.children(".gcui-superpanel-vbar-buttontop").removeClass(w.cornerTR).addClass(w.cornerTL),
                                                    o.children(".gcui-superpanel-vbar-buttonbottom").removeClass(w.cornerBR).addClass(w.cornerBL),
                                                    o.removeClass(w.cornerRight).addClass(w.cornerLeft))) : (o.css(b),
                                                i.css(v),
                                                p ? (o.children(".gcui-superpanel-hbar-buttonleft").removeClass(w.cornerTL).addClass(w.cornerBL),
                                                    o.children(".gcui-superpanel-hbar-buttonright").removeClass(w.cornerBL).addClass(w.cornerBR),
                                                    o.removeClass(w.cornerTop).addClass(w.cornerBottom)) : (o.children(".gcui-superpanel-vbar-buttontop").removeClass(w.cornerTL).addClass(w.cornerTR),
                                                    o.children(".gcui-superpanel-vbar-buttonbottom").removeClass(w.cornerBL).addClass(w.cornerBR),
                                                    o.removeClass(w.cornerLeft).addClass(w.cornerRight))),
                                            x = 0,
                                        a && (x = n[0][p ? "offsetWidth" : "offsetHeight"],
                                            "left" === l ? o.css("right", "0px") : "right" === l ? o.css("left", "0px") : "top" === l ? o.css("bottom", "0px") : "bottom" === l && o.css("top", "0px")),
                                        !p && a && (x = 0),
                                            o[p ? "width" : "height"](y - h),
                                            t.Zc(c, o, !d)) : e.css(p ? "left" : "top", "")
                                    },
                                    Lc: function(e, t, i) {
                                        var o = t.templateWrapper, n = t.contentWrapper, r = t.stateContainer, a = n.innerWidth(), s = n.innerHeight(), d = t.contentWidth, p = t.contentHeight, u, h, f, g, m, b;
                                        return t.hScrolling = d > a,
                                            t.vScrolling = p > s,
                                            u = e.hNeedScrollBar = e.Vc(i.hScroller, t.hScrolling),
                                        !1 !== e.Xc(u, r, "h", l, n) && (u && !t.vScrolling && (o.css("float", "left"),
                                            t.contentHeight = o.height(),
                                            t.vScrolling = t.contentHeight > s - t.hbarContainer[0].offsetHeight,
                                            o.css("float", "")),
                                            h = e.vNeedScrollBar = e.Vc(i.vScroller, t.vScrolling),
                                        !1 !== e.Xc(h, r, "v", c, n) && (!(h && !t.hScrolling && (o.css("float", "left"),
                                            t.contentWidth = o.width(),
                                            t.hScrolling = t.contentWidth > a - t.vbarContainer[0].offsetWidth,
                                            o.css("float", ""),
                                        t.hScrolling && !u && (u = e.hNeedScrollBar = e.Vc(i.hScroller, t.hScrolling),
                                        !1 === e.Xc(u, r, "h", l, n)))) && (f = t.hbarContainer,
                                            g = t.vbarContainer,
                                            m = i.hScroller.scrollBarPosition,
                                            b = i.vScroller.scrollBarPosition,
                                            e.Yc(o, e, n, f, g, u, h, m, b, "h", t.hScrolling),
                                            void e.Yc(o, e, n, g, f, h, u, b, m, "v", t.vScrolling))))
                                    },
                                    Zc: function(e, t, i) {
                                        var n = this.options;
                                        "v" === e ? (t[i ? "addClass" : "removeClass"]("gcui-superpanel-vbarcontainer-disabled"),
                                            t.find("." + n.uiCSS.stateDefault)[i ? "addClass" : "removeClass"](n.uiCSS.stateDisabled)) : "h" === e && (t[i ? "addClass" : "removeClass"]("gcui-superpanel-hbarcontainer-disabled"),
                                            t.find("." + n.uiCSS.stateDefault)[i ? "addClass" : "removeClass"](n.uiCSS.stateDisabled)),
                                            t.children("." + o)[i ? "hide" : "show"]()
                                    },
                                    Kb: function() {
                                        var e = this, t = e.options, i = e.Hb(), o = i.resizer, n, r;
                                        u.fn.resizable && (!o && t.allowResize && (n = t.resizableOptions,
                                            r = n.stop,
                                            n.stop = function(t) {
                                                e.$c(t, e),
                                                u.isFunction(r) && r(t)
                                            }
                                            ,
                                            i.resizer = o = e.element.resizable(n)),
                                        !t.allowResize && i.resizer && (o.resizable("destroy"),
                                            i.resizer = null))
                                    },
                                    $c: function(e, t) {
                                        this.options.autoRefresh || t.paintPanel(!0),
                                            t._trigger("resized")
                                    },
                                    Oc: function(e, t, i) {
                                        i.attr("tabindex") || (i.attr("tabindex", "-1"),
                                            t.tabindex = !0);
                                        var o = t.stateContainer = u(s), n;
                                        t.contentWrapper = o.children(),
                                            n = t.templateWrapper = t.contentWrapper.children(),
                                            i.contents().each(function(e, i) {
                                                var o = u(i);
                                                return o.hasClass("gcui-superpanel-header") ? void (t.header = o) : o.hasClass("gcui-superpanel-footer") ? void (t.footer = o) : void n[0].appendChild(i)
                                            }),
                                        void 0 !== t.header && i.prepend(t.header),
                                            i[0].appendChild(o[0]),
                                        void 0 !== t.footer && t.footer.insertAfter(o)
                                    },
                                    Jc: function(e, t) {
                                        var i, o, n, r, a;
                                        if (this.options.showRounder) {
                                            if (t.addClass(this.options.uiCSS.cornerAll),
                                                    e._c)
                                                return;
                                            if (i = GC.Spread.Sheets.util.browser,
                                                    i.msie)
                                                return;
                                            o = "",
                                                n = "",
                                                i.webkit ? (n = "WebkitBorderTopLeftRadius",
                                                    o = "WebkitBorderRadius") : i.mozilla ? (n = "MozBorderRadiusBottomleft",
                                                    o = "MozBorderRadius") : (n = "border-top-left-radius",
                                                    o = "border-radius"),
                                                r = t.css(n),
                                                a = parseInt(r, 10),
                                                t.css(o, a + 1),
                                                e._c = !0,
                                                e.Rb = o
                                        } else
                                            t.removeClass(this.options.uiCSS.cornerAll)
                                    },
                                    Kc: function(e, t) {
                                        var i = e.stateContainer, o = e.contentWrapper, n = 0, r, a, s, l;
                                        void 0 !== e.header && (n += e.header.outerHeight()),
                                        void 0 !== e.footer && (n += e.footer.outerHeight()),
                                            r = i[0].style,
                                            a = t.innerHeight() - n,
                                            s = t.innerWidth(),
                                            r.display = "none",
                                            r.height = a + "px",
                                            r.width = s + "px",
                                            l = o[0].style,
                                            l.height = a + "px",
                                            l.width = s + "px",
                                            r.display = ""
                                    }
                                }),
                                t.prototype.options = u.extend(!0, {}, e.gcuiWidget.prototype.options, new h),
                                u.gcui.registerWidget("superpanel", t.prototype))
                    }(e.superpanel || (e.superpanel = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o, n = jQuery;
                        function r(e, t) {
                            var i = n.extend(!0, {}, e, t);
                            return delete i.constructor,
                                i
                        }
                        t.extendWidgetOptions = r,
                            i = function(i) {
                                __extends(o, i);
                                function o() {
                                    i.apply(this, arguments),
                                        this.ld = 0,
                                        this.md = {
                                            x: null,
                                            y: null,
                                            index: 0
                                        },
                                        this.nd = 0
                                }
                                return o.prototype.P = function(t, o) {
                                    var n = t && e.data.util.isClassInstance(t.data) && !("function" == typeof gcuidatasource && t.data instanceof gcuidatasource) && t.data;
                                    n && delete t.data,
                                        i.prototype.P.apply(this, arguments),
                                    n && (t.data = n,
                                        this.option("data", n))
                                }
                                    ,
                                    o.prototype._create = function() {
                                        var t, i, o, r, a = this;
                                        if (!this.element.is("table"))
                                            throw "invalid markup";
                                        this.nd = 0,
                                            this.ld = 0,
                                            this.md = {
                                                x: null,
                                                y: null,
                                                index: 0
                                            },
                                            this.od = !1,
                                            this.pd = !1,
                                            this.qd = !1,
                                            this.rd = void 0,
                                            this.sd = void 0,
                                            this.ud = void 0,
                                            this.vd = void 0,
                                            this.wd = void 0,
                                            this.xd = void 0,
                                            this.yd = void 0,
                                            this.zd = 0,
                                            this.$superPanelHeader = void 0,
                                            this.$topPagerDiv = void 0,
                                            this.$bottomPagerDiv = void 0,
                                            this.$groupArea = void 0,
                                            this.Ad = void 0,
                                            this.Bd = void 0,
                                            this.outerDiv = void 0,
                                            this.sketchTable = void 0,
                                            this.cellFormatter = void 0,
                                            this.rowStyleFormatter = void 0,
                                            this.cellStyleFormatter = void 0,
                                            this.rd = e.grid.getUID(),
                                            this.Cd = !1,
                                            this.deficientFilters = {},
                                            t = "data"in this.options,
                                            i = t && this.options.data,
                                        t && delete this.options.data,
                                            this.options = n.extend(!0, {}, this.options),
                                        t && (this.options.data = i),
                                        window.applyTouchUtilEvents && (n = window.applyTouchUtilEvents(n)),
                                        n.isFunction(window.gcuiASPNetParseOptions) && window.gcuiASPNetParseOptions(this.options),
                                            this.od = !1,
                                            this.pd = !1,
                                            this.Dd("closestCulture", Globalize.findClosestCulture(this.options.culture) || Globalize.findClosestCulture("default")),
                                            this.sd = new e.grid.dataViewWrapper(this),
                                            this.ud = this.element.html(),
                                            this.vd = {},
                                            this.wd = this.element[0].style.cssText,
                                            this.element.addClass("gcui-gcuigrid-root"),
                                            this.element.wrap('<div class="' + this.options.uiCSS.widget + " gcui-gcuigrid " + this.options.uiCSS.content + " " + this.options.uiCSS.cornerAll + '"></div>'),
                                            this.outerDiv = this.element.parent(),
                                            o = this.element[0].style.height,
                                            r = this.element[0].style.width,
                                        o && this.outerDiv.css("height", o),
                                            this.xd = "" == o || "auto" == o,
                                        r && this.outerDiv.css("width", this.element[0].style.width),
                                            this.yd = "" == r || "auto" == r,
                                            this.element.css({
                                                height: "",
                                                width: ""
                                            }),
                                        this.options.disabled && this.disable(),
                                            this.cellFormatter = new e.grid.cellFormatterHelper,
                                            this.rowStyleFormatter = new e.grid.rowStyleFormatterHelper(this),
                                            this.cellStyleFormatter = new e.grid.cellStyleFormatterHelper(this),
                                            this.Dd("viewRenderBounds", {
                                                start: 0,
                                                end: 0
                                            }),
                                        this.Ed() && (this.Dd("viewRenderBounds").start = this.md.index,
                                        this.Fd() && (this.ld = this.md.index)),
                                        this.element.addVisibilityObserver && this.element.addVisibilityObserver(function() {
                                            a.od && !a.pd && a.setSize()
                                        }, "gcuigrid"),
                                            this.zd = 0
                                    }
                                    ,
                                    o.prototype.Ta = function() {
                                        var t, i = this;
                                        try {
                                            this.Gd().dispose(),
                                                this.Hd(!0),
                                            (t = this.Dd("resizer")) && t.dispose(),
                                            (t = this.Dd("frozener")) && t.dispose(),
                                            (t = this.Dd("selectionui")) && t.dispose(),
                                            (t = this.Dd("dragndrop")) && t.dispose(),
                                                this.sd.dispose(),
                                                e.grid.remove$dataByPrefix(this.element, this.Id),
                                            this.element.removeVisibilityObserver && this.element.removeVisibilityObserver(),
                                                this.element.insertBefore(this.outerDiv),
                                                this.outerDiv.remove(),
                                                this.element.html(this.ud),
                                                n.each(this.vd, function(e, t) {
                                                    void 0 === t ? i.element.removeAttr(e) : i.element.attr(e, t)
                                                }),
                                                this.element.removeClass("gcui-gcuigrid-root"),
                                                this.element[0].style.cssText = this.wd
                                        } finally {
                                            this.pd = !0
                                        }
                                    }
                                    ,
                                    o.prototype._init = function() {
                                        this.$superPanelHeader = null,
                                            this.$topPagerDiv = null,
                                            this.$bottomPagerDiv = null,
                                            this.$groupArea = null,
                                            this.Dd("closestCulture", Globalize.findClosestCulture(this.options.culture) || Globalize.findClosestCulture("default")),
                                        this.options.data || (this.Dd("thead") || this.Dd("thead", e.grid.readTableSection(this.element, 1)),
                                        this.Dd("tfoot") || this.Dd("tfoot", e.grid.readTableSection(this.element, 3))),
                                            this.od = this.od || !1,
                                            this.ensureControl(!0)
                                    }
                                    ,
                                    o.prototype._setOption = function(e, t) {
                                        var o = this["preset_" + e], n = this.options[e], r, a;
                                        void 0 !== o && (t = o.apply(this, [t, n])),
                                            r = t !== n,
                                            i.prototype._setOption.apply(this, [e, t]),
                                        r && void 0 !== (a = this["postset_" + e]) && a.apply(this, [t, n])
                                    }
                                    ,
                                    o.prototype.columns = function() {
                                        return this.Dd("columns") || []
                                    }
                                    ,
                                    o.prototype.currentCell = function(t, i, o) {
                                        var n, r = this.Gd(), a = this.Jd();
                                        if (0 === arguments.length)
                                            return n = this.Dd("currentCell"),
                                            n || this.Dd("currentCell", n = e.grid.cellInfo.outsideValue),
                                                n;
                                        if (n = "number" != typeof t ? t.Kd() : new e.grid.cellInfo(t,i),
                                                !n.isEqual(e.grid.cellInfo.outsideValue)) {
                                            if (!n.Ld())
                                                throw "invalid arguments";
                                            if (n.Md(this.Nd()),
                                                n.rowIndex() >= 0 && !(r.Od(a.item(n.rowIndex())).type & e.grid.rowType.data))
                                                return
                                        }
                                        return n.Pd(this),
                                            this.Qd(null, n, {
                                                changeSelection: o || !1,
                                                setFocus: !1
                                            }),
                                            this.Dd("currentCell")
                                    }
                                    ,
                                    o.prototype.data = function() {
                                        return this.sd.dataView().getSource()
                                    }
                                    ,
                                    o.prototype.dataView = function() {
                                        return this.sd.dataView()
                                    }
                                    ,
                                    o.prototype.doRefresh = function(t) {
                                        var i, o, r, a, s, l;
                                        if (n.isPlainObject(t) || (t = {}),
                                                o = this,
                                                r = e.grid.EXPANDO,
                                                a = t && t.virtualScrollData,
                                                !this.od)
                                            try {
                                                this.Rd(this.options.columns, this.options.columnsAutogenerationMode, this.sd.getFieldsInfo(), !0, !0)
                                            } catch (e) {
                                                throw e
                                            } finally {
                                                this.Sd(!0),
                                                    this.od = !0
                                            }
                                        a || (this.Td(),
                                            s = this.sd.data(),
                                            l = this.sd.dataView(),
                                            n.each(this.Dd("leaves"), function() {
                                                this.Ud = s.totals ? s.totals[this.dataKey] : void 0
                                            }),
                                            this.sketchTable = [],
                                            s.data && s.data.length ? (i = this.Dd("leaves"),
                                                n.each(s.data, function(e, t) {
                                                    o.sketchTable.push(o.Vd(t, i))
                                                })) : s.emptyData && (i = this.Dd("visibleLeaves"),
                                                n.each(s.emptyData, function(e, t) {
                                                    o.sketchTable.push(o.Wd(t, i, e === s.emptyData.length - 1))
                                                }))),
                                            this.Xd(t),
                                            a ? this.Yd(t) : this.Sa(t),
                                            this.Zd(t),
                                        t && n.isFunction(t.afterRefresh) && t.afterRefresh.apply(this, [t])
                                    }
                                    ,
                                    o.prototype.beginEdit = function() {
                                        return this.$d(null)
                                    }
                                    ,
                                    o.prototype.endEdit = function() {
                                        return this._d(null)
                                    }
                                    ,
                                    o.prototype.ensureControl = function(t, i) {
                                        this.ae(),
                                        n.isPlainObject(i) || (i = {
                                            data: null,
                                            afterRefresh: null,
                                            beforeRefresh: null
                                        }),
                                            i.be = !0,
                                            this.od ? this.ce() : (this.Rd(this.options.columns, this.options.columnsAutogenerationMode, this.sd.isDataLoaded() && this.sd.getFieldsInfo(), this.sd.isDataLoaded(), !1),
                                            this.sd.isOwnDataView() || new e.grid.settingsManager(this).MapDVToWG()),
                                            this.Sd(!0),
                                        this.od && i && n.isFunction(i.beforeRefresh) && i.beforeRefresh.apply(this),
                                            this.Dd("allowVirtualScrolling", null),
                                            !0 === t ? this.sd.load(i) : (this.doRefresh(i),
                                                this.La())
                                    }
                                    ,
                                    o.prototype.getCellInfo = function(e) {
                                        var t = null;
                                        return e && (e = this.de(e, {
                                            td: !0,
                                            th: !0
                                        })) && (t = this.Gd().getAbsoluteCellInfo(e)),
                                            t
                                    }
                                    ,
                                    o.prototype.getFilterOperatorsByDataType = function(t) {
                                        return new e.grid.filterOperatorsCache(this).getByDataType(t || "string")
                                    }
                                    ,
                                    o.prototype.pageCount = function() {
                                        return this.ee() ? Math.ceil(this.options.totalRows / this.options.pageSize) || 1 : this.options.allowPaging ? this.sd.dataView().pageCount() : 1
                                    }
                                    ,
                                    o.prototype.fe = function() {
                                        return !1
                                    }
                                    ,
                                    o.prototype.ge = function() {
                                        return this.options.pageIndex
                                    }
                                    ,
                                    o.prototype.setSize = function(e, t) {
                                        var i = this.Gd()
                                            , o = {
                                            type: "",
                                            hScrollValue: null,
                                            vScrollValue: null
                                        }
                                            , r = this.outerDiv
                                            , a = this.Dd("frozener")
                                            , s = this.Dd("visibleLeaves")
                                            , l = [];
                                        i && i.getScrollValue && (o = i.getScrollValue()),
                                        (e || 0 === e) && (this.yd = !1,
                                            r.width(e)),
                                        (t || 0 === t) && (this.xd = !1,
                                            r.height(t)),
                                            n.each(s, function(e, t) {
                                                var o = i.getHeaderCell(e)
                                                    , r = i.getJoinedCols(e);
                                                n(o).css("width", ""),
                                                    n.each(r, function(e, t) {
                                                        n(t).css("width", "")
                                                    })
                                            }),
                                            this.Gd().updateSplits(o),
                                        a && a.refresh()
                                    }
                                    ,
                                    o.prototype.selection = function() {
                                        var t = this.Dd("selection");
                                        return t || this.Dd("selection", t = new e.grid.selection(this)),
                                            t
                                    }
                                    ,
                                    o.prototype.he = function(e, t) {
                                        var i = this.ie(this.currentCell().cellIndex())
                                            , o = this.selection();
                                        i = this.currentCell(i, null, !0)
                                    }
                                    ,
                                    o.prototype.je = function() {
                                        this.options.pageIndex = 0;
                                        var e = this.Dd("viewRenderBounds");
                                        e.start = e.end = 0
                                    }
                                    ,
                                    o.prototype.ke = function() {
                                        this.le(),
                                            this._trigger("dataLoading")
                                    }
                                    ,
                                    o.prototype.me = function(t) {
                                        new e.grid.settingsManager(this).MapDVToWG(),
                                            this._trigger("dataLoaded"),
                                            this.doRefresh(t),
                                            this.La()
                                    }
                                    ,
                                    o.prototype.oe = function() {}
                                    ,
                                    o.prototype.ae = function() {
                                        this.le(),
                                            this._trigger("loading")
                                    }
                                    ,
                                    o.prototype.La = function() {
                                        this.pe(),
                                            this._trigger("loaded")
                                    }
                                    ,
                                    o.prototype.Vd = function(t, i) {
                                        var o, n, r, a, s, l, c = [], d = e.data.Expando.getFrom(t.values, !1), p = d ? d[e.grid.EXPANDO] : null;
                                        for (o = 0,
                                                 n = i.length; o < n; o++)
                                            r = i[o],
                                            e.grid.validDataKey(r.dataKey) && (a = p && p.cellsAttributes ? p.cellsAttributes[r.dataKey] : {},
                                                s = this.sd.getValue(t.values, r.dataKey),
                                                c.push({
                                                    value: this.parse(r, s),
                                                    qe: a || {},
                                                    re: {}
                                                }));
                                        return c.originalRowIndex = t.originalRowIndex,
                                            c.rowType = e.grid.rowType.data,
                                        t.originalRowIndex % 2 != 0 && (c.rowType |= e.grid.rowType.dataAlt),
                                            c.re = {},
                                            c.qe = p && p.rowAttributes ? p.rowAttributes : {},
                                            c
                                    }
                                    ,
                                    o.prototype.Wd = function(t, i, o) {
                                        var n, r, a = [], s = i.length;
                                        for (n = 0,
                                                 r = t.length; n < r; n++)
                                            a.push({
                                                html: t[n],
                                                qe: {
                                                    colSpan: s > 0 && o ? s : 1
                                                },
                                                re: {}
                                            });
                                        return a.rowType = e.grid.rowType.emptyDataRow,
                                            a.re = {},
                                            a.qe = {},
                                            a
                                    }
                                    ,
                                    o.prototype.Rd = function(i, o, r, a, s) {
                                        e.grid.traverse(i, function(e) {
                                            e.isBand = n.isArray(e.columns) || "c1band" === e.clientType,
                                                e.te = e.dataKey,
                                                e.ue = e.headerText
                                        }),
                                            (new e.grid.bandProcessor).getVisibleHeight(i, !0);
                                        var l = []
                                            , c = this.ve()
                                            , d = this.we()
                                            , p = (o || "").toLowerCase()
                                            , u = this;
                                        a && e.grid.columnsGenerator.generate(p, r, i),
                                            e.grid.setTraverseIndex(i),
                                            e.grid.traverse(i, function(i) {
                                                i.isBand = n.isArray(i.columns) || "c1band" === i.clientType,
                                                    e.grid.shallowMerge(i, t.c1basefield.prototype.options),
                                                    i.isBand ? i.clientType = "c1band" : (e.grid.shallowMerge(i, t.c1field.prototype.options),
                                                        i.groupInfo = i.groupInfo || {},
                                                        e.grid.shallowMerge(i.groupInfo, t.c1field.prototype.options.groupInfo),
                                                    i.clientType || (i.clientType = "c1field")),
                                                i.isLeaf && !i.isBand && l.push(i)
                                            }),
                                            this.Dd("leaves", l),
                                        a && n.each(l, n.proxy(function(t, i) {
                                            var o = "number" == typeof i.dataKey ? i.dataKey : t;
                                            "merge" !== p && !0 !== i.dynamic || void 0 === i.headerText && (u.sd && u.sd.isBoundedToDOM() && c && o < c.length ? i.headerText = n.trim(c[o]) : e.grid.validDataKey(i.dataKey) && (i.headerText = "" + i.dataKey)),
                                            u.sd && u.sd.isBoundedToDOM() && d && o < d.length && (i.xe = n.trim(d[o]))
                                        }, this))
                                    }
                                    ,
                                    o.prototype.Td = function() {
                                        var t = [], i = [], o;
                                        this.ye() && (o = e.grid.createDynamicField({
                                            clientType: "c1basefield",
                                            dataIndex: -1,
                                            travIdx: -1,
                                            parentVis: !0,
                                            allowMoving: !1,
                                            allowSizing: !1,
                                            allowSort: !1,
                                            isRowHeader: !0
                                        }),
                                            o.owner = this,
                                            t.push(o)),
                                            n.each(this.options.columns, function(e, i) {
                                                t.push(i)
                                            }),
                                            this.ze((new e.grid.bandProcessor).generateSpanTable(t, i)),
                                            this.Dd("leaves", i),
                                            this.Ae()
                                    }
                                    ,
                                    o.prototype.Ae = function() {
                                        var t = this.Dd("leaves"), i = this.sd.getFieldsInfo(), o, r = 0, a = 0, s = this;
                                        this.Dd("visibleLeaves", n.grep(t, function(t, s) {
                                            return t.leavesIdx = s,
                                                e.grid.validDataKey(t.dataKey) ? t.dataIndex = r++ : t.dataIndex = -1,
                                            t.isBand || (o = i[t.dataKey],
                                            o && (t.Be = o.type,
                                                t.Ce = o.format),
                                            n.isFunction(t.dataParser) && (t.dataParser = new t.dataParser)),
                                            !!t.parentVis && (t.visLeavesIdx = a++,
                                                !0)
                                        }))
                                    }
                                    ,
                                    o.prototype.Ed = function() {
                                        var e = this.Dd("allowVirtualScrolling");
                                        return e || (e = this.Dd("allowVirtualScrolling", !this.options.allowPaging && this.options.allowVirtualScrolling && this.options.staticRowIndex < 0 && "none" !== this.options.scrollMode && !this.De())),
                                            e
                                    }
                                    ,
                                    o.prototype.Ee = function(t) {
                                        void 0 === t && (t = !1);
                                        var i = this.Dd("dragndrop");
                                        return !i && t && this.Dd("dragndrop", i = new e.grid.uiDragndrop(this)),
                                            i
                                    }
                                    ,
                                    o.prototype.Fe = function() {
                                        return this.Gd().headerRows()
                                    }
                                    ,
                                    o.prototype.Ge = function() {
                                        return this.Gd().filterRow()
                                    }
                                    ,
                                    o.prototype.Jd = function() {
                                        return this.Gd().bodyRows()
                                    }
                                    ,
                                    o.prototype.He = function(t) {
                                        var i = this
                                            , o = new e.grid.filterOperatorsCache(this);
                                        n.each(t, function(e, t) {
                                            if (t.name) {
                                                var i = o.getByName(t.name);
                                                i && (i.displayName = t.displayName)
                                            }
                                        })
                                    }
                                    ,
                                    o.prototype.Ie = function(t) {
                                        var i = this.Dd("selectionui");
                                        return !i && t && this.Dd("selectionui", i = new e.grid.uiSelection(this)),
                                            i
                                    }
                                    ,
                                    o.prototype.postset_allowColMoving = function(e, t) {
                                        var i, o = this;
                                        n.each(this.columns(), function(t, i) {
                                            e ? o.Ee(!0).attach(i) : o.Ee(!0).detach(i)
                                        }),
                                        (i = this.Dd("groupedWidgets")) && n.each(i, function(t, i) {
                                            e ? o.Ee(!0).attach(i) : o.Ee(!0).detach(i)
                                        })
                                    }
                                    ,
                                    o.prototype.postset_allowSorting = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_columns = function(e, t) {
                                        this.od = !1,
                                            this.ensureControl(!0)
                                    }
                                    ,
                                    o.prototype.postset_allowPaging = function(e, t) {
                                        this.ensureControl(!0)
                                    }
                                    ,
                                    o.prototype.postset_culture = function(e, t) {
                                        throw "read-only"
                                    }
                                    ,
                                    o.prototype.postset_customFilterOperators = function(e, t) {
                                        var i = this.sd.dataView()
                                    }
                                    ,
                                    o.prototype.postset_data = function(t, i) {
                                        this.Sd(!1),
                                            e.grid.traverse(this.options.columns, function(e, t) {
                                                if (e.dynamic) {
                                                    var i = n.inArray(e, t);
                                                    i >= 0 && t.splice(i, 1)
                                                } else
                                                    e.dataKey = e.te,
                                                        e.headerText = e.ue
                                            }),
                                            this.od = !1,
                                        this.sd && this.sd.dispose(),
                                            this.sd = new e.grid.dataViewWrapper(this),
                                            this.ensureControl(!0)
                                    }
                                    ,
                                    o.prototype.postset_disabled = function(t, i) {
                                        var o = this
                                            , n = this.Gd();
                                        e.grid.iterateChildrenWidgets(this.outerDiv, function(e, i) {
                                            i !== o && i.option("disabled", t)
                                        }),
                                        n && n.ensureDisabledState()
                                    }
                                    ,
                                    o.prototype.postset_groupIndent = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_groupAreaCaption = function(e, t) {
                                        var i = this.Je();
                                        !this.$groupArea || i && i.length || this.$groupArea.html(e || "&nbsp;")
                                    }
                                    ,
                                    o.prototype.postset_highlightCurrentCell = function(e, t) {
                                        var i = this.currentCell();
                                        i && i.Ld() && this.Ke(i, e)
                                    }
                                    ,
                                    o.prototype.preset_pageIndex = function(e, t) {
                                        if (isNaN(e))
                                            throw "out of range";
                                        var i = this.pageCount(), o = function(e) {
                                            return e > i - 1 && (e = i - 1),
                                            e < 0 && (e = 0),
                                                e
                                        }, n;
                                        return e = o(e),
                                        this.options.allowPaging && e !== t && (n = {
                                            newPageIndex: e
                                        },
                                            e = this.Le(n) ? o(n.newPageIndex) : t),
                                            e
                                    }
                                    ,
                                    o.prototype.postset_pageIndex = function(e, t) {
                                        if (this.options.allowPaging) {
                                            var i = {
                                                newPageIndex: e
                                            };
                                            this.ee() ? (this.ce(),
                                                this.Me(i)) : this.ensureControl(!0, {
                                                afterRefresh: function() {
                                                    this.Me(i)
                                                }
                                            })
                                        }
                                    }
                                    ,
                                    o.prototype.preset_pageSize = function(e, t) {
                                        if (isNaN(e))
                                            throw "out of range";
                                        return e <= 0 && (e = 1),
                                            e
                                    }
                                    ,
                                    o.prototype.postset_pageSize = function(e, t) {
                                        this.je(),
                                        this.options.allowPaging && !this.ee() && this.ensureControl(!0)
                                    }
                                    ,
                                    o.prototype.postset_pagerSettings = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_scrollMode = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_selectionMode = function(t, i) {
                                        var o = this.selection()
                                            , n = this.currentCell()
                                            , r = this.selection().selectedCells().length();
                                        o.beginUpdate(),
                                            o.clear(),
                                        n && n.Ld() && r && o.Ne(new e.grid.cellInfoRange(n,n), !1, !1, e.grid.cellRangeExtendMode.none, null),
                                            o.endUpdate(),
                                            this.Gd().toggleDOMSelection("none" === t)
                                    }
                                    ,
                                    o.prototype.postset_showFilter = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_showGroupArea = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_showRowHeader = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_staticRowIndex = function() {
                                        "none" !== this.options.scrollMode && this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_staticColumnIndex = function() {
                                        "none" !== this.options.scrollMode && this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.postset_allowVirtualScrolling = function(e, t) {
                                        this.ensureControl(!1)
                                    }
                                    ,
                                    o.prototype.preset_allowVirtualScrolling = function(e, t) {
                                        if (isNaN(e) || e < 0)
                                            throw "out of range";
                                        return e
                                    }
                                    ,
                                    o.prototype.le = function() {
                                        if (!this.Cd) {
                                            var e = this.options.uiCSS
                                                , t = this.outerDiv.append('<div class="gcui-gcuigrid-overlay ' + e.overlay + '"></div><span class="gcui-gcuigrid-loadingtext ' + e.content + " " + e.cornerAll + '"><span class="' + e.icon + ' ui-icon-clock"></span>' + this.options.loadingText + "</span>").find("> .gcui-gcuigrid-loadingtext");
                                            t.position({
                                                my: "center",
                                                at: "center center",
                                                of: this.outerDiv,
                                                collision: "none"
                                            }),
                                                this.Cd = !0
                                        }
                                    }
                                    ,
                                    o.prototype.ee = function() {
                                        return this.options.allowPaging && this.options.totalRows >= 0
                                    }
                                    ,
                                    o.prototype.pe = function() {
                                        if (this.Cd)
                                            try {
                                                this.outerDiv.find("> .gcui-gcuigrid-overlay, > .gcui-gcuigrid-loadingtext").remove()
                                            } finally {
                                                this.Cd = !1
                                            }
                                    }
                                    ,
                                    o.prototype.Oe = function(e, t) {
                                        var i, o = t.clientType;
                                        !o && t.isBand && (o = "c1band"),
                                            t = n.extend({}, t, {
                                                disabled: this.options.disabled
                                            });
                                        try {
                                            switch (n.data(e[0], "gcuigridowner", this),
                                                o) {
                                                case "c1basefield":
                                                    i = e.c1basefield(t);
                                                    break;
                                                case "c1band":
                                                    i = e.c1band(t);
                                                    break;
                                                default:
                                                    i = e.c1field(t)
                                            }
                                        } finally {
                                            n.removeData(e[0], "gcuigridowner")
                                        }
                                        return i
                                    }
                                    ,
                                    o.prototype.ce = function() {
                                        this.od && this.Pe && (this.Sd(!1),
                                            this.Qe(),
                                            this.Sd(!0))
                                    }
                                    ,
                                    o.prototype.Dd = function(t, i) {
                                        return e.grid.dataPrefix(this.element, this.Id, t, i)
                                    }
                                    ,
                                    o.prototype.Re = function(e) {
                                        var t = this.Id + e;
                                        this.element.removeData(t)
                                    }
                                    ,
                                    o.prototype.Se = function(t) {
                                        var i = this.Dd("leaves"), o, r;
                                        return i && this.options.showFooter ? o = n.map(i, function(i, o) {
                                            return !i.isBand && e.grid.validDataKey(i.dataKey) && i.aggregate && "none" !== i.aggregate ? t ? [{
                                                column: i,
                                                aggregate: i.aggregate
                                            }] : [{
                                                dataKey: i.dataKey,
                                                aggregate: i.aggregate
                                            }] : null
                                        }) : []
                                    }
                                    ,
                                    o.prototype.Qe = function() {
                                        var t = e.grid.flatten(this.options.columns);
                                        n.each(this.columns(), function(e, i) {
                                            delete i.options.columns;
                                            var o = t[i.options.travIdx];
                                            n.extend(!0, o, i.options),
                                                o.filterValue = i.options.filterValue,
                                                o.filterOperator = i.options.filterOperator
                                        })
                                    }
                                    ,
                                    o.prototype.Te = function() {
                                        n.each(this.columns(), function(e, t) {
                                            t.destroy()
                                        });
                                        var t = [], i = this.Fe(), o, r, a, s, l, c, d;
                                        if (i && i.length())
                                            for (o = [],
                                                     e.grid.traverse(this.options.columns, function(e) {
                                                         e.parentVis && o.push(e)
                                                     }),
                                                     r = 0,
                                                     a = o.length; r < a; r++)
                                                s = o[r],
                                                    l = i.item(s.thY),
                                                    c = e.grid.rowAccessor.getCell(l, s.thX),
                                                    d = this.Oe(n(c), s),
                                                    t.push(d.data(e.grid.widgetName(d)));
                                        this.Dd("columns", t)
                                    }
                                    ,
                                    o.prototype.Je = function(e) {
                                        var t, i, o, r;
                                        return e = !(t = this.Dd("groupedColumns")) || e,
                                        e && (t = [],
                                            i = this.Dd("leaves") || [],
                                            o = !1,
                                            r = function(e) {
                                                return e.groupInfo && e.groupInfo.position && "none" !== e.groupInfo.position
                                            }
                                            ,
                                            n.each(i, function(e, i) {
                                                r(i) ? (o = o || void 0 === i.groupedIndex) || t.push(i) : delete i.groupedIndex
                                            }),
                                            o ? n.each(i, function(e, i) {
                                                r(i) && (i.groupedIndex = t.length,
                                                    t.push(i))
                                            }) : (t.sort(function(e, t) {
                                                return e.groupedIndex - t.groupedIndex
                                            }),
                                                n.each(t, function(e, t) {
                                                    t.groupedIndex = e
                                                })),
                                            this.Dd("groupedColumns", t)),
                                        t || []
                                    }
                                    ,
                                    o.prototype.Sd = function(t) {
                                        if (t) {
                                            var i = this;
                                            e.grid.traverse(this.options.columns, function(e) {
                                                e.owner = i;
                                                var t, o, n;
                                                if ((t = e.groupInfo) && (t.owner = e,
                                                        t.expandInfo))
                                                    for (o = 0,
                                                             n = t.expandInfo.length; o < n; o++)
                                                        t.expandInfo[o].owner = t
                                            })
                                        } else
                                            e.grid.traverse(this.options.columns, function(e) {
                                                delete e.owner;
                                                var t, i, o;
                                                if ((t = e.groupInfo) && (delete t.owner,
                                                        t.expandInfo))
                                                    for (i = 0,
                                                             o = t.expandInfo.length; i < o; i++)
                                                        delete t.expandInfo[i].owner
                                            })
                                    }
                                    ,
                                    o.prototype.Ue = function(e) {
                                        var t = this.Ve();
                                        return e.start < 0 && (e.start = 0),
                                            e.start = Math.min(e.start, t - 1),
                                        e.end < 0 && (e.end = 0),
                                            e.end = Math.min(e.end, t - 1),
                                            e
                                    }
                                    ,
                                    o.prototype.Sa = function(t) {
                                        (new e.grid.grouper).group(this, this.sketchTable, this.Dd("leaves")),
                                            (new e.grid.merger).merge(this.sketchTable, this.Dd("visibleLeaves"));
                                        var i = this.Dd("viewRenderBounds");
                                        this.Ue(i),
                                            "none" !== this.options.scrollMode ? this.Dd("view", new e.grid.fixedView(this,this.Dd("viewRenderBounds"))) : this.Dd("view", new e.grid.flatView(this,this.Dd("viewRenderBounds"))),
                                            this.We(),
                                            this.Sd(!1),
                                            this.Te(),
                                            this.Sd(!0),
                                        this.options.allowPaging && (this.$topPagerDiv && this.$topPagerDiv.gcuipager(this.Xe()).css("zIndex", 5),
                                        this.$bottomPagerDiv && this.$bottomPagerDiv.gcuipager(this.Xe()).css("zIndex", 5))
                                    }
                                    ,
                                    o.prototype.Yd = function(e) {
                                        var t = e.virtualScrollData
                                            , i = {
                                            top: 0,
                                            bottom: 0
                                        };
                                        t.data && (i = this.Ye(t)),
                                            this.Ze(t, i),
                                            this.$e(t)
                                    }
                                    ,
                                    o.prototype.Ze = function(e, t) {
                                        var i = this.Dd("viewRenderBounds"), o = this.Gd(), n = e.newBounds, r = this.Gd().bodyRows(), a, s, l, c;
                                        switch (e.mode) {
                                            case "reset":
                                                break;
                                            case "overlapBottom":
                                                for (a = {
                                                    start: n.start - i.start,
                                                    end: i.end - i.start
                                                },
                                                         l = n.start - i.start,
                                                         s = a.start; s <= a.end; s++)
                                                    c = o.Od(r.item(s), !1),
                                                        c.sectionRowIndex -= l,
                                                        c.dataItemIndex += t.top,
                                                        o._e(c.$rows, c);
                                                break;
                                            case "overlapTop":
                                                for (a = {
                                                    start: i.start - i.start,
                                                    end: n.end - i.start
                                                },
                                                         l = i.start - n.start,
                                                         s = a.start; s <= a.end; s++)
                                                    c = o.Od(r.item(s), !1),
                                                        c.sectionRowIndex += l,
                                                        c.dataItemIndex += t.top,
                                                        o._e(c.$rows, c)
                                        }
                                    }
                                    ,
                                    o.prototype.$e = function(t) {
                                        var i = this.Dd("viewRenderBounds"), o = this.Gd(), n = function(t) {
                                            return t.rowType & e.grid.rowType.data ? t.originalRowIndex : -1
                                        }, r, a, s, l;
                                        switch (t.mode) {
                                            case "reset":
                                                for (o.af(),
                                                         a = t.newBounds.start; a <= t.newBounds.end; a++)
                                                    s = this.sketchTable[a - this.ld],
                                                        o.bf(s, -1, n(s), a);
                                                o.cf();
                                                break;
                                            case "overlapBottom":
                                                for (r = {
                                                    start: t.newBounds.start,
                                                    end: i.end
                                                },
                                                         a = 0; a < r.start - i.start; a++)
                                                    o.df(0, !1);
                                                for (a = r.end + 1; a <= t.newBounds.end; a++)
                                                    s = this.sketchTable[a - this.ld],
                                                        o.bf(s, -1, n(s), a);
                                                break;
                                            case "overlapTop":
                                                for (r = {
                                                    start: i.start,
                                                    end: t.newBounds.end
                                                },
                                                         a = 0; a < i.end - t.newBounds.end; a++)
                                                    o.df(r.end - r.start + 1, !1);
                                                for (l = 0,
                                                         a = t.newBounds.start; a < i.start; a++)
                                                    s = this.sketchTable[a - this.ld],
                                                        o.bf(s, l++, n(s), a)
                                        }
                                    }
                                    ,
                                    o.prototype.Ye = function(e) {
                                        var t = this.sd, i = t.dataView().getSource(), o, n = this.Dd("leaves"), r, a, s, l = 0, c = {
                                            top: 0,
                                            bottom: 0
                                        }, d, p = this.ef();
                                        switch (e.mode) {
                                            case "reset":
                                                for (this.sketchTable.splice(0, this.sketchTable.length),
                                                         t.ff(0, i.length),
                                                         this.ld = e.request.index,
                                                         r = 0; r < e.data.length; r++)
                                                    t.gf(o = e.data[r]),
                                                        this.sketchTable.push(this.Vd(t.hf(o, r), n));
                                                break;
                                            case "overlapBottom":
                                                for (r = 0; r < e.data.length; r++)
                                                    t.gf(o = e.data[r]),
                                                        this.sketchTable.push(this.Vd(t.hf(o, i.length - 1), n));
                                                c.bottom = e.data.length;
                                                break;
                                            case "overlapTop":
                                                for (r = e.data.length - 1; r >= 0; r--)
                                                    t.ff(0, 0, o = e.data[r]),
                                                        this.sketchTable.splice(0, 0, this.Vd(t.hf(o, r), n));
                                                this.ld = e.request.index,
                                                    c.top = e.data.length
                                        }
                                        for (a = this.Ue({
                                            start: e.newBounds.start,
                                            end: e.newBounds.end
                                        }),
                                                 s = {
                                                     start: this.ld,
                                                     end: this.ld + i.length - 1
                                                 },
                                                 l = s.end - a.end - p,
                                             l > 0 && (c.bottom -= l,
                                                 t.ff(i.length - l, l),
                                                 this.sketchTable.splice(this.sketchTable.length - l, l)),
                                                 l = a.start - s.start - p,
                                             l > 0 && (c.top -= l,
                                                 t.ff(0, l),
                                                 this.sketchTable.splice(0, l),
                                                 this.ld += l),
                                                 r = 0; r < this.sketchTable.length; r++)
                                            this.sketchTable[r].originalRowIndex = r;
                                        return t.if(),
                                            c
                                    }
                                    ,
                                    o.prototype.jf = function() {
                                        return !0 === this.options.allowPaging
                                    }
                                    ,
                                    o.prototype.kf = function() {
                                        return this.O
                                    }
                                    ,
                                    o.prototype.We = function() {
                                        var e = this.Gd(), t = this.options, i = this.options.uiCSS, o;
                                        e.render(),
                                            o = this.outerDiv,
                                        "none" !== t.scrollMode && (o = this.outerDiv.find("div.gcui-gcuigrid-scroller:first")),
                                            this.$superPanelHeader = null,
                                        this.$topPagerDiv && (this.$topPagerDiv.data("gcui-gcuipager") && this.$topPagerDiv.gcuipager("destroy"),
                                            this.$topPagerDiv.remove()),
                                            this.$topPagerDiv = null,
                                        !this.jf() || "top" !== t.pagerSettings.position && "topAndBottom" !== t.pagerSettings.position || this.$topPagerDiv || (o.prepend(this.$superPanelHeader = n('<div class="gcui-superpanel-header"></div>')),
                                            this.$superPanelHeader.prepend(this.$topPagerDiv = n('<div class="gcui-gcuigrid-header ' + i.header + " " + i.cornerTop + '"></div>'))),
                                            t.showGroupArea ? this.lf(o) : this.$groupArea = null,
                                        this.$bottomPagerDiv && (this.$bottomPagerDiv.data("gcui-gcuipager") && this.$bottomPagerDiv.gcuipager("destroy"),
                                            this.$bottomPagerDiv.remove()),
                                            this.$bottomPagerDiv = null,
                                        !this.jf() || "bottom" !== t.pagerSettings.position && "topAndBottom" !== t.pagerSettings.position || this.$bottomPagerDiv || o.append(this.$bottomPagerDiv = n('<div class="gcui-gcuigrid-footer gcui-superpanel-footer ' + i.stateDefault + " " + i.cornerBottom + '"></div>'))
                                    }
                                    ,
                                    o.prototype.lf = function(e) {
                                        var t = this
                                            , i = this.Je()
                                            , o = [];
                                        this.$groupArea = n('<div class="' + this.options.uiCSS.content + " " + this.options.uiCSS.helperClearFix + '"></div>'),
                                            i.length > 0 ? n.each(i, function(e, i) {
                                                var r = n('<a href="#"></a>').appendTo(t.$groupArea);
                                                try {
                                                    n.data(r[0], "gcuigridowner", t),
                                                        r.c1groupedfield(n.extend({}, {
                                                            allowMoving: i.allowMoving,
                                                            allowSort: i.allowSort,
                                                            dataIndex: i.dataIndex,
                                                            headerText: i.headerText,
                                                            isBand: i.isBand,
                                                            isLeaf: i.isLeaf,
                                                            linearIdx: i.linearIdx,
                                                            parentIdx: i.parentIdx,
                                                            sortDirection: i.sortDirection,
                                                            travIdx: i.travIdx,
                                                            groupedIndex: i.groupedIndex
                                                        }, {
                                                            disabled: t.options.disabled
                                                        }))
                                                } finally {
                                                    n.removeData(r[0], "gcuigridowner")
                                                }
                                                o.push(r.data("gcui-c1groupedfield"))
                                            }) : this.$groupArea.addClass("gcui-gcuigrid-group-area").css("padding", 0).html(this.options.groupAreaCaption || "&nbsp;"),
                                            this.Dd("groupedWidgets", o),
                                        this.$superPanelHeader || e.prepend(this.$superPanelHeader = n('<div class="gcui-superpanel-header"></div>')),
                                            this.$superPanelHeader.prepend(this.$groupArea),
                                            this.Ee(!0).attachGroupArea(this.$groupArea)
                                    }
                                    ,
                                    o.prototype.Xe = function() {
                                        return n.extend({}, this.options.pagerSettings, {
                                            disabled: this.options.disabled,
                                            pageCount: this.pageCount(),
                                            pageIndex: this.options.pageIndex,
                                            pageIndexChanging: n.proxy(this.mf, this),
                                            pageIndexChanged: n.proxy(this.nf, this)
                                        })
                                    }
                                    ,
                                    o.prototype.ye = function() {
                                        return !0 === this.options.showRowHeader && "right" !== this.options.staticColumnsAlignment
                                    }
                                    ,
                                    o.prototype.pf = function() {
                                        var e = this.Gd()
                                            , t = e.focusableElement()
                                            , i = this;
                                        t.bind("keydown." + this.widgetName, n.proxy(this.qf, this)),
                                            t.bind("keypress." + this.widgetName, n.proxy(this.rf, this)),
                                            n.each(e.subTables(), function(e, t) {
                                                var o = t.element();
                                                o && (o.tHead && n(o.tHead).bind("click." + i.widgetName, n.proxy(i.Za, i)),
                                                o.tBodies.length && n(o.tBodies[0]).bind("click." + i.widgetName, n.proxy(i.Za, i)).bind("dblclick." + i.widgetName, n.proxy(i.tf, i)).bind("mousemove." + i.widgetName, n.proxy(i.uf, i)).bind("mouseout." + i.widgetName, n.proxy(i.vf, i)))
                                            }),
                                            n(window).bind("resize." + this.widgetName + "." + this.rd, n.proxy(this.wf, this))
                                    }
                                    ,
                                    o.prototype.Hd = function(e) {
                                        var t = this.Gd(), i = this, o;
                                        this.nd = 0,
                                            n(window).unbind("resize." + this.widgetName + "." + this.rd),
                                        t && (o = t.focusableElement(),
                                            o.unbind("keydown." + this.widgetName),
                                            o.unbind("keypress." + this.widgetName),
                                            n.each(t.subTables(), function() {
                                                var e = this.element();
                                                e && (e.tHead && n(e.tHead).unbind("." + i.widgetName),
                                                e.tBodies.length && n(e.tBodies[0]).unbind("." + i.widgetName))
                                            }))
                                    }
                                    ,
                                    o.prototype.xf = function(t, i) {
                                        var o = this.options.columns, r = t.travIdx, a, s;
                                        t && this.options.allowSorting && (a = "none" === t.sortDirection ? "ascending" : "ascending" === t.sortDirection ? "descending" : "ascending",
                                            s = {
                                                column: t,
                                                sortDirection: a,
                                                sortCommand: t.dataKey + " " + ("ascending" === a ? "asc" : "desc")
                                            },
                                        this.yf(s) && (t.sortDirection = s.sortDirection,
                                            i ? t.sortOrder = this.zf++ : (this.zf = 1e3,
                                                n.each(this.columns(), function(e, t) {
                                                    t.options.sortOrder = 0,
                                                    t.options.travIdx === r || t.options.groupInfo && "none" !== t.options.groupInfo.position || (t.options.sortDirection = "none")
                                                }),
                                                e.grid.traverse(o, function(e) {
                                                    e.sortOrder = 0,
                                                    e.travIdx === r || e.groupInfo && "none" !== e.groupInfo.position || (e.sortDirection = "none")
                                                })),
                                            s = {
                                                column: t,
                                                sortDirection: t.sortDirection,
                                                sortCommand: t.dataKey + " " + ("ascending" === t.sortDirection ? "asc" : "desc")
                                            },
                                            this.ee() ? (this.ce(),
                                                this.Af(s)) : this.ensureControl(!0, {
                                                afterRefresh: function() {
                                                    this.Af(s)
                                                }
                                            })))
                                    }
                                    ,
                                    o.prototype.Bf = function(t, i, o, r, a) {
                                        var s = e.grid.getColumnByTravIdx(this.options.columns, t)
                                            , l = e.grid.getColumnByTravIdx(this.options.columns, i)
                                            , c = r ? "groupArea" : "columns"
                                            , d = a ? "groupArea" : "columns";
                                        a ? this.Cf({
                                            drag: s.found,
                                            drop: l ? l.found : null,
                                            dragSource: c,
                                            dropSource: d,
                                            at: o
                                        }) && this.ensureControl(!0, {
                                            beforeRefresh: function() {
                                                if (l)
                                                    switch (o) {
                                                        case "left":
                                                            s.found.groupedIndex = l.found.groupedIndex - .5;
                                                            break;
                                                        case "right":
                                                            s.found.groupedIndex = l.found.groupedIndex + .5
                                                    }
                                                else
                                                    s.found.groupedIndex = 0;
                                                r || n.extend(!0, s.found, {
                                                    groupInfo: {
                                                        position: "header"
                                                    }
                                                })
                                            },
                                            afterRefresh: function() {
                                                this.Df({
                                                    drag: s.found,
                                                    drop: l ? l.found : null,
                                                    dragSource: c,
                                                    dropSource: d,
                                                    at: o
                                                })
                                            }
                                        }) : this.Ef({
                                            drag: s.found,
                                            drop: l.found,
                                            at: o
                                        }) && this.ensureControl(!1, {
                                            beforeRefresh: function() {
                                                switch (s.at.splice(s.found.linearIdx, 1),
                                                    o) {
                                                    case "left":
                                                        s.at === l.at && s.found.linearIdx < l.found.linearIdx ? l.at.splice(l.found.linearIdx - 1, 0, s.found) : l.at.splice(l.found.linearIdx, 0, s.found);
                                                        break;
                                                    case "right":
                                                        s.at === l.at && s.found.linearIdx < l.found.linearIdx ? l.at.splice(l.found.linearIdx, 0, s.found) : l.at.splice(l.found.linearIdx + 1, 0, s.found);
                                                        break;
                                                    case "center":
                                                        l.found.columns.push(s.found)
                                                }
                                                e.grid.setTraverseIndex(this.options.columns)
                                            },
                                            afterRefresh: function() {
                                                this.Ff({
                                                    drag: s.found,
                                                    drop: l.found,
                                                    at: o
                                                })
                                            }
                                        })
                                    }
                                    ,
                                    o.prototype.Gf = function(t, i, o) {
                                        var n = new e.grid.filterOperatorsCache(this).getByName(i), r, a, s;
                                        n && (n.arity > 1 ? (r = this.parse(t.options, o),
                                            a = null !== r && ("string" === e.grid.getDataType(t.options) || !isNaN(r))) : a = !0,
                                        a && (s = {
                                            column: t.options,
                                            operator: n.name,
                                            value: r
                                        },
                                        this.Hf(s) && (t.options.filterValue = s.value,
                                            t.options.filterOperator = s.operator,
                                            this.je(),
                                            this.ee() ? (this.ce(),
                                                this.If({
                                                    column: t.options
                                                })) : this.ensureControl(!0, {
                                                afterRefresh: function() {
                                                    this.If({
                                                        column: t.options
                                                    })
                                                }
                                            }))))
                                    }
                                    ,
                                    o.prototype.Jf = function(t) {
                                        var i = e.grid.getColumnByTravIdx(this.options.columns, t), o;
                                        i && i.found && (o = i.found,
                                        this.Kf({
                                            column: o
                                        }) && this.ensureControl(!0, {
                                            beforeRefresh: function() {
                                                delete o.groupedIndex,
                                                    n.extend(!0, o, {
                                                        groupInfo: {
                                                            position: "none"
                                                        }
                                                    })
                                            },
                                            afterRefresh: function() {
                                                this.Lf({
                                                    column: o
                                                })
                                            }
                                        }))
                                    }
                                    ,
                                    o.prototype.Mf = function(e, t, i, o, r, a) {
                                        this.ensureControl(this.Fd(), {
                                            virtualScrollData: {
                                                newBounds: e,
                                                request: t,
                                                mode: i,
                                                data: a
                                            },
                                            afterRefresh: function(e) {
                                                var t = this.Dd("viewRenderBounds");
                                                n.extend(t, e.virtualScrollData.newBounds),
                                                    this.Gd().Nf(),
                                                    r(o)
                                            }
                                        })
                                    }
                                    ,
                                    o.prototype.Of = function(e, t) {
                                        var i = this.Dd("viewRenderBounds"), o = this.Ue({
                                            start: e,
                                            end: e + this.options.pageSize - 1
                                        }), n = this.Ue({
                                            start: this.ld,
                                            end: this.ld + this.sd.dataView().count() - 1
                                        }), r = null, a;
                                        if (o.start > i.end || o.end < i.start ? a = "reset" : o.start > i.start ? a = "overlapBottom" : o.start < i.start && (a = "overlapTop"),
                                                this.Fd())
                                            switch (a) {
                                                case "reset":
                                                    r = {
                                                        index: e,
                                                        maxCount: this.options.pageSize
                                                    };
                                                    break;
                                                case "overlapBottom":
                                                    o.end > n.end && (r = {
                                                        index: n.end + 1,
                                                        maxCount: this.options.pageSize
                                                    });
                                                    break;
                                                case "overlapTop":
                                                    o.start < n.start && (r = {
                                                        index: Math.max(0, n.start - this.options.pageSize),
                                                        maxCount: 0
                                                    },
                                                        r.maxCount = n.start - r.index)
                                            }
                                        "none" !== a && this.Mf(o, r, a, e, t)
                                    }
                                    ,
                                    o.prototype.Fd = function() {
                                        return !1
                                    }
                                    ,
                                    o.prototype.ef = function() {
                                        return 2 * this.options.pageSize
                                    }
                                    ,
                                    o.prototype.Ef = function(e) {
                                        return this._trigger("columnDropping", null, e)
                                    }
                                    ,
                                    o.prototype.Ff = function(e) {
                                        this._trigger("columnDropped", null, e)
                                    }
                                    ,
                                    o.prototype.Cf = function(e) {
                                        return this._trigger("columnGrouping", null, e)
                                    }
                                    ,
                                    o.prototype.Df = function(e) {
                                        this._trigger("columnGrouped", null, e)
                                    }
                                    ,
                                    o.prototype.Kf = function(e) {
                                        return this._trigger("columnUngrouping", null, e)
                                    }
                                    ,
                                    o.prototype.Lf = function(e) {
                                        this._trigger("columnUngrouped", null, e)
                                    }
                                    ,
                                    o.prototype.Hf = function(e) {
                                        return this._trigger("filtering", null, e)
                                    }
                                    ,
                                    o.prototype.If = function(e) {
                                        this._trigger("filtered", null, e)
                                    }
                                    ,
                                    o.prototype.Pf = function(e) {
                                        this._trigger("filterOperatorsListShowing", null, e)
                                    }
                                    ,
                                    o.prototype.yf = function(e) {
                                        return this._trigger("sorting", null, e)
                                    }
                                    ,
                                    o.prototype.Af = function(e) {
                                        this._trigger("sorted", null, e)
                                    }
                                    ,
                                    o.prototype.Qf = function(t, i) {
                                        var o, n, r, a, s = this.options, l = this.currentCell(), c = this.Rf(l.rowIndex());
                                        if (this.sd.currentPosition(c),
                                            "none" !== s.scrollMode && l && !l.isEqual(e.grid.cellInfo.outsideValue) && this.Gd().scrollTo(l),
                                                this._trigger("currentCellChanged"),
                                                o = t && (t.type || "").toLowerCase() || "",
                                                i.changeSelection) {
                                            if (n = this.selection(),
                                                    r = this.options.selectionMode.toLowerCase(),
                                                    a = i.selectionExtendMode || e.grid.cellRangeExtendMode.none,
                                                    n.beginUpdate(),
                                                    o) {
                                                if (l.Ld())
                                                    switch (o) {
                                                        case "click":
                                                            t.shiftKey && (n.Sf() || "singlerange" === r) || n.Tf(l),
                                                                t.shiftKey && t.ctrlKey ? n.Uf(new e.grid.cellInfoRange(l,l), a) : n.Ne(new e.grid.cellInfoRange(n.Vf(),l), t.ctrlKey, t.shiftKey, a, null);
                                                            break;
                                                        case "keydown":
                                                            t.shiftKey && (n.Sf() || "singlerange" === r) || n.Tf(l),
                                                                n.Ne(new e.grid.cellInfoRange(n.Vf(),l), !1, t.shiftKey, e.grid.cellRangeExtendMode.none, null)
                                                    }
                                            } else
                                                n.clear(),
                                                l.Ld() && (n.Tf(l),
                                                    n.Ne(new e.grid.cellInfoRange(l,l), !1, !1, e.grid.cellRangeExtendMode.none, null));
                                            n.endUpdate()
                                        }
                                        "click" === o && this.Wf() && this.$d(t)
                                    }
                                    ,
                                    o.prototype.Le = function(e) {
                                        return this._trigger("pageIndexChanging", null, e)
                                    }
                                    ,
                                    o.prototype.Me = function(e) {
                                        this._trigger("pageIndexChanged", null, e)
                                    }
                                    ,
                                    o.prototype.mf = function(e, t) {
                                        t.handled = !0
                                    }
                                    ,
                                    o.prototype.nf = function(e, t) {
                                        this._setOption("pageIndex", t.newPageIndex)
                                    }
                                    ,
                                    o.prototype.Xd = function(t) {
                                        var i, o = this.Gd();
                                        this.qd = !1,
                                            t.virtualScrollData ? (this.selection().clear(),
                                            this.options.highlightCurrentCell && this.Ke(this.currentCell(), !1)) : (o && o.dispose(),
                                                this.Hd(!1),
                                                this.element.detach(),
                                                this.element.empty(),
                                                this.outerDiv.empty(),
                                                this.outerDiv.append(this.element),
                                            this.Dd("selectionui") && (this.Dd("selectionui").dispose(),
                                                this.Dd("selectionui", null)),
                                            this.Dd("resizer") && (this.Dd("resizer").dispose(),
                                                this.Dd("resizer", null)),
                                            this.Dd("frozener") && (this.Dd("frozener").dispose(),
                                                this.Dd("frozener", null))),
                                            i = (this.Dd("currentCell") || e.grid.cellInfo.outsideValue).Kd(),
                                            i.Pd(null),
                                            this.Dd("currentCellPrev", i),
                                            this.Dd("currentCell", null),
                                            this._trigger("rendering")
                                    }
                                    ,
                                    o.prototype.Zd = function(t) {
                                        var i = this.Gd(), o, r, a = this.selection().selectedCells().length() > 0;
                                        this.qd = !0,
                                            this.Dd("selection", null),
                                            this.Xf(i.focusableElement(), "tabIndex", 0),
                                            o = this.Dd("currentCellPrev"),
                                            o = this.ie(o.cellIndex()),
                                            o.Yf(!1),
                                        !o.Ld() && this.options.showSelectionOnRender && (o = this.Zf(0)),
                                            this.currentCell(o, null, !0),
                                        t.virtualScrollData || (this.pf(),
                                            this.Ie(!0),
                                            r = new e.grid.uiResizer(this),
                                            n.each(this.columns(), function(e, t) {
                                                var i = t.options;
                                                i.visible && i.parentVis && i.isLeaf && r.addElement(t)
                                            }),
                                            this.Dd("resizer", r),
                                            i.updateSplits(this.md),
                                        "none" !== this.options.scrollMode && this.Dd("frozener", new e.grid.uiFrozener(this))),
                                            this.zd++,
                                            this._trigger("rendered")
                                    }
                                    ,
                                    o.prototype.Za = function(t) {
                                        var i, o, r, a, s, l, c, d;
                                        if (this.$f() && t.target && (i = this.Gd(),
                                                o = this.de(t.target, {
                                                    td: !0,
                                                    th: !0
                                                }),
                                                s = e.grid.cellRangeExtendMode.none,
                                                o)) {
                                            if (n(t.target).hasClass("gcui-gcuigrid-grouptogglebtn"))
                                                return this._f(t),
                                                    t.stopPropagation(),
                                                    !1;
                                            if (r = n(o).closest("tr"),
                                                    !r.length)
                                                return;
                                            a = i.getAbsoluteCellInfo(o),
                                            (r.hasClass("gcui-gcuigrid-datarow") || r.hasClass("gcui-gcuigrid-headerrow")) && ((a.cellIndex() < 0 || a.rowIndex() < 0) && (a.rowIndex() >= 0 ? (a = new e.grid.cellInfo(0,a.rowIndex()),
                                                s = e.grid.cellRangeExtendMode.row) : (a = this.Zf(a.cellIndex()),
                                                s = e.grid.cellRangeExtendMode.column)),
                                                this.Qd(t, a, {
                                                    changeSelection: !0,
                                                    setFocus: !n(t.target).is(":focus"),
                                                    selectionExtendMode: s
                                                })),
                                                d = {
                                                    cell: a
                                                },
                                                this._trigger("cellClicked", null, d)
                                        }
                                    }
                                    ,
                                    o.prototype.tf = function(e) {
                                        this.Wf() || this.$d(e)
                                    }
                                    ,
                                    o.prototype._f = function(t) {
                                        if (this.$f()) {
                                            var i = n(t.target).closest("tr"), o = e.grid.groupHelper, r = o.getGroupInfo(i[0]), a, s;
                                            r && (a = o.getColumnByGroupLevel(this.Dd("leaves"), r.level)) && (s = a.groupInfo.expandInfo[r.index],
                                                s.isExpanded ? s.collapse() : s.expand(t.shiftKey),
                                                this.setSize())
                                        }
                                    }
                                    ,
                                    o.prototype.qf = function(t) {
                                        var i, o, r, a, s, l, c, d, p, u, h, f, g, m, b;
                                        if (!this.$f())
                                            return !0;
                                        if (i = t.target.tagName.toLowerCase(),
                                                o = !1,
                                                a = this.currentCell(),
                                                l = e.getKeyCodeEnum(),
                                            ("input" === i || "option" === i || "select" === i || "textarea" === i) && 0 === n(t.target).closest("tr.gcui-gcuigrid-datarow").length)
                                            return !0;
                                        if (this.options.allowEditing) {
                                            if ((t.which === l.ESCAPE || 113 === t.which) && a.Ld() && a.Yf())
                                                return this._d(t),
                                                    !1;
                                            if (113 === t.which)
                                                return this.$d(t),
                                                    !1
                                        }
                                        if (!this.options.allowKeyboardNavigation || t.which === l.TAB)
                                            return !0;
                                        switch (p = 0,
                                            this.Ed ? (p = this.md.index,
                                                c = new e.grid.cellInfo(a.cellIndex(),a.rowIndex() + p),
                                                d = this.Nd(!0)) : (c = a,
                                                d = this.Nd(!1)),
                                            u = !1,
                                            h = !1,
                                            t.which) {
                                            case l.DOWN:
                                            case l.PAGE_DOWN:
                                                u = !0;
                                            case l.UP:
                                            case l.PAGE_UP:
                                                h = !0;
                                            case l.LEFT:
                                            case l.RIGHT:
                                            case l.HOME:
                                            case l.END:
                                            case l.TAB:
                                                r = this.ag(d, c, t.keyCode, t.shiftKey),
                                                    o = this.bg(t.target, t.which)
                                        }
                                        return !o || (f = this.Nd(!1),
                                            g = this,
                                            this.Ed() && u && r.rowIndex > f.bottomRight().rowIndex() + p || h && r.rowIndex - p < f.topLeft().rowIndex() ? (b = r.rowIndex,
                                            u && (b -= f.cg()),
                                                this.Gd().vsUI.scrollTo(b, function() {
                                                    g.Qd(t, new e.grid.cellInfo(r.cellIndex,r.rowIndex - g.md.index), {
                                                        changeSelection: !0,
                                                        setFocus: !0
                                                    }),
                                                        n(g.Gd().focusableElement()).focus()
                                                })) : this.Qd(t, new e.grid.cellInfo(r.cellIndex,r.rowIndex - p), {
                                                changeSelection: !0,
                                                setFocus: !0
                                            }),
                                            !1)
                                    }
                                    ,
                                    o.prototype.rf = function(e) {
                                        if (this.$f() && this.options.allowEditing) {
                                            var t = e.which, i = this.currentCell(), o, r, a;
                                            if (t && i.Ld() && !i.Yf() && "input" !== (o = e.target.tagName.toLowerCase()) && "option" !== o && "select" !== o && "textarea" !== o && (r = n(e.target).closest(".gcui-gcuigrid-table"),
                                                r.length && (a = n.map(this.Gd().subTables(), function(e, t) {
                                                    return e.element()
                                                }),
                                                n.inArray(r[0], a) >= 0 && n.gcuiutil.charValidator.isPrintableChar(String.fromCharCode(t)))))
                                                return this.$d(e),
                                                    !1
                                        }
                                    }
                                    ,
                                    o.prototype.uf = function(t) {
                                        var i = this.Gd(), o = this.Dd("frozener"), r, a, s, l, c, d, p = e.grid.renderState;
                                        if (this.options.highlightOnHover && this.$f() && (!o || !o.inProgress()) && (r = this.de(t.target, {
                                                td: !0,
                                                th: !0
                                            }))) {
                                            if (a = n(r).closest("tr"),
                                                !a.length || !a.hasClass("gcui-gcuigrid-datarow") && !a.hasClass("gcui-gcuigrid-headerrow"))
                                                return;
                                            s = i.getAbsoluteCellInfo(r),
                                                l = this.Dd("hoveredRow"),
                                            s.rowIndex() !== l && (void 0 !== l && (c = this.Jd().item(l)) && (d = i.Od(c),
                                                i.dg(d, p.hovered, !1),
                                                this.rowStyleFormatter.format(d)),
                                                l = s.rowIndex(),
                                                this.Dd("hoveredRow", l),
                                            l >= 0 && (c = this.Jd().item(l)) && (d = i.Od(c),
                                                i.dg(d, p.hovered, !0),
                                                this.rowStyleFormatter.format(d)))
                                        }
                                    }
                                    ,
                                    o.prototype.vf = function(t) {
                                        if (this.$f() && 0 === n(t.relatedTarget).closest(".gcui-gcuigrid-data").length) {
                                            var i = this.Dd("hoveredRow"), o, r, a = this.Gd();
                                            i >= 0 && (o = this.Jd().item(i)) && (r = a.Od(o),
                                                a.dg(r, e.grid.renderState.hovered, !1),
                                                this.rowStyleFormatter.format(r))
                                        }
                                    }
                                    ,
                                    o.prototype.wf = function(e) {
                                        var t = this;
                                        this.nd > 0 && (window.clearTimeout(this.nd),
                                            this.nd = 0),
                                        -1 !== this.nd && (this.nd = window.setTimeout(function() {
                                            t.nd = -1;
                                            try {
                                                !t.pd && t.od && t.element.parent().length && t.setSize()
                                            } finally {
                                                t.nd = 0
                                            }
                                        }, 50))
                                    }
                                    ,
                                    o.prototype.eg = function(e, t, i) {
                                        var o, n;
                                        t < 0 && (t = 0),
                                        i <= 0 && (i = 1),
                                            o = {
                                                column: e.options,
                                                oldWidth: t,
                                                newWidth: i
                                            },
                                        !1 !== this._trigger("columnResizing", null, o) && ((isNaN(o.newWidth) || o.newWidth < 0) && (o.newWidth = 1),
                                            e.option("width", o.newWidth),
                                            n = {
                                                column: e.options
                                            },
                                            this._trigger("columnResized", null, n))
                                    }
                                    ,
                                    o.prototype.Qd = function(t, i, o) {
                                        var r = this.currentCell(), a = this.Nd(), s, l, c = this.options.highlightCurrentCell, d;
                                        if (a.Ld() && a.fg(i) || i.isEqual(e.grid.cellInfo.outsideValue))
                                            if (r.cellIndex() !== i.cellIndex() || r.rowIndex() !== i.rowIndex()) {
                                                if (s = {
                                                        cellIndex: i.cellIndex(),
                                                        rowIndex: i.rowIndex(),
                                                        oldCellIndex: r.cellIndex(),
                                                        oldRowIndex: r.rowIndex()
                                                    },
                                                        !this._trigger("currentCellChanging", null, s))
                                                    return !1;
                                                l = !1,
                                                this.options.allowEditing && r.Yf() && !(l = this._d(null)) || (a.fg(r) && (c && this.Ke(r, !1),
                                                (d = r.tableCell()) && n(d).removeAttr("tabIndex")),
                                                    r = i.Kd(),
                                                    r.Pd(this),
                                                c && this.Ke(r, !0),
                                                (d = r.tableCell()) && (n(d).attr("tabIndex", 0),
                                                o.setFocus && r.Yf()),
                                                    this.Dd("currentCell", r),
                                                    this.Qf(t, o))
                                            } else
                                                c && this.Ke(r, !0),
                                                (d = r.tableCell()) && n(d).attr("tabIndex", 0),
                                                t && !r.Yf() && this.Wf() && this.$d(t);
                                        return !0
                                    }
                                    ,
                                    o.prototype.Ke = function(t, i) {
                                        if (t && t.Ld()) {
                                            var o = t.cellIndexAbs(), r = t.rowIndexAbs(), a = e.grid.renderState, s = this.Gd(), l, c, d;
                                            c = s.getHeaderCell(o),
                                            c && (l = s.Od(this.Fe().item(t.column().thY)),
                                                c = n(c),
                                                d = s.gg(c, a.current, i),
                                                this.cellStyleFormatter.format(c, o, t.column(), l, d)),
                                                c = s.getJoinedRows(r, 0),
                                            c && (l = s.Od(c),
                                                s.dg(l, a.current, i),
                                                this.rowStyleFormatter.format(l)),
                                                c = s.getCell(o, r),
                                            c && (c = n(c),
                                                d = s.gg(c, a.current, i),
                                                this.cellStyleFormatter.format(c, o, t.column(), l, d))
                                        }
                                    }
                                    ,
                                    o.prototype.$d = function(t) {
                                        if (this.$f() && this.options.allowEditing) {
                                            var i = this.currentCell().column(), o;
                                            if (i && !i.readOnly)
                                                return o = (new e.grid.cellEditorHelper).currentCellEditStart(this, t)
                                        }
                                        return !1
                                    }
                                    ,
                                    o.prototype._d = function(t) {
                                        if (this.$f() && this.options.allowEditing) {
                                            var i = (new e.grid.cellEditorHelper).currentCellEditEnd(this, t);
                                            return i && !this.Ed() && this.Gd().ensureHeight(this.currentCell().rowIndex()),
                                                i
                                        }
                                        return !1
                                    }
                                    ,
                                    o.prototype.hg = function(e, t, i, o, n) {
                                        return null
                                    }
                                    ,
                                    o.prototype.ig = function(e, t, i) {
                                        return null
                                    }
                                    ,
                                    o.prototype.jg = function(e, t, i, o) {}
                                    ,
                                    o.prototype.kg = function(e) {}
                                    ,
                                    o.prototype.lg = function(t) {
                                        return t.dataParser || e.data.defaultParsers[t.dataType] || e.data.defaultParsers.string
                                    }
                                    ,
                                    o.prototype.parse = function(t, i) {
                                        var o = e.grid.getDataType(t)
                                            , r = e.grid.getDataType(t);
                                        return n.isFunction(i) && (i = i()),
                                            i = e.data.convert(i, o, r, {
                                                culture: this.Dd("closestCulture"),
                                                format: t.dataFormatString || t.Ce,
                                                nullString: this.options.nullString,
                                                parser: t.dataParser
                                            })
                                    }
                                    ,
                                    o.prototype.toStr = function(t, i) {
                                        var o = this.sd.dataView()
                                            , n = e.grid.getDataType(t)
                                            , r = "string";
                                        return i = e.data.convert(i, n, r, {
                                            culture: this.Dd("closestCulture"),
                                            format: t.dataFormatString || t.Ce,
                                            nullString: this.options.nullString,
                                            parser: t.dataParser
                                        })
                                    }
                                    ,
                                    o.prototype.parseFailed = function(e, t, i, o) {
                                        return t
                                    }
                                    ,
                                    o.prototype.mg = function() {
                                        return ["cellStyleFormatter", "rowStyleFormatter", "afterCellEdit", "afterCellUpdate", "beforeCellEdit", "beforeCellUpdate", "cellClicked", "columnDragging", "columnDragged", "columnDropping", "columnDropped", "columnResizing", "columnResized", "columnGrouping", "columnGrouped", "columnUngrouping", "columnUngrouped", "currentCellChanging", "currentCellChanged", "filtering", "filtered", "filterOperatorsListShowing", "groupAggregate", "groupText", "invalidCellValue", "pageIndexChanging", "pageIndexChanged", "selectionChanged", "sorting", "sorted", "dataLoading", "dataLoaded", "loading", "loaded", "rendering", "rendered"]
                                    }
                                    ,
                                    o.prototype.$f = function() {
                                        return !this.options.disabled
                                    }
                                    ,
                                    o.prototype.bg = function(t, i) {
                                        var o, r, a, s, l, c = t.tagName.toLowerCase();
                                        switch (c) {
                                            case "input":
                                                return !!n(t).hasClass("gridinput") && (l = t,
                                                "text" !== l.type || (o = l.value.length,
                                                    r = new e.grid.domSelection(l).getSelection(),
                                                    a = e.getKeyCodeEnum(),
                                                    s = i === a.UP || i === a.DOWN || i === a.PAGE_DOWN || i === a.PAGE_UP || 0 === r.length && (0 === r.start && (i === a.LEFT || i === a.HOME) || r.end >= o && (i === a.RIGHT || i === a.END))));
                                            case "textarea":
                                            case "select":
                                                return !1
                                        }
                                        return !0
                                    }
                                    ,
                                    o.prototype.Wf = function() {
                                        var e = (this.options.editingInitOption || "").toLowerCase();
                                        switch (e) {
                                            case "click":
                                            case "doubleclick":
                                                break;
                                            case "auto":
                                            default:
                                                e = this.kf() ? "click" : "doubleclick"
                                        }
                                        return "click" === e
                                    }
                                    ,
                                    o.prototype.ng = function() {
                                        var e = 0
                                            , t = 0
                                            , i = this.Fe();
                                        return this.ye() && e++,
                                        i && (t += i.length()),
                                        this.Ge() && t++,
                                            {
                                                x: e,
                                                y: t
                                            }
                                    }
                                    ,
                                    o.prototype.Rf = function(t) {
                                        var i = -1, o = e.grid.rowType, n;
                                        return t < 0 ? i : (n = this.Gd().Od(this.Jd().item(t)),
                                            n.type & e.grid.rowType.data ? n.dataItemIndex : -1)
                                    }
                                    ,
                                    o.prototype.ie = function(t) {
                                        var i = this.sd.currentPosition()
                                            , o = new e.grid.cellInfo(t,this.og(i),null);
                                        return o.rowIndex() < 0 ? o.cellIndex(-1) : o.cellIndex() < 0 && o.cellIndex(0),
                                            o
                                    }
                                    ,
                                    o.prototype.og = function(t) {
                                        var i = e.grid.rowType, o = this.Gd(), n = this.Jd(), r, a, s;
                                        if (t < 0)
                                            return -1;
                                        for (r = 0,
                                                 a = n.length(); r < a; r++)
                                            if (s = o.Od(n.item(r)),
                                                s.type & i.data && s.dataItemIndex === t)
                                                return s.sectionRowIndex;
                                        return -1
                                    }
                                    ,
                                    o.prototype.Nd = function(t) {
                                        var i = 0
                                            , o = 0
                                            , n = this.Dd("visibleLeaves").length - 1
                                            , r = t || !this.qd ? this.Ve() - 1 : this.Jd().length() - 1;
                                        return this.ye() && n--,
                                        (n < 0 || r < 0) && (i = o = n = r = -1),
                                            new e.grid.cellInfoRange(new e.grid.cellInfo(i,o,null),new e.grid.cellInfo(n,r,null))
                                    }
                                    ,
                                    o.prototype.pg = function(e) {
                                        return this.dataView().item(e)
                                    }
                                    ,
                                    o.prototype.Zf = function(t) {
                                        var i, o, n, r = this.Gd(), a = this.Jd(), s = e.grid.rowType;
                                        for (i = 0,
                                                 o = a.length(); i < o; i++)
                                            if (n = r.Od(a.item(i)),
                                                n.type & s.data)
                                                return new e.grid.cellInfo(t,i);
                                        return e.grid.cellInfo.outsideValue
                                    }
                                    ,
                                    o.prototype.ag = function(t, i, o, n) {
                                        var r = i.cellIndex(), a = i.rowIndex(), s, l = e.getKeyCodeEnum();
                                        switch (o) {
                                            case l.PAGE_UP:
                                                this.qg && a === t.topLeft().rowIndex() ? a = t.bottomRight().rowIndex() : (a -= this.rg) < (s = t.topLeft().rowIndex()) && (a = s);
                                                break;
                                            case l.PAGE_DOWN:
                                                this.qg && a === t.bottomRight().rowIndex() ? a = t.topLeft().rowIndex() : (a += this.rg) > (s = t.bottomRight().rowIndex()) && (a = s);
                                                break;
                                            case l.END:
                                                r = this.qg && r === t.bottomRight().cellIndex() ? t.topLeft().cellIndex() : t.bottomRight().cellIndex();
                                                break;
                                            case l.HOME:
                                                r = this.qg && r === t.topLeft().cellIndex() ? t.bottomRight().cellIndex() : t.topLeft().cellIndex();
                                                break;
                                            case l.LEFT:
                                                r > t.topLeft().cellIndex() ? r-- : this.qg && (r = t.bottomRight().cellIndex());
                                                break;
                                            case l.UP:
                                                a > t.topLeft().rowIndex() ? a-- : this.qg && (a = t.bottomRight().rowIndex());
                                                break;
                                            case l.RIGHT:
                                                r < t.bottomRight().cellIndex() ? r++ : this.qg && (r = t.topLeft().cellIndex());
                                                break;
                                            case l.ENTER:
                                            case l.DOWN:
                                                a < t.bottomRight().rowIndex() ? a++ : this.qg && (a = t.topLeft().rowIndex());
                                                break;
                                            case l.TAB:
                                        }
                                        return {
                                            cellIndex: r,
                                            rowIndex: a
                                        }
                                    }
                                    ,
                                    o.prototype.de = function(e, t) {
                                        for (var i = e, o, n, r = null; i; i = i.parentNode)
                                            if (n = i.nodeName.toLowerCase()) {
                                                if (i === this.outerDiv[0]) {
                                                    o = i;
                                                    break
                                                }
                                                t[n] && (r = i)
                                            }
                                        return o ? r : null
                                    }
                                    ,
                                    o.prototype.sg = function(e) {
                                        var t, i = this.Nd();
                                        return this.tg() ? -1 : (t = e ? Math.min(this.options.staticRowIndex, i.bottomRight().rowIndex()) : Math.min(this.options.staticColumnIndex, i.bottomRight().cellIndex()),
                                        t < -1 && (t = -1),
                                            t)
                                    }
                                    ,
                                    o.prototype.ug = function(e) {
                                        var t = 0;
                                        return e ? this.ye() && t++ : (t = this.ze().length,
                                        this.options.showFilter && t++),
                                            t
                                    }
                                    ,
                                    o.prototype.vg = function() {
                                        var e, t, i = this.ug(!0), o = this.sg(!1), n, r;
                                        if (n = o + i,
                                            o >= 0) {
                                            for (e = this.Dd("visibleLeaves"),
                                                     t = e.length,
                                                     r = n; n < t; n++)
                                                if (-1 === e[n].parentIdx) {
                                                    n > r && n--;
                                                    break
                                                }
                                            n >= t && (n = t - 1)
                                        }
                                        return n
                                    }
                                    ,
                                    o.prototype.wg = function() {
                                        var e = this.ug(!1);
                                        return this.sg(!0) + e
                                    }
                                    ,
                                    o.prototype.De = function() {
                                        var e = this.Dd("leaves"), t, i, o, n = !1;
                                        if (e)
                                            for (t = 0,
                                                     i = e.length; t < i && !n; t++)
                                                o = e[t],
                                                    n = n || o.parentVis && "none" !== o.rowMerge;
                                        return n
                                    }
                                    ,
                                    o.prototype.xg = function() {
                                        var e = this.Dd("leaves"), t, i, o, n = !1;
                                        for (t = 0,
                                                 i = e.length; t < i && !n; t++)
                                            o = e[t],
                                                n = o.groupInfo && "none" !== o.groupInfo.position;
                                        return n
                                    }
                                    ,
                                    o.prototype.tg = function() {
                                        return this.xg() || this.De()
                                    }
                                    ,
                                    o.prototype.ze = function(e) {
                                        return arguments.length && this.Dd("columnsHeadersTable", e),
                                            this.Dd("columnsHeadersTable")
                                    }
                                    ,
                                    o.prototype.Gd = function() {
                                        return this.Dd("view")
                                    }
                                    ,
                                    o.prototype.we = function() {
                                        var e = this.Dd("tfoot");
                                        return e && e.length ? e[0] : null
                                    }
                                    ,
                                    o.prototype.ve = function() {
                                        var e = this.Dd("thead");
                                        return e && e.length ? e[0] : null
                                    }
                                    ,
                                    o.prototype.Xf = function(e, t, i) {
                                        var o = this;
                                        return e === this.element ? 2 === arguments.length ? (n.each(t, function(t, i) {
                                            t in o.vd || (o.vd[t] = e.attr(t))
                                        }),
                                            e.attr(t)) : (t in this.vd || (this.vd[t] = e.attr(t)),
                                            e.attr(t, i)) : 3 === arguments.length ? e.attr(t, i) : e.attr(t)
                                    }
                                    ,
                                    o.prototype.Ve = function() {
                                        return this.sketchTable.length
                                    }
                                    ,
                                    o.prototype.yg = function(e, t) {
                                        this.md.x = e,
                                            this.md.y = t
                                    }
                                    ,
                                    o.prototype.zg = function(e) {
                                        this.md.index = e
                                    }
                                    ,
                                    o.prototype.Ag = function() {
                                        return void 0 === this.Ad && (this.Ad = e.grid.getUID()),
                                        "gcuigrid" + this.Ad
                                    }
                                    ,
                                    o
                            }(e.gcuiWidget),
                            t.gcuigrid = i,
                            i.prototype.widgetEventPrefix = "gcuigrid",
                            i.prototype.Id = "gcuigrid",
                            i.prototype.zf = 1e3,
                            i.prototype.qg = !1,
                            i.prototype.rg = 10,
                            i.prototype.Pe = !0,
                            o = function() {
                                function e() {
                                    this.mobileCSS = {
                                        header: "ui-header ui-bar-a",
                                        content: "ui-body-c",
                                        stateHover: "ui-btn-down-c",
                                        stateActive: "ui-btn-down-c"
                                    },
                                        this.allowColMoving = !1,
                                        this.allowColSizing = !1,
                                        this.allowEditing = !1,
                                        this.allowKeyboardNavigation = !0,
                                        this.allowPaging = !1,
                                        this.allowSorting = !1,
                                        this.allowVirtualScrolling = !1,
                                        this.cellStyleFormatter = void 0,
                                        this.columns = [],
                                        this.columnsAutogenerationMode = "merge",
                                        this.culture = "",
                                        this.customFilterOperators = [],
                                        this.data = null,
                                        this.editingInitOption = "auto",
                                        this.ensureColumnsPxWidth = !1,
                                        this.filterOperatorsSortMode = "alphabeticalCustomFirst",
                                        this.groupAreaCaption = "Drag a column here to group by that column.",
                                        this.groupIndent = 10,
                                        this.highlightCurrentCell = !1,
                                        this.highlightOnHover = !0,
                                        this.loadingText = "Loading...",
                                        this.nullString = "",
                                        this.pageIndex = 0,
                                        this.pageSize = 10,
                                        this.pagerSettings = {
                                            mode: "numeric",
                                            pageButtonCount: 10,
                                            position: "bottom"
                                        },
                                        this.readAttributesFromData = !1,
                                        this.rowStyleFormatter = void 0,
                                        this.scrollMode = "none",
                                        this.selectionMode = "singleRow",
                                        this.showFilter = !1,
                                        this.showFooter = !1,
                                        this.showGroupArea = !1,
                                        this.showSelectionOnRender = !0,
                                        this.showRowHeader = !1,
                                        this.staticColumnIndex = -1,
                                        this.staticColumnsAlignment = "left",
                                        this.staticRowIndex = -1,
                                        this.totalRows = -1,
                                        this.afterCellEdit = null,
                                        this.afterCellUpdate = null,
                                        this.beforeCellEdit = null,
                                        this.beforeCellUpdate = null,
                                        this.cellClicked = null,
                                        this.columnDragging = null,
                                        this.columnDragged = null,
                                        this.columnDropping = null,
                                        this.columnDropped = null,
                                        this.columnGrouping = null,
                                        this.columnGrouped = null,
                                        this.columnResizing = null,
                                        this.columnResized = null,
                                        this.columnUngrouping = null,
                                        this.columnUngrouped = null,
                                        this.currentCellChanging = null,
                                        this.currentCellChanged = null,
                                        this.filterOperatorsListShowing = null,
                                        this.filtering = null,
                                        this.filtered = null,
                                        this.groupAggregate = null,
                                        this.groupText = null,
                                        this.invalidCellValue = null,
                                        this.pageIndexChanging = null,
                                        this.pageIndexChanged = null,
                                        this.selectionChanged = null,
                                        this.sorting = null,
                                        this.sorted = null,
                                        this.dataLoading = null,
                                        this.dataLoaded = null,
                                        this.loading = null,
                                        this.loaded = null,
                                        this.rendering = null,
                                        this.rendered = null
                                }
                                return e
                            }(),
                            i.prototype.options = e.grid.extendWidgetOptions(e.gcuiWidget.prototype.options, new o),
                            n.gcui.registerWidget("gcuigrid", i.prototype)
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function(t) {
                            __extends(i, t);
                            function i() {
                                t.apply(this, arguments)
                            }
                            return i.prototype._create = function() {
                                var t = o.data(this.element[0], "gcuigridowner");
                                this.Dd("owner", t),
                                    e.grid.widgetName(this.element[0], this.widgetFullName),
                                    this.pd = !1,
                                    this.element.addClass(t.options.uiCSS.widget + " gcui-c1basefield " + t.options.uiCSS.stateDefault),
                                this.options.disabled && this.disable(),
                                t.options.allowColMoving && t.Ee(!0).attach(this)
                            }
                                ,
                                i.prototype._init = function() {
                                    this.element.wrapInner("<div class='gcui-gcuigrid-innercell'></div>"),
                                        this.Bg()
                                }
                                ,
                                i.prototype.destroy = function() {
                                    try {
                                        t.prototype.destroy.apply(this, arguments)
                                    } finally {
                                        this.pd = !0
                                    }
                                }
                                ,
                                i.prototype.Ta = function() {
                                    if (!this.Cg()) {
                                        var t = this.Dg();
                                        t && t.Ee(!1) && t.Ee(!1).detach(this),
                                            e.grid.remove$dataByPrefix(this.element, this.Id),
                                            this.element.removeClass(t.options.uiCSS.widget + " gcui-c1basefield " + t.options.uiCSS.stateDefault).html(this.element.find(".gcui-gcuigrid-headertext").html())
                                    }
                                }
                                ,
                                i.prototype.Dd = function(t, i) {
                                    return e.grid.dataPrefix(this.element, this.Id, t, i)
                                }
                                ,
                                i.prototype.Re = function(e) {
                                    var t = this.Id + e;
                                    this.element.removeData(t)
                                }
                                ,
                                i.prototype._setOption = function(e, i) {
                                    var o, n, r, a = this["preset_" + e], s = this.options[e];
                                    void 0 !== a && (i = a.apply(this, [i, s])),
                                        o = i !== s,
                                        t.prototype._setOption.apply(this, [e, i]),
                                    o && (void 0 !== this.options.groupedIndex && (r = this.Dg().Dd("groupedWidgets")[this.options.groupedIndex]) && e in r.options && r._setOption(e, i),
                                    void 0 !== (n = this["postset_" + e]) && n.apply(this, [i, s]))
                                }
                                ,
                                i.prototype.postset_allowMoving = function(e, t) {}
                                ,
                                i.prototype.preset_clientType = function(e, t) {
                                    throw "read-only"
                                }
                                ,
                                i.prototype.postset_headerText = function(e, t) {
                                    this.Bg()
                                }
                                ,
                                i.prototype.postset_visible = function(e, t) {
                                    this.Dg().ensureControl(!1)
                                }
                                ,
                                i.prototype.postset_width = function(t, i) {
                                    var o, n = this.Dg();
                                    n && (this.options.ensurePxWidth = !0,
                                        o = e.grid.getColumnByTravIdx(n.options.columns, this.options.travIdx),
                                    o && (o.found.width = t,
                                        o.found.ensurePxWidth = !0),
                                        n.setSize())
                                }
                                ,
                                i.prototype.Dg = function() {
                                    return this.Dd("owner")
                                }
                                ,
                                i.prototype.Eg = function() {
                                    return this.options.allowSizing && this.Dg().options.allowColSizing
                                }
                                ,
                                i.prototype.Fg = function() {
                                    return !0 === this.options.allowMoving
                                }
                                ,
                                i.prototype.Gg = function(t) {
                                    return !e.grid.isChildOf(this.Dg().options.columns, t, this)
                                }
                                ,
                                i.prototype.Hg = function(e) {
                                    return e.html(this.options.headerText || "&nbsp;")
                                }
                                ,
                                i.prototype.Ig = function(e) {
                                    return e.wrapInner('<span class="gcui-gcuigrid-headertext" />')
                                }
                                ,
                                i.prototype.Bg = function() {
                                    var e = this.element.children(".gcui-gcuigrid-innercell").empty();
                                    this.Hg(e),
                                        this.Ig(e)
                                }
                                ,
                                i.prototype.Cg = function() {
                                    return this.pd
                                }
                                ,
                                i
                        }(e.gcuiWidget);
                        t.c1basefield = n,
                            n.prototype.Id = "c1basefield",
                            i = function() {
                                function e() {
                                    this.allowMoving = !0,
                                        this.allowSizing = !0,
                                        this.cellFormatter = void 0,
                                        this.dataKey = void 0,
                                        this.ensurePxWidth = void 0,
                                        this.footerText = void 0,
                                        this.headerText = void 0,
                                        this.textAlignment = void 0,
                                        this.visible = !0,
                                        this.width = void 0
                                }
                                return e
                            }(),
                            t.c1basefield_options = i,
                            n.prototype.options = e.grid.extendWidgetOptions(e.gcuiWidget.prototype.options, new i),
                            o.gcui.registerWidget("c1basefield", n.prototype)
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function(t) {
                            __extends(i, t);
                            function i() {
                                t.apply(this, arguments)
                            }
                            return i.prototype._create = function() {
                                t.prototype._create.apply(this, arguments);
                                var e = this.Dg();
                                this.element.addClass(e.options.uiCSS.widget + " gcui-c1field")
                            }
                                ,
                                i.prototype.Ta = function() {
                                    if (!this.Cg()) {
                                        var e = this.Dg();
                                        if (this.element.find("*").unbind("." + this.widgetName),
                                                this.$filterEditor) {
                                            switch (this.$filterEditor.closest("td").find("*").unbind("." + this.widgetName),
                                                this.Jg(this.options)) {
                                                case "date":
                                                    this.$filterEditor.data("gcui-inputdate") && this.$filterEditor.gcuiinputdate("destroy");
                                                    break;
                                                case "mask":
                                                    this.$filterEditor.data("gcui-inputmask") && this.$filterEditor.gcuiinputmask("destroy");
                                                    break;
                                                case "numberCurrency":
                                                case "numberNumber":
                                                case "numberPercent":
                                                    this.$filterEditor.data("gcui-inputnumber") && this.$filterEditor.gcuiinputnumber("destroy")
                                            }
                                            this.$filterEditor = null
                                        }
                                        this.element.removeClass(e.options.uiCSS.widget + " gcui-c1field"),
                                            this.Kg(),
                                            t.prototype.Ta.apply(this, arguments)
                                    }
                                }
                                ,
                                i.prototype._init = function() {
                                    t.prototype._init.apply(this, arguments),
                                        this.$filterEditor = null;
                                    var e = this.Dg();
                                    this.filterRow = e.Ge(),
                                    e.options.showFilter && this.options.showFilter && this.options.dataIndex >= 0 && this.Lg()
                                }
                                ,
                                i.prototype.postset_aggregate = function(e, t) {
                                    this.Dg().ensureControl(!1)
                                }
                                ,
                                i.prototype.postset_allowSort = function(e, t) {
                                    this.Bg()
                                }
                                ,
                                i.prototype.postset_dataType = function(e, t) {
                                    throw "read-only"
                                }
                                ,
                                i.prototype.postset_dataParser = function(e, t) {
                                    this.Dg().ensureControl(!1)
                                }
                                ,
                                i.prototype.postset_dataFormatString = function(e, t) {
                                    this.Dg().ensureControl(!1)
                                }
                                ,
                                i.prototype.postset_filterOperator = function(e, t) {
                                    this.Dg().ensureControl(!0)
                                }
                                ,
                                i.prototype.postset_filterValue = function(e, t) {
                                    this.Dg().ensureControl(!0)
                                }
                                ,
                                i.prototype.postset_groupInfo = function(e, t) {
                                    this.Dg().ensureControl(!0)
                                }
                                ,
                                i.prototype.postset_rowMerge = function(e, t) {
                                    this.Dg().ensureControl(!1)
                                }
                                ,
                                i.prototype.postset_showFilter = function(e, t) {
                                    this.Dg().ensureControl(!1)
                                }
                                ,
                                i.prototype.postset_sortDirection = function(e, t) {
                                    this.options.sortOrder = 0,
                                        this.Dg().ensureControl(!0)
                                }
                                ,
                                i.prototype.postset_width = function(e, i) {
                                    t.prototype.postset_width.apply(this, arguments)
                                }
                                ,
                                i.prototype.Gg = function(e) {
                                    return !!t.prototype.Gg.apply(this, arguments) && !(void 0 !== this.options.groupedIndex && e instanceof o.gcui.c1groupedfield)
                                }
                                ,
                                i.prototype.Mg = function() {
                                    var e = this.Dg();
                                    return e && e.options.allowSorting && this.options.allowSort && this.options.dataIndex >= 0
                                }
                                ,
                                i.prototype.Ig = function(e) {
                                    if (this.Mg()) {
                                        var i = this.Dg()
                                            , n = e.wrapInner('<a class="gcui-gcuigrid-headertext" href="#" role="button" />').children("a");
                                        switch (n.bind("click." + this.widgetName, this, o.proxy(this.Ng, this)),
                                            this.options.sortDirection) {
                                            case "ascending":
                                                e.append(o('<span class="gcui-gcuigrid-sort-icon ' + i.options.uiCSS.icon + " " + i.options.uiCSS.iconArrowUp + '">ascending</span>'));
                                                break;
                                            case "descending":
                                                e.append(o('<span class="gcui-gcuigrid-sort-icon ' + i.options.uiCSS.icon + " " + i.options.uiCSS.iconArrowDown + '">descending</span>'))
                                        }
                                    } else
                                        t.prototype.Ig.apply(this, arguments)
                                }
                                ,
                                i.prototype.Lg = function() {
                                    var t = this.options.visLeavesIdx, i = this.Dg(), n = null, r, a, s = this, l, c = e.grid.HTML5InputSupport.getDefaultInputType(i.kf(), this.options);
                                    if (t >= 0) {
                                        if (i = this.Dg(),
                                                !this.filterRow)
                                            throw "exception";
                                        if (n = o(e.grid.rowAccessor.getCell(this.filterRow, t)),
                                                this.$filterEditor = n.find("input"),
                                                n.bind(o.support.selectstart ? "selectstart" : "mousedown", function(e) {
                                                    e.stopPropagation()
                                                }),
                                            null === (r = i.parse(this.options, e.grid.filterHelper.getSingleValue(this.options.filterValue))) || "undefined" === r)
                                            switch (e.grid.getDataType(this.options)) {
                                                case "boolean":
                                                    r = !1;
                                                    break;
                                                case "number":
                                                case "currency":
                                                case "datetime":
                                                    r = 0;
                                                    break;
                                                default:
                                                    r = ""
                                            }
                                        switch (a = {
                                            culture: i.options.culture,
                                            disabled: i.options.disabled,
                                            decimalPlaces: function(e) {
                                                var t = /^(n|p|c){1}(\d*)$/.exec(e);
                                                return t && t[2] ? parseInt(t[2], 10) : (t = /^(d){1}(\d*)$/.exec(e),
                                                    t ? 0 : 2)
                                            }(this.options.dataFormatString)
                                        },
                                            l = this.Jg(this.options)) {
                                            case "date":
                                                "text" === c ? this.$filterEditor.gcuiinputdate(o.extend(a, {
                                                    date: r,
                                                    dateFormat: this.options.dataFormatString || void 0,
                                                    showTrigger: !0
                                                })) : this.Og(this.$filterEditor, c, e.grid.HTML5InputSupport.toStr(r || new Date, c));
                                                break;
                                            case "mask":
                                                this.$filterEditor.gcuiinputmask({
                                                    text: r + ""
                                                });
                                                break;
                                            case "numberCurrency":
                                                this.$filterEditor.gcuiinputnumber(o.extend(a, {
                                                    type: "currency",
                                                    value: r
                                                }));
                                                break;
                                            case "numberNumber":
                                                "text" === c ? this.$filterEditor.gcuiinputnumber(o.extend(a, {
                                                    value: r
                                                })) : this.Og(this.$filterEditor, c, e.grid.HTML5InputSupport.toStr(r, c));
                                                break;
                                            case "numberPercent":
                                                this.$filterEditor.gcuiinputnumber(o.extend(a, {
                                                    type: "percent",
                                                    value: 100 * r
                                                }));
                                                break;
                                            default:
                                                throw e.grid.stringFormat('Unsupported editor type: "{0}"', l)
                                        }
                                        n.find(".gcui-gcuigrid-filter-trigger").attr({
                                            role: "button",
                                            "aria-haspopup": "true"
                                        }).bind("mouseenter." + this.widgetName, function(e) {
                                            s.options.disabled || o(this).addClass(i.options.uiCSS.stateHover)
                                        }).bind("mouseleave." + this.widgetName, function(e) {
                                            s.options.disabled || o(this).removeClass(i.options.uiCSS.stateHover + " " + i.options.uiCSS.stateActive)
                                        }).bind("mouseup." + this.widgetName, this, function(e) {
                                            s.options.disabled || o(this).removeClass(i.options.uiCSS.stateActive)
                                        }).bind("mousedown." + this.widgetName, {
                                            column: this
                                        }, this.Pg).bind("click." + this.widgetName, function(e) {
                                            e.preventDefault()
                                        })
                                    }
                                }
                                ,
                                i.prototype.Og = function(e, t, i) {
                                    return e.wrap('<span class="gcuigrid-input-wrapper"></span').attr("type", t).val(i)
                                }
                                ,
                                i.prototype.Pg = function(t) {
                                    var i = t.data.column, n = 8, r = i.Dg(), a, s, l, c, d, p, u, h, f, g = e.grid.HTML5InputSupport.getDefaultInputType(r.kf(), i.options);
                                    return !i.options.disabled && (i.$dropDownFilterList ? (i.Kg(),
                                        !1) : (t.target.focus(),
                                        a = e.grid.filterHelper.getSingleOperatorName(i.options.filterOperator).toLowerCase(),
                                        s = r.getFilterOperatorsByDataType(e.grid.getDataType(i.options)),
                                        l = {
                                            operators: o.extend(!0, [], s),
                                            column: i.options
                                        },
                                        r.Pf(l),
                                        c = [],
                                    l.operators && o.each(l.operators, function(e, t) {
                                        c.push({
                                            label: t.displayName || t.name,
                                            value: t.name,
                                            selected: t.name.toLowerCase() === a
                                        })
                                    }),
                                        i.$dropDownFilterList = o('<div class="gcui-gcuigrid-filterlist"></div').appendTo(document.body).gcuilist({
                                            autoSize: !0,
                                            maxItemsCount: n,
                                            selected: function(t, o) {
                                                var n, a;
                                                switch (a = i.Jg(i.options)) {
                                                    case "date":
                                                        n = "text" === g ? i.$filterEditor.gcuiinputdate("option", "date") || new Date : e.grid.HTML5InputSupport.parse(i.$filterEditor.val(), g) || new Date;
                                                        break;
                                                    case "mask":
                                                        n = i.$filterEditor.gcuiinputmask("option", "text");
                                                        break;
                                                    case "numberNumber":
                                                        if ("text" !== g) {
                                                            n = e.grid.HTML5InputSupport.parse(i.$filterEditor.val(), g) || 0;
                                                            break
                                                        }
                                                    case "numberCurrency":
                                                    case "numberPercent":
                                                        n = i.$filterEditor.gcuiinputnumber("option", "value"),
                                                        "numberPercent" === a && (n /= 100)
                                                }
                                                i.Kg(),
                                                    r.Gf(i, o.item.value, n)
                                            }
                                        }),
                                    o.ui && o.fn.zIndex && (f = r.outerDiv.zIndex()) && f++,
                                        i.$dropDownFilterList.css("z-index", Math.max(f || 0, 9999)),
                                        i.$dropDownFilterList.gcuilist("setItems", c).gcuilist("renderList"),
                                        u = 150 | i.$dropDownFilterList.width(),
                                        i.$dropDownFilterList.width(c.length > n ? u + 20 : u).gcuilist("refreshSuperPanel").position({
                                            of: o(this),
                                            my: "left top",
                                            at: "left bottom"
                                        }),
                                        i.$dropDownFilterList.$button = o(this),
                                        h = i.$dropDownFilterList.eventUID = e.grid.getUID(),
                                        void o(document).bind("mousedown." + i.widgetName + "." + h, {
                                            column: i
                                        }, i.Qg)))
                                }
                                ,
                                i.prototype.Qg = function(e) {
                                    var t = o(e.target)
                                        , i = t.parents(".gcui-gcuigrid-filterlist:first")
                                        , n = t.is(".gcui-gcuigrid-filter-trigger") ? t : t.parents(".gcui-gcuigrid-filter-trigger:first");
                                    n.length && n[0] === e.data.column.$dropDownFilterList.$button[0] || i.length && i[0] === e.data.column.$dropDownFilterList[0] || e.data.column.Kg()
                                }
                                ,
                                i.prototype.Ng = function(e) {
                                    if (e.data.options.disabled)
                                        return !1;
                                    if (e.data.options.allowSort) {
                                        var t = e.data.Dg();
                                        t.xf(e.data.options, e.ctrlKey)
                                    }
                                    return !1
                                }
                                ,
                                i.prototype.Kg = function() {
                                    if (this.$dropDownFilterList) {
                                        var e = this.$dropDownFilterList.eventUID;
                                        this.$dropDownFilterList.remove(),
                                            this.$dropDownFilterList = null,
                                            o(document).unbind("mousedown." + this.widgetName + "." + e, this.Qg)
                                    }
                                }
                                ,
                                i.prototype.Jg = function(t) {
                                    switch (e.grid.getDataType(t)) {
                                        case "number":
                                            return t.dataFormatString && 0 === t.dataFormatString.indexOf("p") ? "numberPercent" : "numberNumber";
                                        case "currency":
                                            return "numberCurrency";
                                        case "datetime":
                                            return "date";
                                        default:
                                            return "mask"
                                    }
                                }
                                ,
                                i
                        }(t.c1basefield);
                        t.c1field = n,
                            i = function(e) {
                                __extends(t, e);
                                function t() {
                                    e.apply(this, arguments),
                                        this.aggregate = "none",
                                        this.allowSort = !0,
                                        this.dataType = void 0,
                                        this.inputType = void 0,
                                        this.dataParser = void 0,
                                        this.dataFormatString = void 0,
                                        this.filterOperator = "nofilter",
                                        this.filterValue = void 0,
                                        this.groupInfo = {
                                            expandInfo: [],
                                            level: void 0,
                                            groupSingleRow: !0,
                                            collapsedImageClass: o.gcui.uiCSS.iconArrowRight,
                                            expandedImageClass: o.gcui.uiCSS.iconArrowRightDown,
                                            position: "none",
                                            outlineMode: "startExpanded",
                                            headerText: void 0,
                                            footerText: void 0
                                        },
                                        this.readOnly = !1,
                                        this.rowMerge = "none",
                                        this.showFilter = !0,
                                        this.sortDirection = "none",
                                        this.valueRequired = !1
                                }
                                return t
                            }(t.c1basefield_options),
                            t.c1field_options = i,
                            n.prototype.options = e.grid.extendWidgetOptions(t.c1basefield.prototype.options, new i),
                            o.gcui.registerWidget("c1field", o.gcui.c1basefield, n.prototype)
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments)
                            }
                            return t.prototype._create = function() {
                                e.prototype._create.apply(this, arguments);
                                var t = this.Dg();
                                this.element.addClass(t.options.uiCSS.widget + " gcui-c1band")
                            }
                                ,
                                t.prototype.Gg = function(t) {
                                    return !!e.prototype.Gg.apply(this, arguments) && !(t instanceof o.gcui.c1groupedfield)
                                }
                                ,
                                t
                        }(t.c1basefield);
                        t.c1band = n,
                            i = function(e) {
                                __extends(t, e);
                                function t() {
                                    e.apply(this, arguments),
                                        this.columns = []
                                }
                                return t
                            }(t.c1field_options),
                            n.prototype.options = e.grid.extendWidgetOptions(t.c1basefield.prototype.options, new i),
                            o.gcui.registerWidget("c1band", o.gcui.c1basefield, n.prototype)
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function(t) {
                            __extends(o, t);
                            function o() {
                                t.apply(this, arguments)
                            }
                            return o.prototype._create = function() {
                                var t = i.data(this.element[0], "gcuigridowner");
                                this.Dd("owner", t),
                                    e.grid.widgetName(this.element[0], this.widgetFullName),
                                    this.pd = !1,
                                    this.element.addClass("gcui-gcuigrid-group-button " + t.options.uiCSS.stateDefault + " " + t.options.uiCSS.cornerAll),
                                this.options.disabled && this.disable(),
                                t.options.allowColMoving && t.Ee(!0).attach(this)
                            }
                                ,
                                o.prototype._init = function() {
                                    this.Bg()
                                }
                                ,
                                o.prototype.destroy = function() {
                                    try {
                                        t.prototype.destroy.apply(this, arguments)
                                    } finally {
                                        this.pd = !0
                                    }
                                }
                                ,
                                o.prototype.Ta = function() {
                                    if (!this.Cg()) {
                                        this.element.find("*").unbind("." + this.widgetName);
                                        var t = this.Dg();
                                        t && t.Ee(!1) && t.Ee(!1).detach(this),
                                            e.grid.remove$dataByPrefix(this.element, this.Id)
                                    }
                                }
                                ,
                                o.prototype.Dd = function(t, i) {
                                    return e.grid.dataPrefix(this.element, this.Id, t, i)
                                }
                                ,
                                o.prototype.Re = function(e) {
                                    var t = this.Id + e;
                                    this.element.removeData(t)
                                }
                                ,
                                o.prototype._setOption = function(e, i) {
                                    var o = this["preset_" + e], n = this.options[e], r, a;
                                    void 0 !== o && (i = o.apply(this, [i, n])),
                                        r = i !== n,
                                        t.prototype._setOption.apply(this, [e, i]),
                                    r && void 0 !== (a = this["postset_" + e]) && a.apply(this, [i, n])
                                }
                                ,
                                o.prototype.postset_headerText = function(e, t, i) {
                                    this.Bg()
                                }
                                ,
                                o.prototype.postset_allowSort = function(e, t, i) {
                                    this.Bg()
                                }
                                ,
                                o.prototype.Dg = function() {
                                    return this.Dd("owner")
                                }
                                ,
                                o.prototype.Eg = function() {
                                    return this.options.allowSizing && this.Dg().options.allowColSizing
                                }
                                ,
                                o.prototype.Fg = function() {
                                    return !0 === this.options.allowMoving
                                }
                                ,
                                o.prototype.Gg = function(t) {
                                    return t instanceof i.gcui.c1groupedfield && !e.grid.isChildOf(this.Dg().options.columns, t, this)
                                }
                                ,
                                o.prototype.Mg = function() {
                                    var e = this.Dg();
                                    return e && e.options.allowSorting && this.options.allowSort && this.options.dataIndex >= 0
                                }
                                ,
                                o.prototype.Bg = function() {
                                    var e = this.Dg().options.uiCSS
                                        , t = i('<span class="gcui-gcuigrid-group-button-close ' + e.stateDefault + " " + e.cornerAll + '"><span class="' + e.icon + " " + e.iconClose + '"></span></span>').bind("click." + this.widgetName, this, this.Rg);
                                    if (this.element.html(this.options.headerText || "").prepend(t).bind("click." + this.widgetName, this, i.proxy(this.Ng, this)),
                                            this.Mg())
                                        switch (this.options.sortDirection) {
                                            case "ascending":
                                                this.element.append(i('<span class="gcui-gcuigrid-group-button-sort ' + e.icon + " " + e.iconArrowUp + '"></span>'));
                                                break;
                                            case "descending":
                                                this.element.append(i('<span class="gcui-gcuigrid-group-button-sort ' + e.icon + " " + e.iconArrowDown + '"></span>'))
                                        }
                                }
                                ,
                                o.prototype.Rg = function(e) {
                                    var t = e.data.options;
                                    return t.disabled || e.data.Dg().Jf(e.data.options.travIdx),
                                        !1
                                }
                                ,
                                o.prototype.Ng = function(t) {
                                    var i = t.data.Dg(), o = t.data.options, n;
                                    return !o.disabled && o.allowSort && (n = e.grid.search(i.columns(), function(e) {
                                        return e.options.travIdx === o.travIdx
                                    }),
                                    (n = n.found ? n.found.options : e.grid.getColumnByTravIdx(i.options.columns, o.travIdx).found) && i.xf(n, t.ctrlKey)),
                                        !1
                                }
                                ,
                                o.prototype.Cg = function() {
                                    return this.pd
                                }
                                ,
                                o
                        }(e.gcuiWidget);
                        t.c1groupedfield = o,
                            o.prototype.Id = "c1groupedfield",
                            o.prototype.options = i.extend(!0, {}, e.gcuiWidget.prototype.options, {
                                uiCSS: {
                                    header: "ui-header ui-bar-a",
                                    content: "ui-body-c",
                                    stateDefault: "ui-btn-up-c",
                                    stateHover: "ui-btn-down-c",
                                    stateActive: "ui-btn-down-c"
                                },
                                allowMoving: !0,
                                allowSort: !0,
                                headerText: void 0,
                                sortDirection: "none"
                            }),
                            i.gcui.registerWidget("c1groupedfield", o.prototype)
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t() {}
                            return t.prototype.generateSpanTable = function(e, t) {
                                this.cg = this.Sg = this.Tg = this.Ug = 0,
                                    this.Vg = [],
                                    this.Wg = [],
                                    this.Xg = [];
                                var i = this.Yg(e, t, !0);
                                return i
                            }
                                ,
                                t.prototype.Yg = function(t, i, o) {
                                    var n, r, a = this;
                                    for (this.cg = this.getVisibleHeight(t, o),
                                             i = i || [],
                                             e.grid.traverse(t, function(e) {
                                                 e.isLeaf && i.push(e),
                                                     a.Wg.push(e)
                                             }),
                                             this.Sg = i.length,
                                             n = 0; n < this.cg; n++)
                                        for (this.Vg[n] = [],
                                                 r = 0; r < this.Sg; r++)
                                            this.Vg[n][r] = {
                                                column: null,
                                                colSpan: 0,
                                                rowSpan: 0
                                            };
                                    return this.Zg(t, 0, 0),
                                        this.Vg
                                }
                                ,
                                t.prototype.getVisibleHeight = function(e, t) {
                                    var o, n, r, a, s = 0;
                                    if (i.isArray(e))
                                        for (o = 0,
                                                 n = e.length; o < n; o++)
                                            a = this.getVisibleHeight(e[o], t),
                                                s = Math.max(s, a);
                                    else if (r = void 0 === e.visible || e.visible,
                                            e.parentVis = r && t,
                                            e.isBand) {
                                        for (o = 0,
                                                 n = e.columns.length; o < n; o++)
                                            a = this.getVisibleHeight(e.columns[o], e.parentVis),
                                                s = Math.max(s, a);
                                        if (!e.parentVis)
                                            return s;
                                        e.isLeaf = 0 === s,
                                            s++
                                    } else
                                        e.isLeaf = !0,
                                        e.parentVis && (s = 1);
                                    return s
                                }
                                ,
                                t.prototype.$g = function(e) {
                                    for (; e; )
                                        if ((e = this.Wg[e.parentIdx]) && (e.parentVis || void 0 === e.parentVis))
                                            return e;
                                    return null
                                }
                                ,
                                t.prototype.Zg = function(e, t, o) {
                                    var n, r, a, s, l, c;
                                    if (i.isArray(e))
                                        for (n = 0,
                                                 r = e.length; n < r; n++)
                                            this.Zg(e[n], t, o);
                                    else {
                                        if (void 0 === e.travIdx)
                                            throw "undefined travIdx";
                                        if (a = o + this.Ug,
                                            e.parentVis && (s = a + this.Tg,
                                                this.Vg[t][s].column = e,
                                                this.Xg[e.travIdx] = s),
                                                e.isBand)
                                            for (n = 0,
                                                     r = e.columns.length; n < r; n++)
                                                this.Zg(e.columns[n], t + 1, o);
                                        e.parentVis ? this.Ug - a == 0 ? (this.Vg[t][this.Xg[e.travIdx]].rowSpan = this.cg - t,
                                            this.Ug++) : this.Vg[t][this.Xg[e.travIdx]].colSpan = this.Ug - a : !e.isBand && this.cg > 0 && (c = this.$g(e),
                                            l = !!c && c.isLeaf,
                                        l && this.Tg++,
                                        t >= this.cg && (t = this.cg - 1),
                                            s = o + this.Ug + this.Tg,
                                            this.Vg[t][s].column = e,
                                        l || (c && this.Xg[c.travIdx] === s && this.ah(s, t),
                                            this.Tg++))
                                    }
                                }
                                ,
                                t.prototype.ah = function(e, t) {
                                    var i;
                                    for (i = 0; i < t; i++)
                                        this.Vg[i][e + 1] = this.Vg[i][e],
                                            this.Vg[i][e] = {
                                                column: null,
                                                colSpan: 0,
                                                rowSpan: 0
                                            },
                                        this.Vg[i][e + 1].column && this.Xg[this.Vg[i][e + 1].column.travIdx]++
                                }
                                ,
                                t
                        }();
                        t.bandProcessor = o;
                        function n(e) {
                            var t = [];
                            return r(e, t),
                                t
                        }
                        t.getAllLeaves = n;
                        function r(e, t) {
                            var i, o, n, a;
                            if (e)
                                for (i = 0,
                                         o = e.length; i < o; i++)
                                    n = e[i],
                                    n.options && (n = n.options),
                                        a = n.columns,
                                        a && a.length ? r(a, t) : t.push(n)
                        }
                        function a(e, t) {
                            var i, o, n, r = null;
                            if (e && t >= 0)
                                for (i = 0,
                                         o = e.length; i < o && !r; i++) {
                                    if (n = e[i],
                                        n.options && (n = n.options),
                                        n.travIdx === t)
                                        return {
                                            found: n,
                                            at: e
                                        };
                                    n.columns && (r = this.getColumnByTravIdx(n.columns, t))
                                }
                            return r
                        }
                        t.getColumnByTravIdx = a;
                        function s(e, t, i) {
                            if (t.options && (t = t.options),
                                i.options && (i = i.options),
                                i.isBand && t.parentIdx >= 0) {
                                if (t.parentIdx === i.travIdx)
                                    return !0;
                                if (t.parentIdx > i.travIdx)
                                    for (var o = this.flatten(e); ; ) {
                                        if (t = o[t.parentIdx],
                                            t.travIdx === i.travIdx)
                                            return !0;
                                        if (-1 === t.parentIdx)
                                            break
                                    }
                            }
                            return !1
                        }
                        t.isChildOf = s;
                        function l(e) {
                            var t = [];
                            return c(e, t),
                                t
                        }
                        t.getLeaves = l;
                        function c(e, t) {
                            var i, o, n;
                            if (e)
                                for (i = 0,
                                         o = e.length; i < o; i++)
                                    n = e[i],
                                    n.isLeaf && t.push(n),
                                    n.columns && c(n.columns, t)
                        }
                        function d(e) {
                            return p(e, 0, -1)
                        }
                        t.setTraverseIndex = d;
                        function p(e, t, i) {
                            var o, n, r;
                            if (e)
                                for (o = 0,
                                         n = e.length; o < n; o++)
                                    r = e[o],
                                    r.options && (r = r.options),
                                        r.linearIdx = o,
                                        r.travIdx = t++,
                                        r.parentIdx = i,
                                    r.columns && (t = p(r.columns, t, t - 1));
                            return t
                        }
                        function u(t) {
                            var i = [];
                            return e.grid.traverse(t, function(e) {
                                i.push(e)
                            }),
                                i
                        }
                        t.flatten = u;
                        function h(t, o) {
                            var n, r, a;
                            if (t && i.isFunction(o))
                                for (n = 0; n < t.length; n++)
                                    a = t[n],
                                    a.options && (a = a.options),
                                        r = t.length,
                                        o(a, t),
                                        t.length === r ? a.columns && e.grid.traverse(a.columns, o) : n--
                        }
                        t.traverse = h
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(t) {
                                if (this.bh = void 0,
                                        this.eh = void 0,
                                        this.fh = void 0,
                                        this.gh = void 0,
                                        this.hh = void 0,
                                        this.ih = void 0,
                                        !t)
                                    throw "exception";
                                this.jh = t,
                                    this.Bd = t.sd.dataView(),
                                    this.kh = new e.grid.filterOperatorsCache(t)
                            }
                            return t.prototype.compareSettings = function() {
                                var t = !0, i, o, n, r;
                                if (t = (i = this.DVPagingSettings()) === (o = this.WGPagingSettings()),
                                    !t && i && o && (t = i.pageSize === o.pageSize && i.pageIndex === o.pageIndex),
                                    t && !(t = (i = this.DVSortingSettings()) === (o = this.WGSortingSettings())) && i && o && (r = i.length) === o.length)
                                    for (t = !0,
                                             n = 0; n < r && t; n++)
                                        t = i[n].dataKey === o[n].dataKey && i[n].sortDirection === o[n].sortDirection;
                                return t && (i = this.DVFilteringSettings(),
                                    o = this.WGFilteringSettings(),
                                    t = e.grid.compareObj(i, o)),
                                    t
                            }
                                ,
                                t.prototype.DVFilteringSettings = function() {
                                    function e(t, o) {
                                        var n;
                                        i.each(t, function(t, r) {
                                            "string" == typeof r ? n = r : i.isArray(r) ? e(r, o) : (o.filterValue.push(r.value),
                                                o.filterOperator.push({
                                                    name: r.originalOperator || r.operator,
                                                    condition: n
                                                }))
                                        })
                                    }
                                    if (void 0 === this.bh) {
                                        var t = []
                                            , o = this.Bd.filter();
                                        o && i.each(o, function(o, n) {
                                            var r = {
                                                dataKey: o
                                            };
                                            i.isArray(n) ? (r.filterValue = [],
                                                r.filterOperator = [],
                                                e(n, r)) : i.isPlainObject(n) ? (r.filterValue = n.value,
                                                r.filterOperator = n.originalOperator || n.operator || "Equals") : (r.filterValue = n,
                                                r.filterOperator = "Equals"),
                                                t.push(r)
                                        }),
                                            this.bh = t.length ? t : null
                                    }
                                    return this.bh
                                }
                                ,
                                t.prototype.DVPagingSettings = function() {
                                    var t, i;
                                    return void 0 === this.eh && (t = e.grid.asPagedDataView(this.Bd)) && (i = t.pageSize(),
                                        this.eh = i > 0 ? {
                                            pageSize: t.pageSize(),
                                            pageIndex: t.pageIndex()
                                        } : null),
                                        this.eh
                                }
                                ,
                                t.prototype.DVSortingSettings = function() {
                                    var t, o;
                                    return void 0 === this.fh && (t = [],
                                    (o = e.data.sorting.compile(this.Bd.sort()).normalized) && i.each(o, function(e, i) {
                                        null !== i && t.push({
                                            dataKey: "string" == typeof i ? i : i.property,
                                            sortDirection: i.asc || void 0 === i.asc ? "ascending" : "descending"
                                        })
                                    }),
                                        this.fh = t.length ? t : null),
                                        this.fh
                                }
                                ,
                                t.prototype.WGFilteringSettings = function() {
                                    if (void 0 === this.gh) {
                                        var t = []
                                            , o = this.jh.Dd("leaves")
                                            , n = this;
                                        o && i.each(o, function(i, o) {
                                            if (e.grid.validDataKey(o.dataKey) && o.filterOperator) {
                                                var r = e.grid.deepExtend({}, {
                                                    foo: o.filterValue
                                                }).foo
                                                    , a = e.grid.deepExtend({}, {
                                                    foo: o.filterOperator
                                                }).foo
                                                    , s = e.grid.filterHelper.verify(a, r, o.dataType, n.kh);
                                                s && t.push({
                                                    owner: o,
                                                    dataKey: o.dataKey,
                                                    filterValue: s.filterValue,
                                                    filterOperator: s.filterOperator
                                                })
                                            }
                                        }),
                                            this.gh = t.length ? t : null
                                    }
                                    return this.gh
                                }
                                ,
                                t.prototype.WGPagingSettings = function() {
                                    return void 0 === this.hh && (this.hh = this.jh.options.allowPaging ? {
                                        pageSize: this.jh.options.pageSize,
                                        pageIndex: this.jh.options.pageIndex
                                    } : null),
                                        this.hh
                                }
                                ,
                                t.prototype.WGSortingSettings = function() {
                                    if (void 0 === this.ih) {
                                        var t = {}
                                            , o = []
                                            , n = this.jh.Je(!0)
                                            , r = this.jh.Dd("leaves") || []
                                            , a = function(t) {
                                            return !t.isBand && t.allowSort && e.grid.validDataKey(t.dataKey)
                                        }
                                            , s = 0;
                                        this.jh.options.allowSorting && (i.each(n, function(e, i) {
                                            a(i) && ("none" === i.sortDirection && (i.sortDirection = "ascending"),
                                                t[i.dataKey] = {
                                                    dataKey: i.dataKey,
                                                    sortDirection: i.sortDirection,
                                                    sortOrder: s++
                                                })
                                        }),
                                            s++,
                                            i.each(r, function(e, i) {
                                                a(i) && ("ascending" !== i.sortDirection && "descending" !== i.sortDirection || t[i.dataKey] || (t[i.dataKey] = {
                                                    dataKey: i.dataKey,
                                                    sortDirection: i.sortDirection,
                                                    sortOrder: (i.sortOrder || 0) + s
                                                }))
                                            }),
                                            i.each(t, function(e, t) {
                                                o.push(t)
                                            }),
                                            o.sort(function(e, t) {
                                                return e.sortOrder - t.sortOrder
                                            }),
                                            i.each(o, function(e, t) {
                                                delete t.sortOrder
                                            })),
                                            this.ih = o.length ? o : null
                                    }
                                    return this.ih
                                }
                                ,
                                t.prototype.MapWGToDV = function() {
                                    var t, o, n = this, r = {};
                                    return this.lh() && (t = this.WGPagingSettings()) ? (r.pageIndex = t.pageIndex,
                                        r.pageSize = t.pageSize) : r.pageSize = -1,
                                    this.mh() && (r.sort = [],
                                    (t = this.WGSortingSettings()) && (r.sort = [],
                                        i.each(t, function(e, t) {
                                            r.sort.push({
                                                property: t.dataKey,
                                                asc: "ascending" === t.sortDirection
                                            })
                                        }))),
                                        this.jh.deficientFilters = {},
                                    this.nh() && (i.each(this.jh.Dd("leaves"), function(t, i) {
                                        e.grid.validDataKey(i.dataKey) && void 0 === i.filterOperator ^ void 0 === i.filterValue && (n.jh.deficientFilters[i.dataKey] = {
                                            filterOperator: i.filterOperator,
                                            filterValue: i.filterValue
                                        })
                                    }),
                                        r.filter = {},
                                    (t = this.WGFilteringSettings()) && (r.filter = this.oh(t)),
                                    i.isEmptyObject(r.filter) && (r.filter = null)),
                                        r
                                }
                                ,
                                t.prototype.MapDVToWG = function() {
                                    var t, o = {}, n = this.mh(), r = this.lh(), a = this.nh(), s = e.grid.asPagedDataView(this.Bd), l = this;
                                    i.each(this.jh.Dd("leaves"), function(e, t) {
                                        n && (t.sortOrder = 0,
                                            t.sortDirection = "none"),
                                        a && (t.filterOperator = "nofilter",
                                            t.filterValue = void 0),
                                            o[t.dataKey] = t
                                    }),
                                    r && s && (this.jh.options.pageSize = s.pageSize(),
                                        this.jh.options.pageIndex = s.pageIndex()),
                                    n && (t = this.DVSortingSettings()) && i.each(t, function(e, t) {
                                        var i;
                                        (i = o[t.dataKey]) && (i.sortDirection = t.sortDirection,
                                            i.sortOrder = e)
                                    }),
                                    a && ((t = this.DVFilteringSettings()) && i.each(t, function(e, t) {
                                        var n;
                                        (n = o[t.dataKey]) && (n.filterValue = t.filterValue,
                                            n.filterOperator = t.filterOperator,
                                        i.isPlainObject(n.filterOperator) && (n.filterOperator = n.filterOperator.name),
                                            delete l.jh.deficientFilters[n.dataKey])
                                    }),
                                        i.each(this.jh.deficientFilters, function(e, t) {
                                            o[e].filterOperator = t.filterOperator,
                                                o[e].filterValue = t.filterValue
                                        }))
                                }
                                ,
                                t.prototype.lh = function() {
                                    return this.jh.options.allowPaging && !this.jh.ee() && !this.jh.fe()
                                }
                                ,
                                t.prototype.mh = function() {
                                    return this.jh.options.allowSorting && !this.jh.fe()
                                }
                                ,
                                t.prototype.nh = function() {
                                    return !this.jh.fe()
                                }
                                ,
                                t.prototype.makeProxyFilter = function(t, o, n, r) {
                                    var a, s, l, c, d, p;
                                    return n = n.toLowerCase(),
                                        a = this,
                                        s = "datetime" === t.dataType,
                                        l = {
                                            originalOperator: void 0,
                                            property: o,
                                            operator: n,
                                            value: r
                                        },
                                        c = this.kh.getByNameInt(n),
                                        d = e.data.filtering.ops[n],
                                    "nofilter" !== n && (c.isCustom || s) && (l.originalOperator = l.operator,
                                        c.isCustom ? (l.operator = i.extend(!0, {}, c.op),
                                            l.operator.apply = l.operator.operator) : (l.operator = i.extend(!0, {}, d),
                                                p = t.inputType ? e.grid.TimeUnitConverter.convertInputType(t.inputType) : e.grid.TimeUnitConverter.convertFormatString(t.dataFormatString || "d"),
                                                l.operator.apply = function(i, o) {
                                                    return i instanceof Date || (i = a.jh.parse(t, i)),
                                                    o instanceof Date || (o = a.jh.parse(t, o)),
                                                        e.grid.TimeUnitConverter.cutDate(i, p),
                                                        e.grid.TimeUnitConverter.cutDate(o, p),
                                                        d.apply(i, o)
                                                }
                                        )),
                                        l
                                }
                                ,
                                t.prototype.oh = function(e) {
                                    var t = {}
                                        , o = this;
                                    return i.each(e, function(e, n) {
                                        var r = n.dataKey, a = [], s = "and", l, c, d, p;
                                        if (i.isPlainObject(n) && (c = n.filterOperator,
                                                d = n.filterValue,
                                            null != c)) {
                                            if (i.isArray(c) || (c = [c]),
                                                i.isArray(d) || (d = [d]),
                                                c.length != d.length)
                                                throw "The number of filter operators must match the number of filter values";
                                            0 != c.length && (i.each(c, function(e, t) {
                                                var c;
                                                if ("string" == typeof t && (t = {
                                                        name: t
                                                    }),
                                                    !i.isPlainObject(t) || !t.name)
                                                    throw "Invalid filter operator";
                                                c = d[e],
                                                i.isArray(c) || (c = [c]),
                                                    p = i.map(c, function(e) {
                                                        return o.makeProxyFilter(n.owner, r, t.name, e)
                                                    });
                                                function u() {
                                                    p.length > 1 ? p.splice(0, 0, "or") : p = p[0]
                                                }
                                                function h() {
                                                    null == s && (s = l,
                                                        a.splice(0, 0, l))
                                                }
                                                s = null,
                                                    l = t.condition || "or",
                                                    a.length <= 1 || s == l ? 1 == p.length || a.length <= 1 || "or" == s ? (a = a.concat(p),
                                                        h()) : (u(),
                                                        a.push(p),
                                                        h()) : (u(),
                                                        a = [a, p],
                                                        h())
                                            }),
                                                i.each(a, function(e, t) {
                                                    i.isArray(t) && 2 == t.length && (a[e] = t[1])
                                                }),
                                            2 != a.length || (a[0],
                                                0) || a.shift(),
                                            1 == a.length && (a = a[0]),
                                                t[r] = a)
                                        }
                                    }),
                                        t
                                }
                                ,
                                t
                        }();
                        t.settingsManager = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function() {
                            function t(e) {
                                this.ph = null,
                                    this.qh = !1,
                                    this.rh = !1,
                                    this.uh = !1,
                                    this.vh = null,
                                    this.wh = null,
                                    this.xh = null,
                                    this.yh = 0,
                                    this.zh = [],
                                    this.Ah = !1,
                                    this.Bh = !1,
                                    this.Ch = !1,
                                    this.jh = e,
                                    this.Dh()
                            }
                            return t.prototype.data = function() {
                                var t = this.Eh()
                                    , i = e.grid.asPagedDataView(t);
                                return {
                                    data: this.Fh(),
                                    totalRows: null != i ? i.totalItemCount() : (t.getSource() || []).length,
                                    totals: this.Gh(),
                                    emptyData: this.isBoundedToDOM() ? this.ph.emptyData : null
                                }
                            }
                                ,
                                t.prototype.dataView = function() {
                                    return this.Eh()
                                }
                                ,
                                t.prototype.dispose = function() {
                                    var e = this.Eh();
                                    this.Hh.dispose(),
                                        o.each(this.zh, function(e, t) {
                                            t.dispose()
                                        }),
                                    e && this.Ah && e.dispose(),
                                        this.jh.Bd = null
                                }
                                ,
                                t.prototype.ignoreChangeEvent = function(e) {
                                    if (!arguments.length)
                                        return this.rh;
                                    this.rh = !0 === e
                                }
                                ,
                                t.prototype.ignoreCurrentChangedEvent = function(e) {
                                    if (!arguments.length)
                                        return this.uh;
                                    this.uh = !0 === e
                                }
                                ,
                                t.prototype.isDataLoaded = function() {
                                    var e = this.Eh();
                                    return e.isLoaded()
                                }
                                ,
                                t.prototype.isOwnDataView = function() {
                                    return this.Ah
                                }
                                ,
                                t.prototype.getFieldsInfo = function() {
                                    var e = this.Eh();
                                    return this.Ih(e.getProperties())
                                }
                                ,
                                t.prototype.Ih = function(e) {
                                    var t = {};
                                    return e && o.each(e, function(e, i) {
                                        "$$hash" !== i.name && (t[i.name] = {
                                            name: i.name,
                                            type: i.type || "string"
                                        })
                                    }),
                                        t
                                }
                                ,
                                t.prototype.isBoundedToDOM = function() {
                                    return null !== this.ph
                                }
                                ,
                                t.prototype.load = function(t) {
                                    var i, o, n, r;
                                    this.wh = t,
                                        i = this.Eh(),
                                    i || (this.Dh(),
                                        i = this.Eh()),
                                        this.ke(),
                                        o = new e.grid.settingsManager(this.jh),
                                        this.Jh(o) ? (n = o.MapWGToDV(),
                                            r = !1,
                                        this.Bh && !this.Ch && i.isLoaded() && (r = !0),
                                            this.ignoreCurrentChangedEvent(!0),
                                            i.refresh(n, r)) : this.isDataLoaded() && (this.oe(),
                                            this.me())
                                }
                                ,
                                t.prototype.currentPosition = function(e) {
                                    var t = this.Eh();
                                    if (!arguments.length)
                                        return t.currentPosition();
                                    this.ignoreCurrentChangedEvent(!0);
                                    try {
                                        t.currentPosition(e)
                                    } finally {
                                        this.ignoreCurrentChangedEvent(!1)
                                    }
                                }
                                ,
                                t.prototype.getValue = function(e, t) {
                                    var i = this.Eh();
                                    return "number" == typeof t && (t += ""),
                                        i.getProperty(e, t)
                                }
                                ,
                                t.prototype.setValue = function(e, t, i) {
                                    var o = this.Eh();
                                    this.ignoreChangeEvent(!0);
                                    try {
                                        "number" == typeof t && (t += ""),
                                            o.setProperty(e, t, i)
                                    } finally {
                                        this.ignoreChangeEvent(!1)
                                    }
                                }
                                ,
                                t.prototype.makeDirty = function() {
                                    this.Hh.removeAll(),
                                        this.xh = null,
                                        this.vh = null
                                }
                                ,
                                t.prototype.Dh = function() {
                                    var t, i, n = this.jh.options.data, r = this.Eh(), a = !1;
                                    r || (n || (this.ph = this.Kh(this.jh.element, this.jh.options.readAttributesFromData),
                                        n = this.ph.items),
                                        a = "undefined" != typeof gcuidatasource && n instanceof gcuidatasource,
                                        this.Ah = o.isArray(n) || a,
                                        this.Bh = !(!this.Ah || !a),
                                        this.Ch = !!(this.Ah && a && n.dynamic),
                                        this.Ah ? (!this.ph && this.jh.options.readAttributesFromData && this.Lh(n),
                                            i = this.isBoundedToDOM() && e.grid.getTableSection(this.jh.element, e.grid.rowScope.body),
                                            r = e.grid.GridDataView.create(e.data.asDataView(this.Mh(n, i)))) : r = n,
                                        this.jh.Bd = r,
                                        this.zh.push(r.isLoading.subscribe(o.proxy(this.Nh, this))),
                                        this.zh.push(r.isLoaded.subscribe(o.proxy(this.Oh, this))),
                                        this.zh.push(r.subscribe(o.proxy(this.Ph, this))),
                                        this.zh.push(r.currentPosition.subscribe(o.proxy(this.Qh, this))),
                                        this.Hh = new e.grid.propChangeListener(o.proxy(this.Rh, this)))
                                }
                                ,
                                t.prototype.Mh = function(t, i) {
                                    var n, r, a, s, l = this;
                                    return t && t.length && (n = o.extend(!0, [], this.jh.options.columns),
                                        r = e.data.ArrayDataViewBase.ua(t[0]) || [],
                                        a = this.Ih(r),
                                        s = [],
                                        this.jh.Rd(n, "merge", a, !0, !0),
                                        e.grid.traverse(n, function(t) {
                                            e.grid.validDataKey(t.dataKey) && s.push(t)
                                        }),
                                    n.length && o.each(t, function(t, o) {
                                        e.grid.dataViewWrapper.Sh(l.jh, o, i && i.rows[t], s)
                                    })),
                                        t
                                }
                                ,
                                t.Sh = function t(i, n, r, a) {
                                    return o.each(a, function(t, o) {
                                        var a, s, l;
                                        "string" !== e.grid.getDataType(o) && e.grid.validDataKey(o.dataKey) && (a = n[o.dataKey],
                                            s = i.parse(o, a),
                                        isNaN(s) && (l = null,
                                        r && (l = r.cells[o.dataKey]),
                                            s = i.parseFailed(o, a, n, l)),
                                            n[o.dataKey] = s)
                                    }),
                                        n
                                }
                                ,
                                t.prototype.Eh = function() {
                                    return this.jh.Bd
                                }
                                ,
                                t.prototype.Jh = function(e) {
                                    var t = this.Eh();
                                    return !!(this.Ch || this.Bh && !t.isLoaded()) || (!(!this.Ah || this.Bh || !this.isDataLoaded()) || (!this.isDataLoaded() && !t.isLoading() || !e.compareSettings()))
                                }
                                ,
                                t.prototype.Th = function(e) {
                                    if (!this.Ah && this.jh.options.allowPaging && (e.DVPagingSettings() || {}).pageSize !== (e.WGPagingSettings() || {}).pageSize)
                                        throw "The pageSize option of the external dataView can't be changed."
                                }
                                ,
                                t.prototype.Nh = function(e) {
                                    this.qh || e && (this.wh || this.ke())
                                }
                                ,
                                t.prototype.Oh = function(e) {
                                    this.qh || e && this.oe()
                                }
                                ,
                                t.prototype.Ph = function(e) {
                                    var t = this;
                                    if (!this.qh && !this.rh) {
                                        if (e.changes) {
                                            if (e.length && "detached" === e[0].entityState())
                                                return;
                                            o.each(e.changes, function(e, i) {
                                                switch (i.changeType) {
                                                    case "remove":
                                                        t.Hh.remove(i.index);
                                                        break;
                                                    case "add":
                                                        t.Hh.insert(i.index, i.element)
                                                }
                                            })
                                        }
                                        this.Uh.apply(this, arguments)
                                    }
                                }
                                ,
                                t.prototype.Qh = function() {
                                    this.qh || this.uh || this.Vh.apply(this, arguments)
                                }
                                ,
                                t.prototype.me = function() {
                                    try {
                                        this.ignoreCurrentChangedEvent(!1),
                                            this.makeDirty(),
                                            this.jh.me(this.wh)
                                    } finally {
                                        this.wh = null
                                    }
                                }
                                ,
                                t.prototype.Rh = function(e) {
                                    var t = this;
                                    this.yh > 0 && (window.clearTimeout(this.yh),
                                        this.yh = 0),
                                    -1 != this.yh && (this.yh = window.setTimeout(function() {
                                        t.yh = -1,
                                        t.jh.pd || t.Uh(),
                                            t.yh = 0
                                    }, 100))
                                }
                                ,
                                t.prototype.Uh = function(e) {
                                    this.me()
                                }
                                ,
                                t.prototype.Vh = function(e, t) {
                                    this.jh.he(e, t)
                                }
                                ,
                                t.prototype.ke = function() {
                                    this.jh.ke()
                                }
                                ,
                                t.prototype.oe = function() {
                                    this.jh.oe()
                                }
                                ,
                                t.prototype.Fh = function() {
                                    var e, t, i, o, n;
                                    if (!this.vh)
                                        for (e = this.Eh(),
                                                 t = e.count(),
                                                 this.vh = [],
                                                 i = !0,
                                                 o = 0; o < t; o++)
                                            n = e.item(o),
                                            i && (this.Hh.insert(o, n) || 0 !== o || (i = !1)),
                                                this.vh.push(this.hf(n, o));
                                    return this.vh || (this.vh = []),
                                        this.vh
                                }
                                ,
                                t.prototype.Gh = function() {
                                    if (!this.xh) {
                                        var e = this.Eh();
                                        this.xh = this.Wh(e, this.jh.Se(!0))
                                    }
                                    return this.xh || (this.xh = {}),
                                        this.xh
                                }
                                ,
                                t.prototype.Wh = function(t, i) {
                                    if (!i || 0 === i.length)
                                        return {};
                                    var o, n, r, a, s = [], l = {};
                                    for (o = 0,
                                             n = i.length; o < n; o++)
                                        s.push(new e.grid.tally);
                                    for (o = 0,
                                             n = t.count(); o < n; o++)
                                        for (r = 0,
                                                 a = s.length; r < a; r++)
                                            s[r].add(this.jh.parse(i[r].column, this.getValue(o, i[r].column.dataKey)));
                                    for (o = 0,
                                             n = s.length; o < n; o++)
                                        l[i[o].column.dataKey] = s[o].getValueString(i[o].column);
                                    return l
                                }
                                ,
                                t.prototype.Kh = function(t, i) {
                                    var n = {
                                        items: [],
                                        emptyData: [],
                                        header: e.grid.readTableSection(t, e.grid.rowScope.head)
                                    };
                                    return 1 === e.grid.getTableSectionLength(t, 2) && o(e.grid.getTableSectionRow(t, 2, 0)).hasClass("gcui-gcuigrid-emptydatarow") ? n.emptyData = e.grid.readTableSection(t, e.grid.rowScope.body) : n.items = e.grid.readTableSection(t, e.grid.rowScope.body, i),
                                        n
                                }
                                ,
                                t.prototype.Lh = function(t) {
                                    o.each(t, function(t, i) {
                                        var n = e.data.Expando.getFrom(i, !0), r;
                                        r = n[e.grid.EXPANDO] = {
                                            cellsAttributes: {},
                                            rowAttributes: {}
                                        },
                                        i.rowAttributes && (r.rowAttributes = i.rowAttributes,
                                            delete i.rowAttributes),
                                            o.each(i, function(e, t) {
                                                o.isArray(t) && (r.cellsAttributes[e] = t[1],
                                                    i[e] = t[0])
                                            })
                                    })
                                }
                                ,
                                t.prototype.hf = function(e, t) {
                                    return {
                                        values: e,
                                        originalRowIndex: t
                                    }
                                }
                                ,
                                t.prototype.if = function() {
                                    var e = this.Eh();
                                    if (e)
                                        try {
                                            this.qh = !0,
                                                e.refresh()
                                        } finally {
                                            this.qh = !1
                                        }
                                }
                                ,
                                t.prototype.Xh = function(t, i) {
                                    var o = this.Eh();
                                    e.grid.GridDataView,
                                        o.Xh(t, i)
                                }
                                ,
                                t.prototype.ff = function(t, i, o) {
                                    var n = this.Eh();
                                    e.grid.GridDataView,
                                        2 === arguments.length ? n.ff(t, i) : n.ff(t, i, o)
                                }
                                ,
                                t.prototype.gf = function(t) {
                                    var i = this.Eh();
                                    e.grid.GridDataView,
                                        i.gf(t)
                                }
                                ,
                                t
                        }();
                        t.dataViewWrapper = n;
                        function r(e) {
                            return e && "pageCount"in e ? e : null
                        }
                        t.asPagedDataView = r;
                        function a(e) {
                            return e && "commitEdit"in e ? e : null
                        }
                        t.asEditableDataView = a,
                            i = function() {
                                function e(e) {
                                    this.Yh = [],
                                        this.Zh = e
                                }
                                return e.prototype.insert = function(e, t) {
                                    var i = null
                                        , n = this;
                                    return o.each(t, function(e, t) {
                                        n.$h(e) && t && o.isFunction(t.subscribe) && (i = i || [],
                                            i.push(t.subscribe(n.Zh)))
                                    }),
                                    !!i && (this.Yh.length < e && (this.Yh.length = e),
                                        this.Yh.splice(e, 0, i),
                                        !0)
                                }
                                    ,
                                    e.prototype.remove = function(e) {
                                        var t = this.Yh[e];
                                        t && o.each(t, function(e, i) {
                                            i.dispose(),
                                                t[e] = null
                                        }),
                                            this.Yh[e] = null,
                                            this.Yh.splice(e, 1)
                                    }
                                    ,
                                    e.prototype.removeAll = function() {
                                        for (var e, t; e = this.Yh.length; )
                                            this.remove(e - 1);
                                        this.Yh = []
                                    }
                                    ,
                                    e.prototype.dispose = function() {
                                        this.removeAll()
                                    }
                                    ,
                                    e.prototype.$h = function(e) {
                                        return !e || "string" != typeof e || null === e.match(/^entityState|jQuery/)
                                    }
                                    ,
                                    e
                            }(),
                            t.propChangeListener = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function() {
                            function i(t, i, o, n, r) {
                                this.cr = new e.grid.cellRange(-1,-1),
                                    this.isExpanded = !1,
                                    this._h = -1,
                                    this.ai = -1,
                                    this.bi = "none",
                                    this.ci = !0,
                                void 0 !== t && (this.isExpanded = t),
                                void 0 !== i && (this.cr = i),
                                void 0 !== o && (this.ai = o),
                                void 0 !== n && (this.bi = n),
                                void 0 !== r && (this.ci = r)
                            }
                            return i.prototype.isSubRange = function(e) {
                                return this.cr.r1 >= e.cr.r1 && this.cr.r2 <= e.cr.r2
                            }
                                ,
                                i.prototype.toString = function() {
                                    return this.cr.r1 + "-" + this.cr.r2
                                }
                                ,
                                i.prototype.getHeaderImageClass = function(e) {
                                    var i = this.owner;
                                    return i ? e ? i.expandedImageClass || t.c1field.prototype.options.groupInfo.expandedImageClass : i.collapsedImageClass || t.c1field.prototype.options.groupInfo.collapsedImageClass : null
                                }
                                ,
                                i.prototype.collapse = function() {
                                    var t, i, o, n, r;
                                    (t = this.owner) && (i = t.owner) && (o = i.owner) && (n = o.Dd("leaves"),
                                    e.grid.groupHelper.isParentExpanded(n, this.cr, t.level) && "footer" !== t.position && "none" !== t.outlineMode && (r = e.grid.groupHelper.getGroupedColumnsCount(n),
                                        this.di(o.Jd(), n, this, r, o.Dd("viewRenderBounds").start)))
                                }
                                ,
                                i.prototype.expand = function(t) {
                                    var i, o, n, r, a;
                                    (i = this.owner) && (o = i.owner) && (n = o.owner) && (r = n.Dd("leaves"),
                                    e.grid.groupHelper.isParentExpanded(r, this.cr, i.level) && (a = e.grid.groupHelper.getGroupedColumnsCount(r),
                                        this.ei(n.Jd(), r, this, a, t, !0, n.Dd("viewRenderBounds").start)))
                                }
                                ,
                                i.prototype.di = function(t, i, o, n, r) {
                                    var a = o.owner, s = o.cr.r1, l = o.cr.r2, c, d, p, u, h;
                                    switch (a.position) {
                                        case "header":
                                        case "headerAndFooter":
                                            this.fi(t.item(o.cr.r1 - r), void 0, !1),
                                                s++
                                    }
                                    for (c = s; c <= l; c++)
                                        this.fi(t.item(c - r), !1);
                                    for (o.isExpanded = !1,
                                             this.gi(t, o, r),
                                             c = a.level + 1; c <= n; c++)
                                        for (p = e.grid.groupHelper.getChildGroupRanges(i, o.cr, c - 1),
                                                 h = 0,
                                                 d = p.length; h < d; h++) {
                                            switch (u = p[h],
                                                u.isExpanded = !1,
                                                u.owner.position) {
                                                case "header":
                                                case "headerAndFooter":
                                                    this.fi(t.item(u.cr.r1 - r), void 0, !1)
                                            }
                                            this.gi(t, u, r)
                                        }
                                }
                                ,
                                i.prototype.ei = function(t, i, o, n, r, a, s) {
                                    var l = o.owner, c = o.cr.r1, d = o.cr.r2, p, u, h, f, g;
                                    switch (l.position) {
                                        case "header":
                                            this.fi(t.item(c - s), !0, a || r),
                                                c++;
                                            break;
                                        case "footer":
                                            this.fi(t.item(d - s), !0),
                                                d--;
                                            break;
                                        case "headerAndFooter":
                                            this.fi(t.item(c - s), !0, a || r),
                                            a && this.fi(t.item(d - s), !0),
                                                c++,
                                                d--
                                    }
                                    if (a)
                                        if (o.isExpanded = !0,
                                                this.gi(t, o, s),
                                            o.owner.level === n)
                                            for (p = c; p <= d; p++)
                                                this.fi(t.item(p - s), !0);
                                        else {
                                            if (h = e.grid.groupHelper.getChildGroupRanges(i, o.cr, o.owner.level),
                                                h.length && c !== h[0].cr.r1)
                                                for (p = c; p < h[0].cr.r1; p++)
                                                    this.fi(t.item(p - s), !0);
                                            if (r)
                                                for (p = 0,
                                                         u = h.length; p < u; p++)
                                                    f = h[p],
                                                        this.ei(t, i, f, n, r, !0, s);
                                            else
                                                for (p = 0,
                                                         u = h.length; p < u; p++)
                                                    f = h[p],
                                                        g = "footer" === f.owner.position || "none" === f.owner.outlineMode,
                                                        this.ei(t, i, f, n, !1, g, s)
                                        }
                                }
                                ,
                                i.prototype.fi = function(e, t, i) {
                                    e && (e[0] && (void 0 !== t && (e[0].style.display = t ? "" : "none",
                                        e[0]["aria-hidden"] = t ? "false" : "true"),
                                    void 0 !== i && (e[0]["aria-expanded"] = i ? "true" : "false")),
                                    e[1] && (void 0 !== t && (e[1].style.display = t ? "" : "none",
                                        e[1]["aria-hidden"] = t ? "false" : "true"),
                                    void 0 !== i && (e[1]["aria-expanded"] = i ? "true" : "false")))
                                }
                                ,
                                i.prototype.gi = function(e, t, i) {
                                    if ("footer" !== t.owner.position) {
                                        var n = e.item(t.cr.r1 - i);
                                        n && o.each(n, function(e, i) {
                                            if (i) {
                                                var n = o(i).find("div.gcui-gcuigrid-grouptogglebtn:first-child");
                                                n && n.length && (n.toggleClass(t.getHeaderImageClass(!t.isExpanded), !1),
                                                    n.toggleClass(t.getHeaderImageClass(t.isExpanded), !0))
                                            }
                                        })
                                    }
                                }
                                ,
                                i
                        }();
                        t.groupRange = n,
                            i = function() {
                                function t() {
                                    this.hi = 0
                                }
                                return t.prototype.group = function(e, t, i) {
                                    var n, r, a = this;
                                    this.jh = e,
                                        this.k = t,
                                        this.ii = i,
                                        this.hi = 0,
                                        o.each(i, function(e, t) {
                                            t.groupInfo && (delete t.groupInfo.level,
                                                delete t.groupInfo.expandInfo)
                                        }),
                                        n = this.jh.Je(!0),
                                        r = 1,
                                        o.each(n, function(e, t) {
                                            a.hi = 0,
                                            t.groupInfo && t.groupInfo.position && "none" !== t.groupInfo.position && t.dataIndex >= 0 && (t.groupInfo.level = r,
                                                t.groupInfo.expandInfo = [],
                                                a.ji(t, r++))
                                        }),
                                        delete this.jh,
                                        delete this.k,
                                        delete this.ii
                                }
                                    ,
                                    t.prototype.ji = function(t, i) {
                                        var n, r, a, s, l, c, d, p, u, h, f = 0, g = !0;
                                        for (o.each(this.ii, function(e, t) {
                                            if (t.parentVis)
                                                return f = e,
                                                    !1
                                        }),
                                                 n = 0; n < this.k.length; n++)
                                            if (this.k[n].rowType & e.grid.rowType.data) {
                                                if (r = this.ki(n, t, i),
                                                        a = !0,
                                                    (s = "startCollapsed" === t.groupInfo.outlineMode) || e.grid.groupHelper.isParentCollapsed(this.ii, r, i)) {
                                                    if (!1 === t.groupInfo.groupSingleRow && r.r1 === r.r2)
                                                        continue;
                                                    a = !1
                                                }
                                                if (i && this.jh.options.groupIndent)
                                                    for (l = r.r1; l <= r.r2; l++)
                                                        this.li(this.k[l][f], i);
                                                switch (g = !(!1 === t.groupInfo.groupSingleRow && r.r1 === r.r2),
                                                    t.groupInfo.position) {
                                                    case "header":
                                                        for (c = this.mi(t.groupInfo, r, a, g),
                                                                 h = r.r1; h <= r.r2; h++)
                                                            this.k[h].qe["aria-level"] = i + 1,
                                                            a || (this.k[h].re.display = "none",
                                                                this.k[h].qe["aria-hidden"] = !0);
                                                        if (!g)
                                                            break;
                                                        this.ni(c, i),
                                                            d = e.grid.groupHelper.isParentCollapsed(this.ii, c.cr, i),
                                                            p = this.oi(c, r, !0, d),
                                                            this.k.splice(r.r1, 0, p),
                                                            p.qe["arial-level"] = i,
                                                            p.qe["aria-expanded"] = a,
                                                        d && (p.re.display = "none",
                                                            p.qe["aria-hidden"] = !0),
                                                            n = r.r2 + 1;
                                                        break;
                                                    case "footer":
                                                        if (c = this.mi(t.groupInfo, r, !0, g),
                                                                !g)
                                                            break;
                                                        this.ni(c, i),
                                                            u = this.oi(c, r, !1, !1),
                                                            u.qe["aria-level"] = i,
                                                            this.k.splice(r.r2 + 1, 0, u),
                                                            n = r.r2 + 1,
                                                            d = e.grid.groupHelper.isParentCollapsed(this.ii, c.cr, i),
                                                        d && (u.re.display = "none",
                                                            u.qe["aria-hidden"] = !0);
                                                        break;
                                                    case "headerAndFooter":
                                                        for (c = this.mi(t.groupInfo, r, a, g),
                                                                 h = r.r1; h <= r.r2; h++)
                                                            this.k[h].qe["aria-level"] = i + 1,
                                                            a || (this.k[h].re.display = "none",
                                                                this.k[h].qe["aria-hidden"] = !0);
                                                        if (!g)
                                                            break;
                                                        this.ni(c, i),
                                                            d = e.grid.groupHelper.isParentCollapsed(this.ii, c.cr, i),
                                                            p = this.oi(c, r, !0, d),
                                                            u = this.oi(c, r, !1, !1),
                                                            this.k.splice(r.r2 + 1, 0, u),
                                                            u.qe["aria-level"] = i,
                                                        !d && a || (u.re.display = "none",
                                                            u.qe["aria-hidden"] = !0),
                                                            this.k.splice(r.r1, 0, p),
                                                            p.qe["aria-level"] = i,
                                                            p.qe["aria-expanded"] = a,
                                                        d && (p.re.display = "none",
                                                            p.qe["aria-hidden"] = !0),
                                                            n = r.r2 + 2;
                                                        break;
                                                    default:
                                                        throw e.grid.stringFormat('Unknown Position value: "{0}"', t.groupInfo.position)
                                                }
                                                this.hi++
                                            }
                                    }
                                    ,
                                    t.prototype.oi = function(t, i, o, n) {
                                        var r = t.owner, a = r.owner, s = a.owner, l = [], c = "", d = "", p, u, h, f, g, m, b, v;
                                        for (l.re = {},
                                                 l.qe = {},
                                                 l.qe.id = (o ? "GH" : "GF") + this.hi + "-" + r.level,
                                                 l.rowType = o ? e.grid.rowType.groupHeader : e.grid.rowType.groupFooter,
                                             a.dataIndex >= 0 && null !== (p = this.k[i.r1][a.dataIndex].value) && (c = s.toStr(a, p)),
                                             this.jh.ye() && l.push({
                                                 html: "&nbsp;"
                                             }),
                                                 u = {
                                                     html: "",
                                                     qe: {},
                                                     re: {}
                                                 },
                                             o && "none" !== r.outlineMode && (t.isExpanded ? u.html = '<div class="' + s.options.uiCSS.icon + " " + t.getHeaderImageClass(!0) + ' gcui-gcuigrid-grouptogglebtn">&nbsp;</div>' : u.html = '<div class="' + s.options.uiCSS.icon + " " + t.getHeaderImageClass(!1) + ' gcui-gcuigrid-grouptogglebtn">&nbsp;</div>'),
                                                 l.push(u),
                                             a.aggregate && "none" !== a.aggregate && (d = this.pi(i, a, a, o, c)),
                                                 h = o ? r.headerText : r.footerText,
                                                 "custom" === h ? (f = {
                                                     data: this.k,
                                                     column: a,
                                                     groupByColumn: r.owner,
                                                     groupText: c,
                                                     text: "",
                                                     groupingStart: i.r1,
                                                     groupingEnd: i.r2,
                                                     isGroupHeader: o,
                                                     aggregate: d
                                                 },
                                                 this.jh._trigger("groupText", null, f) && (h = f.text)) : (void 0 !== h && null !== h || (o && (h = "{1}: {0}"),
                                                 (d || 0 === d) && (h = h ? h + " {2}" : "{2}")),
                                                     h = e.grid.stringFormat(h, c, a && a.headerText ? a.headerText : "", "" + d)),
                                             h || (h = "&nbsp;"),
                                                 u.html += "<span>" + h + "</span>",
                                                 this.li(u, r.level - 1),
                                                 g = 1,
                                                 m = this.jh.ye() ? 1 : 0,
                                                 b = !0; m < this.ii.length; m++)
                                            if (p = this.ii[m],
                                                    p.parentVis) {
                                                if (b) {
                                                    b = !1;
                                                    continue
                                                }
                                                if (!0 !== p.dynamic && p.aggregate && "none" !== p.aggregate)
                                                    break;
                                                g++
                                            }
                                        for (; m < this.ii.length; m++)
                                            p = this.ii[m],
                                            p.parentVis && (v = this.pi(i, p, r.owner, o, c),
                                            v || 0 === v || (v = "&nbsp;"),
                                                l.push({
                                                    html: "" + v,
                                                    qe: {
                                                        groupInfo: {
                                                            leafIndex: p.leavesIdx,
                                                            purpose: e.grid.groupRowCellPurpose.aggregateCell
                                                        }
                                                    }
                                                }));
                                        return u.qe.colSpan = g,
                                            u.qe.groupInfo = {
                                                leafIndex: a.leavesIdx,
                                                purpose: e.grid.groupRowCellPurpose.groupCell
                                            },
                                            l
                                    }
                                    ,
                                    t.prototype.pi = function(t, i, o, n, r) {
                                        var a = "", s, l, c;
                                        if (!i.aggregate || "none" === i.aggregate)
                                            return a;
                                        if ("custom" === i.aggregate)
                                            s = {
                                                data: this.k,
                                                column: i,
                                                groupByColumn: o,
                                                groupText: r,
                                                text: "",
                                                groupingStart: t.r1,
                                                groupingEnd: t.r2,
                                                isGroupHeader: n
                                            },
                                            this.jh._trigger("groupAggregate", null, s) && (a = s.text);
                                        else {
                                            for (l = new e.grid.tally,
                                                     c = t.r1; c <= t.r2; c++)
                                                l.add(this.k[c][i.dataIndex].value);
                                            a = l.getValueString(i)
                                        }
                                        return a
                                    }
                                    ,
                                    t.prototype.ki = function(t, i, o) {
                                        var n = i.leavesIdx, r = new e.grid.cellRange(t,n), a = e.grid.groupHelper.getParentGroupRange(this.ii, r, o), s, l, c;
                                        if (this.k[t].rowType & e.grid.rowType.data)
                                            for (s = this.k[t][i.dataIndex].value,
                                                 s instanceof Date && (s = s.getTime()),
                                                     r.r2 = t,
                                                     c = this.k.length - 1; r.r2 < c && (this.k[r.r2 + 1].rowType & e.grid.rowType.data && !(a && r.r2 + 1 > a.cr.r2)) && (l = this.k[r.r2 + 1][i.dataIndex].value,
                                            l instanceof Date && (l = l.getTime()),
                                            s === l); r.r2++)
                                                ;
                                        return r
                                    }
                                    ,
                                    t.prototype.mi = function(t, i, o, n) {
                                        var r = null, a = e.grid.groupHelper.getChildGroupIndex(i, t.expandInfo), s, l, c, d;
                                        return a >= 0 && a < t.expandInfo.length ? r = t.expandInfo[a] : (s = new e.grid.cellRange(i.r1,i.r1,i.r2,i.r2),
                                            l = "footer" === t.position || !n || o && "startCollapsed" !== t.outlineMode,
                                            r = new e.grid.groupRange(l,s,-1,t.position,n),
                                            r.owner = t,
                                            t.expandInfo.push(r)),
                                        r && n && (c = i.r1,
                                            d = i.r2,
                                        "headerAndFooter" === t.position && (d += 2),
                                        "headerAndFooter" !== t.position && d++,
                                            r.cr.r2 = d),
                                            r
                                    }
                                    ,
                                    t.prototype.ni = function(e, t) {
                                        var i, o, n, r, a, s, l;
                                        for (i = 0,
                                                 o = this.ii.length; i < o; i++)
                                            if ((n = this.ii[i].groupInfo) && n.level < t)
                                                for (r = n.expandInfo ? n.expandInfo.length : 0,
                                                         a = 0; a < r; a++)
                                                    s = n.expandInfo[a],
                                                        l = "headerAndFooter" === e.position ? 2 : 1,
                                                    s.cr.r1 >= e.cr.r1 && (s.cr.r1 !== e.cr.r1 || "footer" !== s.position) && (s.cr.r1 += l),
                                                    s.cr.r2 >= e.cr.r1 && (s.cr.r2 += l)
                                    }
                                    ,
                                    t.prototype.li = function(e, t) {
                                        var i;
                                        t > 0 && (i = this.jh.options.groupIndent) && (e.re.paddingLeft = i * t + "px")
                                    }
                                    ,
                                    t
                            }(),
                            t.grouper = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t() {}
                            return t.qi = RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"),
                                t.getGroupInfo = function t(i) {
                                    if (i) {
                                        var o = e.grid.groupHelper.qi.exec(i.id), n, r, a;
                                        if (o)
                                            return n = parseInt(o[3], 10),
                                                r = parseInt(o[2], 10),
                                                a = "H" === o[1],
                                                {
                                                    level: n,
                                                    index: r,
                                                    isHeader: a,
                                                    toString: function() {
                                                        return (a ? "GH" : "GF") + r + "-" + n
                                                    }
                                                }
                                    }
                                    return null
                                }
                                ,
                                t.getColumnByGroupLevel = function e(t, i) {
                                    var o, n, r;
                                    for (o = 0,
                                             n = t.length; o < n; o++)
                                        if (r = t[o],
                                            r.groupInfo && r.groupInfo.level === i)
                                            return r;
                                    return null
                                }
                                ,
                                t.getGroupedColumnsCount = function e(t) {
                                    var i = 0, o, n, r;
                                    for (o = 0,
                                             n = t.length; o < n; o++)
                                        !(r = t[o].groupInfo) || "header" !== r.position && "headerAndFooter" !== r.position && "footer" !== r.position || i++;
                                    return i
                                }
                                ,
                                t.getChildGroupIndex = function e(t, i) {
                                    for (var o = 0, n = i.length - 1, r, a; o <= n; ) {
                                        if (r = (n - o >> 1) + o,
                                            0 === (a = i[r].cr.r1 - t.r1))
                                            return r;
                                        a < 0 ? o = r + 1 : n = r - 1
                                    }
                                    return o
                                }
                                ,
                                t.getParentGroupIndex = function t(i, o) {
                                    var n = e.grid.groupHelper.getChildGroupIndex(i, o);
                                    return n > 0 && n--,
                                        n < o.length ? n : -1
                                }
                                ,
                                t.getChildGroupRanges = function t(i, o, n) {
                                    var r = [], a, s, l, c, d, p = e.grid.groupHelper.getColumnByGroupLevel(i, n + 1);
                                    if (p)
                                        for (a = p.groupInfo.expandInfo,
                                                 d = e.grid.groupHelper.getChildGroupIndex(o, a),
                                                 l = d,
                                                 c = a.length; l < c && (s = a[l],
                                        s.cr.r2 <= o.r2); l++)
                                            r.push(s);
                                    return r
                                }
                                ,
                                t.getParentGroupRange = function t(i, o, n) {
                                    var r, a, s;
                                    if (void 0 === n && (n = 65535),
                                        n - 2 >= 0)
                                        for (r = i.length - 1; r >= 0; r--)
                                            if ((a = i[r].groupInfo) && a.expandInfo && !(a.level < 0) && a.level === n - 1 && (s = e.grid.groupHelper.getParentGroupIndex(o, a.expandInfo)) >= 0)
                                                return a.expandInfo[s];
                                    return null
                                }
                                ,
                                t.isParentCollapsed = function t(i, o, n) {
                                    var r, a;
                                    if (1 === n)
                                        return !1;
                                    for (r = n; r > 1; r--) {
                                        if ((a = e.grid.groupHelper.getParentGroupRange(i, o, r)) && !a.isExpanded)
                                            return !0;
                                        o = a.cr
                                    }
                                    return !1
                                }
                                ,
                                t.isParentExpanded = function t(i, o, n) {
                                    var r, a;
                                    if (1 === n)
                                        return !0;
                                    for (r = n; r > 1; r--) {
                                        if ((a = e.grid.groupHelper.getParentGroupRange(i, o, r)) && a.isExpanded)
                                            return !0;
                                        o = a.cr
                                    }
                                    return !1
                                }
                                ,
                                t
                        }();
                        t.groupHelper = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function() {
                            function e(e, t, i, o) {
                                switch (arguments.length) {
                                    case 2:
                                        this.r1 = this.r2 = e,
                                            this.c1 = this.c2 = t;
                                        break;
                                    case 4:
                                        this.r1 = e,
                                            this.r2 = i,
                                            this.c1 = t,
                                            this.c2 = o;
                                        break;
                                    default:
                                        this.r1 = 0,
                                            this.r2 = 0,
                                            this.c1 = 0,
                                            this.c2 = 0
                                }
                            }
                            return e.prototype.isSingleCell = function() {
                                return this.r1 === this.r2 && this.c1 === this.c2
                            }
                                ,
                                e
                        }();
                        t.cellRange = n,
                            i = function() {
                                function t() {}
                                return t.prototype.merge = function(e, t) {
                                    this.ii = t,
                                        this.k = e;
                                    var i, o, n;
                                    for (i = 0,
                                             o = this.ii.length; i < o; i++)
                                        n = this.ii[i],
                                        n.dataIndex >= 0 && !n.isBand && ("free" === n.rowMerge || "restricted" === n.rowMerge) && this.ri(n);
                                    delete this.k,
                                        delete this.ii
                                }
                                    ,
                                    t.prototype.ri = function(t) {
                                        var i = t.dataIndex, o, n, r, a, s;
                                        for (o = 0,
                                                 n = this.k.length; o < n; o++)
                                            if (this.k[o].rowType & e.grid.rowType.data) {
                                                if (r = this.si(o, t),
                                                    r.r1 !== r.r2)
                                                    for (a = r.r2 - r.r1 + 1,
                                                             this.k[r.r1][i].qe.rowSpan = a,
                                                             s = r.r1 + 1; s <= r.r2; s++)
                                                        this.k[s][i].visible = !1;
                                                o = r.r2
                                            }
                                    }
                                    ,
                                    t.prototype.si = function(t, i) {
                                        var o = i.dataIndex, n = new e.grid.cellRange(t,o), r = "" + (this.k[t][o].value || ""), a = this.k.length, s, l, c, d;
                                        for (n.r2 = t; n.r2 < a - 1 && (s = this.k[n.r2 + 1],
                                        s.rowType & e.grid.rowType.data && "" + (s[o].value || "") === r); n.r2++)
                                            ;
                                        return l = i.leavesIdx,
                                        l > 0 && "restricted" === i.rowMerge && (c = this.ii[l - 1],
                                        c.dataIndex >= 0 && (d = this.si(t, c),
                                            n.r1 = Math.max(n.r1, d.r1),
                                            n.r2 = Math.min(n.r2, d.r2))),
                                            n
                                    }
                                    ,
                                    t
                            }(),
                            t.merger = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o, n, r, a, s, l, c, d, p = jQuery;
                        t.EXPANDO = "__gcuigrid",
                            function(e) {
                                e.ti = [],
                                    e.header = 1,
                                    e.data = 2,
                                    e.dataAlt = 4,
                                    e.filter = 8,
                                    e.groupHeader = 16,
                                    e.groupFooter = 32,
                                    e.footer = 64,
                                    e.emptyDataRow = 128
                            }(t.rowType || (t.rowType = {})),
                            i = t.rowType,
                            function(e) {
                                e.ti = [],
                                    e.none = 0,
                                    e.rendering = 1,
                                    e.current = 2,
                                    e.hovered = 4,
                                    e.selected = 8
                            }(t.renderState || (t.renderState = {})),
                            o = t.renderState,
                            function(e) {
                                e.ti = [],
                                    e.table = 0,
                                    e.head = 1,
                                    e.body = 2,
                                    e.foot = 3
                            }(t.rowScope || (t.rowScope = {})),
                            n = t.rowScope,
                            function(e) {
                                e.ti = [],
                                    e.none = 0,
                                    e.column = 1,
                                    e.row = 2
                            }(t.cellRangeExtendMode || (t.cellRangeExtendMode = {})),
                            r = t.cellRangeExtendMode,
                            function(e) {
                                e.ti = [],
                                    e.createIfNull = 0,
                                    e.createAlways = 1,
                                    e.dispose = 2
                            }(t.objectMode || (t.objectMode = {})),
                            a = t.objectMode,
                            function(e) {
                                e.ti = [],
                                    e.groupCell = 0,
                                    e.aggregateCell = 1
                            }(t.groupRowCellPurpose || (t.groupRowCellPurpose = {})),
                            s = t.groupRowCellPurpose;
                        function u(t, i) {
                            var o, n, r;
                            if (p.isArray(t) && p.isArray(i)) {
                                if (t.length === i.length) {
                                    for (r = !0,
                                             o = 0,
                                             n = t.length; o < n && r; o++)
                                        r = e.grid.compareObj(t[o], i[o]);
                                    return r
                                }
                            } else {
                                if (p.isPlainObject(t) && p.isPlainObject(i)) {
                                    for (o in t)
                                        if (t.hasOwnProperty(o) && !e.grid.compareObj(t[o], i[o]))
                                            return !1;
                                    for (o in i)
                                        if (i.hasOwnProperty(o) && !e.grid.compareObj(t[o], i[o]))
                                            return !1;
                                    return !0
                                }
                                t instanceof Date && (t = t.getTime()),
                                i instanceof Date && (i = i.getTime())
                            }
                            return t === i
                        }
                        t.compareObj = u;
                        function h(e) {
                            var t, i, o, n = [];
                            for (t = 0; t < arguments.length - 1; t++)
                                n[t] = arguments[t + 1];
                            if (!e)
                                return "";
                            for (i = 0,
                                     o = n.length; i < o; i++)
                                e = e.replace(RegExp("\\{" + i + "\\}", "gm"), n[i]);
                            return e
                        }
                        t.stringFormat = h;
                        function f(e) {
                            return e && !(e < 0) || 0 === e
                        }
                        t.validDataKey = f;
                        function g(e) {
                            return !!(e && e instanceof Date) && !isNaN(e.getTime())
                        }
                        t.validDate = g;
                        function m(e) {
                            return e.dataType || e.Be || "string"
                        }
                        t.getDataType = m;
                        function b(e, t) {
                            e && t && e.find(".ui-widget").each(function(e, i) {
                                return p.each(p(i).data(), function(i, o) {
                                    o.widgetName && t(e, o)
                                }),
                                    !0
                            })
                        }
                        t.iterateChildrenWidgets = b;
                        function v(e, t) {
                            var i = [];
                            p.each(e.data(), function(e) {
                                0 === e.indexOf(t) && i.push(e)
                            }),
                                p.each(i, function(t, i) {
                                    e.removeData(i)
                                })
                        }
                        t.remove$dataByPrefix = v,
                            l = function() {
                                function e(e) {
                                    this.vi = e
                                }
                                return e.prototype.getSelection = function() {
                                    var e = 0, t = 0, i;
                                    return void 0 !== this.vi.selectionStart ? (e = this.vi.selectionStart,
                                        t = this.vi.selectionEnd) : document.selection && (i = document.selection.createRange().duplicate(),
                                        t = i.text.length,
                                        e = Math.abs(i.moveStart("character", -this.vi.value.length)),
                                        t += e),
                                        {
                                            start: e,
                                            end: t,
                                            length: t - e
                                        }
                                }
                                    ,
                                    e.prototype.setSelection = function(e) {
                                        if (void 0 !== this.vi.selectionStart)
                                            this.vi.setSelectionRange(e.start, e.end);
                                        else {
                                            var t = this.vi.createTextRange();
                                            t.collapse(!0),
                                                t.moveStart("character", e.start),
                                                t.moveEnd("character", e.end),
                                                t.select()
                                        }
                                    }
                                    ,
                                    e.prototype.toggleSelection = function(e) {
                                        var t = p(this.vi)
                                            , i = "onselectstart"in this.vi;
                                        e ? i ? t.unbind(".gcuigrid-disableSelection") : t.css({
                                            MozUserSelect: "",
                                            WebkitUserSelect: ""
                                        }) : i ? t.bind("selectstart.gcuigrid-disableSelection", function(e) {
                                            e.preventDefault()
                                        }) : t.css({
                                            MozUserSelect: "-moz-none",
                                            WebkitUserSelect: "none"
                                        })
                                    }
                                    ,
                                    e
                            }(),
                            t.domSelection = l;
                        function y(e) {
                            return p.extend(!0, {}, t.c1basefield.prototype.options, t.c1field.prototype.options, {
                                dynamic: !0,
                                isLeaf: !0,
                                isBand: !1,
                                parentIdx: -1
                            }, e)
                        }
                        t.createDynamicField = y;
                        function x(e, t) {
                            if (e) {
                                var i = e.nodeType ? p(e) : e
                                    , o = i.offset();
                                if (o)
                                    return t ? {
                                        top: o.top,
                                        left: o.left,
                                        width: i[0].clientWidth || 0,
                                        height: i[0].clientHeight || 0
                                    } : {
                                        top: o.top,
                                        left: o.left,
                                        width: i.outerWidth(),
                                        height: i.outerHeight()
                                    }
                            }
                            return null
                        }
                        t.bounds = x;
                        function w(t, i, o) {
                            if (void 0 === i && (i = 3),
                                t && 0 !== i) {
                                if (!o && 3 === t.nodeType)
                                    return t.nodeValue;
                                if (1 === t.nodeType) {
                                    switch (t.type) {
                                        case "button":
                                        case "text":
                                        case "textarea":
                                        case "select-one":
                                            return t.value;
                                        case "checkbox":
                                            return "" + t.checked
                                    }
                                    for (var n = "", r = 0, a; a = t.childNodes[r++]; )
                                        n += e.grid.wi(a, i - 1);
                                    return n
                                }
                            }
                            return ""
                        }
                        t.wi = w;
                        function C(e, t, i, o) {
                            var n = e.jquery || p.isArray(e), r, a, s, l = t + i;
                            if (3 === arguments.length)
                                return n ? p.data(e[0], l) : p.data(e, l);
                            if (n) {
                                for (r = 0,
                                         a = e.length; r < a; r++)
                                    s = p.data(e[r], l, o);
                                return s
                            }
                            return p.data(e, l, o)
                        }
                        t.dataPrefix = C;
                        function S(e, t) {
                            if (t && e) {
                                var i, o, n;
                                for (i in t)
                                    t.hasOwnProperty(i) && (o = t[i],
                                    "string" !== (n = typeof o) && "boolean" !== n && "number" !== n || void 0 !== e[i] || (e[i] = o))
                            }
                        }
                        t.shallowMerge = S;
                        function k(e) {
                            return e && "object" == typeof e && !(e instanceof Date)
                        }
                        t.isCustomObject = k;
                        function T(e, t) {
                            var i, o, n = p.isFunction(t);
                            for (i in e)
                                if (e.hasOwnProperty(i) && !0 === (o = n ? t(e[i]) : e[i] === t))
                                    return {
                                        at: i,
                                        found: e[i]
                                    };
                            return {
                                at: null,
                                found: null
                            }
                        }
                        t.search = T;
                        function A(e, t) {
                            if (e) {
                                var i, o, n = 0, r = {}, a, s;
                                for (i = 0,
                                         o = e.attributes.length; i < o; i++)
                                    !(s = e.attributes[i].name) || t && t(s) || (a = e.getAttribute(s),
                                    "style" === s && (a = "object" == typeof a ? a.cssText : a),
                                    a || "class" !== s || (a = e.getAttribute("className")),
                                    a && "function" != typeof a && (r[s] = a,
                                        n++));
                                if (n)
                                    return r
                            }
                            return null
                        }
                        t.getAttributes = A;
                        function I(t, i) {
                            var o, n, r, a, s;
                            if (t) {
                                "object" == typeof i || p.isFunction(i) || (i = {});
                                for (o in t)
                                    n = t[o],
                                        r = i[r],
                                    n !== i && (n && (p.isPlainObject(n) || (a = p.isArray(n))) ? (a ? (a = !1,
                                        s = r && p.isArray(r) ? r : []) : s = r && p.isPlainObject(r) ? r : {},
                                        i[o] = e.grid.deepExtend(n, s)) : i[o] = n)
                            }
                            return i
                        }
                        t.deepExtend = I;
                        function D(e, t) {
                            if (e && e.jquery && (e = e[0]),
                                    e)
                                return 1 === arguments.length ? p.data(e, "gcuigridwidgetName") : p.data(e, "gcuigridwidgetName", t)
                        }
                        t.widgetName = D,
                            c = function() {
                                function t() {}
                                return t.xi = {
                                    date: "",
                                    datetime: "",
                                    "datetime-local": "",
                                    month: "",
                                    time: ""
                                },
                                    t.isExtendSupportRequired = function t(i) {
                                        return (i = (i || "").toLowerCase())in e.grid.HTML5InputSupport.xi
                                    }
                                    ,
                                    t.getDefaultInputType = function t(i, o) {
                                        var n = o.inputType;
                                        if (!n && (n = "text",
                                                i))
                                            switch (e.grid.getDataType(o)) {
                                                case "number":
                                                case "currency":
                                                    n = "number";
                                                    break;
                                                case "datetime":
                                                    n = "datetime"
                                            }
                                        return n
                                    }
                                    ,
                                    t.toStr = function t(i, o) {
                                        var n = i;
                                        if (o = (o || "").toLowerCase(),
                                                e.grid.HTML5InputSupport.isExtendSupportRequired(o))
                                            switch (o) {
                                                case "datetime":
                                                    n = i ? n = Globalize.format(i, "yyyy-MM-ddTHH:mm:ssZ") : "";
                                                    break;
                                                case "datetime-local":
                                                    n = i ? n = Globalize.format(i, "yyyy-MM-ddTHH:mm:ss") : "";
                                                    break;
                                                case "date":
                                                    n = i ? n = Globalize.format(i, "yyyy-MM-dd") : "";
                                                    break;
                                                case "month":
                                                    n = i ? n = Globalize.format(i, "yyyy-MM") : "";
                                                    break;
                                                case "time":
                                                    n = i ? n = Globalize.format(i, "HH:mm:ss") : ""
                                            }
                                        else
                                            n = i + "";
                                        return n
                                    }
                                    ,
                                    t.parse = function t(i, o) {
                                        var n, r = function(t) {
                                            return t = new Date(t),
                                            e.grid.validDate(t) || (t = null),
                                                t
                                        };
                                        if (o = (o || "").toLowerCase(),
                                                e.grid.HTML5InputSupport.isExtendSupportRequired(o))
                                            switch (o) {
                                                case "datetime":
                                                    n = Globalize.parseDate(i, "yyyy-MM-ddTHH:mm:ssZ") || Globalize.parseDate(i, "yyyy-MM-ddTHH:mmZ") || r(i);
                                                    break;
                                                case "datetime-local":
                                                    n = Globalize.parseDate(i, "yyyy-MM-ddTHH:mm:ss") || Globalize.parseDate(i, "yyyy-MM-ddTHH:mm") || r(i);
                                                    break;
                                                case "date":
                                                    n = Globalize.parseDate(i, "yyyy-MM-dd") || r(i);
                                                    break;
                                                case "month":
                                                    n = Globalize.parseDate(i, "yyyy-MM");
                                                    break;
                                                case "time":
                                                    n = Globalize.parseDate(i, "HH:mm:ss") || Globalize.parseDate(i, "HH:mm");
                                                    break;
                                                case "number":
                                                    n = parseFloat(i)
                                            }
                                        else
                                            n = i;
                                        return n
                                    }
                                    ,
                                    t.extend = function e(t, i, o) {
                                        if (t)
                                            switch (o = (o || "").toLowerCase()) {
                                                case "date":
                                                    t.setFullYear(i.getFullYear(), i.getMonth(), i.getDate());
                                                    break;
                                                case "month":
                                                    t.setFullYear(i.getFullYear(), i.getMonth());
                                                    break;
                                                case "time":
                                                    t.setHours(i.getHours()),
                                                        t.setMinutes(i.getMinutes()),
                                                        t.setSeconds(i.getSeconds());
                                                    break;
                                                default:
                                                    t = i
                                            }
                                        else
                                            t = i;
                                        return t
                                    }
                                    ,
                                    t
                            }(),
                            t.HTML5InputSupport = c;
                        function $(e, t, i) {
                            return e > t && e < t + i
                        }
                        t.isOverAxis = $;
                        function F(t, i, o, n, r, a) {
                            return e.grid.isOverAxis(t, o, r) && e.grid.isOverAxis(i, n, a)
                        }
                        t.isOver = F,
                            d = 0;
                        function L() {
                            return "uid" + d++
                        }
                        t.getUID = L,
                            p.extend(p.gcui.gcuigrid, {
                                rowType: e.grid.rowType,
                                renderState: e.grid.renderState,
                                bounds: e.grid.bounds
                            })
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        var i, o;
                        !function(e) {
                            e.ti = [],
                                e.Millisecond = 1,
                                e.Second = 2,
                                e.Minute = 4,
                                e.Hour = 8,
                                e.Day = 16,
                                e.Month = 32,
                                e.Year = 64,
                                e.DATE = e.Year | e.Month | e.Day,
                                e.TIME = e.Hour | e.Minute | e.Second | e.Millisecond,
                                e.ALL = e.DATE | e.TIME
                        }(t.TimeUnit || (t.TimeUnit = {})),
                            i = t.TimeUnit,
                            o = function() {
                                function t() {}
                                return t.convertInputType = function t(i) {
                                    var o = e.grid.TimeUnitConverter.convertInputTypeToFormatString(i)
                                        , n = e.grid.TimeUnitConverter.convertFormatString(o);
                                    return n
                                }
                                    ,
                                    t.convertInputTypeToFormatString = function e(t) {
                                        switch ((t || "").toLowerCase()) {
                                            case "datetime":
                                            case "datetime-local":
                                                return "f";
                                            case "date":
                                                return "d";
                                            case "month":
                                                return "Y";
                                            case "time":
                                                return "t"
                                        }
                                        return ""
                                    }
                                    ,
                                    t.convertFormatString = function e(t) {
                                        var o, n, r, a, s = 0;
                                        if (t) {
                                            if (1 === t.length)
                                                switch (t[0]) {
                                                    case "t":
                                                        return i.Hour | i.Minute;
                                                    case "T":
                                                        return i.TIME;
                                                    case "d":
                                                    case "D":
                                                        return i.DATE;
                                                    case "Y":
                                                        return i.Month | i.Year;
                                                    case "M":
                                                        return i.Month | i.Day;
                                                    case "S":
                                                        return i.ALL
                                                }
                                            for ((o = t.indexOf("'")) >= 0 && (n = t.lastIndexOf("'")) >= 0 && o !== n && (t = t.substr(0, o) + t.substring(n + 1, t.length - 1)),
                                                     r = 0,
                                                     a = t.length; r < a; r++)
                                                switch (t[r]) {
                                                    case "d":
                                                        s |= i.Day;
                                                        break;
                                                    case "M":
                                                        s |= i.Month;
                                                        break;
                                                    case "y":
                                                        s |= i.Year;
                                                        break;
                                                    case "m":
                                                        s |= i.Minute;
                                                        break;
                                                    case "h":
                                                    case "H":
                                                        s |= i.Hour;
                                                        break;
                                                    case "s":
                                                        s |= i.Second;
                                                        break;
                                                    case "f":
                                                        s |= i.Millisecond
                                                }
                                        }
                                        return s || i.ALL
                                    }
                                    ,
                                    t.cutDate = function e(t, o) {
                                        return t && (o = ~o,
                                        o & i.Millisecond && t.setMilliseconds(0),
                                        o & i.Second && t.setSeconds(0),
                                        o & i.Minute && t.setMinutes(0),
                                        o & i.Hour && t.setHours(0),
                                        o & i.Day && t.setDate(1),
                                        o & i.Month && t.setMonth(0),
                                        o & i.Year && t.setFullYear(0)),
                                            t
                                    }
                                    ,
                                    t
                            }(),
                            t.TimeUnitConverter = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function() {
                            function e() {}
                            return e.NoFilterOp = {
                                applicableTo: null,
                                name: "NoFilter",
                                arity: 1,
                                operator: function() {
                                    return !0
                                }
                            },
                                e
                        }(), r = function() {
                            function t(t) {
                                this.yi = {};
                                var i = this;
                                this.jh = t,
                                    this.zi(null, n.NoFilterOp),
                                    o.each(e.data.filtering.ops, function(e, t) {
                                        i.zi(e, t)
                                    }),
                                    o.each(t.options.customFilterOperators, function(e, t) {
                                        i.zi(null, t, !0)
                                    })
                            }
                            return t.prototype.getByName = function(e) {
                                var t = this.getByNameInt(e);
                                return t ? t.op : null
                            }
                                ,
                                t.prototype.getByNameInt = function(e) {
                                    return this.yi[(e || "").toLowerCase()]
                                }
                                ,
                                t.prototype.getByDataType = function(e) {
                                    var t = [], i;
                                    switch (o.each(this.yi, function(i, n) {
                                        var r = n.op;
                                        (!r.applicableTo || o.inArray(e, r.applicableTo) >= 0) && t.push(n)
                                    }),
                                        this.jh.options.filterOperatorsSortMode.toLowerCase()) {
                                        case "alphabetical":
                                            t.sort(this.Ai);
                                            break;
                                        case "alphabeticalcustomfirst":
                                            t.sort(this.Bi);
                                            break;
                                        case "alphabeticalembeddedFirst":
                                            t.sort(this.Ci)
                                    }
                                    return i = o.map(t, function(e, t) {
                                        return e.op
                                    })
                                }
                                ,
                                t.prototype.zi = function(e, t, i) {
                                    void 0 === i && (i = !1),
                                    e && !t.name && (t.name = e),
                                        e = (e || t.name).toLowerCase(),
                                    this.yi[e] || (this.yi[e] = {
                                        op: t,
                                        isCustom: !0 === i
                                    })
                                }
                                ,
                                t.prototype.Ai = function(e, t) {
                                    var i = e.op.name.toLowerCase()
                                        , o = t.op.name.toLowerCase();
                                    if (i !== o) {
                                        if ("nofilter" === i)
                                            return -1;
                                        if ("nofilter" === o)
                                            return 1
                                    }
                                    return i === o ? 0 : i < o ? -1 : 1
                                }
                                ,
                                t.prototype.Ci = function(e, t) {
                                    var i = e.op.name.toLowerCase()
                                        , o = t.op.name.toLowerCase();
                                    if (i !== o) {
                                        if ("nofilter" === i)
                                            return -1;
                                        if ("nofilter" === o)
                                            return 1
                                    }
                                    if (e.isCustom !== t.isCustom) {
                                        if (e.isCustom)
                                            return 1;
                                        if (t.isCustom)
                                            return -1
                                    }
                                    return i === o ? 0 : i < o ? -1 : 1
                                }
                                ,
                                t.prototype.Bi = function(e, t) {
                                    var i = e.op.name.toLowerCase()
                                        , o = t.op.name.toLowerCase();
                                    if (i !== o) {
                                        if ("nofilter" === i)
                                            return -1;
                                        if ("nofilter" === o)
                                            return 1
                                    }
                                    if (e.isCustom !== t.isCustom) {
                                        if (e.isCustom)
                                            return -1;
                                        if (t.isCustom)
                                            return 1
                                    }
                                    return i === o ? 0 : i < o ? -1 : 1
                                }
                                ,
                                t
                        }();
                        t.filterOperatorsCache = r,
                            i = function() {
                                function t() {}
                                return t.marker = "_gcuigrid",
                                    t.getSingleValue = function e(t) {
                                        return o.isArray(t) && (t = t[0],
                                        o.isArray(t) && (t = t[0])),
                                            t
                                    }
                                    ,
                                    t.getSingleOperatorName = function e(t) {
                                        return o.isArray(t) && (t = t[0]),
                                        t.name || t || ""
                                    }
                                    ,
                                    t.verify = function t(i, n, r, a) {
                                        if (i)
                                            if (o.isArray(i)) {
                                                var s, l, c = [], d = [];
                                                for (o.isArray(n) || (n = [n]),
                                                         s = 0,
                                                         l = i.length; s < l; s++)
                                                    e.grid.filterHelper.Di(i[s], n[s], r, a) && (c.push({
                                                        name: i[s].name || i[s],
                                                        condition: i[s].condition || "or"
                                                    }),
                                                        d.push(n ? n[s] : void 0));
                                                if (c.length)
                                                    return {
                                                        filterOperator: c,
                                                        filterValue: d
                                                    }
                                            } else if (e.grid.filterHelper.Di(i, n, r, a))
                                                return {
                                                    filterOperator: i,
                                                    filterValue: n
                                                };
                                        return null
                                    }
                                    ,
                                    t.Di = function t(i, n, r, a) {
                                        if (i && (i = i.name || i)) {
                                            var s;
                                            if (("nofilter" !== (i = (i || "").toLowerCase()) || void 0 !== n) && (s = a.getByName(i)) && (null === s.applicableTo || o.inArray(r || "string", s.applicableTo) >= 0) && (1 === s.arity || s.arity > 1 && void 0 !== e.grid.filterHelper.getSingleValue(n)))
                                                return !0
                                        }
                                        return !1
                                    }
                                    ,
                                    t
                            }(),
                            t.filterHelper = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery;
                        function n(t, i) {
                            if (t && !t.nodeType && (t = t[0]),
                                    t)
                                switch (i) {
                                    case e.grid.rowScope.head:
                                        return t.tHead;
                                    case e.grid.rowScope.body:
                                        if (t.tBodies)
                                            return t.tBodies[0] || null;
                                        break;
                                    case e.grid.rowScope.foot:
                                        return t.tFoot;
                                    default:
                                        return t
                                }
                            return null
                        }
                        t.getTableSection = n;
                        function r(e, t) {
                            var i;
                            return e && !e.nodeType && (e = e[0]),
                                e && (i = this.getTableSection(e, t)) ? i.rows.length : 0
                        }
                        t.getTableSectionLength = r;
                        function a(e, t, i) {
                            var o;
                            return e && !e.nodeType && (e = e[0]),
                                e && (o = this.getTableSection(e, t)) ? o.rows[i] || null : null
                        }
                        t.getTableSectionRow = a;
                        function s(t, i, n) {
                            var r, a, s, l, c, d, p, u, h = [], f = function(e) {
                                return "rowspan" === (e = e.toLowerCase()) || "colspan" === e
                            }, g;
                            if (t && !t.nodeType && (t = t[0]),
                                t && (g = this.getTableSection(t, i)))
                                for (r = 0,
                                         a = g.rows.length; r < a; r++) {
                                    for (c = g.rows[r],
                                             d = [],
                                         n && (p = e.data.Expando.getFrom(d, !0),
                                             u = p[e.grid.EXPANDO] = {
                                                 cellsAttributes: {},
                                                 rowAttributes: e.grid.getAttributes(c) || {}
                                             }),
                                             s = 0,
                                             l = c.cells.length; s < l; s++)
                                        d[s] = o.trim(c.cells[s].innerHTML),
                                        n && (u.cellsAttributes[s] = e.grid.getAttributes(c.cells[s], f) || {});
                                    h[r] = d
                                }
                            return h
                        }
                        t.readTableSection = s,
                            i = function() {
                                function t(e, t, i, o) {
                                    this.Sg = 0,
                                        this.Vg = e,
                                        this.Ei = [],
                                    o && this.ensureColGroup(),
                                    i && this.ensureTBody(),
                                    t || this.Fi()
                                }
                                return t.prototype.element = function() {
                                    return this.Vg
                                }
                                    ,
                                    t.prototype.width = function() {
                                        return this.Sg
                                    }
                                    ,
                                    t.prototype.getCellIdx = function(e, t) {
                                        return e < this.Sg ? this.Ei[t][e].cellIdx : -1
                                    }
                                    ,
                                    t.prototype.getColumnIdx = function(e, t) {
                                        if ("number" != typeof e) {
                                            var i = e;
                                            e = i.cellIndex,
                                                t = i.parentNode.rowIndex
                                        }
                                        return e < this.Sg ? this.Ei[t][e].colIdx : -1
                                    }
                                    ,
                                    t.prototype.clearSection = function(t) {
                                        var i, o, n = e.grid.getTableSection(this.Vg, t);
                                        switch (t) {
                                            case e.grid.rowScope.body:
                                                i = this.getSectionLength(e.grid.rowScope.table),
                                                    o = i + this.getSectionLength(t) - 1;
                                                break;
                                            case e.grid.rowScope.foot:
                                                i = this.getSectionLength(e.grid.rowScope.table) + this.getSectionLength(e.grid.rowScope.head),
                                                    o = i + this.getSectionLength(t) - 1;
                                                break;
                                            default:
                                                i = 0,
                                                    o = this.getSectionLength(t) - 1
                                        }
                                        for (; n.rows.length; )
                                            n.deleteRow(0);
                                        this.Ei.splice(i, o - i + 1)
                                    }
                                    ,
                                    t.prototype.getSectionLength = function(t) {
                                        return e.grid.getTableSectionLength(this.Vg, t)
                                    }
                                    ,
                                    t.prototype.getSectionRow = function(t, i) {
                                        return e.grid.getTableSectionRow(this.Vg, i, t)
                                    }
                                    ,
                                    t.prototype.forEachColumnCellNatural = function(e, t, i) {
                                        var o, n, r, a;
                                        for (o = 0,
                                                 n = this.Vg.rows.length; o < n; o++)
                                            if (r = this.Vg.rows[o],
                                                e < r.cells.length && !0 !== (a = t(r.cells[e], o, i)))
                                                return a;
                                        return !0
                                    }
                                    ,
                                    t.prototype.forEachColumnCell = function(e, t, i) {
                                        var o, n, r, a, s;
                                        for (o = 0,
                                                 n = this.Ei.length; o < n; o++)
                                            if (r = this.Vg.rows[o],
                                                (a = this.getCellIdx(e, o)) >= 0 && !0 !== (s = t(r.cells[a], o, i)))
                                                return s;
                                        return !0
                                    }
                                    ,
                                    t.prototype.forEachRowCell = function(e, t, i) {
                                        var o = this.Vg.rows[e], n, r, a;
                                        for (n = 0,
                                                 r = o.cells.length; n < r; n++)
                                            if (!0 !== (a = t(o.cells[n], n, i)))
                                                return a;
                                        return !0
                                    }
                                    ,
                                    t.prototype.colGroupTag = function() {
                                        var e = this.Vg.getElementsByTagName("colgroup");
                                        return e && e[0] || null
                                    }
                                    ,
                                    t.prototype.colTags = function() {
                                        var e = this.colGroupTag();
                                        return e && e.getElementsByTagName("col") || []
                                    }
                                    ,
                                    t.prototype.ensureTBody = function() {
                                        return this.Vg.tBodies && this.Vg.tBodies[0] || this.Vg.appendChild(document.createElement("tbody"))
                                    }
                                    ,
                                    t.prototype.ensureTHead = function() {
                                        return this.Vg.tHead && this.Vg.tHead[0] || this.Vg.createTHead()
                                    }
                                    ,
                                    t.prototype.ensureTFoot = function() {
                                        return this.Vg.tFoot && this.Vg.tFoot[0] || this.Vg.createTFoot()
                                    }
                                    ,
                                    t.prototype.ensureColGroup = function() {
                                        var e = this.Vg.getElementsByTagName("colgroup");
                                        return e && e[0] || this.Vg.appendChild(document.createElement("colgroup"))
                                    }
                                    ,
                                    t.prototype.appendCol = function(e) {
                                        var t = this.ensureColGroup();
                                        return e && t.appendChild(e) || t.appendChild(document.createElement("col"))
                                    }
                                    ,
                                    t.prototype.removeOffset = function(e) {
                                        e >= 0 && e < this.Ei.length && ((e < 0 || !e && 0 !== e) && (e = this.Ei.length - 1),
                                            this.Ei.splice(e, 1))
                                    }
                                    ,
                                    t.prototype.insertOffset = function(e) {
                                        var t, i;
                                        if (this.Sg > 0) {
                                            for (t = [],
                                                     i = 0; i < this.Sg; i++)
                                                t.push({
                                                    cellIdx: i,
                                                    colIdx: i
                                                });
                                            (e < 0 || !e && 0 !== e) && (e = this.Ei.length),
                                                this.Ei.splice(e, 0, t)
                                        }
                                    }
                                    ,
                                    t.prototype.rebuildOffsets = function() {
                                        this.Ei = [],
                                            this.Sg = 0,
                                            this.Fi()
                                    }
                                    ,
                                    t.prototype.Fi = function() {
                                        var e = [], t, i, o, n, r, a, s, l, c, d;
                                        for (i = 0,
                                                 o = this.Vg.rows.length; i < o; i++) {
                                            for (t = [],
                                                     this.Ei[i] = t,
                                                     n = this.Vg.rows[i],
                                                     r = 0,
                                                     a = 0,
                                                     s = n.cells.length; r < s; r++,
                                                     a++) {
                                                for (l = n.cells[r]; e[a] > 1; a++)
                                                    e[a]--,
                                                        t[a] = {
                                                            cellIdx: -1,
                                                            colIdx: -1
                                                        };
                                                for (e[a] > 1 || (e[a] = l.rowSpan),
                                                         t[a] = {
                                                             cellIdx: r,
                                                             colIdx: -1
                                                         },
                                                         t[r].colIdx = a,
                                                         c = l.colSpan; c > 1; c--)
                                                    t[++a] = {
                                                        cellIdx: -1,
                                                        colIdx: -1
                                                    }
                                            }
                                            for (d = e.length; a < d; a++)
                                                e[a]--,
                                                    t[a] = {
                                                        cellIdx: -1,
                                                        colIdx: -1
                                                    };
                                            this.Sg = Math.max(this.Sg, d)
                                        }
                                    }
                                    ,
                                    t
                            }(),
                            t.htmlTableAccessor = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function() {
                            function t(e, t, i, o) {
                                void 0 === i && (i = null),
                                void 0 === o && (o = !1),
                                    this.Gi = !1,
                                    this.jh = i,
                                    o ? (this.Hi = e,
                                        this.Ii = t) : (this.Ji = e,
                                        this.Ki = t)
                            }
                            return t.outsideValue = new t(-1,-1,null,!0),
                                t.prototype.cellIndexAbs = function(e) {
                                    if (0 === arguments.length)
                                        return this.Li(),
                                            this.Hi;
                                    this.Ji = void 0,
                                        this.Hi = e
                                }
                                ,
                                t.prototype.rowIndexAbs = function(e) {
                                    if (0 === arguments.length)
                                        return this.Mi(),
                                            this.Ii;
                                    this.Ki = void 0,
                                        this.Ii = e
                                }
                                ,
                                t.prototype.cellIndex = function(e) {
                                    if (0 === arguments.length)
                                        return this.Ni(),
                                            this.Ji;
                                    this.Hi = void 0,
                                        this.Ji = e
                                }
                                ,
                                t.prototype.column = function() {
                                    return this.jh && this.Ld() ? this.jh.Dd("visibleLeaves")[this.cellIndexAbs()] : null
                                }
                                ,
                                t.prototype.container = function() {
                                    var e = this.tableCell(), t;
                                    return e && (t = o(e).children("div.gcui-gcuigrid-innercell")) ? t : null
                                }
                                ,
                                t.prototype.isEqual = function(e) {
                                    return e && e.rowIndex() === this.rowIndex() && e.cellIndex() === this.cellIndex()
                                }
                                ,
                                t.prototype.row = function() {
                                    var e = null
                                        , t = null;
                                    return this.jh && (e = this.jh.Gd().rows().item(this.rowIndexAbs())) && e.length && (t = this.jh.Gd().Od(e)),
                                        t
                                }
                                ,
                                t.prototype.rowIndex = function(e) {
                                    if (0 === arguments.length)
                                        return this.Oi(),
                                            this.Ki;
                                    this.Ii = void 0,
                                        this.Ki = e
                                }
                                ,
                                t.prototype.tableCell = function() {
                                    return this.jh && this.Ld() ? this.jh.Gd().getCell(this.cellIndexAbs(), this.rowIndexAbs()) : null
                                }
                                ,
                                t.prototype.value = function(t) {
                                    var i, o, n;
                                    if (this.jh && this.Ld() && (o = this.jh.Gd().Od(this.jh.Jd().item(this.rowIndex())),
                                        o.type & e.grid.rowType.data)) {
                                        if (i = this.column(),
                                            0 === arguments.length)
                                            return n = this.jh.sd.getValue(o.data, i.dataKey),
                                                this.jh.parse(i, n);
                                        if (null === (t = this.jh.parse(i, t)) && i.valueRequired || "string" !== e.grid.getDataType(i) && isNaN(t))
                                            throw "invalid value";
                                        this.jh.sd.setValue(o.dataItemIndex, i.dataKey, t)
                                    }
                                }
                                ,
                                t.prototype.toString = function() {
                                    return this.cellIndex() + ":" + this.rowIndex()
                                }
                                ,
                                t.prototype.Md = function(e, t) {
                                    void 0 === t && (t = !1);
                                    var i = !1, o;
                                    return t ? (this.cellIndexAbs() < (o = e.topLeft().cellIndexAbs()) && (i = !0,
                                        this.Hi = o,
                                        this.Ji = void 0),
                                    this.cellIndexAbs() > (o = e.bottomRight().cellIndexAbs()) && (i = !0,
                                        this.Hi = o,
                                        this.Ji = void 0),
                                    this.rowIndexAbs() < (o = e.topLeft().rowIndexAbs()) && (i = !0,
                                        this.Ii = o,
                                        this.Ki = void 0),
                                    this.rowIndexAbs() > (o = e.bottomRight().rowIndexAbs()) && (i = !0,
                                        this.Ii = o,
                                        this.Ki = void 0)) : (this.cellIndex() < (o = e.topLeft().cellIndex()) && (i = !0,
                                        this.Ji = o,
                                        this.Hi = void 0),
                                    this.cellIndex() > (o = e.bottomRight().cellIndex()) && (i = !0,
                                        this.Ji = o,
                                        this.Hi = void 0),
                                    this.rowIndex() < (o = e.topLeft().rowIndex()) && (i = !0,
                                        this.Ki = o,
                                        this.Ii = void 0),
                                    this.rowIndex() > (o = e.bottomRight().rowIndex()) && (i = !0,
                                        this.Ki = o,
                                        this.Ii = void 0)),
                                        i
                                }
                                ,
                                t.prototype.Kd = function() {
                                    return new e.grid.cellInfo(this.cellIndex(),this.rowIndex(),this.jh)
                                }
                                ,
                                t.prototype.Ld = function() {
                                    return this.cellIndex() >= 0 && this.rowIndex() >= 0
                                }
                                ,
                                t.prototype.Yf = function(e) {
                                    if (!arguments.length)
                                        return this.Gi;
                                    this.Gi = e
                                }
                                ,
                                t.prototype.Pd = function(e) {
                                    this.jh = e
                                }
                                ,
                                t.prototype.Li = function() {
                                    if (void 0 === this.Hi) {
                                        if (null === this.Ji)
                                            throw "relative index value is undefined";
                                        if (this.Ji >= 0) {
                                            if (!this.jh)
                                                throw "gcuigrid is null";
                                            this.Hi = this.Ji + this.jh.ng().x
                                        } else
                                            this.Hi = this.Ji;
                                        this.Hi < 0 && (this.Hi = -1)
                                    }
                                }
                                ,
                                t.prototype.Mi = function() {
                                    if (void 0 === this.Ii) {
                                        if (void 0 === this.Ki)
                                            throw "relative index value is undefined";
                                        if (this.Ki >= 0) {
                                            if (!this.jh)
                                                throw "gcuigrid is null";
                                            this.Ii = this.Ki + this.jh.ng().y
                                        } else
                                            this.Ii = this.Ki;
                                        this.Ii < 0 && (this.Ii = -1)
                                    }
                                }
                                ,
                                t.prototype.Ni = function() {
                                    if (void 0 === this.Ji) {
                                        if (void 0 === this.Hi)
                                            throw "absolute index value is undefined";
                                        if (this.Hi >= 0) {
                                            if (!this.jh)
                                                throw "gcuigrid is null";
                                            this.Ji = this.Hi - this.jh.ng().x
                                        } else
                                            this.Ji = this.Hi;
                                        this.Ji < 0 && (this.Ji = -1)
                                    }
                                }
                                ,
                                t.prototype.Oi = function() {
                                    if (void 0 === this.Ki) {
                                        if (void 0 === this.Ii)
                                            throw "relative index value is undefined";
                                        if (this.Ii >= 0) {
                                            if (!this.jh)
                                                throw "gcuigrid is null";
                                            this.Ki = this.Ii - this.jh.ng().y
                                        } else
                                            this.Ki = this.Ii;
                                        this.Ki < 0 && (this.Ki = -1)
                                    }
                                }
                                ,
                                t
                        }();
                        t.cellInfo = n,
                            i = function() {
                                function t(e, t) {
                                    if (!e || !t)
                                        throw "invalid arguments";
                                    this.Pi = e.Kd(),
                                        this.Qi = t.Kd()
                                }
                                return t.prototype.bottomRight = function() {
                                    return this.Qi
                                }
                                    ,
                                    t.prototype.isEqual = function(e) {
                                        return e && this.Pi.isEqual(e.topLeft()) && this.Qi.isEqual(e.bottomRight())
                                    }
                                    ,
                                    t.prototype.topLeft = function() {
                                        return this.Pi
                                    }
                                    ,
                                    t.prototype.toString = function() {
                                        return this.Pi + " - " + this.Qi
                                    }
                                    ,
                                    t.prototype.Ri = function(e) {
                                        var t, i, o, n;
                                        return !!(e && (t = e.bottomRight().rowIndex() - e.topLeft().rowIndex() + 1,
                                            i = this.Qi.rowIndex() - this.Pi.rowIndex() + 1,
                                        e.topLeft().rowIndex() + t - this.Pi.rowIndex() < t + i)) && (o = e.bottomRight().cellIndex() - e.topLeft().cellIndex() + 1,
                                            n = this.Qi.cellIndex() - this.Pi.cellIndex() + 1,
                                        e.topLeft().cellIndex() + o - this.Pi.cellIndex() < o + n)
                                    }
                                    ,
                                    t.prototype.Ld = function() {
                                        return this.Pi.Ld() && this.Qi.Ld()
                                    }
                                    ,
                                    t.prototype.Md = function(e, t) {
                                        var i, o;
                                        return void 0 === t && (t = !1),
                                            i = this.Pi.Md(e, t),
                                            o = this.Qi.Md(e, t),
                                        i || o
                                    }
                                    ,
                                    t.prototype.Kd = function() {
                                        return new t(this.Pi.Kd(),this.Qi.Kd())
                                    }
                                    ,
                                    t.prototype.fg = function(e) {
                                        return e && e.cellIndex() >= this.Pi.cellIndex() && e.cellIndex() <= this.Qi.cellIndex() && e.rowIndex() >= this.Pi.rowIndex() && e.rowIndex() <= this.Qi.rowIndex()
                                    }
                                    ,
                                    t.prototype.Si = function(e) {
                                        return e && this.fg(e.topLeft()) && this.fg(e.bottomRight())
                                    }
                                    ,
                                    t.prototype.Ti = function(t, i) {
                                        return t === e.grid.cellRangeExtendMode.column ? (this.Pi.rowIndex(i.topLeft().rowIndex()),
                                            this.Qi.rowIndex(i.bottomRight().rowIndex())) : t === e.grid.cellRangeExtendMode.row && (this.Pi.cellIndex(i.topLeft().cellIndex()),
                                            this.Qi.cellIndex(i.bottomRight().cellIndex())),
                                            this
                                    }
                                    ,
                                    t.prototype.Ui = function() {
                                        var e = this.Pi.cellIndex()
                                            , t = this.Pi.rowIndex()
                                            , i = this.Qi.cellIndex()
                                            , o = this.Qi.rowIndex();
                                        this.Pi.cellIndex(Math.min(e, i)),
                                            this.Pi.rowIndex(Math.min(t, o)),
                                            this.Qi.cellIndex(Math.max(e, i)),
                                            this.Qi.rowIndex(Math.max(t, o))
                                    }
                                    ,
                                    t.prototype.cg = function() {
                                        return this.Qi.rowIndex() - this.Pi.rowIndex()
                                    }
                                    ,
                                    t.prototype.Sg = function() {
                                        return this.Qi.cellIndex() - this.Pi.cellIndex()
                                    }
                                    ,
                                    t
                            }(),
                            t.cellInfoRange = i,
                            o.extend(o.gcui.gcuigrid, {
                                cellInfo: e.grid.cellInfo,
                                cellInfoRange: e.grid.cellInfoRange
                            })
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(e, t) {
                                if (this.Vi = 22,
                                        this.Wi = {
                                            th: 0,
                                            col: 0,
                                            subTable: 0
                                        },
                                        !e)
                                    throw "'gcuigrid' must be specified";
                                this.jh = e,
                                    this.Xi = t,
                                    this.jh.element.addClass("gcui-gcuigrid-table")
                            }
                            return t.prototype.dispose = function() {
                                this.toggleDOMSelection(!0),
                                    this.jh.element.removeClass("gcui-gcuigrid-table")
                            }
                                ,
                                t.prototype.ensureDisabledState = function() {
                                    var e = "gcui-gcuigrid-disabled " + this.jh.options.uiCSS.stateDisabled
                                        , t = this.jh.options.disabled
                                        , o = this;
                                    i.each(this.subTables(), function(n, r) {
                                        if (r) {
                                            var a = i(r.element());
                                            t ? (a.addClass(e),
                                                o.jh.Xf(a, "aria-disabled", !0)) : (a.removeClass(e),
                                                o.jh.Xf(a, "aria-disabled", !1))
                                        }
                                    })
                                }
                                ,
                                t.prototype.ensureWidth = function(e, t, i) {
                                    this.Yi(e, t)
                                }
                                ,
                                t.prototype.ensureHeight = function(e) {}
                                ,
                                t.prototype.getScrollValue = function() {
                                    return null
                                }
                                ,
                                t.prototype.getVisibleAreaBounds = function() {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getFixedAreaVisibleBounds = function() {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.render = function() {
                                    this.Ue(),
                                        this.Zi();
                                    var e = this.jh.outerDiv.css("display");
                                    this.jh.outerDiv.css("display", "none"),
                                        this.$i(),
                                        this.jh.outerDiv.css("display", e),
                                        this._i()
                                }
                                ,
                                t.prototype.toggleDOMSelection = function(t) {
                                    i.each(this.subTables(), function(i, o) {
                                        new e.grid.domSelection(o.element()).toggleSelection(t)
                                    }),
                                        new e.grid.domSelection(this.jh.outerDiv).toggleSelection(t)
                                }
                                ,
                                t.prototype.updateSplits = function(e) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.bodyRows = function() {
                                    return this.aj || (this.aj = new e.grid.rowAccessor(this,e.grid.rowScope.body,0,0)),
                                        this.aj
                                }
                                ,
                                t.prototype.filterRow = function() {
                                    if (this.jh.options.showFilter) {
                                        var t = new e.grid.rowAccessor(this,e.grid.rowScope.head,0,0);
                                        return t.item(t.length() - 1)
                                    }
                                    return null
                                }
                                ,
                                t.prototype.headerRows = function() {
                                    var t;
                                    return this.bj || (t = this.jh.options.showFilter ? 1 : 0,
                                        this.bj = new e.grid.rowAccessor(this,e.grid.rowScope.head,0,t)),
                                        this.bj
                                }
                                ,
                                t.prototype.rows = function() {
                                    return this.cj || (this.cj = new e.grid.rowAccessor(this,e.grid.rowScope.table,0,0)),
                                        this.cj
                                }
                                ,
                                t.prototype.focusableElement = function() {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.forEachColumnCell = function(e, t, i) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.forEachRowCell = function(e, t, i) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getAbsoluteCellInfo = function(e) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getAbsoluteRowIndex = function(e) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getCell = function(e, t) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getColumnIndex = function(e) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getHeaderCell = function(e) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getJoinedCols = function(e) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getJoinedRows = function(e, t) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.getJoinedTables = function(e, t) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.subTables = function() {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.dj = function() {
                                    var e = this.jh.options.scrollMode
                                        , t = "auto"
                                        , i = "auto";
                                    switch (e) {
                                        case "horizontal":
                                            t = "hidden",
                                                i = "visible";
                                            break;
                                        case "vertical":
                                            t = "visible",
                                                i = "hidden";
                                            break;
                                        case "both":
                                            t = "visible",
                                                i = "visible"
                                    }
                                    return {
                                        vScrollBarVisibility: t,
                                        hScrollBarVisibility: i
                                    }
                                }
                                ,
                                t.prototype._i = function() {
                                    var e, t, o, n;
                                    this.ensureDisabledState(),
                                        this.Wi.col = 0,
                                        this.Wi.th = 0,
                                        this.Wi.subTable = 0,
                                        e = this.jh.Dd("visibleLeaves"),
                                    e.length > 0 && (t = this.getHeaderCell(0),
                                        o = this.getJoinedCols(0),
                                    t && (this.Wi.th = i(t).leftBorderWidth() + i(t).rightBorderWidth()),
                                    o && o.length && (this.Wi.col = i(o[0]).leftBorderWidth() + i(o[0]).rightBorderWidth())),
                                        n = this.subTables()[0],
                                        this.Wi.subTable = i(n.element()).leftBorderWidth() + i(n.element()).rightBorderWidth()
                                }
                                ,
                                t.prototype.Zi = function() {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.Ue = function() {
                                    var e = this.jh.Nd();
                                    this.Xi.start = 0,
                                        this.Xi.end = e.bottomRight().rowIndex()
                                }
                                ,
                                t.prototype.$i = function() {
                                    this.ej(),
                                        this.fj(),
                                    this.jh.options.showFilter && this.gj(),
                                        this.hj(),
                                    this.jh.options.showFooter && this.ij()
                                }
                                ,
                                t.prototype.ej = function() {
                                    var e = this.jh.Dd("visibleLeaves"), t, i, o, n;
                                    for (o = 0,
                                             n = e.length; o < n; o++)
                                        t = e[o],
                                            i = this.jj(t, o),
                                            this.kj(i, t, o)
                                }
                                ,
                                t.prototype.fj = function() {
                                    var t = e.grid.rowType, i = this.jh.ze(), o, n, r;
                                    if (i && (n = i.length))
                                        for (o = 0; o < n; o++)
                                            r = this.lj(t.header, o, -1, -1, -1),
                                                this.mj(r, null, i[o])
                                }
                                ,
                                t.prototype.gj = function() {
                                    var t = this.lj(e.grid.rowType.filter, -1, -1, -1, -1);
                                    this.mj(t, this.jh.Dd("visibleLeaves"), null)
                                }
                                ,
                                t.prototype.hj = function() {
                                    var t = e.grid.rowType, i = this.jh.Dd("visibleLeaves"), o = this.jh.sketchTable, n = -1, r = 0, a = 0, s, l, c, d, p = this.jh.ld;
                                    if (this.Xi.start >= 0)
                                        for (s = this.Xi.start; s <= this.Xi.end; s++)
                                            c = o[s - p],
                                                d = 0 != (c.rowType & t.data),
                                                l = this.lj(c.rowType, a++, d ? ++n : -1, d ? c.originalRowIndex : -1, d ? r + c.originalRowIndex : -1),
                                                this.mj(l, i, c)
                                }
                                ,
                                t.prototype.ij = function() {
                                    var t = this.lj(e.grid.rowType.footer, -1, -1, -1, -1);
                                    this.mj(t, this.jh.Dd("visibleLeaves"), null)
                                }
                                ,
                                t.prototype.lj = function(t, i, o, n, r) {
                                    var a = this.jh.hg.apply(this.jh, arguments)
                                        , s = this.nj(t, i, a);
                                    return this.oj(s, t, e.grid.renderState.rendering, i, o, n, r)
                                }
                                ,
                                t.prototype.pj = function(t, i, o) {
                                    var n = e.grid.rowType
                                        , r = this.jh.ig.apply(this.jh, arguments);
                                    return this.qj(t.type, r)
                                }
                                ,
                                t.prototype.nj = function(e, t, i) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.qj = function(t, o) {
                                    var n = e.grid.rowType, r;
                                    if (o || (o = t === n.header ? document.createElement("th") : document.createElement("td")),
                                        t !== n.filter) {
                                        if (r = document.createElement("div"),
                                                r.className = "gcui-gcuigrid-innercell",
                                                o.firstChild)
                                            for (; o.firstChild; )
                                                r.appendChild(o.firstChild);
                                        o.appendChild(r)
                                    }
                                    return i(o)
                                }
                                ,
                                t.prototype.rj = function(e, t, i) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.jj = function(e, t) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.kj = function(e, t, i) {
                                    throw "not implemented"
                                }
                                ,
                                t.prototype.mj = function(t, i, o) {
                                    var n = e.grid.rowType, r, a;
                                    switch (t.type) {
                                        case n.filter:
                                            this.sj(t, i);
                                            break;
                                        case n.footer:
                                            this.tj(t, i);
                                            break;
                                        case n.header:
                                            this.uj(t, o);
                                            break;
                                        case n.data:
                                        case n.data | n.dataAlt:
                                            this.vj(t, i, o),
                                                r = o.qe,
                                                a = o.re;
                                            break;
                                        case n.emptyDataRow:
                                        case n.groupHeader:
                                        case n.groupFooter:
                                            this.wj(t, i, o),
                                                r = o.qe,
                                                a = o.re;
                                            break;
                                        default:
                                            throw "unknown rowType"
                                    }
                                    this.xj(t, r, a)
                                }
                                ,
                                t.prototype.yj = function(t, o, n, r, a, s, l) {
                                    var c = this.pj(t, a.dataIndex, a)
                                        , d = t.type === e.grid.rowType.filter ? c : i(c[0].firstChild);
                                    this.rj(t, o, c),
                                        r ? d.html(n) : this.jh.cellFormatter.format(d, a, n, t),
                                        this.zj(t, c, o, a, s, l)
                                }
                                ,
                                t.prototype.vj = function(e, t, i) {
                                    var o, n, r, a, s, l, c, d = !1;
                                    for (o = 0,
                                             n = t.length; o < n; o++)
                                        r = t[o],
                                            a = r.dataIndex,
                                            s = null,
                                        a >= 0 && (!i[a] || !1 === i[a].visible) || (s = a >= 0 ? this.jh.toStr(r, i[a].value) : null,
                                            l = a >= 0 ? i[a].qe : null,
                                            c = a >= 0 ? i[a].re : null,
                                            this.yj(e, o, s, d, r, l, c))
                                }
                                ,
                                t.prototype.sj = function(t, i) {
                                    var o, n, r;
                                    for (o = 0,
                                             n = i.length; o < n; o++)
                                        r = i[o],
                                            this.yj(t, o, e.grid.filterHelper.getSingleValue(r.filterValue), !1, r)
                                }
                                ,
                                t.prototype.tj = function(e, t) {
                                    var i, o;
                                    for (i = 0,
                                             o = t.length; i < o; i++)
                                        this.yj(e, i, "", !1, t[i])
                                }
                                ,
                                t.prototype.uj = function(e, t) {
                                    var i, o, n = 0, r;
                                    for (i = 0,
                                             o = t.length; i < o; i++)
                                        r = t[i],
                                        r.column && r.column.parentVis && (r.column.thX = n++,
                                            r.column.thY = e.sectionRowIndex,
                                            this.yj(e, i, r.column.headerText, !1, r.column, {
                                                colSpan: r.colSpan,
                                                rowSpan: r.rowSpan
                                            }))
                                }
                                ,
                                t.prototype.wj = function(e, t, i) {
                                    var o, n, r = Math.min(t.length, i.length);
                                    for (o = 0; o < r; o++)
                                        this.yj(e, o, i[o].html, !0, t[o], i[o].qe, i[o].re)
                                }
                                ,
                                t.prototype.zj = function(t, i, o, n, r, a) {
                                    this.jh.cellStyleFormatter.format(i, o, n, t, e.grid.renderState.rendering, r, a),
                                        this.gg(i, e.grid.renderState.rendering, !1),
                                        this.jh.jg(t, i, o, n)
                                }
                                ,
                                t.prototype.xj = function(t, i, o) {
                                    this.jh.rowStyleFormatter.format(t, i, o),
                                        t.state &= ~e.grid.renderState.rendering,
                                        this._e(t.$rows, t),
                                        this.jh.kg(t)
                                }
                                ,
                                t.prototype.Aj = function(t) {
                                    var i = e.grid.rowType
                                        , o = t.type;
                                    return o & i.data || o === i.groupHeader || o === i.groupFooter || o === i.emptyDataRow
                                }
                                ,
                                t.prototype.dg = function(e, t, i) {
                                    i ? e.state |= t : e.state &= ~t,
                                        this._e(e.$rows, e)
                                }
                                ,
                                t.prototype.gg = function(t, i, o) {
                                    var n = e.grid.dataPrefix
                                        , r = this.jh.Id
                                        , a = n(t, r, "renderState");
                                    return o ? (i |= a,
                                        n(t, r, "renderState", i)) : (i = a & ~i,
                                        n(t, r, "renderState", i)),
                                        i
                                }
                                ,
                                t.prototype.Bj = function(e, t, o, n) {
                                    var r = this.Cj(e), a = this.Cj(t), s = [], l, c = 0, d, p, u = !0;
                                    if (r <= o) {
                                        if (i.extend(!0, s, e),
                                            r === o || n)
                                            return s;
                                        l = o - r
                                    } else {
                                        if (i.extend(!0, s, t),
                                            a >= o)
                                            return s;
                                        l = o - a
                                    }
                                    return i.each(s, function(e, t) {
                                        t.real || c++
                                    }),
                                    0 !== c && (d = Math.floor(l / c),
                                        p = l - d * c,
                                        i.each(s, function(e, t) {
                                            t.real || (t.width += d,
                                            u && (t.width += p,
                                                u = !1))
                                        })),
                                        s
                                }
                                ,
                                t.prototype.Dj = function(e) {
                                    var t, o, n, r, a, s, l, c, d, p, u, h = this.jh.Dd("visibleLeaves")[e];
                                    if (void 0 !== h.Ej)
                                        t = {
                                            width: h.Ej,
                                            real: !0
                                        };
                                    else if (h.isRowHeader)
                                        t = {
                                            width: this.Vi,
                                            real: !0
                                        };
                                    else {
                                        for (u = 0,
                                                 o = this.getJoinedTables(!0, e),
                                                 n = o[2],
                                                 r = 0; r < 2; r++)
                                            if (null !== (a = o[r]) && (s = a.element().rows,
                                                    p = s.length)) {
                                                for (d = p - 1,
                                                         c = null; d >= 0; d--)
                                                    if (s[d].cells.length === a.width()) {
                                                        c = s[d];
                                                        break
                                                    }
                                                c && (l = c.cells[n],
                                                    u = Math.max(u, i(l).outerWidth()))
                                            }
                                        t = {
                                            width: u,
                                            real: !1
                                        }
                                    }
                                    return t
                                }
                                ,
                                t.prototype.Yi = function(e, t) {
                                    var o, n, r = this.getHeaderCell(e), a = this.getJoinedCols(e);
                                    t && (n = this,
                                    r && (o = t - this.Wi.th,
                                    o < 0 && (o = 0),
                                        r.style.width = o + "px"),
                                        i.each(a, function(e, i) {
                                            i && (o = t - n.Wi.col,
                                            o < 0 && (o = 0),
                                                i.style.width = o + "px")
                                        }))
                                }
                                ,
                                t.prototype.Fj = function(e, t, o, n) {
                                    var r, a, s = this;
                                    i.each(e, function(e, i) {
                                        i[0].style.tableLayout = "fixed",
                                            i[0].style.width = t - s.Wi.subTable + "px"
                                    }),
                                        r = e[0].outerWidth(),
                                    0 !== (a = r - t) && this.Yi(n, o - a)
                                }
                                ,
                                t.prototype.Cj = function(e, t, o) {
                                    var n = 0;
                                    return i.each(e, function(e, i) {
                                        if (void 0 !== t && void 0 !== o && (e < t || e > o))
                                            return !0;
                                        n += i.width
                                    }),
                                        n
                                }
                                ,
                                t.prototype.af = function() {
                                    i.each(this.subTables(), function(e, t) {
                                        t.clearSection(2)
                                    })
                                }
                                ,
                                t.prototype.cf = function() {
                                    i.each(this.subTables(), function(e, t) {
                                        t.rebuildOffsets()
                                    })
                                }
                                ,
                                t.prototype.df = function(t, i) {
                                    var o = e.grid.rowType, n = this.jh.Jd(), r, a, s, l, c, d, p;
                                    if (t >= 0 && t < (a = n.length())) {
                                        if (i)
                                            for (r = 0; r < a; r++)
                                                s = this.Od(n.item(r)),
                                                    c = s.sectionRowIndex - t,
                                                s.sectionRowIndex > t && (s.sectionRowIndex--,
                                                s.type & o.data && (s.type & o.dataAlt ? s.type &= ~o.dataAlt : s.type |= o.dataAlt,
                                                    s.dataItemIndex--,
                                                    s.dataRowIndex--,
                                                    s.virtualDataItemIndex--),
                                                    this._e(s.$rows, s));
                                        s = this.Od(n.item(t), !1),
                                            d = this.getAbsoluteRowIndex(s.$rows[0]),
                                            s.$rows.remove(),
                                            p = this.getJoinedTables(!1, d),
                                        p[0] && p[0].removeOffset(p[2]),
                                        p[1] && p[1].removeOffset(p[2])
                                    }
                                }
                                ,
                                t.prototype.bf = function(t, i, o, n) {
                                    var r = this.jh.Dd("visibleLeaves"), a = e.grid.rowType, s = this.jh.Gd(), l = this.jh.Jd(), c = l.length(), d = 0 != (t.rowType & a.data), p, u, h;
                                    return (i < 0 || i >= c || !i && 0 !== i) && (i = c),
                                        p = this.lj(t.rowType, i, -1, o, n),
                                        this.mj(p, r, t),
                                        u = this.getAbsoluteRowIndex(p.$rows[0]),
                                        h = this.getJoinedTables(!1, u),
                                    h[0] && h[0].insertOffset(u),
                                    h[1] && h[1].insertOffset(u),
                                        p
                                }
                                ,
                                t.prototype.Gj = function(e) {
                                    var t = this.bodyRows(), o = 0, n = t.length(), r;
                                    if (i.isFunction(e))
                                        for (o = 0; o < n; o++)
                                            if (r = this.Od(t.item(o)),
                                                !0 === e(r))
                                                return r;
                                    return null
                                }
                                ,
                                t.prototype._e = function(t, i) {
                                    var o = "$rows"in i, n = "data"in i, r, a;
                                    o && (r = i.$rows,
                                        delete i.$rows),
                                    n && (a = i.data,
                                        delete i.data),
                                        e.grid.dataPrefix(t, this.jh.Id, "rowInfo", i),
                                    o && (i.$rows = r),
                                    n && (i.data = a)
                                }
                                ,
                                t.prototype.Od = function(t, o) {
                                    void 0 === o && (o = !0);
                                    var n = this.jh, r = i(t[1] ? t : t[0]), a = e.grid.dataPrefix(r, n.Id, "rowInfo"), s;
                                    if (a.$rows = r,
                                        o && a.dataItemIndex >= 0 && a.type & e.grid.rowType.data)
                                        try {
                                            a.data = n.pg(a.dataItemIndex)
                                        } catch (e) {
                                            a.data = null
                                        }
                                    return a
                                }
                                ,
                                t.prototype.oj = function(t, o, n, r, a, s, l) {
                                    var c, d = {
                                        type: o,
                                        state: n,
                                        sectionRowIndex: r,
                                        dataRowIndex: a,
                                        dataItemIndex: s,
                                        virtualDataItemIndex: l,
                                        $rows: i(t)
                                    };
                                    return s >= 0 && o & e.grid.rowType.data && (d.data = this.jh.pg(s)),
                                        d
                                }
                                ,
                                t
                        }();
                        t.baseView = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function(t) {
                            __extends(o, t);
                            function o(e, i) {
                                t.call(this, e, i),
                                    this.Hj = null,
                                    this.Ij = null
                            }
                            return o.prototype.dispose = function() {
                                this.jh.outerDiv.unbind("scroll", this.Jj),
                                    t.prototype.dispose.call(this)
                            }
                                ,
                                o.prototype.ensureWidth = function(e, o, n) {
                                    var r = i(this.Hj.element())
                                        , a = r.width() + o - n;
                                    t.prototype.ensureWidth.call(this, e, o, n),
                                        this.Fj([r], a, o, e)
                                }
                                ,
                                o.prototype.getVisibleAreaBounds = function() {
                                    var t = e.grid.bounds(this.Hj.element()), i;
                                    return "none" === this.jh.options.scrollMode ? t : (i = e.grid.bounds(this.jh.outerDiv.find(".gcui-gcuigrid-split-area-se:first")[0]),
                                        {
                                            top: t.top,
                                            left: t.left,
                                            width: Math.min(i.width, t.width),
                                            height: Math.min(i.height, t.height)
                                        })
                                }
                                ,
                                o.prototype.updateSplits = function(e) {
                                    var t = this, o = this.jh, n = o.options, r = o.element, a = [], s = [], l = [], c = o.Dd("visibleLeaves"), d = o.outerDiv, p, u;
                                    r.css({
                                        "table-layout": "",
                                        width: ""
                                    }),
                                        i.each(c, function(e, i) {
                                            var o, r = i.width;
                                            (r || 0 === r) && (o = "string" == typeof r && r.length > 1 && "%" === r[r.length - 1],
                                                r = o ? d.width() * parseFloat(r) / 100 : parseFloat(r),
                                            (i.ensurePxWidth || void 0 === i.ensurePxWidth && n.ensureColumnsPxWidth) && (i.Ej = r),
                                                t.Yi(e, r))
                                        }),
                                        i.each(c, function(e, i) {
                                            a.push(t.Dj(e))
                                        }),
                                        r.css("width", "1px"),
                                        i.each(c, function(e, i) {
                                            s.push(t.Dj(e))
                                        }),
                                        p = d.width(),
                                        l = this.Bj(a, s, p, n.ensureColumnsPxWidth),
                                        i.each(l, function(e, i) {
                                            var o = c[e];
                                            if (void 0 !== o.Ej)
                                                return void delete o.Ej;
                                            t.Yi(e, i.width)
                                        }),
                                    -1 !== (u = l.length - 1) && this.Fj([r], this.Cj(l, 0, u), l[u].width, u)
                                }
                                ,
                                o.prototype.focusableElement = function() {
                                    return i(this.Hj.element())
                                }
                                ,
                                o.prototype.forEachColumnCell = function(e, t, i) {
                                    return this.Hj.forEachColumnCell(e, t, i)
                                }
                                ,
                                o.prototype.forEachRowCell = function(e, t, i) {
                                    return this.Hj.forEachRowCell(e, t, i)
                                }
                                ,
                                o.prototype.getAbsoluteCellInfo = function(t) {
                                    return new e.grid.cellInfo(this.getColumnIndex(t),t.parentNode.rowIndex,this.jh,!0)
                                }
                                ,
                                o.prototype.getAbsoluteRowIndex = function(e) {
                                    return e.rowIndex
                                }
                                ,
                                o.prototype.getCell = function(e, t) {
                                    var i = this.Hj.getCellIdx(e, t), o;
                                    return i >= 0 && (o = this.getJoinedRows(t, 0),
                                        o[0]) ? o[0].cells[i] : null
                                }
                                ,
                                o.prototype.getColumnIndex = function(e) {
                                    return this.Hj.getColumnIdx(e)
                                }
                                ,
                                o.prototype.getHeaderCell = function(t) {
                                    var i = this.jh.Dd("visibleLeaves")[t], o;
                                    return i && (o = this.jh.Fe()) ? e.grid.rowAccessor.getCell(o.item(i.thY), i.thX) : null
                                }
                                ,
                                o.prototype.getJoinedCols = function(e) {
                                    var t = i(this.Hj.element()).find("> colgroup");
                                    return t.length && e < t[0].childNodes.length ? [t[0].childNodes[e], null] : [null, null]
                                }
                                ,
                                o.prototype.getJoinedRows = function(e, t) {
                                    return [this.Hj.getSectionRow(e, t), null]
                                }
                                ,
                                o.prototype.getJoinedTables = function(e, t) {
                                    return [this.Hj, null, t]
                                }
                                ,
                                o.prototype.subTables = function() {
                                    return [this.Hj]
                                }
                                ,
                                o.prototype.Zi = function() {
                                    this.Hj = new e.grid.htmlTableAccessor(this.jh.element[0],!0,!0,!0)
                                }
                                ,
                                o.prototype._i = function() {
                                    this.jh.element.find("> tbody").addClass(this.jh.options.uiCSS.content + " gcui-gcuigrid-data"),
                                        this.Hj = new e.grid.htmlTableAccessor(this.jh.element[0]),
                                        this.jh.Xf(this.jh.element, {
                                            role: "grid",
                                            cellpadding: "0",
                                            border: "0",
                                            cellspacing: "0"
                                        }),
                                        this.jh.element.css("border-collapse", "separate"),
                                        this.jh.outerDiv.bind("scroll", {
                                            gcuigrid: this.jh
                                        }, i.proxy(this.Jj, this)),
                                        t.prototype._i.call(this)
                                }
                                ,
                                o.prototype.nj = function(t, i, o) {
                                    var n = e.grid.rowType, r;
                                    switch (t) {
                                        case n.header:
                                        case n.filter:
                                            r = this.Hj.ensureTHead();
                                            break;
                                        case n.footer:
                                            r = this.Hj.ensureTFoot();
                                            break;
                                        default:
                                            r = this.Hj.ensureTBody()
                                    }
                                    return o ? [r.appendChild(o)] : (i > r.rows.length && (i = -1),
                                        [r.insertRow(i)])
                                }
                                ,
                                o.prototype.xj = function(e, i, o) {
                                    var n = e.$rows[0];
                                    !n.cells.length && this.Aj(e) ? n.parentNode.removeChild(n) : t.prototype.xj.call(this, e, i, o)
                                }
                                ,
                                o.prototype.rj = function(e, t, i) {
                                    e.$rows[0].appendChild(i[0])
                                }
                                ,
                                o.prototype.jj = function(e, t) {
                                    return [document.createElement("col")]
                                }
                                ,
                                o.prototype.kj = function(e, t, i) {
                                    this.Hj.appendCol(e[0])
                                }
                                ,
                                o.prototype.Jj = function(e) {
                                    e.data.gcuigrid.$superPanelHeader && e.data.gcuigrid.$superPanelHeader.css("left", e.target.scrollLeft),
                                    e.data.gcuigrid.$bottomPagerDiv && e.data.gcuigrid.$bottomPagerDiv.css("left", e.target.scrollLeft)
                                }
                                ,
                                o
                        }(t.baseView);
                        t.flatView = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function(t) {
                            __extends(o, t);
                            function o(e, o) {
                                t.call(this, e, o),
                                    this.Kj = 18,
                                    this.Lj = {},
                                    this.Mj = {},
                                    this.element = e.element,
                                    this.Ed = e.Ed(),
                                    this.Nj = e.sg(!0),
                                    this.Oj = e.wg(),
                                    this.Pj = e.vg(),
                                    this.Qj = -1 === this.Pj ? -1 : e.Dd("visibleLeaves")[this.Pj].leavesIdx,
                                    this.Rj = i.proxy(this.Sj, this)
                            }
                            return o.prototype.dispose = function() {
                                t.prototype.dispose.call(this),
                                    this.jh.outerDiv.unbind("mousewheel", this.Rj)
                            }
                                ,
                                o.prototype.ensureWidth = function(e, o, n) {
                                    var r = this.jh
                                        , a = r.options
                                        , s = this.Pj
                                        , l = e <= s
                                        , c = i(this.Lj.nw.element())
                                        , d = i(this.Lj.ne.element())
                                        , p = i(this.Lj.sw.element())
                                        , u = i(this.Lj.se.element())
                                        , h = l ? [c, p] : [d, u]
                                        , f = (l ? c.width() : d.width()) + o - n
                                        , g = r.Dd("frozener")
                                        , m = this.getScrollValue();
                                    this.Tj(),
                                        t.prototype.ensureWidth.call(this, e, o, n),
                                        this.Fj(h, f, o, e);
                                    try {
                                        a.splitDistanceX = s >= 0 ? c[0].offsetWidth : 0
                                    } catch (e) {}
                                    this.Uj(0),
                                        this.Nf();
                                    try {
                                        this.Oj >= 0 ? a.splitDistanceY = Math.max(c[0].offsetHeight, d[0].offsetHeight) : a.splitDistanceY = 0
                                    } catch (e) {}
                                    this.Uj(1),
                                        this.refreshPanel(m),
                                        g.refresh()
                                }
                                ,
                                o.prototype.ensureHeight = function(e) {
                                    var t, o = this.jh, n = o.options, r = i(this.Lj.nw.element()), a = i(this.Lj.ne.element()), s = i(this.Lj.sw.element()), l = i(this.Lj.se.element()), c = o.Dd("frozener"), d = this.getScrollValue(), p;
                                    this.Tj(),
                                    arguments.length > 0 && (t = this.getJoinedRows(e, 2),
                                        this.Vj(t, this.Wj(t))),
                                        l.css("height", ""),
                                        s.css("height", ""),
                                        p = Math.max(l.height(), s.height()),
                                        l.height(p),
                                        s.height(p);
                                    try {
                                        this.Oj >= 0 ? n.splitDistanceY = Math.max(r[0].offsetHeight, a[0].offsetHeight) : n.splitDistanceY = 0
                                    } catch (e) {}
                                    this.Uj(1),
                                        this.refreshPanel(d),
                                        c.refresh()
                                }
                                ,
                                o.prototype.getScrollValue = function() {
                                    var e = this.Xj();
                                    return e ? {
                                        x: e.options.hScroller.scrollValue,
                                        y: e.options.vScroller.scrollValue
                                    } : null
                                }
                                ,
                                o.prototype.getVisibleAreaBounds = function() {
                                    var t = e.grid.bounds(this.jh.outerDiv.find(".gcui-superpanel-contentwrapper:first"));
                                    return t || (t = e.grid.bounds(this.jh.outerDiv)),
                                        t
                                }
                                ,
                                o.prototype.getFixedAreaVisibleBounds = function() {
                                    var t = this.getVisibleAreaBounds()
                                        , i = e.grid.bounds(this.Mj.ne)
                                        , o = e.grid.bounds(this.Mj.nw)
                                        , n = null
                                        , r = null;
                                    return (i.height || o.height) && (n = {
                                        left: t.left,
                                        top: t.top,
                                        width: t.width,
                                        height: Math.min(i.height || o.height, t.height)
                                    }),
                                    o.width && (r = {
                                        left: o.left,
                                        top: t.top,
                                        width: Math.min(o.width, t.width),
                                        height: t.height
                                    }),
                                        [n, r]
                                }
                                ,
                                o.prototype.refreshPanel = function(t) {
                                    var o = this
                                        , n = this.jh
                                        , r = n.options
                                        , a = this.Yj(r.scrollMode)
                                        , s = this.dj()
                                        , l = this.Zj(n.outerDiv, n.element, i(this.Lj.ne.element()), r.scrollMode, n.xd)
                                        , c = l && !u
                                        , d = t ? t.x : null
                                        , p = t ? t.y : null
                                        , u = i.support.isTouchEnabled && i.support.isTouchEnabled();
                                    this.$j.width(a),
                                        this.Mj.ne.width(a - r.splitDistanceX - (c ? this.Kj : 0)),
                                    "right" === r.staticColumnsAlignment && (this.Mj.nw.css({
                                        left: "",
                                        right: c ? this.Kj : 0
                                    }),
                                        this.Mj.sw.css({
                                            left: "",
                                            right: c ? this.Kj : 0
                                        })),
                                        this.$j.data("gcui-superpanel") ? this.$j.superpanel("paintPanel") : (this.Ed && (this.vsUI = new e.grid.uiVirtualScroller(n,this.Mj.se,r.splitDistanceY)),
                                            this.$j.superpanel({
                                                disabled: n.options.disabled,
                                                scroll: i.proxy(this.Jj, this),
                                                bubbleScrollingEvent: !0,
                                                customScrolling: this.Ed,
                                                vScroller: {
                                                    scrollBarVisibility: s.vScrollBarVisibility,
                                                    scrollValue: t ? t.y : null
                                                },
                                                hScroller: {
                                                    scrollBarVisibility: s.hScrollBarVisibility,
                                                    scrollValue: t ? t.x : null
                                                },
                                                hScrollerActivating: function(e, t) {
                                                    var i;
                                                    if (n.xd && (i = n.element.height() + r.splitDistanceY - t.contentLength) > 0)
                                                        return o.$j.height(o.$j.height() + i),
                                                            o.$j.superpanel("paintPanel"),
                                                            !1;
                                                    o.Mj.sw.height(t.contentLength - r.splitDistanceY)
                                                }
                                            }),
                                        this.Ed && this.vsUI.attach(this.$j)),
                                        this.$j.find(".gcui-superpanel-hbarcontainer, .gcui-superpanel-vbarcontainer").css("zIndex", 5)
                                }
                                ,
                                o.prototype.scrollTo = function(e) {
                                    var t, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S;
                                    e.tableCell() && (t = this.jh,
                                        o = t.options,
                                        n = this.Xj(),
                                        r = e.tableCell(),
                                        a = r.nodeType ? i(r) : r,
                                        s = null,
                                        l = null,
                                    n && a.is(":visible") && (c = n.getContentElement(),
                                        d = c.parent(),
                                        p = -1 * parseInt((c.css("left") + "").replace("px", ""), 10),
                                        u = -1 * parseInt((c.css("top") + "").replace("px", ""), 10),
                                        h = d.outerWidth() - o.splitDistanceX,
                                        f = d.outerHeight() - o.splitDistanceY,
                                        g = a.position(),
                                        m = g.left,
                                        b = g.top,
                                        v = a.outerWidth(),
                                        y = a.outerHeight(),
                                        x = t.sg(!0),
                                        w = t.sg(!1),
                                        C = e.rowIndex(),
                                        S = e.cellIndex(),
                                        C <= x ? S <= w ? (s = 0,
                                            l = 0) : (m += p,
                                        m + v > p + h && (p = s = m + v - h),
                                        m < p && (s = m),
                                            l = 0) : S <= w ? (b += this.Mj.sw.scrollTop(),
                                        b + y > u + f && (u = l = b + y - f),
                                        b < u && (l = b),
                                            s = 0) : (m -= o.splitDistanceX,
                                        b + y > u + f && (u = l = b + y - f),
                                        m + v > p + h && (p = s = m + v - h),
                                        b < u && (l = b),
                                        m < p && (s = m)),
                                    null !== s && n.hScrollTo(s),
                                    null !== l && (this.Ed || n.vScrollTo(l))))
                                }
                                ,
                                o.prototype.updateSplits = function(e) {
                                    var t = this.jh, o = t.options, n, r = this, a = [], s = [], l = [], c = this.Pj, d, p = o.scrollMode, u = t.Dd("visibleLeaves"), h = i(this.Lj.se.element()), f = i(this.Lj.ne.element()), g = i(this.Lj.sw.element()), m = i(this.Lj.nw.element()), b = t.outerDiv, v, y, x;
                                    if (this.Tj(),
                                            b.unbind("mousewheel", this.Rj),
                                        (v = r.Lj.se.element().tBodies) && (v = v[0])) {
                                        for (x = !1,
                                                 y = 0; y < v.rows.length; y++)
                                            if (!i(v.rows[y]).hasClass("gcui-gcuigrid-groupheaderrow")) {
                                                x = !0;
                                                break
                                            }
                                        x || t.element.css("width", "100%")
                                    }
                                    i.each([h, f, g, m], function(e, t) {
                                        t.css({
                                            "table-layout": "",
                                            width: ""
                                        })
                                    }),
                                        i.each(u, function(e, t) {
                                            var i, n = t.width;
                                            (n || 0 === n) && (i = "string" == typeof n && n.length > 1 && "%" === n[n.length - 1],
                                                n = i ? b.width() * parseFloat(n) / 100 : parseFloat(n),
                                            (t.ensurePxWidth || void 0 === t.ensurePxWidth && o.ensureColumnsPxWidth) && (t.Ej = n),
                                                r.Yi(e, n))
                                        }),
                                        i.each(u, function(e, t) {
                                            l.push(r.Dj(e))
                                        }),
                                        i.each([m, f, g, h], function(e, t) {
                                            t.css({
                                                width: "1px"
                                            })
                                        }),
                                        i.each(u, function(e, t) {
                                            s.push(r.Dj(e))
                                        }),
                                        n = b.width(),
                                        a = this.Bj(l, s, n, o.ensureColumnsPxWidth),
                                        i.each(a, function(e, t) {
                                            var i = u[e];
                                            if (void 0 !== i.Ej)
                                                return void delete i.Ej;
                                            r.Yi(e, t.width)
                                        }),
                                    c >= 0 && (d = c,
                                        this.Fj([m, g], this.Cj(a, 0, d), a[d].width, d));
                                    try {
                                        o.splitDistanceX = c >= 0 ? m[0].offsetWidth : 0
                                    } catch (e) {}
                                    this.Uj(0),
                                    o.ensureColumnsPxWidth || f.parent().width(n - o.splitDistanceX),
                                        d = a.length - 1,
                                    -1 !== d && this.Fj([f, h], this.Cj(a, c + 1, d), a[d].width, d),
                                        this.Nf();
                                    try {
                                        this.Oj >= 0 ? o.splitDistanceY = Math.max(m[0].offsetHeight, f[0].offsetHeight) : o.splitDistanceY = 0
                                    } catch (e) {}
                                    if (this.Uj(1),
                                        !o.ensureColumnsPxWidth && this.Zj(t.outerDiv, h, f, p, t.xd)) {
                                        n -= this.Kj,
                                            a = this.Bj(l, s, n, o.ensureColumnsPxWidth),
                                            i.each(a, function(e, t) {
                                                t.real || r.Yi(e, t.width)
                                            }),
                                        c >= 0 && (d = c,
                                            this.Fj([m, g], this.Cj(a, 0, d), a[d].width, d));
                                        try {
                                            o.splitDistanceX = c >= 0 ? m[0].offsetWidth : 0
                                        } catch (e) {}
                                        this.Uj(0),
                                            f.parent().width(n - o.splitDistanceX),
                                            d = a.length - 1,
                                        -1 !== d && this.Fj([f, h], this.Cj(a, c + 1, d), a[d].width, d),
                                            this.Nf();
                                        try {
                                            this.Oj >= 0 ? o.splitDistanceY = Math.max(m[0].offsetHeight, f[0].offsetHeight) : o.splitDistanceY = 0
                                        } catch (e) {}
                                        this.Uj(1)
                                    }
                                    this.refreshPanel(e),
                                        b.bind("mousewheel", i.proxy(this.Rj, this))
                                }
                                ,
                                o.prototype.af = function() {
                                    t.prototype.af.call(this)
                                }
                                ,
                                o.prototype.bodyRows = function() {
                                    var e = t.prototype.bodyRows.call(this);
                                    return e
                                }
                                ,
                                o.prototype.focusableElement = function() {
                                    return this.jh.outerDiv
                                }
                                ,
                                o.prototype.forEachColumnCell = function(e, t, i) {
                                    var o = this.getJoinedTables(!0, e), n, r;
                                    if (null !== o[0]) {
                                        if (n = o[2],
                                            !0 !== (r = o[0].forEachColumnCell(n, t, i)))
                                            return r;
                                        if (null !== o[1] && !0 !== (r = o[1].forEachColumnCell(n, t, i)))
                                            return r
                                    }
                                    return !0
                                }
                                ,
                                o.prototype.forEachRowCell = function(e, t, i) {
                                    var o = this.getJoinedTables(!1, e), n = o[0], r = o[1], a, s;
                                    if (null !== n) {
                                        if ((a = o[2]) < n.element().rows.length && !0 !== (s = n.forEachRowCell(a, t, i)))
                                            return s;
                                        if (null !== r && a < r.element().rows.length && !0 !== (s = r.forEachRowCell(a, t, i)))
                                            return s
                                    }
                                    return HTMLTableCellElement,
                                        !0
                                }
                                ,
                                o.prototype.getAbsoluteCellInfo = function(t) {
                                    return new e.grid.cellInfo(this.getColumnIndex(t),this.getAbsoluteRowIndex(t.parentNode),this.jh,!0)
                                }
                                ,
                                o.prototype.getAbsoluteRowIndex = function(e) {
                                    for (var t = e.rowIndex, i = e.parentNode; "table" !== i.tagName.toLowerCase(); )
                                        i = i.parentNode;
                                    return i === this.Lj.nw.element() || i === this.Lj.ne.element() ? t : t + this.Oj + 1
                                }
                                ,
                                o.prototype.getCell = function(e, t) {
                                    var i = this.getJoinedTables(!1, t), o, n, r, a, s;
                                    return null !== i[0] && (o = this.getJoinedTables(!0, e),
                                    null !== o[0] && (n = i[2],
                                        r = o[2],
                                        a = null,
                                        a = null !== i[1] ? e === r ? i[0] : i[1] : i[0],
                                    (s = a.getCellIdx(r, n)) >= 0)) ? a.element().rows[n].cells[s] : null
                                }
                                ,
                                o.prototype.getColumnIndex = function(e) {
                                    var t = null, i = null, o = !1, n;
                                    for (t = e.parentNode; "table" !== t.tagName.toLowerCase(); t = t.parentNode)
                                        ;
                                    return null !== t && (t === this.Lj.nw.element() ? i = this.Lj.nw : t === this.Lj.ne.element() ? (i = this.Lj.ne,
                                        o = !0) : t === this.Lj.sw.element() ? i = this.Lj.sw : t === this.Lj.se.element() && (i = this.Lj.se,
                                        o = !0),
                                    null !== i) ? (n = i.getColumnIdx(e),
                                    o && (n += this.Pj + 1),
                                        n) : -1
                                }
                                ,
                                o.prototype.getHeaderCell = function(t) {
                                    var i = this.jh.Dd("visibleLeaves")[t], o;
                                    return i && (o = this.jh.Fe()) ? e.grid.rowAccessor.getCell(o.item(i.thY), i.thX) : null
                                }
                                ,
                                o.prototype.getJoinedCols = function(e) {
                                    var t = []
                                        , o = this.getJoinedTables(!0, e)
                                        , n = o[2];
                                    return o.splice(o.length - 1, 1),
                                        i.each(o, function(e, o) {
                                            t.push(o ? i(o.element()).find("col")[n] : null)
                                        }),
                                        t
                                }
                                ,
                                o.prototype.getJoinedRows = function(e, t) {
                                    var i = null
                                        , o = null
                                        , n = null
                                        , r = null
                                        , a = this.Oj
                                        , s = this.Pj
                                        , l = this.jh.Dd("visibleLeaves").length - 1
                                        , c = this._j() - 1
                                        , d = a === c
                                        , p = a < 0
                                        , u = !d && !p
                                        , h = 0;
                                    return (d || u) && (s >= 0 && s < l ? (n = this.Lj.nw,
                                        r = this.Lj.ne) : n = s < 0 ? this.Lj.ne : this.Lj.nw,
                                        h = n.getSectionLength(t),
                                    e < h && (i = n.getSectionRow(e, t),
                                    null !== r && (o = r.getSectionRow(e, t)))),
                                    (p || u && null === i) && (p || (e -= h),
                                        s >= 0 && s < l ? (n = this.Lj.sw,
                                            r = this.Lj.se) : n = s < 0 ? this.Lj.se : this.Lj.sw,
                                        i = n.getSectionRow(e, t),
                                    null !== r && (o = r.getSectionRow(e, t))),
                                        null === i && null === o ? null : [i, o]
                                }
                                ,
                                o.prototype.getJoinedTables = function(e, t) {
                                    var i = null
                                        , o = null
                                        , n = t
                                        , r = this.jh
                                        , a = this.Oj
                                        , s = this.Pj;
                                    return e ? (t <= s ? (i = this.Lj.nw,
                                        o = this.Lj.sw) : (i = this.Lj.ne,
                                        o = this.Lj.se,
                                        n -= s + 1),
                                    a < 0 && (i = null),
                                    a === this._j() - 1 && (o = null)) : (t <= a ? (i = this.Lj.nw,
                                        o = this.Lj.ne) : (i = this.Lj.sw,
                                        o = this.Lj.se,
                                        n -= a + 1),
                                    s < 0 && (i = null),
                                    s === r.Dd("leaves").length - 1 && (o = null)),
                                    null === i && (i = o,
                                        o = null),
                                        [i, o, n]
                                }
                                ,
                                o.prototype.subTables = function() {
                                    return [this.Lj.nw, this.Lj.ne, this.Lj.sw, this.Lj.se]
                                }
                                ,
                                o.prototype.Yj = function(e) {
                                    var t = this.jh
                                        , o = t.element.outerWidth(!0) + t.options.splitDistanceX
                                        , n = t.outerDiv.innerWidth();
                                    return this.Zj(t.outerDiv, t.element, i(this.Lj.ne.element()), e, t.xd) && (o += this.Kj),
                                    o > n && (o = n),
                                        o
                                }
                                ,
                                o.prototype.Xj = function() {
                                    return this.$j ? this.$j.data("gcui-superpanel") : null
                                }
                                ,
                                o.prototype.Ue = function() {
                                    this.jh.Ed() ? (this.jh.Ue(this.Xi),
                                        this.jh.Fd(),
                                        this.Xi.end = this.Xi.start + this.jh.options.pageSize - 1,
                                        this.jh.Ue(this.Xi)) : t.prototype.Ue.call(this)
                                }
                                ,
                                o.prototype.$i = function() {
                                    t.prototype.$i.call(this)
                                }
                                ,
                                o.prototype.Zi = function() {
                                    var t = document.createDocumentFragment()
                                        , o = e.grid.htmlTableAccessor;
                                    this.jh.outerDiv.wrapInner('<div class="gcui-gcuigrid-fixedview"><div class="gcui-gcuigrid-scroller"><div class="gcui-gcuigrid-split-area-se gcui-gcuigrid-content-area"></div></div></div>'),
                                        this.$j = this.jh.outerDiv.find(".gcui-gcuigrid-scroller"),
                                        this.$j.css("padding", 0),
                                        this.$j.after(this.Mj.nw = i('<div class="gcui-gcuigrid-split-area gcui-gcuigrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),
                                        this.$j.after(this.Mj.ne = i('<div class="gcui-gcuigrid-split-area gcui-gcuigrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),
                                        this.$j.after(this.Mj.sw = i('<div class="gcui-gcuigrid-split-area gcui-gcuigrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),
                                        this.Mj.se = this.$j.find(".gcui-gcuigrid-split-area-se:first"),
                                        this.Lj = {
                                            nw: new o(t.appendChild(document.createElement("table")),!0,!0,!0),
                                            ne: new o(t.appendChild(document.createElement("table")),!0,!0,!0),
                                            sw: new o(t.appendChild(document.createElement("table")),!0,!0,!0),
                                            se: new o(t.appendChild(this.jh.element[0]),!0,!0,!0)
                                        }
                                }
                                ,
                                o.prototype._i = function() {
                                    var o, n, r, a, s = e.grid.htmlTableAccessor, l = this;
                                    this.Lj = {
                                        nw: new s(o = this.Lj.nw.element()),
                                        ne: new s(n = this.Lj.ne.element()),
                                        sw: new s(r = this.Lj.sw.element()),
                                        se: new s(a = this.Lj.se.element())
                                    },
                                        this.Mj.nw.empty().append(o),
                                        this.Mj.ne.empty().append(n),
                                        this.Mj.sw.empty().append(r),
                                        this.Mj.se.empty().append(a),
                                        i.each(this.Lj, function(e, t) {
                                            var o = i(t.element());
                                            l.jh.Xf(o, {
                                                role: "grid",
                                                border: "0",
                                                cellpadding: "0",
                                                cellspacing: "0"
                                            }),
                                                o.addClass("gcui-gcuigrid-table").css("border-collapse", "separate").find("> tbody").addClass(l.jh.options.uiCSS.content + " gcui-gcuigrid-data")
                                        }),
                                        t.prototype._i.call(this)
                                }
                                ,
                                o.prototype._j = function() {
                                    var e = this.Lj.nw.element(), t = this.Lj.ne.element(), i = this.Lj.sw.element(), o = this.Lj.se.element(), n;
                                    return n = Math.max(e.rows.length, t.rows.length) + Math.max(i.rows.length, o.rows.length)
                                }
                                ,
                                o.prototype.jj = function(e, t) {
                                    return [document.createElement("col"), document.createElement("col")]
                                }
                                ,
                                o.prototype.kj = function(e, t, i) {
                                    i <= this.Pj ? (this.Lj.nw.appendCol(e[0]),
                                        this.Lj.sw.appendCol(e[1])) : (this.Lj.ne.appendCol(e[0]),
                                        this.Lj.se.appendCol(e[1]))
                                }
                                ,
                                o.prototype.nj = function(t, i, o) {
                                    var n = e.grid.rowType, r, a, s = this.Lj;
                                    switch (t) {
                                        case n.header:
                                        case n.filter:
                                            r = s.nw.ensureTHead(),
                                                a = s.ne.ensureTHead();
                                            break;
                                        case n.footer:
                                            r = s.sw.ensureTFoot(),
                                                a = s.se.ensureTFoot();
                                            break;
                                        default:
                                            i <= this.Nj ? (r = s.nw.ensureTBody(),
                                                a = s.ne.ensureTBody()) : (i -= this.Nj + 1,
                                                r = s.sw.ensureTBody(),
                                                a = s.se.ensureTBody())
                                    }
                                    return o ? [r.appendChild(o), a.appendChild(o.cloneNode(!1))] : [r.insertRow(i > r.rows.length ? -1 : i), a.insertRow(i > a.rows.length ? -1 : i)]
                                }
                                ,
                                o.prototype.xj = function(e, o, n) {
                                    var r = e.$rows[0]
                                        , a = e.$rows[1];
                                    !r.cells.length && this.Aj(e) && (r.parentNode.removeChild(r),
                                        r = null),
                                    !a.cells.length && this.Aj(e) && (a.parentNode.removeChild(a),
                                        a = null),
                                    (r || a) && (r && a || (e.$rows = i(r ? r : a)),
                                        t.prototype.xj.call(this, e, o, n))
                                }
                                ,
                                o.prototype.rj = function(t, i, o) {
                                    var n = t.type !== e.grid.rowType.header ? this.Pj : this.Qj;
                                    i <= n ? t.$rows[0].appendChild(o[0]) : t.$rows[1].appendChild(o[0])
                                }
                                ,
                                o.prototype.Wj = function(e, t) {
                                    if (e[0] && e[1]) {
                                        var o = e[0], n = e[1], r = i(o), a = i(n), s, l, c, d = function(e) {
                                            var t, o = e[0], n;
                                            for (t = 0; t < o.cells.length; t++)
                                                if (n = o.cells[t],
                                                    !n.rowSpan || 1 === n.rowSpan)
                                                    return i(n).outerHeight();
                                            return e.height()
                                        };
                                        return (c = i.data(o, "customHeight")) ? s = l = parseInt(c) : (r.css("height", ""),
                                            a.css("height", ""),
                                            t ? (s = d(r),
                                                l = d(a)) : (s = r.height(),
                                                l = a.height())),
                                            Math.max(s, l)
                                    }
                                    return null
                                }
                                ,
                                o.prototype.Vj = function(e, t) {
                                    if (e[0] && e[1]) {
                                        var o = [i(e[0]), i(e[1])], n;
                                        if (null === t)
                                            return;
                                        t += 1,
                                            i.each(o, function(e, i) {
                                                i.height(t),
                                                (n = t - i.height()) && i.height(t + n)
                                            })
                                    }
                                }
                                ,
                                o.prototype.ak = function() {
                                    var e = this.jh, t = this.Pj, i = e.Dd("visibleLeaves").length - 1, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y = [];
                                    if (t > -1 && t < i) {
                                        if (o = this.Oj,
                                                n = this._j() - 1,
                                                r = this.Lj,
                                            o > -1 && o <= n)
                                            for (a = r.ne.element(),
                                                     s = a.parentNode,
                                                     l = r.nw.element(),
                                                     c = l.parentNode,
                                                     b = l.rows,
                                                     v = a.rows,
                                                     f = b.length,
                                                     g = 0; g < f; g++)
                                                y.push(this.Wj([b[g], v[g]], !0));
                                        if (o >= -1 && o < n)
                                            for (d = r.se.element(),
                                                     p = d.parentNode,
                                                     u = r.sw.element(),
                                                     h = u.parentNode,
                                                     b = u.rows,
                                                     v = d.rows,
                                                     f = b.length,
                                                     g = 0; g < f; g++)
                                                y.push(this.Wj([b[g], v[g]]));
                                        if (o > -1 && o <= n && (c.removeChild(l),
                                                s.removeChild(a)),
                                            o >= -1 && o < n && (h.removeChild(u),
                                                p.removeChild(d)),
                                            o > -1 && o <= n)
                                            for (b = l.rows,
                                                     v = a.rows,
                                                     f = b.length,
                                                     g = 0,
                                                     m = 0; g < f; g++)
                                                this.Vj([b[g], v[g]], y[m++]);
                                        if (o >= -1 && o < n)
                                            for (b = u.rows,
                                                     v = d.rows,
                                                     f = b.length,
                                                     g = 0; g < f; g++)
                                                this.Vj([b[g], v[g]], y[m++]);
                                        o > -1 && o <= n && (c.appendChild(l),
                                            s.appendChild(a)),
                                        o >= -1 && o < n && (h.appendChild(u),
                                            p.appendChild(d))
                                    }
                                }
                                ,
                                o.prototype.Nf = function() {
                                    var e = i(this.Lj.sw.element()), t = i(this.Lj.se.element()), o;
                                    t.css("height", ""),
                                        e.css("height", ""),
                                        this.ak(),
                                        o = Math.max(t.height(), e.height()),
                                        e.height(o),
                                        t.height(o)
                                }
                                ,
                                o.prototype.Tj = function() {
                                    this.$j.data("gcui-superpanel") && (this.vsUI && this.vsUI.dispose(),
                                        this.$j.superpanel("destroy"))
                                }
                                ,
                                o.prototype.Jj = function(e, t) {
                                    var i = this.Xj();
                                    this.Ed ? "h" === t.dir && (this.bk(i.getContentElement(), t.dir, t.position, t.animationOptions, !1),
                                        this.bk(this.Mj.ne, t.dir, t.position, t.animationOptions, !0)) : this.bk("h" === t.dir ? this.Mj.ne : this.Mj.sw, t.dir, t.position, t.animationOptions, !0),
                                        this.jh.yg(i.options.hScroller.scrollValue, i.options.vScroller.scrollValue)
                                }
                                ,
                                o.prototype.Sj = function(t, o) {
                                    var n, r = o > 0 ? "top" : "bottom", a = !1, s;
                                    this.jh.$f() && (n = this.getFixedAreaVisibleBounds(),
                                        i.each(n, function(i, o) {
                                            if (o && e.grid.isOver(t.pageY, t.pageX, o.top, o.left, o.height, o.width))
                                                return a = !0,
                                                    !1
                                        }),
                                    a && this.$j.data("gcui-superpanel") && (s = this.$j.superpanel("option", "vScroller").scrollValue,
                                        this.$j.superpanel("doScrolling", r),
                                    s !== this.$j.superpanel("option", "vScroller").scrollValue && (t.stopPropagation(),
                                        t.preventDefault())))
                                }
                                ,
                                o.prototype.bk = function(e, t, i, o, n) {
                                    var r = {}, a;
                                    a = "h" === t ? n ? "scrollLeft" : "left" : n ? "scrollTop" : "top",
                                    n || (i = -i),
                                        o ? (r[a] = i,
                                            e.animate(r, o)) : n ? e[0][a] = i : e.css(a, i)
                                }
                                ,
                                o.prototype.Zj = function(e, t, i, o, n) {
                                    var r, a = this.jh, s = i.width() + a.options.splitDistanceX, l = t.height() + a.options.splitDistanceY, c = e.width(), d = e.height(), p, u = 0, h = 0;
                                    return !!(this.Ed && a.Ve() > 1) || (null !== a.$superPanelHeader && (u = a.$superPanelHeader.outerHeight(!0)),
                                    null !== a.$bottomPagerDiv && (h = a.$bottomPagerDiv.outerHeight(!0)),
                                        p = d - u - h,
                                        r = "both" === o || "vertical" === o || "auto" === o && (l > p || !n && s > c && l > p - this.Kj))
                                }
                                ,
                                o.prototype.Uj = function(e) {
                                    var t = this.jh, i = t.options, o, n, r = 0, a = 0;
                                    0 !== e && 2 !== e || (this.Mj.nw.width(i.splitDistanceX),
                                        this.Mj.sw.width(i.splitDistanceX),
                                        "right" === t.options.staticColumnsAlignment ? (this.Mj.se.css("marginRight", i.splitDistanceX),
                                            this.Mj.ne.css("marginRight", i.splitDistanceX)) : (this.Mj.se.css("marginLeft", i.splitDistanceX),
                                            this.Mj.ne.css("marginLeft", i.splitDistanceX))),
                                    1 !== e && 2 !== e || (this.$j.css("height", ""),
                                        this.Mj.se.css("marginTop", 0),
                                        o = t.outerDiv.height(),
                                        t.xd ? this.$j.height(o + i.splitDistanceY) : this.$j.height(o),
                                        this.Mj.nw.height(i.splitDistanceY),
                                        this.Mj.ne.height(i.splitDistanceY),
                                    null !== t.$superPanelHeader && (r = t.$superPanelHeader.outerHeight(!0)),
                                    null !== t.$bottomPagerDiv && (a = t.$bottomPagerDiv.outerHeight(!0)),
                                        n = o - r - a,
                                    null !== t.$superPanelHeader && (this.Mj.nw.css("top", r + "px"),
                                        this.Mj.ne.css("top", r + "px")),
                                        t.xd ? this.Mj.sw.height(n) : this.Mj.sw.height(n - i.splitDistanceY),
                                        this.Mj.sw.css("top", i.splitDistanceY + r),
                                        this.Mj.se.css("marginTop", i.splitDistanceY))
                                }
                                ,
                                o
                        }(t.baseView);
                        t.fixedView = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = function() {
                            function t(e) {
                                if (this.ck = 0,
                                        this.dk = null,
                                        this.ek = null,
                                        this.fk = {
                                            singlecell: [0, 0, 0],
                                            singlecolumn: [1, 1, 1],
                                            singlerow: [2, 2, 2],
                                            singlerange: [0, 1, 2],
                                            multicolumn: [1, 1, 1],
                                            multirow: [2, 2, 2],
                                            multirange: [0, 1, 2]
                                        },
                                        !e)
                                    throw "invalid arguments";
                                this.jh = e,
                                    this.gk = new i(e),
                                    this.hk = new i(e),
                                    this.ik = new i(e),
                                    this.jk = new i(e)
                            }
                            return t.prototype.selectedCells = function() {
                                return this.ik
                            }
                                ,
                                t.prototype.addColumns = function(e, t) {
                                    t || 0 === t || (t = e),
                                        this.addRange(e, 0, t, 16777215)
                                }
                                ,
                                t.prototype.addRange = function(t, i, o, n) {
                                    if (!t && 1 === arguments.length)
                                        throw "invalid argument";
                                    var r = 4 === arguments.length ? new e.grid.cellInfoRange(new e.grid.cellInfo(t,i),new e.grid.cellInfo(o,n)) : t.Kd();
                                    if (r.Ui(),
                                            !r.Ld())
                                        throw "invalid argument";
                                    this.beginUpdate(),
                                        this.Tf(this.jh.Dd("currentCell")),
                                        this.Ne(r, !1, !0, e.grid.cellRangeExtendMode.none, null),
                                        this.endUpdate()
                                }
                                ,
                                t.prototype.addRows = function(e, t) {
                                    t || 0 === t || (t = e),
                                        this.addRange(0, e, 16777215, t)
                                }
                                ,
                                t.prototype.removeRange = function(t, i, o, n) {
                                    if (!t && 1 === arguments.length)
                                        throw "invalid argument";
                                    var r = 4 === arguments.length ? new e.grid.cellInfoRange(new e.grid.cellInfo(t,i),new e.grid.cellInfo(o,n)) : t.Kd();
                                    if (r.Ui(),
                                            !r.Ld())
                                        throw "invalid argument";
                                    this.beginUpdate(),
                                        this.Tf(this.jh.Dd("currentCell")),
                                        this.Uf(r, e.grid.cellRangeExtendMode.none),
                                        this.endUpdate()
                                }
                                ,
                                t.prototype.removeColumns = function(e, t) {
                                    t || 0 === t || (t = e),
                                        this.removeRange(e, 0, t, 16777215)
                                }
                                ,
                                t.prototype.removeRows = function(e, t) {
                                    t || 0 === t || (t = e),
                                        this.removeRange(0, e, 16777215, t)
                                }
                                ,
                                t.prototype.clear = function() {
                                    this.beginUpdate(),
                                        this.hk.kk(),
                                        this.hk.lk(this.ik),
                                        this.endUpdate()
                                }
                                ,
                                t.prototype.selectAll = function() {
                                    this.beginUpdate(),
                                        this.Ne(this.jh.Nd(), !1, !1, e.grid.cellRangeExtendMode.none, null),
                                        this.endUpdate()
                                }
                                ,
                                t.prototype.beginUpdate = function() {
                                    this.ck++
                                }
                                ,
                                t.prototype.endUpdate = function() {
                                    this.ck > 0 && 0 === --this.ck && (this.doSelection(),
                                    (this.gk.length() || this.hk.length()) && (null !== this.dk && this.dk.UnderlyingDataChanged(),
                                    null !== this.ek && this.ek.UnderlyingDataChanged(),
                                        this.jh._trigger("selectionChanged", null, {
                                            addedCells: this.gk,
                                            removedCells: this.hk
                                        })),
                                        this.gk = new e.grid.cellInfoOrderedCollection(this.jh),
                                        this.hk.kk())
                                }
                                ,
                                t.prototype.Sf = function() {
                                    var e = this.jh.options.selectionMode;
                                    return e && ("multicolumn" === (e = e.toLowerCase()) || "multirow" === e || "multirange" === e)
                                }
                                ,
                                t.prototype.Vf = function() {
                                    return this.mk
                                }
                                ,
                                t.prototype.Tf = function(t) {
                                    t && (this.mk = t.Kd(),
                                        this.jk = new e.grid.cellInfoOrderedCollection(this.jh))
                                }
                                ,
                                t.prototype.Uf = function(e, t) {
                                    var i = this.jh.options.selectionMode.toLowerCase(), o, n, r, a, s, l, c, d, p, u = this.jh.Nd();
                                    if (e.Ld() && "none" !== i && this.ik.length() > 0) {
                                        if (o = e.Kd(),
                                                o.Ui(),
                                                o.Md(u),
                                                !e.Ld())
                                            return;
                                        for (o.Ti(this.fk[i][t], u),
                                                 this.beginUpdate(),
                                                 c = 0,
                                                 d = this.ik.length(); c < d; c++)
                                            p = this.ik.item(c),
                                            o.fg(p) && this.hk.nk(p);
                                        this.endUpdate()
                                    }
                                }
                                ,
                                t.prototype.Ne = function(t, i, o, n, r) {
                                    var a = this.jh.options.selectionMode.toLowerCase(), s, l = this.jh.Nd();
                                    if ("none" !== a && t.Ld()) {
                                        if (s = t.Kd(),
                                                s.Ui(),
                                                s.Md(l),
                                                !s.Ld())
                                            return;
                                        switch (this.beginUpdate(),
                                            this.Sf() && (i || o) ? o && (this.hk.kk(),
                                                this.hk.lk(this.jk)) : this.clear(),
                                            a) {
                                            case "singlecell":
                                            case "singlecolumn":
                                            case "singlerow":
                                                s = null === r ? new e.grid.cellInfoRange(s.topLeft(),s.topLeft()) : new e.grid.cellInfoRange(r,r)
                                        }
                                        s.Ti(this.fk[a][n], l),
                                            this.doRange(s, !0),
                                            this.endUpdate()
                                    }
                                }
                                ,
                                t.prototype.doSelection = function() {
                                    var t = this.jh.ng(), i = t.x, n = t.y, r = this.jh.Gd(), a, s, l, c, d, p, u = e.grid.renderState, h, f, g = -1;
                                    for (a = 0,
                                             s = this.hk.length(); a < s; a++)
                                        l = this.hk.item(a),
                                            this.gk.indexOf(l) < 0 ? (c = r.getCell(l.cellIndex() + i, l.rowIndex() + n),
                                            c && (g !== l.rowIndex() && (h = l.row(),
                                                g = l.rowIndex()),
                                                d = o(c),
                                                f = r.gg(d, u.selected, !1),
                                                this.jh.cellStyleFormatter.format(d, l.cellIndex(), l.column(), h, f)),
                                                this.ik.Fa(l),
                                                this.jk.Fa(l)) : (this.hk.pk(a),
                                                a--,
                                                s--);
                                    for (g = -1,
                                             a = 0,
                                             s = this.gk.length(); a < s; a++)
                                        l = this.gk.item(a),
                                            p = this.ik.indexOf(l),
                                            p < 0 ? (c = r.getCell(l.cellIndex() + i, l.rowIndex() + n),
                                            c && (g !== l.rowIndex() && (h = l.row(),
                                                g = l.rowIndex()),
                                                d = o(c),
                                                f = r.gg(d, u.selected, !0),
                                                this.jh.cellStyleFormatter.format(d, l.cellIndex(), l.column(), h, f)),
                                                this.ik.qk(l, ~p),
                                                this.jk.nk(l)) : (this.gk.pk(a),
                                                a--,
                                                s--)
                                }
                                ,
                                t.prototype.doRange = function(t, i) {
                                    var o = t.topLeft().cellIndex(), n = t.topLeft().rowIndex(), r = t.bottomRight().cellIndex(), a = t.bottomRight().rowIndex(), s, l, c, d, p = this.jh.Gd(), u, h;
                                    if (i) {
                                        for (s = this.gk.length(),
                                                 h = this.jh.Jd(),
                                                 l = n; l <= a; l++)
                                            if (u = p.Od(h.item(l)),
                                                u.type & e.grid.rowType.data)
                                                for (c = o; c <= r; c++)
                                                    d = new e.grid.cellInfo(c,l),
                                                        0 === s ? this.gk.rk(d) : this.gk.nk(d)
                                    } else
                                        for (s = this.hk.length(),
                                                 l = n; l <= a; l++)
                                            for (c = o; c <= r; c++)
                                                d = new e.grid.cellInfo(c,l),
                                                    0 === s ? this.hk.rk(d) : this.hk.nk(d)
                                }
                                ,
                                t
                        }();
                        t.selection = n,
                            i = function() {
                                function t(e) {
                                    if (this.kk = function() {
                                            this.sk.length = 0
                                        }
                                            ,
                                            !e)
                                        throw "invalid arguments";
                                    this.jh = e,
                                        this.sk = []
                                }
                                return t.prototype.item = function(e) {
                                    return this.sk[e]
                                }
                                    ,
                                    t.prototype.length = function() {
                                        return this.sk.length
                                    }
                                    ,
                                    t.prototype.indexOf = function(e, t) {
                                        1 === arguments.length && (t = e.rowIndex(),
                                            e = e.cellIndex());
                                        for (var i = 0, o = this.sk.length - 1, n, r, a; i <= o; )
                                            if (n = i + (o - i >> 1),
                                                    r = this.sk[n],
                                                    a = r.rowIndex() - t,
                                                0 === a && (a = r.cellIndex() - e),
                                                a < 0)
                                                i = n + 1;
                                            else {
                                                if (!(a > 0))
                                                    return n;
                                                o = n - 1
                                            }
                                        return ~i
                                    }
                                    ,
                                    t.prototype.toString = function() {
                                        var e = "", t, i;
                                        for (t = 0,
                                                 i = this.sk.length; t < i; t++)
                                            e += this.sk[t] + "\n";
                                        return e
                                    }
                                    ,
                                    t.prototype.nk = function(e) {
                                        var t = this.indexOf(e);
                                        return t < 0 && (this.sk.splice(~t, 0, e),
                                            e.Pd(this.jh),
                                            !0)
                                    }
                                    ,
                                    t.prototype.lk = function(e) {
                                        if (e) {
                                            var t = e.length(), i = this.sk.length, o;
                                            if (0 === i)
                                                for (this.sk.length = t,
                                                         o = 0; o < t; o++)
                                                    this.sk[o] = e.item(o),
                                                        this.sk[o].Pd(this.jh);
                                            else
                                                for (o = 0; o < t; o++)
                                                    this.nk(e.item(o))
                                        }
                                    }
                                    ,
                                    t.prototype.rk = function(e) {
                                        this.sk[this.sk.length] = e,
                                            e.Pd(this.jh)
                                    }
                                    ,
                                    t.prototype.qk = function(e, t) {
                                        this.sk.splice(t, 0, e)
                                    }
                                    ,
                                    t.prototype.Fa = function(e) {
                                        var t = this.indexOf(e);
                                        return t >= 0 && (this.sk.splice(t, 1),
                                            !0)
                                    }
                                    ,
                                    t.prototype.pk = function(e) {
                                        this.sk.splice(e, 1)
                                    }
                                    ,
                                    t.prototype.tk = function() {
                                        var e = [], t = this.sk.length, i, o, n;
                                        if (t) {
                                            for (i = [],
                                                     o = 0; o < t; o++)
                                                i[this.sk[o].cellIndex()] = 1;
                                            for (t = i.length,
                                                     n = 0,
                                                     o = 0; o < t; o++)
                                                i[o] && (e[n++] = o)
                                        }
                                        return e
                                    }
                                    ,
                                    t.prototype.uk = function() {
                                        var e = [], t = this.sk.length, i, o, n;
                                        if (t) {
                                            for (i = [],
                                                     o = 0; o < t; o++)
                                                i[this.sk[o].rowIndex()] = 1;
                                            for (t = i.length,
                                                     n = 0,
                                                     o = 0; o < t; o++)
                                                i[o] && (e[n++] = o)
                                        }
                                        return e
                                    }
                                    ,
                                    t.prototype.vk = function() {
                                        var t = this.sk.length, i = 4294967295, o = 4294967295, n = 0, r = 0, a, s;
                                        if (t) {
                                            for (a = 0; a < t; a++)
                                                s = this.sk[a],
                                                    i = Math.min(i, s.cellIndex()),
                                                    o = Math.min(o, s.rowIndex()),
                                                    n = Math.max(n, s.cellIndex()),
                                                    r = Math.max(r, s.rowIndex());
                                            return new e.grid.cellInfoRange(new e.grid.cellInfo(i,o),new e.grid.cellInfo(n,r))
                                        }
                                        return null
                                    }
                                    ,
                                    t
                            }(),
                            t.cellInfoOrderedCollection = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(t) {
                                this.wk = 10,
                                    this.xk = !1,
                                    this.yk = !1,
                                    this.jh = t,
                                    this.zk = "{0}." + this.jh.widgetName + ".selectionui",
                                    this.gk = new e.grid.cellInfoOrderedCollection(this.jh),
                                    this.Gd = this.jh.Gd(),
                                    this.Ak = this.Gd.focusableElement(),
                                    this.Bk = this.jh.Dd("visibleLeaves").length,
                                    this.Ak.bind(this.Ck("mousedown"), i.proxy(this.Dk, this))
                            }
                            return t.prototype.dispose = function() {
                                this.Ak.unbind(this.Ck("mousedown"), this.Dk),
                                    this.Ek()
                            }
                                ,
                                t.prototype.Dk = function(e) {
                                    if (this.jh.$f() && "none" !== this.jh.options.selectionMode.toLowerCase()) {
                                        var t = this.Gd.getVisibleAreaBounds()
                                            , o = {
                                            x: e.pageX,
                                            y: e.pageY
                                        }
                                            , n = e.target && void 0 !== e.target.tagName ? e.target.tagName.toLowerCase() : void 0
                                            , r = i(e.target);
                                        (!n || r.is("td.gcuigridtd, th.gcuigridtd, div.gcui-gcuigrid-innercell")) && o.x > t.left && o.x < t.left + t.width && o.y > t.top && o.y < t.top + t.height && (this.Fk(),
                                            this.Gk = o,
                                            this.Hk = this.Ik(this.Gk))
                                    }
                                }
                                ,
                                t.prototype.Jk = function(t) {
                                    if (this.Hk && this.Hk.Ld()) {
                                        var o = {
                                            x: t.pageX,
                                            y: t.pageY
                                        }, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y = this.jh.Gd(), x = this.jh.Jd(), w = e.grid.renderState;
                                        if (this.xk || (this.xk = Math.abs(this.Gk.x - o.x) > this.wk || Math.abs(this.Gk.y - o.y) > this.wk),
                                                this.xk) {
                                            if (n = this.Ik(o),
                                                    !n.Ld())
                                                return;
                                            if (this.Kk = n,
                                                    a = new e.grid.cellInfoRange(this.Hk,this.Kk),
                                                    a.Ui(),
                                                    a.Md(this.jh.Nd()),
                                                a.Ld() && !a.isEqual(this.Lk)) {
                                                for (s = this.jh.ng(),
                                                         this.Lk = a,
                                                         l = new e.grid.cellInfoOrderedCollection(this.jh),
                                                         c = a.bottomRight().rowIndex(),
                                                         d = a.bottomRight().cellIndex(),
                                                         p = a.topLeft().rowIndex(); p <= c; p++)
                                                    if (m = y.Od(x.item(p)),
                                                        m.type & e.grid.rowType.data)
                                                        for (u = a.topLeft().cellIndex(); u <= d; u++)
                                                            l.rk(new e.grid.cellInfo(u,p));
                                                for (b = -1,
                                                         h = 0,
                                                         f = this.gk.length(); h < f; h++)
                                                    r = this.gk.item(h),
                                                    l.indexOf(r) < 0 && (this.jh.selection().selectedCells().indexOf(r) < 0 && (u = this.Gd.getCell(r.cellIndex() + s.x, r.rowIndex() + s.y)) && (b !== r.rowIndex() && (m = r.row(),
                                                        b = r.rowIndex()),
                                                        g = i(u),
                                                        v = y.gg(g, w.selected, !1),
                                                        this.jh.cellStyleFormatter.format(g, r.cellIndex(), r.column(), m, v)),
                                                        this.gk.pk(h),
                                                        h--,
                                                        f--);
                                                for (b = -1,
                                                         h = 0,
                                                         f = l.length(); h < f; h++)
                                                    r = l.item(h),
                                                    this.gk.indexOf(r) < 0 && this.jh.selection().selectedCells().indexOf(r) < 0 && this.gk.nk(r) && (u = this.Gd.getCell(r.cellIndex() + s.x, r.rowIndex() + s.y)) && (b !== r.rowIndex() && (m = r.row(),
                                                        b = r.rowIndex()),
                                                        g = i(u),
                                                        v = y.gg(g, w.selected, !0),
                                                        this.jh.cellStyleFormatter.format(g, r.cellIndex(), r.column(), m, v))
                                            }
                                        }
                                    }
                                }
                                ,
                                t.prototype.Mk = function(t) {
                                    if (this.Ek(),
                                        this.xk && (this.xk = !1,
                                        this.Lk && this.Lk.Ld())) {
                                        this.jh.Qd(t, this.Kk, {
                                            changeSelection: !1,
                                            setFocus: !1
                                        }),
                                        t.shiftKey && (this.jh.selection().Sf() || "singleRange" === this.jh.options.selectionMode.toLowerCase()) || this.jh.selection().Tf(this.Hk),
                                            this.jh.selection().beginUpdate(),
                                            this.jh.selection().Ne(this.Lk, t.shiftKey, t.ctrlKey, e.grid.cellRangeExtendMode.none, this.Kk),
                                            this.jh.selection().endUpdate();
                                        var o = this.jh.Gd(), n = this.jh.ng(), r, a, s, l, c, d = -1, p, u, h = e.grid.renderState;
                                        for (r = 0,
                                                 a = this.gk.length(); r < a; r++)
                                            s = this.gk.item(r),
                                            this.jh.selection().selectedCells().indexOf(s) < 0 && null !== (l = o.getCell(s.cellIndex() + n.x, s.rowIndex() + n.y)) && (d !== s.rowIndex() && (p = s.row(),
                                                d = s.rowIndex()),
                                                c = i(l),
                                                u = o.gg(c, h.selected, !1),
                                                this.jh.cellStyleFormatter.format(c, s.cellIndex(), s.column(), p, u));
                                        return this.gk.kk(),
                                            this.Hk = this.Kk = this.Lk = null,
                                            !1
                                    }
                                }
                                ,
                                t.prototype.Fk = function() {
                                    if (!this.yk)
                                        try {
                                            this.Gd.toggleDOMSelection(!1),
                                                i(document).bind(this.Ck("mousemove"), i.proxy(this.Jk, this)).bind(this.Ck("mouseup"), i.proxy(this.Mk, this))
                                        } finally {
                                            this.yk = !0
                                        }
                                }
                                ,
                                t.prototype.Ek = function() {
                                    if (this.yk)
                                        try {
                                            this.Gd.toggleDOMSelection(!0),
                                                i(document).unbind(this.Ck("mousemove"), this.Jk).unbind(this.Ck("mouseup"), this.Mk)
                                        } finally {
                                            this.yk = !1
                                        }
                                }
                                ,
                                t.prototype.Ck = function(t) {
                                    return e.grid.stringFormat(this.zk, t)
                                }
                                ,
                                t.prototype.Ik = function(t) {
                                    for (var i = 0, o = this.Bk - 1, n = 0, r = -1, a, s = new e.grid.rowAccessor(this.Gd,2,0,0), l, c, d, p; i <= o && (n = (o - i >> 1) + i,
                                        a = e.grid.bounds(this.Gd.getHeaderCell(n)),
                                    a || (c = s.item(0),
                                        a = e.grid.bounds(e.grid.rowAccessor.getCell(c, n))),
                                        a); )
                                        if (t.x < a.left)
                                            o = n - 1;
                                        else {
                                            if (!(t.x > a.left + a.width)) {
                                                r = n;
                                                break
                                            }
                                            i = n + 1
                                        }
                                    if (-1 === r)
                                        return e.grid.cellInfo.outsideValue;
                                    for (s = new e.grid.rowAccessor(this.Gd,0,0,0),
                                             l = -1,
                                             i = 0,
                                             o = s.length() - 1,
                                             n = 0; i <= o; )
                                        if (n = (o - i >> 1) + i,
                                                c = s.item(n),
                                                a = e.grid.bounds(e.grid.rowAccessor.getCell(c, 0)),
                                            t.y < a.top)
                                            o = n - 1;
                                        else {
                                            if (!(t.y > a.top + a.height)) {
                                                l = n;
                                                break
                                            }
                                            i = n + 1
                                        }
                                    return -1 === l ? e.grid.cellInfo.outsideValue : (d = this.jh.ng(),
                                        p = new e.grid.cellInfo(r - d.x,l - d.y),
                                        p.Md(this.jh.Nd()),
                                        p)
                                }
                                ,
                                t
                        }();
                        t.uiSelection = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        "use strict";
                        var t = jQuery
                            , i = function() {
                            function e(e, t, i, o) {
                                this.Gd = e,
                                    this.Nk = t,
                                    this.Ok = o,
                                    this.Pk = i
                            }
                            return e.prototype.item = function(e) {
                                var t = this.length();
                                return e < t ? this.Gd.getJoinedRows(e + this.Pk, this.Nk) : null
                            }
                                ,
                                e.prototype.length = function() {
                                    var e = this.Gd.getJoinedTables(!0, 0), t = 0, i;
                                    return (i = e[0]) && (t = i.getSectionLength(this.Nk)),
                                    (i = e[1]) && (t += i.getSectionLength(this.Nk)),
                                        t -= this.Pk + this.Ok,
                                    t < 0 && (t = 0),
                                        t
                                }
                                ,
                                e.iterateCells = function e(t, i, o) {
                                    if (t && i) {
                                        var n = 0, r, a, s, l, c, d;
                                        for (r = 0,
                                                 a = t.length; r < a; r++)
                                            if (s = t[r])
                                                for (l = 0,
                                                         c = s.cells.length; l < c; l++)
                                                    if (!0 !== (d = i(s.cells[l], n++, o)))
                                                        return
                                    }
                                }
                                ,
                                e.getCell = function e(t, i) {
                                    var o, n;
                                    if (t && (o = t[0])) {
                                        if (n = o.cells.length,
                                            i < n)
                                            return o.cells[i];
                                        if (i -= n,
                                            (o = t[1]) && (n = o.cells.length,
                                            i < n))
                                            return o.cells[i]
                                    }
                                    return null
                                }
                                ,
                                e.cellsCount = function e(t) {
                                    var i = 0, o;
                                    return t && (o = t[0]) && (i = o.cells.length,
                                    (o = t[1]) && (i += o.cells.length)),
                                        i
                                }
                                ,
                                e
                        }();
                        e.rowAccessor = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t() {
                                this.Qk = 25
                            }
                            return t.prototype.currentCellEditStart = function(t, o) {
                                var n = !1, r = t.currentCell(), a = t.Gd(), s, l, c, d;
                                return r.Ld() && !r.Yf() && r.column().dataIndex >= 0 && (s = r.row()) && (d = s.type) & e.grid.rowType.data && (l = {
                                    cell: r,
                                    event: o,
                                    handled: !1
                                },
                                (n = t._trigger("beforeCellEdit", null, l)) && (l.handled || (n = this.Rk(t, l))),
                                n && (r.Yf(!0),
                                t.ye() && (c = i(s.$rows[0].cells[0]).children("div.gcui-gcuigrid-innercell"),
                                c.length && (c.empty(),
                                    c.append(i("<div>&nbsp;</div>").addClass(t.options.uiCSS.icon + " ui-icon-pencil")))))),
                                    n
                            }
                                ,
                                t.prototype.currentCellEditEnd = function(t, o) {
                                    var n, r, a, s, l, c, d, p, u, h, f, g = t.currentCell(), m = g.column(), b = !1, v = t.Gd(), y = e.getKeyCodeEnum();
                                    if (g.Ld() && g.Yf()) {
                                        if (n = g.row()) {
                                            if (!((r = n.type) & e.grid.rowType.data))
                                                return b;
                                            if (a = o && o.which === y.ESCAPE,
                                                o && a)
                                                b = !0;
                                            else if (p = {
                                                    cell: g,
                                                    value: void 0
                                                },
                                                    b = t._trigger("beforeCellUpdate", null, p)) {
                                                void 0 === p.value && (p.value = this.Sk(t, g)),
                                                    s = p.value,
                                                    l = g.value();
                                                try {
                                                    d = this.Tk(g),
                                                        e.grid.HTML5InputSupport.isExtendSupportRequired(d) ? (p.value = e.grid.HTML5InputSupport.parse(p.value, d),
                                                            p.value = e.grid.HTML5InputSupport.extend(l, p.value, d)) : p.value = t.parse(g.column(), p.value),
                                                        s = p.value
                                                } catch (e) {
                                                    p.value = s
                                                }
                                                if ("datetime" === e.grid.getDataType(m) && (s instanceof Date && (s = s.getTime()),
                                                    l instanceof Date && (l = l.getTime())),
                                                    s !== l) {
                                                    try {
                                                        g.value(p.value)
                                                    } catch (e) {
                                                        u = {
                                                            cell: g,
                                                            value: p.value
                                                        },
                                                            b = !1,
                                                            t._trigger("invalidCellValue", null, u)
                                                    }
                                                    b && (h = {
                                                        cell: g
                                                    },
                                                        t._trigger("afterCellUpdate", null, h))
                                                }
                                            }
                                            b && (f = {
                                                cell: g,
                                                event: o,
                                                handled: !1
                                            },
                                                t._trigger("afterCellEdit", null, f),
                                            f.handled || (b = this.Uk(t, f)),
                                            b && g.Yf(!1),
                                            t.ye() && i(n.$rows[0].cells[0]).children("div.gcui-gcuigrid-innercell").html("&nbsp;"),
                                                window.setTimeout(function() {
                                                    t.pd || (g = t.currentCell(),
                                                        (c = g.tableCell()) ? i(c).attr("tabIndex", 0).focus() : i(t.Gd().focusableElement()).focus())
                                                }, this.Qk))
                                        }
                                        return b
                                    }
                                }
                                ,
                                t.prototype.Rk = function(t, o) {
                                    var n, r, a, s, l, c, d, p = o.cell.column(), u = !1, h = e.getKeyCodeEnum(), f = e.grid.HTML5InputSupport.getDefaultInputType(t.kf(), p);
                                    if (p.dataIndex >= 0) {
                                        n = o.cell.value(),
                                            u = !0;
                                        try {
                                            if (a = o.cell.container(),
                                                "boolean" === e.grid.getDataType(p))
                                                d = a.children("span"),
                                                d.length && d.prop("disabled") && (i.data(d[0], "disabledSpan", !0),
                                                    d.prop("disabled", !1)),
                                                    s = a.find(":checkbox"),
                                                    s.prop("disabled", !1),
                                                    s.focus(),
                                                o.event && "keypress" === o.event.type && s.one("keyup", function(e) {
                                                    e.which === h.SPACE && (e.preventDefault(),
                                                        s[0].checked = !n)
                                                });
                                            else {
                                                if (s = i("<input />").attr("type", f).addClass("gridinput gcui-input " + t.options.uiCSS.stateFocus).bind("keydown", t, i.proxy(this.Vk, this)),
                                                        s.bind(i.support.selectstart ? "selectstart" : "mousedown", function(e) {
                                                            e.stopPropagation()
                                                        }),
                                                    o.event && "keypress" === o.event.type && o.event.which)
                                                    s.val(String.fromCharCode(o.event.which));
                                                else
                                                    switch (e.grid.getDataType(p)) {
                                                        case "currency":
                                                        case "number":
                                                            if (null !== n) {
                                                                s.val(n);
                                                                break
                                                            }
                                                        case "datetime":
                                                            if (e.grid.HTML5InputSupport.isExtendSupportRequired(f)) {
                                                                s.val(e.grid.HTML5InputSupport.toStr(n, f));
                                                                break
                                                            }
                                                        default:
                                                            s.val(t.toStr(p, n))
                                                    }
                                                a.empty().append(s),
                                                    l = s.val().length,
                                                "text" === f && new e.grid.domSelection(s[0]).setSelection({
                                                    start: l,
                                                    end: l
                                                }),
                                                    s.focus(),
                                                    setTimeout(function() {
                                                        s.focus()
                                                    }, 2 * this.Qk)
                                            }
                                        } catch (e) {
                                            alert(e.message),
                                                u = !1
                                        }
                                    }
                                    return u
                                }
                                ,
                                t.prototype.Uk = function(t, o) {
                                    var n, r, a, s, l, c, d, p = o.cell.column(), u = !1;
                                    if (p.dataIndex >= 0) {
                                        u = !0,
                                            l = t.Gd();
                                        try {
                                            n = o.cell.container(),
                                                r = t.toStr(p, o.cell.value()),
                                                s = l.Od(t.Jd().item(o.cell.rowIndex())),
                                                "boolean" === e.grid.getDataType(p) ? (c = n.children("span"),
                                                    d = c.length && i.data(c[0], "disabledSpan"),
                                                    a = n.find(":checkbox"),
                                                    "true" === r ? a.attr("checked", "checked") : a.removeAttr("checked"),
                                                d && (c.prop("disabled", !0),
                                                    a.prop("disabled", !0))) : t.cellFormatter.format(n, p, r, s)
                                        } catch (e) {
                                            alert("defaultAfterCellEdit: " + e.message),
                                                u = !1
                                        }
                                    }
                                    return u
                                }
                                ,
                                t.prototype.Vk = function(t) {
                                    var i, o = e.getKeyCodeEnum();
                                    if (t.which === o.ENTER && (i = t.data))
                                        return i._d(t),
                                            !1
                                }
                                ,
                                t.prototype.Sk = function(e, t) {
                                    var i = t.container().find(":input:first")
                                        , o = null;
                                    return i.length && (o = "checkbox" === i.attr("type") ? i[0].checked : i.val()),
                                        o
                                }
                                ,
                                t.prototype.Tk = function(e) {
                                    return e.container().find(":input:first").attr("type")
                                }
                                ,
                                t
                        }();
                        t.cellEditorHelper = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t() {}
                            return t.Wk = document.createElement("div"),
                                t.prototype.format = function(t, o, n, r) {
                                    r.type & e.grid.rowType.footer && (n = o.aggregate && "none" !== o.aggregate ? e.grid.stringFormat(o.footerText || "{0}", o.Ud || "") : o.footerText || o.xe || "");
                                    var a = !0, s = null, l = {
                                        $container: t,
                                        column: o,
                                        formattedValue: n,
                                        row: r,
                                        afterDefaultCallback: null
                                    }, c;
                                    if (i.isFunction(o.cellFormatter) && (a = !o.cellFormatter(l)),
                                            a) {
                                        switch (e.grid.getDataType(o)) {
                                            case "boolean":
                                                s = this.Xk;
                                                break;
                                            default:
                                                s = this.Yk
                                        }
                                        s && (s.call(this, l),
                                        i.isFunction(c = l.afterDefaultCallback) && c(l))
                                    }
                                }
                                ,
                                t.prototype.Yk = function(t) {
                                    var i;
                                    switch (t.row.type) {
                                        case e.grid.rowType.filter:
                                            this.Zk(t);
                                            break;
                                        default:
                                            if (i = t.$container[0],
                                                    i.firstChild)
                                                for (; i.firstChild; )
                                                    i.removeChild(i.firstChild);
                                            for (e.grid.cellFormatterHelper.Wk.innerHTML = t.formattedValue || "&nbsp;"; e.grid.cellFormatterHelper.Wk.firstChild; )
                                                i.appendChild(e.grid.cellFormatterHelper.Wk.firstChild)
                                    }
                                }
                                ,
                                t.prototype.Xk = function(t) {
                                    var i, o, n = "disabled='disabled'", r, a, s = e.grid.rowType, l = e.getKeyCodeEnum();
                                    switch (t.row.type) {
                                        case s.data:
                                        case s.data | s.dataAlt:
                                            i = t.column.owner,
                                                o = i.options.allowEditing && !0 !== t.column.readOnly,
                                            o && (n = ""),
                                                !0 === i.parse(t.column, i.sd.getValue(t.row.data, t.column.dataKey)) ? t.$container.html("<input class='gridinput' type='checkbox' checked='checked' " + n + " />") : t.$container.html("<input class='gridinput' type='checkbox' " + n + " />"),
                                            o && t.$container.children("input").bind("mousedown", function(e) {
                                                r = t.$container.parent()[0],
                                                    a = i.currentCell(),
                                                a.tableCell() !== r && i.Za({
                                                    target: r
                                                }),
                                                a.Yf() || i.beginEdit()
                                            }).bind("keydown", function(e) {
                                                if (e.which === l.ENTER)
                                                    return i._d(e),
                                                        !1
                                            });
                                            break;
                                        default:
                                            this.Yk(t)
                                    }
                                }
                                ,
                                t.prototype.Zk = function(e) {
                                    var t = e.column.owner
                                        , i = t.options.uiCSS;
                                    e.$container.addClass(i.widget + " " + i.stateDefault),
                                        e.column.dataIndex >= 0 && !e.column.isBand && e.column.showFilter ? e.$container.html('<table cellPadding="0" cellSpacing="0" class="gcui-gcuigrid-filter ' + i.cornerAll + '"><tr><td style="width:100%"><input type="text" class="gcui-gcuigrid-filter-input" style="width:100%" /></td><td class="gcui-gcuigrid-filter-trigger ' + i.cornerRight + " " + i.stateDefault + '"><span class="' + i.icon + " " + i.iconArrowDown + '"></span></td></tr></table>') : e.$container.html("&nbsp;")
                                }
                                ,
                                t
                        }();
                        t.cellFormatterHelper = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(e) {
                                this.MIN_WIDTH = 5,
                                    this.$k = [],
                                    this._k = 10,
                                    this.al = 1,
                                    this.xk = !1,
                                    this.bl = null,
                                    this.cl = null,
                                    this.dl = null,
                                    this.el = null,
                                    this.jh = e,
                                    this.zk = "{0}." + this.jh.widgetName + ".resizer"
                            }
                            return t.prototype.addElement = function(e) {
                                e && e.element && (e.element.bind(this.Ck("mousemove"), i.proxy(this.uf, this)).bind(this.Ck("mousedown"), i.proxy(this.fl, this)).bind(this.Ck("mouseout"), i.proxy(this.vf, this)),
                                    this.$k.push(e))
                            }
                                ,
                                t.prototype.dispose = function() {
                                    var e = this;
                                    i.each(this.$k, function(t, i) {
                                        i.element.unbind(e.Ck("mousemove"), e.uf).unbind(e.Ck("mousedown"), e.fl).unbind(e.Ck("mouseout"), e.vf)
                                    }),
                                        this.gl()
                                }
                                ,
                                t.prototype.inProgress = function() {
                                    return this.xk
                                }
                                ,
                                t.prototype.uf = function(e) {
                                    if (!this.xk) {
                                        var t = this.hl({
                                            x: e.pageX,
                                            y: e.pageY
                                        });
                                        t && t.Eg() && this.jh.$f() ? (t.element.css("cursor", "e-resize"),
                                            this.bl = t,
                                            e.stopPropagation()) : this.vf(e)
                                    }
                                }
                                ,
                                t.prototype.vf = function(e) {
                                    this.xk || this.bl && (this.bl.element.css("cursor", ""),
                                        this.bl = null)
                                }
                                ,
                                t.prototype.fl = function(t) {
                                    if (this.bl = this.hl({
                                            x: t.pageX,
                                            y: t.pageY
                                        }),
                                        this.bl && this.bl.Eg() && this.jh.$f())
                                        try {
                                            this.bl.element.css("cursor", ""),
                                                this.il = document.body.style.cursor,
                                                document.body.style.cursor = "e-resize",
                                                this.cl = this.dl = e.grid.bounds(this.bl.element),
                                                this.el = i('<div class="gcui-gcuigrid-resizehandle ' + this.jh.options.uiCSS.stateHightlight + '">&nbsp;</div>');
                                            var o = this.jh.Gd().getVisibleAreaBounds();
                                            this.el.css({
                                                left: t.pageX,
                                                top: this.cl.top,
                                                height: o.height + o.top - this.cl.top
                                            }),
                                                i(document.body).append(this.el)
                                        } finally {
                                            this.jl(),
                                                this.xk = !0,
                                                t.stopPropagation()
                                        }
                                }
                                ,
                                t.prototype.Jk = function(e) {
                                    var t = this.al * Math.round((e.pageX - this.dl.left) / this.al);
                                    this.dl = {
                                        left: this.dl.left + t,
                                        top: e.pageY,
                                        width: void 0,
                                        height: void 0
                                    },
                                        this.el.css("left", this.dl.left)
                                }
                                ,
                                t.prototype.Mk = function(e) {
                                    try {
                                        document.body.style.cursor = this.il,
                                            this.el.remove(),
                                        this.cl !== this.dl && this.jh.eg(this.bl, this.cl.width, Math.max(this.dl.left - this.cl.left, this.MIN_WIDTH))
                                    } finally {
                                        this.bl = null,
                                            this.el = null,
                                            this.gl(),
                                            this.xk = !1
                                    }
                                }
                                ,
                                t.prototype.kl = function(e) {
                                    e.preventDefault()
                                }
                                ,
                                t.prototype.jl = function() {
                                    this.xk || (i(document).bind(this.Ck("mousemove"), i.proxy(this.Jk, this)).bind(this.Ck("mouseup"), i.proxy(this.Mk, this)),
                                    i.fn.disableSelection && i(document.body).disableSelection(),
                                    "onselectstart"in document && i(document.body).bind("selectstart", this.kl))
                                }
                                ,
                                t.prototype.gl = function() {
                                    this.xk && (i(document).unbind(this.Ck("mousemove"), this.Jk).unbind(this.Ck("mouseup"), this.Mk),
                                    i.fn.enableSelection && i(document.body).enableSelection(),
                                    "onselectstart"in document && i(document.body).unbind("selectstart", this.kl))
                                }
                                ,
                                t.prototype.hl = function(t) {
                                    var i, o, n, r, a;
                                    for (i = 0,
                                             o = this.$k.length; i < o; i++)
                                        if (n = this.$k[i],
                                                r = e.grid.bounds(n.element),
                                                a = e.grid.isOver(t.y, t.x, r.top, r.left + r.width - this._k, r.height, this._k))
                                            return n;
                                    return null
                                }
                                ,
                                t.prototype.Ck = function(t) {
                                    return e.grid.stringFormat(this.zk, t)
                                }
                                ,
                                t
                        }();
                        t.uiResizer = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(t) {
                                this.ll = "scope_" + e.grid.getUID(),
                                    this.ml = !1,
                                    this.jh = t,
                                    this.nl = this.jh.options.uiCSS,
                                    this.ol = '<div class="' + this.nl.widget + " gcui-gcuigrid " + this.nl.content + " " + this.nl.cornerAll + '"><table class="gcui-gcuigrid-root gcui-gcuigrid-table"><tr class="gcui-gcuigrid-headerrow"></tr></table></div>'
                            }
                            return t.prototype.attachGroupArea = function(e) {
                                var t, o = this;
                                i.ui.droppable && i.ui.draggable && e.droppable({
                                    scope: this.ll,
                                    tolerance: "pointer",
                                    greedy: !0,
                                    accept: function(e) {
                                        return !(!o.jh.options.allowColMoving || !(t = o.pl(e))) && (!(t instanceof i.gcui.c1groupedfield && t.options.groupedIndex === o.jh.Je().length - 1) && (!t.options.isBand && (void 0 === t.options.groupedIndex || t instanceof i.gcui.c1groupedfield)))
                                    },
                                    drop: function(e, i) {
                                        !o.ql(e, i.draggable) && (t = o.pl(i.draggable)) && (o.ml = !0)
                                    },
                                    over: function(t, i) {
                                        var n = o.jh.Dd("groupedWidgets").length;
                                        o.rl = n > 0,
                                            o.sl = n > 0 ? o.jh.Dd("groupedWidgets")[n - 1] : e,
                                            e.data("thisDroppableField", o.sl)
                                    },
                                    out: function(t, i) {
                                        o.sl === e.data("thisDroppableField") && (o.sl = null)
                                    }
                                })
                            }
                                ,
                                t.prototype.attach = function(t) {
                                    var o, n, r = this;
                                    i.ui.droppable && i.ui.draggable && t && (o = t.element) && o.draggable({
                                        helper: function(e) {
                                            return t instanceof i.gcui.c1groupedfield ? o.clone().addClass("gcui-gcuigrid-dnd-helper") : o.clone().wrap(r.ol).width(o.width()).height(o.height()).closest(".gcui-gcuigrid").addClass("gcui-gcuigrid-dnd-helper")
                                        },
                                        appendTo: "body",
                                        scope: r.ll,
                                        drag: function(e, i) {
                                            if (r.tl(),
                                                r.sl && !r.ql(e, o)) {
                                                var n = r.sl.element;
                                                n || (n = r.sl),
                                                    r.ul(n, r.vl(t, r.sl, e, i))
                                            }
                                        },
                                        start: function(o, n) {
                                            if (r.jh.$f() && r.jh.options.allowColMoving && !r.jh.Dd("resizer").inProgress()) {
                                                var a = t.options
                                                    , s = t.options.travIdx
                                                    , l = t instanceof i.gcui.c1groupedfield
                                                    , c = l ? "groupArea" : "columns";
                                                if (l && (a = e.grid.search(r.jh.columns(), function(e) {
                                                        return e.options.travIdx === s
                                                    }),
                                                        a = a.found ? a.found.options : e.grid.getColumnByTravIdx(r.jh.options.columns, s).found),
                                                    t.Fg() && r.jh._trigger("columnDragging", null, {
                                                        drag: a,
                                                        dragSource: c
                                                    }))
                                                    return r.jh._trigger("columnDragged", null, {
                                                        drag: a,
                                                        dragSource: c
                                                    }),
                                                        !0
                                            }
                                            return !1
                                        },
                                        stop: function(e, o) {
                                            r.tl();
                                            try {
                                                r.ml && (r.sl.element ? r.jh.Bf(t.options.travIdx, r.sl.options.travIdx, r.vl(t, r.sl, e, o), t instanceof i.gcui.c1groupedfield, r.sl instanceof i.gcui.c1groupedfield) : r.jh.Bf(t.options.travIdx, -1, "left", t instanceof i.gcui.c1groupedfield, !0))
                                            } finally {
                                                r.sl = null,
                                                    r.ml = !1
                                            }
                                        }
                                    }).droppable({
                                        hoverClass: r.nl.stateHover,
                                        scope: r.ll,
                                        tolerance: "pointer",
                                        greedy: !0,
                                        accept: function(e) {
                                            return !(!r.jh.options.allowColMoving || o[0] === e[0] || !(n = r.pl(e))) && n.Gg(t)
                                        },
                                        drop: function(e, t) {
                                            (n = r.pl(t.draggable)) && (r.ml = !0)
                                        },
                                        over: function(e, i) {
                                            r.rl = !1,
                                                r.sl = t,
                                                o.data("thisDroppableField", r.sl)
                                        },
                                        out: function(e, i) {
                                            r.sl === t.element.data("thisDroppableField") && (r.sl = null)
                                        }
                                    })
                                }
                                ,
                                t.prototype.detach = function(e) {
                                    var t;
                                    e && (t = e.element) && (t.data("ui-draggable") && t.draggable("destroy"),
                                    t.data("ui-droppable") && t.droppable("destroy"))
                                }
                                ,
                                t.prototype.dispose = function() {
                                    this.wl && (this.wl.remove(),
                                        this.wl = null),
                                    this.xl && (this.xl.remove(),
                                        this.xl = null)
                                }
                                ,
                                t.prototype.pl = function(t) {
                                    var i = e.grid.widgetName(t);
                                    if (!i)
                                        throw "widgetName is undedined";
                                    return t.data(i)
                                }
                                ,
                                t.prototype.ul = function(e, t) {
                                    this.yl().show().position({
                                        my: "center",
                                        at: t + " top",
                                        of: e,
                                        collision: "none"
                                    }),
                                        this.zl().show().position({
                                            my: "center",
                                            at: t + " bottom",
                                            of: e,
                                            collision: "none"
                                        })
                                }
                                ,
                                t.prototype.tl = function() {
                                    this.yl().hide(),
                                        this.zl().hide()
                                }
                                ,
                                t.prototype.yl = function() {
                                    return this.wl || (this.wl = i("<div />").addClass("gcui-gcuigrid-dnd-arrow-top").append(i("<span />").addClass(this.nl.icon + " ui-icon-arrowthick-1-s")).hide().appendTo(document.body)),
                                        this.wl
                                }
                                ,
                                t.prototype.zl = function() {
                                    return this.xl || (this.xl = i("<div />").addClass("gcui-gcuigrid-dnd-arrow-bottom").append(i("<span />").addClass(this.nl.icon + " ui-icon-arrowthick-1-n")).hide().appendTo(document.body)),
                                        this.xl
                                }
                                ,
                                t.prototype.ql = function(t, i) {
                                    var o = e.grid.bounds(i, !1);
                                    return t.pageX > o.left && t.pageX < o.left + o.width && t.pageY > o.top && t.pageY < o.top + o.height
                                }
                                ,
                                t.prototype.vl = function(t, o, n, r) {
                                    if (!o.element)
                                        return "left";
                                    if (this.rl)
                                        return "right";
                                    var a = e.grid.bounds(o.element, !1), s = a.width / 6, l = a.left + a.width / 2, c = "right", d;
                                    return n.pageX < l && (c = "left"),
                                        o instanceof i.gcui.c1groupedfield ? (t instanceof i.gcui.c1groupedfield && (d = o.options.groupedIndex - t.options.groupedIndex,
                                        1 === Math.abs(d) && (c = d < 0 ? "left" : "right")),
                                            c) : (d = o.options.linearIdx - t.options.linearIdx,
                                            o.options.isBand && t.options.parentIdx !== o.options.travIdx && Math.abs(n.pageX - l) < s ? "center" : (t.options.parentIdx === o.options.parentIdx && 1 === Math.abs(d) && (c = d < 0 ? "left" : "right"),
                                                c))
                                }
                                ,
                                t
                        }();
                        t.uiDragndrop = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(e) {
                                if (!e)
                                    throw "invalid arguments";
                                this.jh = e
                            }
                            return t.prototype.format = function(t, o, n, r, a, s, l) {
                                var c = e.grid.renderState, d = e.grid.rowType, p = r.type, u, h = null;
                                0 === o && this.jh.ye() && (n = null),
                                p !== d.groupHeader && p !== d.groupFooter || (n = null,
                                s && (h = s.groupInfo) && (n = this.jh.Dd("leaves")[h.leafIndex],
                                    delete s.groupInfo)),
                                    u = {
                                        $cell: t,
                                        state: a,
                                        row: r,
                                        column: n,
                                        Al: o,
                                        Bl: h ? h.purpose : void 0
                                    },
                                    a === c.rendering ? this.Cl(u, s, l) : (this.Dl(u, a & c.current),
                                        this.El(u, a & c.selected)),
                                i.isFunction(this.jh.options.cellStyleFormatter) && this.jh.options.cellStyleFormatter(u)
                            }
                                ,
                                t.prototype.Cl = function(t, i, o) {
                                    var n = e.grid.rowType, r, a, s = t.column, l = t.row.type;
                                    switch (l) {
                                        case n.header:
                                            t.$cell.addClass("gcuigridth");
                                            break;
                                        default:
                                            t.$cell.addClass("gcuigridtd")
                                    }
                                    if (l & n.data && s && s.textAlignment)
                                        switch (s.textAlignment.toLowerCase()) {
                                            case "left":
                                                t.$cell.addClass("gcui-align-left");
                                                break;
                                            case "right":
                                                t.$cell.addClass("gcui-align-right");
                                                break;
                                            case "center":
                                                t.$cell.addClass("gcui-align-center")
                                        }
                                    if (i)
                                        for (r in i)
                                            if (i.hasOwnProperty(r)) {
                                                if (a = i[r],
                                                        !("colSpan" !== r && "rowSpan" !== r || a > 1))
                                                    continue;
                                                "class" === r ? t.$cell.addClass(a) : t.$cell.attr(r, a)
                                            }
                                    if (o)
                                        for (r in o)
                                            if (o.hasOwnProperty(r)) {
                                                if ("paddingLeft" === r) {
                                                    t.$cell.children(".gcui-gcuigrid-innercell").css(r, o[r]);
                                                    continue
                                                }
                                                t.$cell.css(r, o[r])
                                            }
                                    if (0 === t.Al && this.jh.ye())
                                        t.$cell.attr({
                                            role: "rowheader",
                                            scope: "row"
                                        }).addClass(this.jh.options.uiCSS.stateDefault + " " + this.jh.options.uiCSS.content + " gcui-gcuigrid-rowheader");
                                    else
                                        switch (l) {
                                            case n.header:
                                                t.$cell.attr({
                                                    role: "columnheader",
                                                    scope: "col"
                                                });
                                                break;
                                            case n.footer:
                                                t.$cell.attr({
                                                    role: "columnfooter",
                                                    scope: "col"
                                                });
                                                break;
                                            default:
                                                t.$cell.attr("role", "gridcell")
                                        }
                                    l & n.data && t.Al >= 0 && s && (t.$cell.attr("headers", window.escape(s.headerText)),
                                    s.readOnly && t.$cell.attr("aria-readonly", !0),
                                    s.dataIndex >= 0 && t.$cell.addClass("gcui-data-type-" + e.grid.getDataType(s))),
                                    l !== n.groupHeader && l !== n.groupFooter || s && t.Bl === e.grid.groupRowCellPurpose.aggregateCell && t.$cell.addClass("gcui-data-type-" + e.grid.getDataType(s))
                                }
                                ,
                                t.prototype.Dl = function(t, i) {
                                    var o = e.grid.rowType;
                                    i ? (t.$cell.addClass(this.jh.options.uiCSS.stateActive),
                                        t.row.type === o.header ? t.$cell.addClass("gcui-gcuigrid-current-headercell") : t.$cell.addClass("gcui-gcuigrid-current-cell")) : (t.$cell.removeClass(this.jh.options.uiCSS.stateActive),
                                        t.row.type === o.header ? t.$cell.removeClass("gcui-gcuigrid-current-headercell") : t.$cell.removeClass("gcui-gcuigrid-current-cell"))
                                }
                                ,
                                t.prototype.Fl = function(e, t) {}
                                ,
                                t.prototype.El = function(e, t) {
                                    t ? e.$cell.addClass(this.jh.options.uiCSS.stateHightlight).attr("aria-selected", "true") : e.$cell.removeClass(this.jh.options.uiCSS.stateHightlight).removeAttr("aria-selected")
                                }
                                ,
                                t
                        }();
                        t.cellStyleFormatterHelper = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(e) {
                                if (!e)
                                    throw "invalid arguments";
                                this.jh = e
                            }
                            return t.prototype.format = function(t, o, n) {
                                var r = e.grid.renderState
                                    , a = e.grid.rowType
                                    , s = t.state
                                    , l = t;
                                s === r.rendering ? this.Cl(l, o, n) : (this.Dl(l, 0 != (s & r.current)),
                                    this.Fl(l, 0 != (s & r.hovered)),
                                    this.El(l, 0 != (s & r.selected))),
                                i.isFunction(this.jh.options.rowStyleFormatter) && this.jh.options.rowStyleFormatter(l)
                            }
                                ,
                                t.prototype.Cl = function(t, o, n) {
                                    var r = "gcui-gcuigrid-row " + this.jh.options.uiCSS.content, a = "gcui-gcuigrid-row " + this.jh.options.uiCSS.content, s = e.grid.rowType, l;
                                    if (t.$rows.attr("role", "row"),
                                            o)
                                        for (l in o)
                                            o.hasOwnProperty(l) && ("class" === l ? t.$rows.addClass(o[l]) : (t.$rows.attr(l, o[l]),
                                            t.$rows[0].style.height && t.$rows.each(function() {
                                                return i.data(this, "customHeight", this.style.height),
                                                    !0
                                            })));
                                    if (n)
                                        for (l in n)
                                            n.hasOwnProperty(l) && t.$rows.css(l, n[l]);
                                    switch (t.type & ~s.dataAlt) {
                                        case s.header:
                                            r = "gcui-gcuigrid-headerrow";
                                            break;
                                        case s.data:
                                            r = a + " gcui-gcuigrid-datarow",
                                            t.type & s.dataAlt && (r += " gcui-gcuigrid-alternatingrow");
                                            break;
                                        case s.emptyDataRow:
                                            r = a + " gcui-gcuigrid-emptydatarow";
                                            break;
                                        case s.filter:
                                            r = "gcui-gcuigrid-filterrow";
                                            break;
                                        case s.groupHeader:
                                            r = a + " gcui-gcuigrid-groupheaderrow";
                                            break;
                                        case s.groupFooter:
                                            r = a + " gcui-gcuigrid-groupfooterrow";
                                            break;
                                        case s.footer:
                                            r = "gcui-gcuigrid-footerrow " + this.jh.options.uiCSS.stateHightlight;
                                            break;
                                        default:
                                            throw e.grid.stringFormat("unknown rowType: {0}", t.type)
                                    }
                                    t.$rows.addClass(r)
                                }
                                ,
                                t.prototype.Dl = function(e, t) {
                                    this.jh.ye() && (t ? i(e.$rows[0].cells[0]).addClass(this.jh.options.uiCSS.stateActive + " gcui-gcuigrid-current-rowheadercell") : i(e.$rows[0].cells[0]).removeClass(this.jh.options.uiCSS.stateActive + " gcui-gcuigrid-current-rowheadercell"))
                                }
                                ,
                                t.prototype.Fl = function(e, t) {
                                    t ? e.$rows.addClass(this.jh.options.uiCSS.stateHover) : e.$rows.removeClass(this.jh.options.uiCSS.stateHover)
                                }
                                ,
                                t.prototype.El = function(e, t) {}
                                ,
                                t
                        }();
                        t.rowStyleFormatterHelper = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        "use strict";
                        var t = jQuery
                            , i = function() {
                            function e() {
                                this.ai = 0,
                                    this.Gl = 0,
                                    this.Hl = 0,
                                    this.Il = 0,
                                    this.Jl = 0,
                                    this.Kl = 0,
                                    this.Ll = 0,
                                    this.Ml = 0,
                                    this.Nl = 0
                            }
                            return e.prototype.add = function(e) {
                                if (null !== e && "" !== e) {
                                    var t, i = e instanceof Date ? "datetime" : typeof e;
                                    t = "" + e,
                                    0 == this.Il++ && (this.Ol = this.Pl = t),
                                    t < this.Ol && (this.Ol = t),
                                    t > this.Pl && (this.Pl = t),
                                        "number" === i ? (0 == this.Hl++ && (this.Ll = this.Kl = e),
                                            this.ai += e,
                                            this.Gl += e * e,
                                        e < this.Ll && (this.Ll = e),
                                        e > this.Kl && (this.Kl = e)) : "datetime" === i && (t = e.getTime(),
                                        0 == this.Jl++ && (this.Ml = this.Nl = t),
                                        t < this.Ml && (this.Ml = t),
                                        t > this.Nl && (this.Nl = t))
                                }
                            }
                                ,
                                e.prototype.getValueString = function(e) {
                                    var t, i = e.owner;
                                    if (this.Hl && ("number" === e.dataType || "currency" === e.dataType))
                                        return t = this.Ql(e.aggregate),
                                            i.toStr(e, t);
                                    if (this.Jl && "datetime" === e.dataType)
                                        switch (e.aggregate) {
                                            case "max":
                                                return i.toStr(e, new Date(this.Nl));
                                            case "min":
                                                return i.toStr(e, new Date(this.Ml));
                                            case "count":
                                                return this.Il + ""
                                        }
                                    if (this.Il)
                                        switch (e.aggregate) {
                                            case "max":
                                                return this.Pl;
                                            case "min":
                                                return this.Ol;
                                            case "count":
                                                return this.Il + ""
                                        }
                                    return ""
                                }
                                ,
                                e.prototype.Ql = function(e) {
                                    switch (e) {
                                        case "average":
                                            return 0 === this.Hl ? 0 : this.ai / this.Hl;
                                        case "count":
                                            return this.Il;
                                        case "max":
                                            return this.Kl;
                                        case "min":
                                            return this.Ll;
                                        case "sum":
                                            return this.ai;
                                        case "std":
                                            return this.Hl <= 1 ? 0 : Math.sqrt(this.Ql("var"));
                                        case "stdPop":
                                            return this.Hl <= 1 ? 0 : Math.sqrt(this.Ql("varPop"));
                                        case "var":
                                            return this.Hl <= 1 ? 0 : this.Ql("varPop") * this.Hl / (this.Hl - 1);
                                        case "vapPop":
                                            if (this.Hl <= 1)
                                                return 0;
                                            var t = this.ai / this.Hl;
                                            return this.Gl / this.Hl - t * t
                                    }
                                    return 0
                                }
                                ,
                                e
                        }();
                        e.tally = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t(t) {
                                this.Rl = "gcuigridfrozener" + e.grid.getUID(),
                                    this.Sl = !1,
                                    this.Tl = -1,
                                    this.Pj = -1,
                                    this.Oj = -1,
                                    this.Ul = 0,
                                    this.Vl = 0,
                                    this.xk = !1,
                                    this.jh = t,
                                    this.refresh()
                            }
                            return t.prototype.inProgress = function() {
                                return this.xk
                            }
                                ,
                                t.prototype.refresh = function() {
                                    this.dispose(),
                                        this.Wl = this.jh.outerDiv.find(".gcui-gcuigrid-fixedview"),
                                        this.Xl = this.jh.Gd().Xj(),
                                        this.Ul = this.jh.ug(!1),
                                        this.Vl = this.jh.ug(!0),
                                        this.Pj = this.jh.sg(!1),
                                        this.Oj = this.jh.sg(!0),
                                        this.Yl = this.jh.Gd().getVisibleAreaBounds();
                                    var t = e.grid.bounds(this.Wl.find(".gcui-gcuigrid-split-area-nw"))
                                        , i = e.grid.bounds(this.Wl);
                                    ("right" !== this.jh.options.staticColumnsAlignment || this.Pj >= 0) && this.Zl(this.Yl, t, i),
                                    this.jh.Fd() || this.$l(this.Yl, t, i)
                                }
                                ,
                                t.prototype.dispose = function() {
                                    this._l && (this._l.remove(),
                                        this._l = null),
                                    this.am && (this.am.remove(),
                                        this.am = null),
                                    this.bm && (this.bm.remove(),
                                        this.bm = null),
                                        this.Wl = null,
                                        this.Xl = null,
                                        this.gl()
                                }
                                ,
                                t.prototype.Zl = function(e, t, o) {
                                    var n = "right" !== this.jh.options.staticColumnsAlignment
                                        , r = n ? t.width + t.left : t.left - 2
                                        , a = this;
                                    r <= e.left + e.width && (this.am = i("<div><div></div></div>").addClass("gcui-grid-freezing-handle-v").addClass(n ? "" : "not-allowed").css({
                                        left: r - o.left,
                                        top: t.top - o.top,
                                        height: e.height + e.top - t.top
                                    }).bind("mousedown", function(e) {
                                        e.data = !0,
                                            a.cm.apply(a, arguments)
                                    }).appendTo(this.Wl),
                                        this.am.find("div").addClass(this.jh.options.uiCSS.header).css({
                                            width: 0,
                                            height: "100%"
                                        }))
                                }
                                ,
                                t.prototype.$l = function(e, t, o) {
                                    var n = t.top + t.height
                                        , r = "right" !== this.jh.options.staticColumnsAlignment
                                        , a = this;
                                    n <= e.top + e.height && (this._l = i("<div><div></div></div>").addClass("gcui-grid-freezing-handle-h").css({
                                        left: r ? t.left - o.left : 0,
                                        top: n - o.top,
                                        width: r ? e.width + e.left - t.left : e.width
                                    }).bind("mousedown", function(e) {
                                        e.data = !1,
                                            a.cm.apply(a, arguments)
                                    }).appendTo(this.Wl),
                                        this._l.find("div").addClass(this.jh.options.uiCSS.header).css({
                                            width: "100%",
                                            height: 0
                                        }))
                                }
                                ,
                                t.prototype.cm = function(e) {
                                    if (this.jh.options.disabled || "right" === this.jh.options.staticColumnsAlignment && e.data)
                                        return !1;
                                    this.Yl = this.jh.Gd().getVisibleAreaBounds(),
                                        this.Tl = e.data ? this.Pj : this.Oj,
                                        this.bm = i('<div class="gcui-gcuigrid-resizehandle ' + this.jh.options.uiCSS.header + '"></div>').appendTo(document.body),
                                        this.jl(e.data),
                                        this.xk = !0,
                                        e.stopPropagation()
                                }
                                ,
                                t.prototype.Jk = function(e) {
                                    e.data && this.Xl.options.hScroller.scrollValue ? this.Xl.hScrollTo(0) : !e.data && this.Xl.options.vScroller.scrollValue && this.Xl.vScrollTo(0),
                                        this.dm(e)
                                }
                                ,
                                t.prototype.Mk = function(e) {
                                    try {
                                        this.bm && this.bm.remove(),
                                            this.gl(),
                                            e.data ? this.Tl !== this.Pj && this.jh.option("staticColumnIndex", this.Tl) : this.Tl !== this.Oj && this.jh.option("staticRowIndex", this.Tl)
                                    } finally {
                                        this.bm = null,
                                            this.xk = !1
                                    }
                                }
                                ,
                                t.prototype.jl = function(e) {
                                    if (!this.Sl)
                                        try {
                                            i.fn.disableSelection && i(document.body).disableSelection(),
                                                this.jh.Gd().toggleDOMSelection(!1),
                                                i(document).bind(this.em("mousemove"), e, i.proxy(this.Jk, this)).bind(this.em("mouseup"), e, i.proxy(this.Mk, this))
                                        } finally {
                                            this.Sl = !0
                                        }
                                }
                                ,
                                t.prototype.gl = function() {
                                    if (this.Sl)
                                        try {
                                            i.fn.enableSelection && i(document.body).enableSelection(),
                                                this.jh.Gd().toggleDOMSelection(!0),
                                                i(document).unbind("." + this.Rl)
                                        } finally {
                                            this.Sl = !1
                                        }
                                }
                                ,
                                t.prototype.em = function(t) {
                                    return e.grid.stringFormat("{0}.{1}", t, this.Rl)
                                }
                                ,
                                t.prototype.dm = function(t) {
                                    var i, o, n, r, a, s, l, c, d = "right" !== this.jh.options.staticColumnsAlignment;
                                    if (t.data) {
                                        if (c = e.grid.bounds(this.am),
                                            Math.abs(t.pageX - (c.left + c.width / 2)) < c.width)
                                            return void this.bm.hide();
                                        if (i = this.hl({
                                                x: t.pageX,
                                                y: t.pageY
                                            })) {
                                            if (o = e.grid.bounds(i.element),
                                                    n = o.left + o.width / 2,
                                                    r = i.options.visLeavesIdx - this.Vl,
                                                    a = Math.max(r - 1, -1),
                                                    s = t.pageX < n ? a !== this.Pj : r === this.Pj,
                                                    l = s ? o.left : o.left + o.width,
                                                    !e.grid.isOverAxis(l, this.Yl.left - 1, this.Yl.width + 2))
                                                return;
                                            this.Tl = s ? a : r,
                                                this.bm.show().css({
                                                    left: l,
                                                    top: o.top,
                                                    width: 3,
                                                    height: this.Yl.height + this.Yl.top - o.top
                                                })
                                        }
                                    } else {
                                        if (c = e.grid.bounds(this._l),
                                            Math.abs(t.pageY - (c.top + c.height / 2)) < c.height)
                                            return void this.bm.hide();
                                        if (i = this.fm({
                                                x: t.pageX,
                                                y: t.pageY
                                            })) {
                                            if (o = e.grid.bounds(i),
                                                    n = o.top + o.height / 2,
                                                    r = this.jh.Gd().getAbsoluteRowIndex(i) - this.Ul,
                                                    a = Math.max(r - 1, -1),
                                                    s = t.pageY < n ? a !== this.Oj : r === this.Oj,
                                                    l = s ? o.top : o.top + o.height,
                                                    !e.grid.isOverAxis(l, this.Yl.top - 1, this.Yl.height + 2))
                                                return;
                                            this.Tl = s ? a : r,
                                                this.bm.show().css({
                                                    left: d ? o.left : this.Yl.left,
                                                    top: l,
                                                    width: d ? this.Yl.width + this.Yl.left - o.left : this.Yl.width,
                                                    height: 3
                                                })
                                        }
                                    }
                                }
                                ,
                                t.prototype.hl = function(t) {
                                    var i = this.jh.columns(), o, n, r, a, s;
                                    for (o = 0,
                                             n = i.length; o < n; o++)
                                        if (r = i[o],
                                                a = r.options,
                                            a.isLeaf && (s = e.grid.bounds(r.element),
                                                e.grid.isOverAxis(t.x, s.left, s.width)))
                                            return r;
                                    return null
                                }
                                ,
                                t.prototype.fm = function(t) {
                                    var o = this.jh.Jd(), n, r, a, s;
                                    for (n = 0,
                                             r = o.length(); n < r; n++)
                                        if (a = o.item(n)[0],
                                                s = e.grid.bounds(i(a)),
                                                e.grid.isOverAxis(t.y, s.top, s.height))
                                            return a;
                                    return null
                                }
                                ,
                                t
                        }();
                        t.uiFrozener = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i = jQuery
                            , o = function() {
                            function t() {}
                            return t.generate = function i(o, n, r) {
                                switch (o) {
                                    case "append":
                                        t.gm(n, r);
                                        break;
                                    case "merge":
                                        t.hm(n, r);
                                        break;
                                    case "none":
                                        break;
                                    default:
                                        throw e.grid.stringFormat('Unsupported value: "{0}"', o)
                                }
                            }
                                ,
                                t.gm = function o(n, r) {
                                    var a = {};
                                    e.grid.traverse(r, function(t) {
                                        t.dynamic && e.grid.validDataKey(t.dataKey) && (a[t.dataKey] = !0)
                                    }),
                                        i.each(n, function(e, i) {
                                            if ("name"in i && !a[i.name]) {
                                                var o = t.im(i);
                                                r.push(o)
                                            }
                                        })
                                }
                                ,
                                t.hm = function o(n, r) {
                                    var a = [], s;
                                    e.grid.traverse(r, function(t) {
                                        if (t.isLeaf && !t.isBand) {
                                            var i = t.dataKey;
                                            e.grid.validDataKey(i) ? void 0 !== n[i] && delete n[i] : null !== i && a.push(t)
                                        }
                                    }),
                                    a.length && (s = 0,
                                        i.each(n, function(e, t) {
                                            var i = a[s++];
                                            i && (i.dataKey = t.name,
                                                delete n[e])
                                        })),
                                        i.each(n, function(e, i) {
                                            var o = t.im(i);
                                            r.push(o)
                                        })
                                }
                                ,
                                t.im = function t(i) {
                                    return e.grid.createDynamicField({
                                        dataKey: i.name
                                    })
                                }
                                ,
                                t
                        }();
                        t.columnsGenerator = o
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        "use strict";
                        var t = jQuery
                            , i = function() {
                            function e(e, t, i) {
                                this.jm = 0,
                                    this.Qk = 50,
                                    this.km = !1,
                                    this.jh = e,
                                    this.lm = i,
                                    this.Gd = this.jh.Gd(),
                                    this.mm = this.jh.Ve();
                                var o = 20
                                    , n = this.jh.outerDiv.height() + this.mm * o;
                                t.height(n - i - (this.mm > 0 ? o : 0)),
                                    this.Gd.Mj.sw.height(n)
                            }
                            return e.prototype.scrollTo = function(e, t) {
                                this.nm = t,
                                    this.om.vScrollTo(e * this.om.options.vScroller.scrollSmallChange, !0)
                            }
                                ,
                                e.prototype.attach = function(e) {
                                    this.pm = e,
                                        this.om = e.data("gcui-superpanel");
                                    var i, o = e.find(".gcui-superpanel-contentwrapper:first"), n = this.om.getContentElement().height(), r = this.lm + n, a = o.innerHeight(), s = 101 / (this.mm - 1) * ((r - a) / r);
                                    i = this.om.options.vScroller,
                                        i.scrollSmallChange = s,
                                        this.om.option("vScroller", i),
                                        e.bind("superpanelscrolled.gcuigrid", t.proxy(this.qm, this)),
                                        e.bind("superpanelscrolling.gcuigrid", t.proxy(this.rm, this)),
                                        e.bind("superpanelscrolled.gcuigrid", t.proxy(this.tm, this))
                                }
                                ,
                                e.prototype.dispose = function() {
                                    this.pm.unbind(".gcuigrid"),
                                        this.um()
                                }
                                ,
                                e.prototype.um = function() {
                                    window.clearTimeout(this.jm),
                                        this.jm = 0
                                }
                                ,
                                e.prototype.rm = function(e, t) {
                                    if (!this.km && "v" === t.dir)
                                        return -1 !== this.jm && void 0
                                }
                                ,
                                e.prototype.qm = function(e, i) {
                                    var o, n, r = this;
                                    this.km || "v" !== i.dir || (this.jm > 0 && this.um(),
                                    -1 !== this.jm && (r.jm = -1,
                                        o = Math.round(i.newValue / r.om.options.vScroller.scrollSmallChange),
                                        n = r.Gd.Xi.start,
                                    o < 0 && (o = 0),
                                    o >= r.mm && (o = r.mm - 1),
                                        o !== n ? r.jh.Of(o, t.proxy(r.vm, r)) : (r.wm(),
                                            r.um())))
                                }
                                ,
                                e.prototype.vm = function(e) {
                                    this.jh.zg(e),
                                        this.wm(),
                                    this.nm && (this.nm(),
                                        this.nm = null),
                                        this.um()
                                }
                                ,
                                e.prototype.tm = function() {
                                    t.isFunction(this.xm) && this.xm.apply(this, arguments)
                                }
                                ,
                                e.prototype.wm = function() {}
                                ,
                                e
                        }();
                        e.uiVirtualScroller = i
                    }(e.grid || (e.grid = {}));
                    var t = e.grid
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        var t = jQuery
                            , i = Globalize;
                        function o(i, o, n, r) {
                            var a = i;
                            r = t.extend({
                                nullString: "",
                                format: ""
                            }, r);
                            function s(t) {
                                return r.parser = r.parser || e.defaultParsers[t],
                                r.parser || null == i || e.errors.noParser(t),
                                    r.parser
                            }
                            if (o = o || null != i && typeof i,
                                    !(n = n || o))
                                return i;
                            if ("string" == n)
                                return s(o),
                                    r.parser ? r.parser.toStr(i, r.culture, r.format, r.nullString, !0) : i;
                            if (s(n),
                                    !r.parser)
                                return i;
                            if (i = r.parser.parse(i, r.culture, r.format, r.nullString, !0),
                                isNaN(i) && null != i && e.util.isNumeric(i)) {
                                if (r.ignoreError)
                                    return a;
                                e.errors.cantConvert(n, a)
                            }
                            return i
                        }
                        e.convert = o,
                            e.defaultParsers = {
                                string: {
                                    parse: function(e, t, i, o, n) {
                                        switch (e) {
                                            case null:
                                                return null;
                                            case o:
                                                if (n)
                                                    return null;
                                            case void 0:
                                            case "&nbsp":
                                                return "";
                                            default:
                                                return "" + e
                                        }
                                    },
                                    toStr: function(e, t, i, o, n) {
                                        return null === e && n ? o : "" + e
                                    }
                                },
                                number: {
                                    parse: function(e, t, o, n, r) {
                                        var a = typeof e;
                                        return "number" === a ? isNaN(e) ? NaN : e : !e && 0 !== e || "&nbsp;" === e || e === n && r ? null : i.parseFloat(e, 10, t.name)
                                    },
                                    toStr: function(e, t, o, n, r) {
                                        return null === e && r ? n : i.format(e, o || "n", t.name)
                                    }
                                },
                                currency: {
                                    parse: function(e, t, o, n, r) {
                                        var a = typeof e;
                                        return "number" === a ? isNaN(e) ? NaN : e : !e && 0 !== e || "&nbsp;" === e || e === n && r ? null : ("string" === a && (e = e.replace(t.numberFormat.currency.symbol, "")),
                                            i.parseFloat(e, 10, t.name))
                                    },
                                    toStr: function(e, t, o, n, r) {
                                        return null === e && r ? n : i.format(e, o || "c", t.name)
                                    }
                                },
                                datetime: {
                                    parse: function(e, t, o, n, r) {
                                        var a, s;
                                        return e instanceof Date ? e : !e || "&nbsp;" === e || e === n && r ? null : (a = /^\/Date\((\d+)\)\/$/.exec(e)) ? new Date(parseInt(a[1], 10)) : (s = i.parseDate(e, o, t.name),
                                        (null == s || isNaN(s)) && (s = Date.parse(e),
                                            s = isNaN(s) ? NaN : new Date(s)),
                                            s)
                                    },
                                    toStr: function(e, t, o, n, r) {
                                        return null === e && r ? n : i.format(e, o || "d", t.name)
                                    }
                                },
                                boolean: {
                                    parse: function(e, i, o, n, r) {
                                        var a = typeof e;
                                        if ("number" === a)
                                            return 0 != e;
                                        if ("boolean" === a)
                                            return e;
                                        if ("string" === a && (e = t.trim(e)),
                                            !e || "&nbsp;" === e || e === n && r)
                                            return null;
                                        switch (e.toLowerCase()) {
                                            case "true":
                                                return !0;
                                            case "false":
                                                return !1
                                        }
                                        return NaN
                                    },
                                    toStr: function(e, t, i, o, n) {
                                        return null === e && n ? o : e ? "true" : "false"
                                    }
                                }
                            };
                        function n(t) {
                            return function() {
                                return i || e.util.logError(e.errors.noGlobalize.create().message),
                                    t.apply(this, arguments)
                            }
                        }
                        t.each(e.defaultParsers, function(e, t) {
                            t.parse = t.parse && n(t.parse),
                                t.toStr = t.toStr && n(t.toStr)
                        })
                    }(e.data || (e.data = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(e) {
                        !function(t) {
                            !function(i) {
                                i.Connective = {
                                    AND: "and",
                                    OR: "or"
                                };
                                function o(o) {
                                    function n(o) {
                                        var r, a = [];
                                        return 0 === o.length ? a : (r = i.Connective.AND,
                                            e.util.each(o, function(o, s) {
                                                var l, c;
                                                if (0 == o && e.util.isString(s) && ((l = s.toLowerCase()) == i.Connective.AND || l == i.Connective.OR))
                                                    return void (r = l);
                                                if ($.isArray(s)) {
                                                    if (!(s = n(s)))
                                                        return;
                                                    if (s[0] === r || 2 == s.length)
                                                        return s.shift(),
                                                            void (a = a.concat(s))
                                                } else {
                                                    if (!(c = t.normalizeCondition(s)))
                                                        return;
                                                    c.property = s.property,
                                                        s = c
                                                }
                                                a.push(s)
                                            }),
                                            0 == a.length ? null : (a.unshift(r),
                                                a))
                                    }
                                    return n(o)
                                }
                                function n(t) {
                                    if (!$.isArray(t))
                                        return null;
                                    var n = {
                                        original: t,
                                        normalized: o(t),
                                        func: null
                                    };
                                    return null == n.normalized ? n.func = function(e) {
                                            return !0
                                        }
                                        : n.func = function(t) {
                                            function o(n) {
                                                var r = n[0] === i.Connective.AND
                                                    , a = r ? e.util.every : e.util.some;
                                                return a(n, function(i, n) {
                                                    if (0 === n)
                                                        return r;
                                                    if ($.isArray(i))
                                                        return o(i);
                                                    var a = e.util.getProperty(t, i.property);
                                                    return i.op.apply(a, i.value)
                                                })
                                            }
                                            return o(n.normalized)
                                        }
                                        ,
                                        n
                                }
                                function r(t) {
                                    return n(t) || e.filtering.compile(t)
                                }
                                i.compile = r
                            }(t.extended || (t.extended = {}));
                            var i = t.extended
                        }(e.filtering || (e.filtering = {}))
                    }(e.data || (e.data = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        var i = jQuery
                            , o = e.data
                            , n = o.filtering.extended
                            , r = function() {
                            function e(e) {
                                this.real = e,
                                    this.ym = !1,
                                    this.zm(),
                                    this.Am()
                            }
                            return e.prototype.zm = function() {
                                var e = this;
                                this.filter = o.observable(this.real.filter()),
                                    this.filter.subscribe(function(t) {
                                        e.real.filter() === t || e.ym || e.refresh({
                                            filter: t
                                        })
                                    }),
                                    this.real.filter.subscribe(function(t) {
                                        t !== e.Bm && e.filter(t)
                                    })
                            }
                                ,
                                e.prototype.refresh = function(e, t) {
                                    void 0 === t && (t = !1),
                                        e = i.extend({}, e);
                                    var o = e.filter;
                                    e.filter = this.Cm(e.filter),
                                        this.Bm = e.filter,
                                        this.ym = !0;
                                    try {
                                        i.isFunction(e.filter) && !i.isFunction(o) ? this.filter(o) : this.filter(e.filter)
                                    } finally {
                                        this.ym = !1
                                    }
                                    return this.real.refresh(e, t)
                                }
                                ,
                                e.prototype.Am = function() {
                                    var e = this;
                                    o.util.each(this.real, function(t, o) {
                                        i.isFunction(o) && !e[t] && "_" !== t.charAt(0) && (e[t] = i.isFunction(o.subscribe) ? o : function() {
                                                return o.apply(e.real, arguments)
                                            }
                                        )
                                    })
                                }
                                ,
                                e.create = function t(i) {
                                    return new e(i)
                                }
                                ,
                                e.prototype.Dm = function(e) {
                                    var t = [];
                                    return i.each(e, function(e, r) {
                                        var a, s;
                                        if (i.isArray(r)) {
                                            if ((a = o.util.isString(r[0]) && r[0].toLowerCase()) === n.Connective.AND || a === n.Connective.OR)
                                                return void t.push(r)
                                        } else
                                            r = [r];
                                        s = [],
                                            i.each(r, function(t, i) {
                                                var n = o.filtering.normalizeCondition(i);
                                                n && (n.property = e,
                                                    s.push(n))
                                            }),
                                        s.length > 0 && t.push(s)
                                    }),
                                        t.length > 0 ? t : null
                                }
                                ,
                                e.prototype.Cm = function(e) {
                                    var t, r;
                                    return i.isArray(e) ? n.compile(e).func : i.isPlainObject(e) ? (e = i.extend(!0, {}, e),
                                        t = {},
                                        i.each(e, function(n, r) {
                                            if (i.isArray(r) || (r = [r]),
                                                    t) {
                                                var a = o.util.isString(r[0]) && r[0].toLowerCase();
                                                if (1 == r.length || 2 == r.length && ("and" === a || "or" === a))
                                                    return void (t[n] = r[r.length - 1])
                                            }
                                            e[n] = r,
                                                t = null
                                        }),
                                    t || (r = this.Dm(e),
                                        n.compile(r).func)) : e
                                }
                                ,
                                e.prototype.Xh = function(e, t) {
                                    this.real.sourceArray[e] = t,
                                        this.real.local[e] = t
                                }
                                ,
                                e.prototype.ff = function(e, t, i) {
                                    2 === arguments.length ? (this.real.sourceArray.splice(e, t),
                                        this.real.local.splice(e, t)) : (this.real.sourceArray.splice(e, t, i),
                                        this.real.local.splice(e, t, i))
                                }
                                ,
                                e.prototype.gf = function(e) {
                                    this.real.sourceArray.push(e),
                                        this.real.local.push(e)
                                }
                                ,
                                e
                        }();
                        t.GridDataView = r
                    }(e.grid || (e.grid = {}))
                }(gcui || (gcui = {})),
                function(e) {
                    !function(t) {
                        "use strict";
                        var i, o = jQuery, n = "gcuiribbon", r = "gcui-ribbon", a = r + "-disabled", s = r + "-bigbutton", l = r + "-panel", c = r + "-groups", d = r + "-group", p = d + "-content", u = d + "-label", h = r + "-dropdown", f = r + "-dropdowngroup", g = r + "-abbrev", m = g + "group", b = r + "-text", v = r + "-icon", y = r + "-abbrevicon", x = function(e) {
                            __extends(t, e);
                            function t() {
                                e.apply(this, arguments)
                            }
                            return t.prototype._create = function() {
                                var e = this;
                                window.applyTouchUtilEvents && (o = window.applyTouchUtilEvents(o)),
                                    e.Em(),
                                    o(window).bind("resize." + this.widgetName, function() {
                                        e.updateRibbonSize()
                                    }),
                                e.element.is(":hidden") && e.element.addVisibilityObserver && e.element.addVisibilityObserver(function() {
                                    e.updateRibbonSize(),
                                    e.options.disabled && e.Fm(!0),
                                    e.element.removeVisibilityObserver && e.element.removeVisibilityObserver()
                                }, "gcuiribbon"),
                                e.options.disabled && e.Fm(!0)
                            }
                                ,
                                t.prototype._setOption = function(e, t) {
                                    o.gcui.widget.prototype._setOption.apply(this, arguments),
                                    "disabled" === e && this.Fm(t),
                                        o(".gcui-ribbon-startmenulink", this.element).unbind("click.tabs")
                                }
                                ,
                                t.prototype.Fm = function(e) {
                                    var t = this
                                        , i = t.element
                                        , n = i.offset()
                                        , r = n.top
                                        , s = n.left
                                        , l = o("body")
                                        , c = this.options.uiCSS
                                        , d = t.disabledModal;
                                    i.data("gcuiUITabs") && i.gcuitabs("option", "disabled", e),
                                    0 !== i.closest(".gcui-editor").length && (r = 0,
                                        s = 0,
                                        l = i.parent()),
                                        e ? (d || (d = o("<div></div>").addClass(c.stateDisabled + " " + a).css({
                                            top: r,
                                            left: s,
                                            "background-color": "lightgray",
                                            position: "absolute"
                                        }).appendTo(l).bind("click mousedown mouseup mouseover mouseout focus keydown keypress", function(e) {
                                            return e.stopPropagation(),
                                                e.preventDefault(),
                                                !1
                                        }),
                                            t.disabledModal = d),
                                            t.disabledModal.width(i.width()).height(i.outerHeight()).show()) : t.disabledModal && t.disabledModal.hide()
                                }
                                ,
                                t.prototype.Gm = function() {
                                    var e = this, t;
                                    o.each(o("[customtype]", e.element), function(i, n) {
                                        (t = o(n).attr("customtype")) && e.options.custombuttons[t] && e.options.custombuttons[t].create(o(n))
                                    })
                                }
                                ,
                                t.prototype.Em = function() {
                                    var e = this
                                        , t = this.options.uiCSS;
                                    e.buttons = {},
                                        e.listUis = {},
                                        e.accessbarBtns = {},
                                        e.Gm(),
                                        e.Hm(),
                                        e.Im(),
                                        e.Jm(),
                                        e.Km(),
                                        e.Lm(),
                                        e.Mm(),
                                        e.Nm(),
                                        e.Om(),
                                        e.Pm(),
                                        e.Qm(),
                                        o("." + t.helperReset + ":not(." + c + ", ." + t.tabsNav + ", .gcui-menu-list)", e.element).hover(function() {
                                            o(this).addClass(t.stateHover)
                                        }, function() {
                                            o(this).removeClass(t.stateHover)
                                        }),
                                        o("." + t.button, e.element).bind("mouseenter", function() {
                                            o("." + t.buttonText, this).addClass(t.stateHover)
                                        }).bind("mouseleave", function() {
                                            o("." + t.buttonText, this).removeClass(t.stateHover)
                                        }),
                                        o("button." + t.button, e.element).bind("mousedown", function() {
                                            e.Rm(this)
                                        }).bind("mouseup", function() {
                                            e.Rm(this)
                                        }),
                                        o("label." + t.button, e.element).bind("click", function() {
                                            o("span", this) && 1 === o("span", this).length && e.Sm(this)
                                        })
                                }
                                ,
                                t.prototype.Rm = function(e) {
                                    var t = this.options.uiCSS;
                                    e && (o(e).hasClass(t.stateActive) ? o("." + t.buttonText, e).addClass(t.stateActive) : o("." + t.buttonText, e).removeClass(t.stateActive))
                                }
                                ,
                                t.prototype.Sm = function(e) {
                                    var t = this, i, n, r;
                                    e && (n = o(e).attr("for"),
                                        i = o("#" + n, t.element),
                                        i.is(":checkbox") ? t.Rm(e) : i.is(":radio") && (r = t.element.find("[name='" + i.attr("name") + "']"),
                                            o.each(r, function() {
                                                t.Tm(this)
                                            })))
                                }
                                ,
                                t.prototype.Tm = function(e) {
                                    var t, i = this.options.uiCSS;
                                    e && (t = o("[for='" + o(e).attr("id") + "']", o(e).parent())) && (t.hasClass(i.stateActive) ? t.children("." + i.buttonText).addClass(i.stateActive) : t.children("." + i.buttonText).removeClass(i.stateActive))
                                }
                                ,
                                t.prototype.Im = function() {
                                    var e = this, t;
                                    e.groups = [],
                                        e.splits = [],
                                        e.dropdowns = [],
                                        e.inputDropdowns = [],
                                        o("span>button, span>:checkbox, span>:radio, div>button, div>:checkbox, div>:radio, div>:text", e.element).each(function(i, n) {
                                            if (!o(n).parents("[customtype]") || 0 === o(n).parents("[customtype]").length)
                                                return t = o(n).parent(),
                                                    0 !== o(">ul", t).length || t.hasClass("gcui-ribbon-accesstoolbar") ? 2 === o(">button", t).length ? e.splits.push(t) : 1 === o(">button", t).length ? e.dropdowns.push(t) : 1 === o(">input[type='text']", t).length && e.inputDropdowns.push(t) : e.groups.push(t),
                                                    this
                                        }),
                                        e.groups = e.Um(e.groups),
                                        e.splits = e.Um(e.splits)
                                }
                                ,
                                t.prototype.Um = function(e) {
                                    var t = o.makeArray(o.map(e, function(e) {
                                        return e.get(0)
                                    }));
                                    return o.map(o.unique(t), function(e) {
                                        return o(e)
                                    })
                                }
                                ,
                                t.prototype.Jm = function() {
                                    var e = this
                                        , t = e.element;
                                    o(":checkbox", t).each(function() {
                                        if (!o(this).parents("[customtype]") || 0 === o(this).parents("[customtype]").length)
                                            return e.Vm(o(this), "checkbox"),
                                                o(this).bind("change", function() {
                                                    e.Sm(o(this).button("widget")[0])
                                                }),
                                                this
                                    }),
                                        o(":radio", t).each(function() {
                                            if (!o(this).parents("[customtype]") || 0 === o(this).parents("[customtype]").length)
                                                return e.Vm(o(this), "radio"),
                                                    o(this).bind("change", function() {
                                                        e.Sm(o(this).button("widget")[0])
                                                    }),
                                                    this
                                        }),
                                        o("button", t).each(function() {
                                            if (!o(this).parents("[customtype]") || 0 === o(this).parents("[customtype]").length)
                                                return e.Vm(o(this), "button"),
                                                    this
                                        })
                                }
                                ,
                                t.prototype.Vm = function(e, t) {
                                    var i = this, n = this.options.uiCSS, r = i.Wm(e, t), a = e.data("commandName"), s;
                                    e.button(r),
                                    r.text || ("button" === t ? e.children("." + n.buttonText).text(a) : (s = o("[for='" + e.attr("id") + "']", e.parent())) && s.children("." + n.buttonText).text(a)),
                                    e.parent().is(".gcui-ribbon-accesstoolbar") && "true" === e.attr("canlocateonaccesstoolbar") && e.button("widget").hide(),
                                        i.Xm(e)
                                }
                                ,
                                t.prototype.Km = function() {
                                    o.each(this.groups, function(e, t) {
                                        t.buttonset()
                                    })
                                }
                                ,
                                t.prototype.Lm = function() {
                                    var e = this
                                        , t = this.options.uiCSS;
                                    o.each(e.splits, function(i, n) {
                                        var a = n.children("ul"), s = n.children("button:eq(0)"), l = s.data("commandName"), c = n.children("button:eq(1)"), d;
                                        a.children("li").addClass(t.cornerAll),
                                            n.addClass(r + "-" + l),
                                            c.button({
                                                icons: {
                                                    primary: t.iconArrowDown
                                                },
                                                text: !1
                                            }).data("list", a).unbind("click").bind("click", function(e) {
                                                e.stopPropagation(),
                                                    e.preventDefault()
                                            }).bind("mouseup", function(t) {
                                                a = o(this).data("list"),
                                                    a.is(":visible") ? (e.showList.hide().css("z-index", ""),
                                                        e.showList = null) : (a.show().position({
                                                        my: "left top",
                                                        at: "left bottom",
                                                        of: n
                                                    }).css("z-index", 9999),
                                                        e.showList = a),
                                                    t.stopPropagation(),
                                                    t.preventDefault()
                                            }),
                                            c.children("." + t.buttonText).text("foo"),
                                            n.after(a),
                                            a.css("position", "absolute").addClass(t.helperReset + " " + t.helperClearFix + " " + t.cornerAll + " " + h).hide(),
                                            n.buttonset(),
                                            d = {
                                                ui: s,
                                                defaultValue: s.button("option", "label"),
                                                buttons: [],
                                                type: "split",
                                                trigger: c,
                                                list: a
                                            },
                                            o("button, :checkbox, :radio", a).bind("click", function(t) {
                                                a.hide().css("z-index", ""),
                                                    e.showList = null,
                                                    t.preventDefault()
                                            }),
                                            a.find(">li>button,>li>:radio,>li>:checkbox").each(function(t, i) {
                                                var n = o(i).data("commandName");
                                                "" !== n && e.buttons[n] && (e.buttons[n].parent = s,
                                                    e.buttons[n].type = "split"),
                                                    d.buttons.push(o(i))
                                            }),
                                        "" !== l && (e.listUis[l] = d)
                                    })
                                }
                                ,
                                t.prototype.Mm = function() {
                                    var e = this, t = this.options.uiCSS, i, n;
                                    e.dropdownLabels = {},
                                        o.each(e.dropdowns, function(i, n) {
                                            var a = n.children("ul"), s = n.children("button:eq(0)"), l = s.data("commandName"), c;
                                            a.children("li").addClass(t.cornerAll),
                                                n.addClass(r + "-" + l),
                                                s.button({
                                                    icons: {
                                                        secondary: t.iconArrowDown
                                                    }
                                                }).unbind("click").bind("click", function(e) {
                                                    e.stopPropagation(),
                                                        e.preventDefault()
                                                }).bind("mouseup", function(t) {
                                                    e.Ym(a, s),
                                                        t.stopPropagation(),
                                                        t.preventDefault()
                                                }).bind("keydown", function(t) {
                                                    a.is(":visible") && e.Zm(t, a, s)
                                                }),
                                                c = {
                                                    ui: s,
                                                    defaultValue: s.button("option", "label"),
                                                    buttons: [],
                                                    type: "dropdown",
                                                    list: a
                                                },
                                                o("button, :checkbox, :radio", a).bind("click", function(i) {
                                                    var n = o(this).data("commandName"), r, l = s.children("." + t.buttonText).width();
                                                    e.dropdownLabels[n] || (e.dropdownLabels[n] = e.$m(o(this).button("option", "label"), s.children("." + t.buttonText), l)),
                                                        r = e.dropdownLabels[n],
                                                        s.button("option", "label", r),
                                                        s.attr("title", o(this).button("option", "label")),
                                                        a.hide().css("z-index", ""),
                                                        e.showList = null,
                                                        i.preventDefault()
                                                }),
                                                a.css("position", "absolute").addClass(t.helperReset + " " + t.helperClearFix + " " + t.cornerAll + " " + h).hide(),
                                                n.buttonset(),
                                                e._m(a, s, c, l)
                                        })
                                }
                                ,
                                t.prototype.Nm = function() {
                                    var e = this
                                        , t = this.options.uiCSS;
                                    e.dropdownLabels = {},
                                        o.each(e.inputDropdowns, function(i, n) {
                                            var a = n.children("ul"), s = n.children("input[type='text']:eq(0)"), l = e.an(s), c = s.prop("name"), d;
                                            n.prepend(l),
                                                a.children("li").addClass(t.cornerAll),
                                                n.addClass(r + "-" + c),
                                                s.removeProp("name").data("commandName", c).addClass(t.stateDefault + " " + t.content + " " + t.cornerLeft),
                                                l.find("a").bind("mouseup", function(t) {
                                                    e.Ym(a, s),
                                                        s.focus(),
                                                        t.stopPropagation(),
                                                        t.preventDefault()
                                                }).bind("keydown", function(t) {
                                                    e.Zm(t, a, l)
                                                }),
                                                e.bn(s, a),
                                                d = {
                                                    ui: s,
                                                    defaultValue: s.val(),
                                                    buttons: [],
                                                    type: "dropdown",
                                                    list: a
                                                },
                                                o("button, :checkbox, :radio", a).bind("click", function(t) {
                                                    var i = o(this).data("commandName"), n;
                                                    e.dropdownLabels[i] || (e.dropdownLabels[i] = o(this).button("option", "label")),
                                                        n = e.dropdownLabels[i],
                                                        s.val(o(this).button("option", "label")).attr("title", o(this).button("option", "label")),
                                                        a.hide().css("z-index", ""),
                                                        e.showList = null,
                                                        t.preventDefault(),
                                                        t.stopPropagation()
                                                }),
                                                a.css("position", "absolute").addClass(t.helperReset + " " + t.helperClearFix + " " + t.cornerAll + " " + h).hide(),
                                                e._m(a, s, d, c)
                                        })
                                }
                                ,
                                t.prototype._m = function(e, t, i, n) {
                                    var r = this;
                                    e.find(">li>button,>li>:radio,>li>:checkbox").each(function(e, n) {
                                        var a = o(n).data("commandName");
                                        "" !== a && r.buttons[a] && (r.buttons[a].parent = t,
                                            r.buttons[a].type = "dropdown"),
                                            i.buttons.push(o(n))
                                    }),
                                    "" !== n && (r.listUis[n] = i)
                                }
                                ,
                                t.prototype.Ym = function(e, t) {
                                    var i = this;
                                    e.is(":visible") && !e.find("li." + i.options.uiCSS.stateActive) ? (i.showList.hide().css("z-index", ""),
                                        i.showList = null) : (i.showList && (i.showList.hide(),
                                        i.showList = null),
                                        e.show().position({
                                            my: "left top",
                                            at: "left bottom",
                                            of: t
                                        }).css("z-index", 9999),
                                        i.showList = e,
                                        i.isShow = !0,
                                    o("#measureWidth")[0].className.indexOf("update-width") < 0 && e.css("width", o.gcui.getTextAutoWidth(e)))
                                }
                                ,
                                t.prototype.bn = function(e, t) {
                                    var i = this, o, n;
                                    e.bind("change", function(t) {
                                        var o = {
                                            name: void 0,
                                            commandName: void 0
                                        };
                                        o.name = e.prop("name"),
                                            o.commandName = e.val(),
                                            i._trigger("click", t, o)
                                    }).bind("keydown", function(o) {
                                        i.Zm(o, t, e)
                                    })
                                }
                                ,
                                t.prototype.Zm = function(e, t, i) {
                                    var o = this
                                        , n = e.keyCode
                                        , r = o.cn();
                                    switch (n) {
                                        case r.UP:
                                            o.dn(!1, t, i),
                                                e.preventDefault();
                                            break;
                                        case r.DOWN:
                                            o.dn(!0, t, i),
                                                e.preventDefault();
                                            break;
                                        case r.ENTER:
                                            t.find("label." + o.options.uiCSS.stateActive).parent("li").find("input").trigger("click"),
                                                e.preventDefault()
                                    }
                                }
                                ,
                                t.prototype.dn = function(e, t, i) {
                                    var n = this, r = t.find("li").length, a, s;
                                    if (!t.is(":visible"))
                                        return void n.Ym(t, i);
                                    s = t.find("label." + n.options.uiCSS.stateActive).parent("li"),
                                    s && s.length > 0 && (a = t.find("li").index(s)),
                                        n.gn(s, !1),
                                        void 0 === a ? a = 0 : e ? ++a == r && (a = void 0) : -1 == --a && (a = r - 1),
                                        n.gn(o(t.find("li")[a]), !0)
                                }
                                ,
                                t.prototype.gn = function(e, t) {
                                    var i = this.options.uiCSS;
                                    e && (t ? (o("label", e).addClass(i.stateActive),
                                        o("span", e).addClass(i.stateActive)) : (o("label", e).removeClass(i.stateActive),
                                        o("span", e).removeClass(i.stateActive)))
                                }
                                ,
                                t.prototype.Om = function() {
                                    var e = this
                                        , t = e.options.uiCSS;
                                    o(".gcui-ribbon-gallery", e.element).each(function(i, n) {
                                        o(n).children("div").each(function(i, n) {
                                            o(n).bind("mouseenter", function(e) {
                                                o(n).hasClass(t.stateDisabled) || o(n).addClass(t.stateHover)
                                            }).bind("mouseleave", function(e) {
                                                o(n).hasClass(t.stateDisabled) || o(n).removeClass(t.stateHover)
                                            }).bind("click", function(i) {
                                                if (!o(n).hasClass(t.stateDisabled)) {
                                                    o(n).parent("div.gcui-ribbon-gallery").children("div").removeClass(t.stateActive),
                                                        o(n).addClass(t.stateActive);
                                                    var r = {
                                                        name: void 0,
                                                        commandName: void 0
                                                    };
                                                    r.name = o(n).parent("div.gcui-ribbon-gallery").attr("name"),
                                                        r.commandName = o(n).attr("name"),
                                                        e._trigger("click", i, r)
                                                }
                                            }),
                                                e.buttons[o(n).attr("name")] = {
                                                    button: o(n),
                                                    type: "galleryBtn"
                                                }
                                        })
                                    })
                                }
                                ,
                                t.prototype.cn = function() {
                                    if (o.ui && o.ui.keyCode)
                                        return o.ui.keyCode;
                                    if (o.mobile && o.mobile.keyCode)
                                        return o.mobile.keyCode;
                                    throw "keyCode object is not found"
                                }
                                ,
                                t.prototype.an = function(e) {
                                    var t = this.options.uiCSS
                                        , i = o("<span class='gcui-ribbon-inputdropdownwrapper'></span>").append(e);
                                    return o("<a></a>").appendTo(i).button({
                                        icons: {
                                            primary: t.iconArrowDown
                                        },
                                        text: !1
                                    }).removeClass(t.cornerAll).addClass("gcui-ribbon-inputdropdownbtn " + t.cornerRight),
                                        i
                                }
                                ,
                                t.prototype.Qm = function() {
                                    var e = this
                                        , t = this.options.uiCSS
                                        , i = e.element;
                                    return i.addClass(r),
                                        e.tabEle = i,
                                        o(">ul", i).length > 0 ? (i.gcuitabs({
                                            select: function(t, i) {
                                                e.hn()
                                            }
                                        }),
                                            e.in(),
                                        o(".gcui-ribbon-startmenu") && o(".gcui-ribbon-startmenu").length > 0 && (i.gcuitabs("option", "selected", 1),
                                            e.jn()),
                                            !0) : (i.addClass(r + "-simple").addClass(t.stateDefault).addClass(t.helperClearFix),
                                            !1)
                                }
                                ,
                                t.prototype.Hm = function() {
                                    var e = this, t, i = o("<div class='gcui-ribbon-accesstoolbar'></div>"), n;
                                    0 === o("*[canlocateonaccesstoolbar='true']", e.element).length && 0 === o("*[locateonaccesstoolbar='true']", e.element).length || (o("input[canlocateonaccesstoolbar='true'],input[locateonaccesstoolbar='true']", e.element).each(function() {
                                        t = o(this).attr("id") + "_accessbar";
                                        var i = o("label[for=" + o(this).attr("id") + "]");
                                        e.accessbarBtns[i.attr("title")] = {
                                            button: o(this).clone().attr("id", t),
                                            type: o(this).attr("type"),
                                            labelEle: i.clone().attr("for", t),
                                            selected: "true" === o(this).attr("locateonaccesstoolbar")
                                        }
                                    }),
                                        o("button[canlocateonaccesstoolbar='true'],button[locateonaccesstoolbar='true']", e.element).each(function() {
                                            t = o(this).attr("id") + "_accessbar",
                                                e.accessbarBtns[o(this).attr("title")] = {
                                                    button: o(this).clone(),
                                                    type: "button",
                                                    selected: "true" === o(this).attr("locateonaccesstoolbar")
                                                }
                                        }),
                                        o.each(e.accessbarBtns, function(e, t) {
                                            i.append(t.button),
                                            t.labelEle && i.append(t.labelEle)
                                        }),
                                        n = o('<button title="Customize Access Toolbar" class ="gcui-ribbon-accesstoolbarbtn ' + e.options.uiCSS.iconArrowDown + '" name="quicktoolbar"></button>'),
                                        i.append(n),
                                    e.accessbarBtns && e.element.prepend(i),
                                        e.kn(n, i))
                                }
                                ,
                                t.prototype.kn = function(e, t) {
                                    var i = this, n, r, a = i.options.uiCSS, s = o('<ul class="gcui-ribbon-accesstoolbarmenu"></ul>');
                                    o.each(i.accessbarBtns, function(e, t) {
                                        r = t.selected ? " gcui-ribbon-accesstoolbarmenuitemchecked" : " gcui-ribbon-accesstoolbarmenuitemunchecked",
                                            n = o('<li><a class="' + a.cornerAll + '" tabindex="-1"><span class="' + a.icon + r + '"></span><span class="gcui-menu-text">' + e + "</span></a></li>"),
                                            n.data("accessbarcommand", e),
                                            s.append(n)
                                    }),
                                        s.prepend("<li class='gcui-ribbon-accesstoolbarmenutitleitem'><a>Customize Access Toolbar</a></li>"),
                                        t.append(s),
                                        s.gcuimenu({
                                            trigger: e,
                                            triggerEvent: "click",
                                            orientation: "vertical",
                                            select: function(e, t) {
                                                var n = t.item
                                                    , r = n.element.data("accessbarcommand")
                                                    , l = o("span." + a.icon, n.element)
                                                    , c = i.accessbarBtns[r].button
                                                    , d = c.button("widget");
                                                l.hasClass("gcui-ribbon-accesstoolbarmenuitemchecked") ? (l.removeClass("gcui-ribbon-accesstoolbarmenuitemchecked").addClass("gcui-ribbon-accesstoolbarmenuitemunchecked"),
                                                    d.hide().removeAttr("canlocateonaccesstoolbar").attr("locateonaccesstoolbar", "true")) : (l.addClass("gcui-ribbon-accesstoolbarmenuitemchecked").removeClass("gcui-ribbon-accesstoolbarmenuitemunchecked"),
                                                    d.show().removeAttr("locateonaccesstoolbar").attr("canlocateonaccesstoolbar", "true")),
                                                    s.gcuimenu("deactivate", null)
                                            }
                                        }),
                                        s.gcuimenu("setItemDisabled", o(".gcui-ribbon-accesstoolbarmenutitleitem"), !0)
                                }
                                ,
                                t.prototype.updateRibbonSize = function() {
                                    var e = this, t, i = this.options.uiCSS, n;
                                    e.tabEle.children("div").not(".gcui-menu").each(function(a, s) {
                                        var l = o(s)
                                            , c = l.is(":visible")
                                            , d = l.find(">ul>li:not(.gcui-menu-item)")
                                            , p = []
                                            , u = l.width();
                                        return c || (l.removeClass(i.tabsHide),
                                            u = l.width()),
                                            d.each(function(i, a) {
                                                var s = o(a)
                                                    , l = s.find(">div:last")
                                                    , c = e.ln(l);
                                                return t = s.children("." + f),
                                                    n = s.children("." + m),
                                                t && (s.addClass(r + "-" + o.gcui.replaceClassName(c.toLowerCase())).prepend(t.children()),
                                                    t.remove(),
                                                n && n.remove()),
                                                    p.push({
                                                        width: s.outerWidth(!0),
                                                        contentWidth: s.width(),
                                                        height: s.outerHeight(!0),
                                                        text: c
                                                    }),
                                                    this
                                            }),
                                            e.mn(d, p, u),
                                        c || l.addClass(i.tabsHide),
                                            this
                                    }),
                                    e.options.disabled && e.Fm(!0)
                                }
                                ,
                                t.prototype.in = function() {
                                    var e = this
                                        , t = this.options.uiCSS;
                                    e.tabEle.children("div").each(function(i, n) {
                                        var a = o(n), s = a.is(":visible"), h = a.find(">ul:not(.gcui-ribbon-accesstoolbarmenu)>li"), f = [], g;
                                        return a.data("destroy.tabs") ? void a.remove() : (s || a.removeClass(t.tabsHide),
                                            g = a.width(),
                                            a.addClass(l),
                                        a.hasClass(t.tabsPanel) || (a.addClass("gcui-ribbon-accesstoolbar"),
                                            e.tabEle.prepend(a)),
                                            a.find(">ul").addClass(t.helperReset + " " + t.helperClearFix + " " + t.content + " " + t.cornerAll + " " + c),
                                            h.each(function(i, n) {
                                                var a = o(n)
                                                    , s = a.find(">div:last")
                                                    , l = s.find("span")
                                                    , c = t.stateDefault + " " + d
                                                    , h = e.ln(s);
                                                return s && (c += " " + r + "-" + o.gcui.replaceClassName(h.toLowerCase())),
                                                    a.addClass(c),
                                                    s.addClass(u).bind("click", function() {
                                                        return !1
                                                    }),
                                                    a.wrapInner("<div class = '" + p + "'></div>"),
                                                    a.children().bind("mouseover", function() {
                                                        o(this).addClass(t.stateHover)
                                                    }).bind("mouseout", function() {
                                                        o(this).removeClass(t.stateHover)
                                                    }),
                                                    s.appendTo(a),
                                                    f.push({
                                                        width: a.outerWidth(!0),
                                                        text: h
                                                    }),
                                                    this
                                            }),
                                            e.nn = f,
                                            e.mn(h, f, g),
                                        s || a.addClass(t.tabsHide),
                                            this)
                                    })
                                }
                                ,
                                t.prototype.jn = function() {
                                    var e = this
                                        , t = o(".gcui-ribbon-startmenulink", e.element)
                                        , i = e.options.uiCSS;
                                    t.unbind("click"),
                                        t.parent("li").addClass("gcui-ribbon-startmenulinkcontainer").hover(function() {
                                            o(this).removeClass("gcui-ribbon-startmenulinkcontainer")
                                        }, function() {
                                            o(this).addClass("gcui-ribbon-startmenulinkcontainer")
                                        }),
                                        o(".gcui-ribbon-startmenuindicator", e.element).addClass(i.icon + " " + i.iconArrowDown),
                                        o(".gcui-ribbon-startmenu", e.element).gcuimenu({
                                            trigger: o(".gcui-ribbon-startmenulink", e.element).parent(),
                                            triggerEvent: "click",
                                            orientation: "vertical",
                                            select: function(t, i) {
                                                var o = {
                                                    name: void 0,
                                                    commandName: void 0
                                                };
                                                o.commandName = i.item.pn.attr("name"),
                                                    e._trigger("click", t, o)
                                            },
                                            hidden: function(e, t) {
                                                t.activeItem && t.activeItem.pn.removeClass(i.stateFocus)
                                            }
                                        })
                                }
                                ,
                                t.prototype.ln = function(e) {
                                    var t, i;
                                    return e && (t = e.find("span"),
                                        i = e.attr("displayname") ? e.attr("displayname") : t && t.length > 0 && !e.hasClass(m) ? o(t[0]).text() : o.trim(e.text())),
                                        i
                                }
                                ,
                                t.prototype.mn = function(e, t, i) {
                                    for (var n = this, a = e.length - 1, s = 0, l = 0, c = 0, d, p, u; a >= 0; a--) {
                                        for (c = 0,
                                                 s = 0; s < a; s++)
                                            c += t[s].width;
                                        c + l + t[a].width <= i ? (d = o(e[a]).children("." + f),
                                            p = o(e[a]).children("." + m),
                                        d && (o(e[a]).addClass(r + "-" + t[a].text.toLowerCase()).prepend(d.children()),
                                            d.remove(),
                                        p && p.remove())) : (u = t[a],
                                            l += n.qn(u, e[a], i))
                                    }
                                }
                                ,
                                t.prototype.qn = function(e, t, i) {
                                    var n = this, a = e.text, s = r + "-" + o.gcui.replaceClassName(a.toLowerCase()), l = this.options.uiCSS, c = o(t).removeClass(s), p = n.ln(c.find(">div:last")) || a, u;
                                    return c.wrapInner("<div class='" + f + " " + d + "'></div>").children().hide().addClass(s).bind("mouseup." + n.widget, function(e) {
                                        null !== n.showDrpDwnGroup && (n.showDrpDwnGroup.hide().css("z-index", ""),
                                            n.showDrpDwnGroup = null)
                                    }),
                                        u = o("<div class='" + m + "'><span class='" + g + o.gcui.replaceClassName(p.toLowerCase()) + " " + v + " " + y + "'></span><span class='" + b + "'>" + p + "</span><span class='" + l.icon + " " + l.iconArrowDown + " " + v + "'></span></div>").appendTo(c).unbind(n.widget).bind("mouseover." + n.widget, function(e) {
                                            o(this).addClass(l.stateHover)
                                        }).bind("mouseout." + n.widget, function(e) {
                                            o(this).removeClass(l.stateHover)
                                        }).bind("click." + n.widget, function(t) {
                                            var i, r, a = o(this).siblings("." + f);
                                            a.is(":visible") ? (a.hide().css("z-index", ""),
                                                n.showDrpDwnGroup = null) : (n.showDrpDwnGroup && n.showDrpDwnGroup.hide().css("z-index", ""),
                                                i = e.contentWidth + 1,
                                                r = e.height,
                                                a.css({
                                                    width: i,
                                                    height: r
                                                }),
                                                a.show().position({
                                                    my: "left top",
                                                    at: "left bottom",
                                                    of: this
                                                }).css("z-index", "10000"),
                                                n.showDrpDwnGroup = a,
                                                t.stopPropagation())
                                        }),
                                        c.outerWidth(!0)
                                }
                                ,
                                t.prototype.Pm = function() {
                                    var e = this;
                                    o(document).bind("mouseup", function(t) {
                                        var i = t.target;
                                        e.showList && (o(i).is(document) || i !== e.showList.get(0) && !o.contains(e.showList.get(0), i)) && (e.showList.hide().css("z-index", ""),
                                            e.showList = null),
                                        e.showDrpDwnGroup && (!o(i).is(document) && o.contains(e.showDrpDwnGroup.get(0), i) || (e.showDrpDwnGroup.hide().css("z-index", ""),
                                            e.showDrpDwnGroup = null))
                                    })
                                }
                                ,
                                t.prototype.Wm = function(e, t) {
                                    var i = !0, n = this, r = e.attr("class"), a, l, c, d, p, u, h;
                                    if (r && "" !== r && r !== s)
                                        l = r.split(" ")[0],
                                            e.removeClass(l),
                                        "" === (p = o.trim(e.text())) && (i = !1);
                                    else {
                                        if ("checkbox" === t || "radio" === t) {
                                            if ("" === o.trim(e.attr("id")))
                                                return;
                                            if (u = o("[for='" + e.attr("id") + "']", e.parent()),
                                                    !u.is("label"))
                                                return;
                                            r = u.attr("class"),
                                                r && "" !== r && r !== s ? (l = r.split(" ")[0],
                                                    u.removeClass(l),
                                                "" === (p = o.trim(u.text())) && (i = !1)) : a = u.children("span,div")
                                        } else
                                            "button" === t && (a = e.children("span,div"));
                                        a && (1 === a.length ? "" !== a.eq(0).attr("class") && (c = a.eq(0),
                                            l = c.attr("class"),
                                            i = !1) : 2 === a.length ? a.eq(0).attr("class") && (c = a.eq(0),
                                            l = c.attr("class"),
                                            c.is("span") ? d = "left" : c.is("div") && (d = "top"),
                                            p = a.eq(1).text()) : "button" === t && "" !== o.trim(e.text()) && (p = o.trim(e.text())))
                                    }
                                    return "button" === t ? (e.empty(),
                                    "" !== (h = o.trim(e.attr("name"))) && e.removeAttr("name")) : "" !== (h = o.trim(u.attr("name"))) && u.removeAttr("name"),
                                    "" !== h && (e.data("commandName", h),
                                    n.buttons[h] || (n.buttons[h] = {
                                        button: void 0,
                                        accessToolbarButton: void 0
                                    }),
                                        e.parent().is(".gcui-ribbon-accesstoolbar") ? n.buttons[h].accessToolbarButton = e : n.buttons[h].button = e),
                                        {
                                            label: p,
                                            icons: {
                                                primary: l
                                            },
                                            position: d,
                                            text: i
                                        }
                                }
                                ,
                                t.prototype.Xm = function(e) {
                                    var t = this, i, n, r = t.options.uiCSS;
                                    e.bind("click", function(a) {
                                        if (t.options.disabled)
                                            return a.preventDefault(),
                                                void a.stopPropagation();
                                        t.hn();
                                        var s = !0
                                            , l = e.data("commandName")
                                            , c = t.buttons[l]
                                            , d = {
                                            name: void 0,
                                            commandName: void 0
                                        };
                                        c && c.parent && (d.name = c.parent.data("commandName")),
                                            d.commandName = l,
                                            t._trigger("click", a, d),
                                            i = e.parent().is(".gcui-ribbon-accesstoolbar") ? t.buttons[l].button : t.buttons[l].accessToolbarButton,
                                        i && (n = i.button("widget"),
                                        i.is("button") || (n && n.hasClass(r.stateActive) && (s = !1),
                                            t.rn(i, s))),
                                        e.is("button") && (a.preventDefault(),
                                            a.stopPropagation()),
                                            o("." + r.buttonText, this).removeClass(r.stateHover)
                                    })
                                }
                                ,
                                t.prototype.getDropdownLabelSubstr = function(e, t, i) {
                                    return this.$m(e, t, i)
                                }
                                ,
                                t.prototype.$m = function(e, t, i) {
                                    var n = this, r = e.length, a = 0, s = r, l = Math.floor((a + s) / 2), c = o("<span></span>"), d = e.substr(0, l), p;
                                    for (c.appendTo(t.parent()),
                                             p = n.tn(d, c); p !== i && s > a; )
                                        d = e.substr(0, l + 1),
                                            p = n.tn(d, c),
                                            p > i ? s = l - 1 : p < i && (a = l + 1),
                                            l = Math.floor((a + s) / 2);
                                    return c.remove(),
                                        d
                                }
                                ,
                                t.prototype.tn = function(e, t) {
                                    return t.text(e),
                                        t.width()
                                }
                                ,
                                t.prototype.hideDropdown = function(e) {
                                    var t = this
                                        , i = t.listUis[e];
                                    i && i.list && i.list.hide()
                                }
                                ,
                                t.prototype.hn = function() {
                                    var e = this;
                                    o(".gcui-menu", e.tabEle).hide()
                                }
                                ,
                                t.prototype.setTabPageVisible = function(e, t) {
                                    var i = this, n = o("a[href=#" + e + "]", i.element).parent("li"), r = n.parent("ul"), a;
                                    n && n.length > 0 && (t ? (n.show(),
                                        a = o("li[role='tab']", r).index(n)) : (n.hide(),
                                        a = o("li", r).index(o('li:visible:not(".gcui-ribbon-startmenulinkcontainer")', r)))),
                                        i.element.gcuitabs("option", "selected", a)
                                }
                                ,
                                t.prototype.destroy = function() {
                                    this.disabledModal && this.disabledModal.remove(),
                                        o(window).unbind("resize." + this.widgetName),
                                        o.Widget.prototype.destroy.call(this)
                                }
                                ,
                                t.prototype.getDropdownList = function(e) {
                                    var t = this
                                        , i = t.listUis[e]
                                        , n = {};
                                    return i && o.each(i.buttons, function(e, t) {
                                        n[t.data("commandName")] = t.button("option", "label")
                                    }),
                                        n
                                }
                                ,
                                t.prototype.setButtonDisabled = function(e, t) {
                                    var i = this.buttons[e], n = this.options.uiCSS, r = !1, a, s, l;
                                    if (i && i.disabled)
                                        return void i.disabled(t);
                                    if (i && i.button && "galleryBtn" === i.type && i.button.addClass(n.stateDisabled),
                                        i && i.button) {
                                        if (a = i.button,
                                                s = i.accessToolbarButton,
                                                r = a.is("button"),
                                            "galleryBtn" === i.type)
                                            return void (t ? a.addClass(n.stateDisabled) : a.removeClass(n.stateDisabled));
                                        a.button("option", "disabled", t),
                                        s && s.button("option", "disabled", t),
                                            r ? "save" !== e && s && a.children("." + n.buttonText).text(e) : o("[for='" + a.attr("id") + "']", a.parent()).children("." + n.buttonText).text(e),
                                            l = this.listUis[e],
                                        l && "split" === l.type && (l.trigger.button("option", "disabled", t),
                                            l.trigger.children("." + n.buttonText).text(e))
                                    }
                                }
                                ,
                                t.prototype.setButtonsDisabled = function(e) {
                                    var t = this;
                                    o.each(e, function(e, i) {
                                        t.setButtonDisabled(e, i)
                                    })
                                }
                                ,
                                t.prototype.setButtonsChecked = function(e) {
                                    var t = this;
                                    o.each(e, function(e, i) {
                                        o.isPlainObject(i) ? t.setButtonChecked(e, i.checked, i.name) : t.setButtonChecked(e, i, null)
                                    })
                                }
                                ,
                                t.prototype.registerButtonInformation = function(e, t) {
                                    if (e && t)
                                        return this.buttons[e] = t
                                }
                                ,
                                t.prototype.ribbonClick = function(e, t) {
                                    this._trigger("click", e, t)
                                }
                                ,
                                t.prototype.rn = function(e, t) {
                                    var i = this, e, o = i.options.uiCSS;
                                    e.is("button") ? t ? e.addClass(o.stateActive) : e.removeClass(o.stateActive) : e.is("input[type='text']") || (e.prop("checked", t),
                                        e.button("refresh")),
                                        i.Rm(e.button("widget"))
                                }
                                ,
                                t.prototype.setButtonChecked = function(e, t, i) {
                                    var n, r, a, s, l, c, d = this, p = d.buttons[e], u = this.options.uiCSS;
                                    if (p && p.checked)
                                        return void p.checked(t);
                                    if (p && p.button) {
                                        if (r = p.button,
                                                a = p.accessToolbarButton,
                                                r.is("button"))
                                            t ? (r.addClass(u.stateActive),
                                            a && a.addClass(u.stateActive)) : (r.removeClass(u.stateActive),
                                            a && a.removeClass(u.stateActive));
                                        else {
                                            if ("galleryBtn" === p.type)
                                                return c = r.parent("div"),
                                                    o("div", c).removeClass(u.stateActive),
                                                    void (t ? r.addClass(u.stateActive) : r.removeClass(u.stateActive));
                                            r.is("input[type='text']") || (r.prop("checked", t),
                                                r.button("refresh"),
                                            a && (a.prop("checked", t),
                                                a.button("refresh")))
                                        }
                                        p.parent ? "dropdown" === p.type && t && (d.dropdownLabels[e] || (d.dropdownLabels[e] = d.$m(r.button("option", "label"), p.parent.children("." + u.buttonText), p.parent.children("." + u.buttonText).width())),
                                            l = d.dropdownLabels[e],
                                            p.parent.is("input[type='text']") ? (p.parent.val(l),
                                                p.parent.attr("title", l)) : (p.parent.button("option", "label", l),
                                                p.parent.attr("title", r.button("option", "label"))),
                                        (n = o(":radio", p.button.closest("ul"))) && o.each(n, function() {
                                            d.Tm(this)
                                        })) : (d.Rm(r.button("widget")),
                                        a && d.Rm(a.button("widget")))
                                    } else
                                        i && (s = d.listUis[i]) && (s.ui.is("input[type='text']") ? s.ui.val(s.defaultValue) : s.ui.button("option", "label", s.defaultValue),
                                        s.buttons && o.each(s.buttons, function(e, t) {
                                            t.prop("checked", !1),
                                                t.button("refresh"),
                                                d.Rm(t.button("widget"))
                                        }))
                                }
                                ,
                                t
                        }(e.gcuiWidget);
                        t.gcuiribbon = x,
                            i = function() {
                                function e() {
                                    this.initSelector = ":jqmData(role='gcuiribbon')",
                                        this.uiCSS = {
                                            tabsHide: "gcui-gcuitabs-hide",
                                            dropDownGroupSpace: 20
                                        },
                                        this.click = null,
                                        this.custombuttons = null
                                }
                                return e
                            }(),
                            x.prototype.options = o.extend(!0, {}, e.gcuiWidget.prototype.options, new i),
                            o.gcui.registerWidget("gcuiribbon", x.prototype)
                    }(e.ribbon || (e.ribbon = {}))
                }(gcui || (gcui = {})),
                designer.gcui = gcui
        }
        , function(e, t, i) {
            !function() {
                "use strict";
                i(38),
                    i(40),
                    i(39),
                    i(37),
                    i(41)
            }()
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer
                , o = GC.Spread.Sheets
                , n = o.Charts
                , r = o.CalcEngine.rangeToFormula
                , a = i.util.chartHelper;
            !function(e) {
                "use strict";
                var t, o;
                function r() {
                    t = new GC.Spread.Sheets.Workbook(document.getElementById("chartPreviewer"),{
                        sheetCount: 1
                    })
                }
                function s(e) {
                    t.fromJSON(e.toJSON({
                        ignoreStyle: !0,
                        ignoreFormula: !0
                    }))
                }
                e.synchronizeData = s;
                function l() {
                    return t.getActiveSheet()
                }
                function c(e) {
                    var t, i, r, s, c, d, p, u, h, f = e.category;
                    try {
                        if (o = l(),
                                i = n.ChartType[e.chartType],
                                r = e.dataFormula,
                                s = e.dataOrientation,
                                f === a.chartTypeDict[52].chartGroup ? t = o.charts.add("", i, 20, 20, 480, 288, r) : i === n.ChartType.pie ? (r || (d = e.series[0],
                                    r = d.yValues),
                                r && (t = o.charts.add("", i, 20, 20, 480, 288, r, s))) : r && f !== a.chartTypeDict[0].chartGroup ? t = o.charts.add("", i, 20, 20, 480, 288, r, s) : (t = o.charts.add("", i, 20, 20, 480, 288),
                                    p = t.series(),
                                    p.add(e.series)),
                                !t)
                            return;
                        if (e.axes && a.getChartGroupString(t.chartType()) !== a.chartTypeDict[3].chartGroup && t.axes(e.axes),
                            e.dataLabels && t.dataLabels(e.dataLabels),
                            e.legend && t.legend(e.legend),
                            e.title && t.title(e.title),
                            e.chartArea && t.chartArea(e.chartArea),
                            t.series().get(8) && t.legend({
                                visible: !1
                            }),
                            f === a.chartTypeDict[3].chartGroup && e.series.length > 0)
                            for (u = t.series(),
                                     c = 0; c < u.length; c++)
                                u.set(c, e.series[c]);
                        return e.colorAndStyle && e.colorAndStyle.color && (a.applyChartSeriesTheme(t, e.colorAndStyle.color),
                            t.colorAndStyle = {
                                color: e.colorAndStyle.color
                            }),
                            t
                    } catch (e) {
                        return h = f === a.chartTypeDict[52].chartGroup ? e.message : "Chart are not available for the data you selected"
                    }
                }
                function d(e) {
                    o = l(),
                        o.charts.clear(),
                        t.suspendPaint();
                    var i = [], n, r;
                    for (n = 0; n < e.length; n++)
                        r = c(e[n]),
                            i.push(r);
                    return t.resumePaint(),
                        i
                }
                e.getChartPreviewCharts = d,
                    i.loader.ready(function() {
                        i.wrapper.spread.notWorking || r()
                    }),
                    i.chartPreviewer = e
            }(i.chartPreviewer || {})
        }
        , function(e, t, i) {
            !function() {
                "use strict";
                var t = GC.Spread.Sheets.Designer
                    , o = t.util.chartHelper
                    , n = o.axesItemEnum
                    , r = i(2);
                function a(e) {
                    this.un = e,
                        this.container = document.createElement("div"),
                        this.container.className = "add-chart-element-container",
                        this.un.appendChild(this.container),
                        this.vn = {
                            axes: {
                                title: t.res.addChartElement.axes.axes,
                                key: "axes",
                                subTitle: {
                                    axesPrimaryHorizontal: {
                                        title: t.res.addChartElement.primaryHorizontal,
                                        key: "axesPrimaryHorizontal"
                                    },
                                    axesPrimaryVertical: {
                                        title: t.res.addChartElement.primaryVertical,
                                        key: "axesPrimaryVertical"
                                    },
                                    axesSecondaryHorizontal: {
                                        title: t.res.addChartElement.secondaryHorizontal,
                                        key: "axesSecondaryHorizontal"
                                    },
                                    axesSecondaryVertical: {
                                        title: t.res.addChartElement.secondaryVertical,
                                        key: "axesSecondaryVertical"
                                    }
                                },
                                openPanel: {
                                    title: t.res.addChartElement.axes.moreAxisOption,
                                    key: "AxesOpenPanel"
                                }
                            },
                            axisTitles: {
                                title: t.res.addChartElement.axisTitles.axisTitles,
                                key: "axisTitles",
                                subTitle: {
                                    axesTitlesPrimaryHorizontal: {
                                        title: t.res.addChartElement.primaryHorizontal,
                                        key: "axesTitlesPrimaryHorizontal"
                                    },
                                    axesTitlesPrimaryVertical: {
                                        title: t.res.addChartElement.primaryVertical,
                                        key: "axesTitlesPrimaryVertical"
                                    },
                                    axesTitlesSecondaryHorizontal: {
                                        title: t.res.addChartElement.secondaryHorizontal,
                                        key: "axesTitlesSecondaryHorizontal"
                                    },
                                    axesTitlesSecondaryVertical: {
                                        title: t.res.addChartElement.secondaryVertical,
                                        key: "axesTitlesSecondaryVertical"
                                    }
                                },
                                openPanel: {
                                    title: t.res.addChartElement.axisTitles.moreAxisTitlesOption,
                                    key: "axisTitlesOpenPanel"
                                }
                            },
                            chartTitle: {
                                title: t.res.addChartElement.chartTitle.chartTitle,
                                key: "chartTitle",
                                subTitle: {
                                    chartTitleNone: {
                                        title: t.res.addChartElement.none,
                                        key: "chartTitleNone"
                                    },
                                    chartTitleAboveChart: {
                                        title: t.res.addChartElement.aboveChart,
                                        key: "chartTitleAboveChart"
                                    }
                                },
                                openPanel: {
                                    title: t.res.addChartElement.chartTitle.moreChartTitleOption,
                                    key: "chartTitleOpenPanel"
                                }
                            },
                            gridLines: {
                                title: t.res.addChartElement.gridLines.gridLines,
                                key: "gridLines",
                                subTitle: {
                                    gridLinesPrimaryMajorHorizontal: {
                                        title: t.res.addChartElement.primaryMajorHorizontal,
                                        key: "gridLinesPrimaryMajorHorizontal"
                                    },
                                    gridLinesPrimaryMajorVertical: {
                                        title: t.res.addChartElement.primaryMajorVertical,
                                        key: "gridLinesPrimaryMajorVertical"
                                    },
                                    gridLinesPrimaryMinorHorizontal: {
                                        title: t.res.addChartElement.primaryMinorHorizontal,
                                        key: "gridLinesPrimaryMinorHorizontal"
                                    },
                                    gridLinesPrimaryMinorVertical: {
                                        title: t.res.addChartElement.primaryMinorVertical,
                                        key: "gridLinesPrimaryMinorVertical"
                                    },
                                    gridLinesSecondaryMajorHorizontal: {
                                        title: t.res.addChartElement.secondaryMajorHorizontal,
                                        key: "gridLinesSecondaryMajorHorizontal"
                                    },
                                    gridLinesSecondaryMajorVertical: {
                                        title: t.res.addChartElement.secondaryMajorVertical,
                                        key: "gridLinesSecondaryMajorVertical"
                                    },
                                    gridLinesSecondaryMinorHorizontal: {
                                        title: t.res.addChartElement.secondaryMinorHorizontal,
                                        key: "gridLinesSecondaryMinorHorizontal"
                                    },
                                    gridLinesSecondaryMinorVertical: {
                                        title: t.res.addChartElement.secondaryMinorVertical,
                                        key: "gridLinesSecondaryMinorVertical"
                                    }
                                },
                                openPanel: {
                                    title: t.res.addChartElement.gridLines.moreGridLinesOption,
                                    key: "gridLinesOpenPanel"
                                }
                            },
                            dataLabels: {
                                title: t.res.addChartElement.dataLabels.dataLabels,
                                key: "dataLabels",
                                subTitle: {
                                    dataLabelsNone: {
                                        title: t.res.addChartElement.none,
                                        key: "dataLabelsNone"
                                    },
                                    dataLabelsCenter: {
                                        title: t.res.addChartElement.center,
                                        key: "dataLabelsCenter"
                                    },
                                    dataLabelsInsideEnd: {
                                        title: t.res.addChartElement.insideEnd,
                                        key: "dataLabelsInsideEnd"
                                    },
                                    dataLabelsOutsideEnd: {
                                        title: t.res.addChartElement.outsideEnd,
                                        key: "dataLabelsOutsideEnd"
                                    },
                                    dataLabelsBestFit: {
                                        title: t.res.addChartElement.bestFit,
                                        key: "dataLabelsBestFit"
                                    },
                                    dataLabelsAbove: {
                                        title: t.res.addChartElement.above,
                                        key: "dataLabelsAbove"
                                    },
                                    dataLabelsBelow: {
                                        title: t.res.addChartElement.below,
                                        key: "dataLabelsBelow"
                                    },
                                    dataLabelsShow: {
                                        title: t.res.addChartElement.show,
                                        key: "dataLabelsShow"
                                    }
                                },
                                openPanel: {
                                    title: t.res.addChartElement.dataLabels.moreDataLabelsOption,
                                    key: "dataLabelsOpenPanel"
                                }
                            },
                            legend: {
                                title: t.res.addChartElement.legend.legend,
                                key: "legend",
                                subTitle: {
                                    legendNone: {
                                        title: t.res.addChartElement.none,
                                        key: "legendNone"
                                    },
                                    legendRight: {
                                        title: t.res.addChartElement.right,
                                        key: "legendRight"
                                    },
                                    legendTop: {
                                        title: t.res.addChartElement.top,
                                        key: "legendTop"
                                    },
                                    legendLeft: {
                                        title: t.res.addChartElement.left,
                                        key: "legendLeft"
                                    },
                                    legendBottom: {
                                        title: t.res.addChartElement.bottom,
                                        key: "legendBottom"
                                    }
                                },
                                openPanel: {
                                    title: t.res.addChartElement.legend.moreLegendOption,
                                    key: "legendOpenPanel"
                                }
                            }
                        },
                        this.wn = {
                            ColumnGroup: {
                                dataLabels: {
                                    needShow: !0,
                                    subTitle: {
                                        dataLabelsBestFit: {
                                            needShow: !1
                                        },
                                        dataLabelsAbove: {
                                            needShow: !1
                                        },
                                        dataLabelsBelow: {
                                            needShow: !1
                                        },
                                        dataLabelsShow: {
                                            needShow: !1
                                        }
                                    }
                                }
                            },
                            LineGroup: {
                                dataLabels: {
                                    needShow: !0,
                                    subTitle: {
                                        dataLabelsInsideEnd: {
                                            needShow: !1
                                        },
                                        dataLabelsOutsideEnd: {
                                            needShow: !1
                                        },
                                        dataLabelsBestFit: {
                                            needShow: !1
                                        },
                                        dataLabelsShow: {
                                            needShow: !1
                                        }
                                    }
                                }
                            },
                            PieGroup: {
                                axes: {
                                    needShow: !1
                                },
                                axisTitles: {
                                    needShow: !1
                                },
                                dataLabels: {
                                    needShow: !0,
                                    subTitle: {
                                        dataLabelsAbove: {
                                            needShow: !1
                                        },
                                        dataLabelsBelow: {
                                            needShow: !1
                                        },
                                        dataLabelsShow: {
                                            needShow: !1
                                        }
                                    }
                                },
                                gridLines: {
                                    needShow: !1
                                }
                            },
                            BarGroup: {
                                dataLabels: {
                                    needShow: !0,
                                    subTitle: {
                                        dataLabelsBestFit: {
                                            needShow: !1
                                        },
                                        dataLabelsAbove: {
                                            needShow: !1
                                        },
                                        dataLabelsBelow: {
                                            needShow: !1
                                        },
                                        dataLabelsShow: {
                                            needShow: !1
                                        }
                                    }
                                }
                            },
                            AreaGroup: {
                                dataLabels: {
                                    needShow: !0,
                                    subTitle: {
                                        dataLabelsCenter: {
                                            needShow: !1
                                        },
                                        dataLabelsInsideEnd: {
                                            needShow: !1
                                        },
                                        dataLabelsOutsideEnd: {
                                            needShow: !1
                                        },
                                        dataLabelsBestFit: {
                                            needShow: !1
                                        },
                                        dataLabelsAbove: {
                                            needShow: !1
                                        },
                                        dataLabelsBelow: {
                                            needShow: !1
                                        }
                                    }
                                }
                            },
                            ScatterGroup: {
                                dataLabels: {
                                    needShow: !0,
                                    subTitle: {
                                        dataLabelsInsideEnd: {
                                            needShow: !1
                                        },
                                        dataLabelsOutsideEnd: {
                                            needShow: !1
                                        },
                                        dataLabelsBestFit: {
                                            needShow: !1
                                        },
                                        dataLabelsShow: {
                                            needShow: !1
                                        }
                                    }
                                }
                            },
                            StockGroup: {
                                dataLabels: {
                                    needShow: !1
                                },
                                legend: {
                                    needShow: !1
                                }
                            },
                            ComboGroup: {}
                        }
                }
                a.prototype.xn = function() {
                    this.yn = this.zn(),
                        this.An = this.Bn(),
                        this.Cn = null,
                        this.Dn(),
                        this.En()
                }
                    ,
                    a.prototype.Dn = function() {
                        this.container.innerHTML = "";
                        for (var e in this.vn)
                            this.Fn(e) && this.container.appendChild(this.Gn(this.vn[e]))
                    }
                    ,
                    a.prototype.Bn = function() {
                        var e, t, i, n, r, a, s = [], l = o.getChartGroupString(this.yn.chartType());
                        if ("ComboGroup" === l) {
                            for (e = this.yn.series().get(),
                                     t = {},
                                     i = 0; i < e.length; i++)
                                n = e[i],
                                    r = o.getChartGroupString(n.chartType),
                                    t[r] = !0;
                            for (a in t)
                                t.hasOwnProperty(a) && s.push(a);
                            return s
                        }
                        return s.push(l),
                            s
                    }
                    ,
                    a.prototype.zn = function() {
                        var e, i, o = t.wrapper.spread.getActiveSheet().charts.all();
                        for (e = 0; e < o.length; e++)
                            if (i = o[e],
                                    i.isSelected())
                                return i
                    }
                    ,
                    a.prototype.Gn = function(e) {
                        var t = document.createElement("div")
                            , i = document.createElement("div")
                            , o = document.createElement("div")
                            , n = document.createElement("div")
                            , r = document.createElement("div");
                        return t.dataset.seriesKey = e.key,
                            t.className = "add-chart-element-item",
                            i.className = "imgItemContainer",
                            o.className = "imgItem",
                            $(o).addClass(e.key),
                            n.className = "textItem",
                            n.innerHTML = e.title,
                            r.className = "trangleItem",
                            i.appendChild(o),
                            t.appendChild(i),
                            t.appendChild(n),
                            t.appendChild(r),
                            t
                    }
                    ,
                    a.prototype.Hn = function(e) {
                        var t, i, o, n, r, a, s, l = document.getElementById("add-chart-element-submenu");
                        l.innerHTML = "",
                            t = document.createElement("div"),
                            t.className = "add-chart-element-container-subMenu",
                            i = this.vn[e].subTitle,
                            o = this.vn[e].key;
                        for (n in i)
                            this.In(e, n) && (r = i[n].key,
                                a = !1,
                                "gridLinesPrimaryMajorHorizontal" === r || "gridLinesPrimaryMajorVertical" === r || "gridLinesPrimaryMinorHorizontal" === r || "gridLinesPrimaryMinorVertical" === r || "axesPrimaryHorizontal" === r || "axesPrimaryVertical" === r || "axesTitlesPrimaryHorizontal" === r || "axesTitlesPrimaryVertical" === r ? (s = this.yn.axes(),
                                s.primaryCategory && s.primaryValue && (a = this.Jn(o, r),
                                    t.appendChild(this.Kn(i[n].title, o, i[n].key, a)))) : "gridLinesSecondaryMajorHorizontal" === r || "gridLinesSecondaryMajorVertical" === r || "gridLinesSecondaryMinorHorizontal" === r || "gridLinesSecondaryMinorVertical" === r || "axesSecondaryHorizontal" === r || "axesSecondaryVertical" === r || "axesTitlesSecondaryHorizontal" === r || "axesTitlesSecondaryVertical" === r ? (s = this.yn.axes(),
                                s.secondaryCategory && s.secondaryValue && (a = this.Jn(o, r),
                                    t.appendChild(this.Kn(i[n].title, o, i[n].key, a)))) : (a = this.Jn(o, r),
                                    t.appendChild(this.Kn(i[n].title, o, i[n].key, a))));
                        return this.vn[e].openPanel && t.appendChild(this.Ln(this.vn[e].openPanel)),
                            l.appendChild(t),
                            this.Mn(),
                            l
                    }
                    ,
                    a.prototype.Kn = function(e, t, i, n) {
                        var r, a, s = this.yn.chartType(), l = document.createElement("div"), c = document.createElement("div"), d = document.createElement("div"), p = document.createElement("div");
                        return l.className = "add-chart-element-subItem",
                            l.dataset.parentKey = t,
                            l.dataset.selfKey = i,
                            c.className = "imgItemContainer",
                            $(c).addClass(n ? "img-item-choosed" : "img-item-no-choose"),
                            p.className = "imgItem",
                            r = i,
                            a = o.getChartGroupString(s),
                        "dataLabels" !== t || null === s || void 0 === s || "ScatterGroup" !== a && "LineGroup" !== a && "PieGroup" !== a || (r = r + "-" + a),
                            $(p).addClass(r),
                            d.className = "textItem",
                            d.innerHTML = e,
                            c.appendChild(p),
                            l.appendChild(c),
                            l.appendChild(d),
                            l
                    }
                    ,
                    a.prototype.Jn = function(e, t) {
                        var i, r, a, s, l, c, d, p = !1, u = this;
                        switch (e) {
                            case "axes":
                                switch (t) {
                                    case "axesPrimaryHorizontal":
                                        i = o.getChartAxesItem(u.yn, n.axesPrimaryHorizontal);
                                        break;
                                    case "axesPrimaryVertical":
                                        i = o.getChartAxesItem(u.yn, n.axesPrimaryVertical);
                                        break;
                                    case "axesSecondaryHorizontal":
                                        i = o.getChartAxesItem(u.yn, n.axesSecondaryHorizontal);
                                        break;
                                    case "axesSecondaryVertical":
                                        i = o.getChartAxesItem(u.yn, n.axesSecondaryVertical);
                                        break;
                                    default:
                                        i = {}
                                }
                                null !== i.visible && void 0 !== i.visible && (p = i.visible);
                                break;
                            case "axisTitles":
                                switch (t) {
                                    case "axesTitlesPrimaryHorizontal":
                                        i = o.getChartAxesItem(u.yn, n.axesPrimaryHorizontal);
                                        break;
                                    case "axesTitlesPrimaryVertical":
                                        i = o.getChartAxesItem(u.yn, n.axesPrimaryVertical);
                                        break;
                                    case "axesTitlesSecondaryHorizontal":
                                        i = o.getChartAxesItem(u.yn, n.axesSecondaryHorizontal);
                                        break;
                                    case "axesTitlesSecondaryVertical":
                                        i = o.getChartAxesItem(u.yn, n.axesSecondaryVertical);
                                        break;
                                    default:
                                        i = {}
                                }
                                i.title && i.title.text && (p = "" !== i.title.text);
                                break;
                            case "chartTitle":
                                switch (r = u.yn.title(),
                                    t) {
                                    case "chartTitleNone":
                                        p = !r || "" === r.text;
                                        break;
                                    case "chartTitleAboveChart":
                                        p = !!r && "" !== r.text
                                }
                                break;
                            case "dataLabels":
                                if (a = u.yn.dataLabels(),
                                        s = GC.Spread.Sheets.Charts.DataLabelPosition,
                                    "dataLabelsNone" !== t && !1 === a.showValue) {
                                    p = !1;
                                    break
                                }
                                switch (t) {
                                    case "dataLabelsNone":
                                        p = !1 === a.showValue;
                                        break;
                                    case "dataLabelsCenter":
                                        p = a.position === s.center;
                                        break;
                                    case "dataLabelsInsideEnd":
                                        p = a.position === s.insideEnd;
                                        break;
                                    case "dataLabelsOutsideEnd":
                                        p = a.position === s.outsideEnd;
                                        break;
                                    case "dataLabelsBestFit":
                                        p = a.position === s.bestFit;
                                        break;
                                    case "dataLabelsLeft":
                                        p = a.position === s.left;
                                        break;
                                    case "dataLabelsRight":
                                        p = a.position === s.right;
                                        break;
                                    case "dataLabelsAbove":
                                        p = a.position === s.above;
                                        break;
                                    case "dataLabelsBelow":
                                        p = a.position === s.below;
                                        break;
                                    case "dataLabelsShow":
                                        p = !0 === a.showValue
                                }
                                break;
                            case "gridLines":
                                switch (l = u.yn.axes(),
                                    t) {
                                    case "gridLinesPrimaryMajorHorizontal":
                                        p = !0 === l.primaryValue.majorGridLine.visible;
                                        break;
                                    case "gridLinesPrimaryMajorVertical":
                                        p = !0 === l.primaryCategory.majorGridLine.visible;
                                        break;
                                    case "gridLinesPrimaryMinorHorizontal":
                                        p = !0 === l.primaryValue.minorGridLine.visible;
                                        break;
                                    case "gridLinesPrimaryMinorVertical":
                                        p = !0 === l.primaryCategory.minorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMajorHorizontal":
                                        p = !0 === l.secondaryValue.majorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMajorVertical":
                                        p = !0 === l.secondaryCategory.majorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMinorHorizontal":
                                        p = !0 === l.secondaryValue.minorGridLine.visible;
                                        break;
                                    case "gridLinesSecondaryMinorVertical":
                                        p = !0 === l.secondaryCategory.minorGridLine.visible
                                }
                                break;
                            case "legend":
                                if (c = u.yn.legend(),
                                        d = GC.Spread.Sheets.Charts.LegendPosition,
                                    "legendNone" !== t && !1 === c.visible) {
                                    p = !1;
                                    break
                                }
                                switch (t) {
                                    case "legendNone":
                                        p = !1 === c.visible;
                                        break;
                                    case "legendRight":
                                        p = c.position === d.right;
                                        break;
                                    case "legendTop":
                                        p = c.position === d.top;
                                        break;
                                    case "legendLeft":
                                        p = c.position === d.left;
                                        break;
                                    case "legendBottom":
                                        p = c.position === d.bottom
                                }
                        }
                        return p
                    }
                    ,
                    a.prototype.Ln = function(e) {
                        var t, i = document.createElement("div");
                        return i.className = " add-chart-element-subItem add-chart-element-openPanel-MenuItem",
                            i.innerHTML = e.title,
                            i.dataset.selfKey = e.key,
                            i.dataset.type = "openPanelMenuItem",
                            t = this,
                            $(i).click(function() {
                                t.Nn(e.key),
                                    t.On()
                            }),
                            i
                    }
                    ,
                    a.prototype.Nn = function(e) {
                        var i, n, a, s, l = {
                            AxesOpenPanel: "axis",
                            axisTitlesOpenPanel: "axis",
                            chartTitleOpenPanel: "chartTitle",
                            dataLabelsOpenPanel: "label",
                            gridLinesOpenPanel: "",
                            legendOpenPanel: "legend"
                        };
                        e && ("AxesOpenPanel" === e ? (i = l[e],
                            n = "primaryCategory") : "axisTitlesOpenPanel" === e ? (a = this.yn.axes(),
                            "" !== a.primaryCategory.title.text ? n = "primaryCategoryTitle" : "" !== a.primaryValue.title.text ? n = "primaryValueTitle" : a.secondaryCategory && "" !== a.secondaryCategory.title.text ? n = "secondaryCategoryTitle" : a.secondaryValue && "" !== a.secondaryValue.title.text ? n = "secondaryValueTitle" : (a.primaryCategory.title.text = "Axis Title",
                                a.primaryCategory.title.fontSize = 14,
                                t.actions.doAction("changeChartElement", t.wrapper.spread, {
                                    axes: a
                                }),
                                n = "primaryCategoryTitle"),
                            i = l[e]) : (i = l[e],
                            n = l[e]),
                            s = o.getChartSeriesNames(this.yn),
                            r.initChartSliderPanel(this.yn, i, n, s))
                    }
                    ,
                    a.prototype.Pn = function(e, t, i) {
                        e && e.removeClass(i),
                        t && t.addClass(i)
                    }
                    ,
                    a.prototype.Qn = function() {
                        var e, t = $(this.un).find(".add-chart-element-item");
                        this.Pn(t, null, "add-chart-element-item-active"),
                            e = $(this.un).find(".add-chart-element-subItem"),
                            this.Pn(e, null, "add-chart-element-subItem-active"),
                        this.Cn && this.Cn.gcuipopup("hide")
                    }
                    ,
                    a.prototype.Rn = function(e) {
                        var t, i = $(this.un).find(".add-chart-element-item");
                        this.Pn(i, $(e.currentTarget), "add-chart-element-item-active"),
                            t = $(e.currentTarget).data("seriesKey"),
                            this.Hn(t),
                        this.Cn || (this.Cn = $("#add-chart-element-submenu").gcuipopup({
                            autoHide: !1
                        })),
                            this.Cn.gcuipopup("show", {
                                of: e.currentTarget,
                                my: "left top",
                                at: "right top"
                            })
                    }
                    ,
                    a.prototype.En = function() {
                        var e = this
                            , t = $(this.un).find(".add-chart-element-item");
                        t.click(function(t) {
                            e.Rn(t)
                        }),
                            t.mouseenter(function(t) {
                                e.Rn(t)
                            })
                    }
                    ,
                    a.prototype.On = function() {}
                    ,
                    a.prototype.Mn = function() {
                        var e = $(this.un).find(".add-chart-element-subItem")
                            , i = this;
                        e.mouseenter(function(t) {
                            i.Pn(e, $(t.currentTarget), "add-chart-element-subItem-active")
                        }),
                            e.click(function(e) {
                                var r, a, s, l, c, d, p, u, h, f, g, m = $(e.currentTarget).data("parentKey"), b = $(e.currentTarget).data("selfKey"), v = $(e.currentTarget).data("type");
                                if ("openPanelMenuItem" !== v) {
                                    switch (r = {},
                                        m) {
                                        case "axes":
                                            switch (b) {
                                                case "axesPrimaryHorizontal":
                                                    a = n.axesPrimaryHorizontal;
                                                    break;
                                                case "axesPrimaryVertical":
                                                    a = n.axesPrimaryVertical;
                                                    break;
                                                case "axesSecondaryHorizontal":
                                                    a = n.axesSecondaryHorizontal;
                                                    break;
                                                case "axesSecondaryVertical":
                                                    a = n.axesSecondaryVertical
                                            }
                                            r = o.getChartAxesItem(i.yn, a),
                                            null !== r.visible && void 0 !== r.visible && (r.visible = !r.visible,
                                                s = o.setChartAxesItem(i.yn, a, r),
                                                t.actions.doAction("changeChartElement", t.wrapper.spread, {
                                                    axes: s
                                                }));
                                            break;
                                        case "axisTitles":
                                            switch (l = i.yn.axes(),
                                                c = "Axis Title",
                                                l.primaryCategory && l.primaryCategory.title && l.primaryCategory.title.text ? c = l.primaryCategory.title.text : l.primaryValue && l.primaryValue.title && l.primaryValue.title.text && (c = l.primaryValue.title.text),
                                                b) {
                                                case "axesTitlesPrimaryHorizontal":
                                                    a = n.axesPrimaryHorizontal;
                                                    break;
                                                case "axesTitlesPrimaryVertical":
                                                    a = n.axesPrimaryVertical;
                                                    break;
                                                case "axesTitlesSecondaryHorizontal":
                                                    a = n.axesSecondaryHorizontal;
                                                    break;
                                                case "axesTitlesSecondaryVertical":
                                                    a = n.axesSecondaryVertical
                                            }
                                            r = o.getChartAxesItem(i.yn, a),
                                                "" !== r.title.text ? r.title.text = "" : r.title.text = c,
                                                r.title.fontSize = 14,
                                                l = o.setChartAxesItem(i.yn, a, r),
                                                t.actions.doAction("changeChartElement", t.wrapper.spread, {
                                                    axes: l
                                                });
                                            break;
                                        case "chartTitle":
                                            switch (d = i.yn.title(),
                                                b) {
                                                case "chartTitleNone":
                                                    d && d.text && (d.text = "");
                                                    break;
                                                case "chartTitleAboveChart":
                                                    d && d.text ? d.text = "" === d.text ? "Chart Title" : d.text : d = {
                                                        text: "Chart Title"
                                                    }
                                            }
                                            t.actions.doAction("changeChartElement", t.wrapper.spread, {
                                                title: d
                                            });
                                            break;
                                        case "dataLabels":
                                            switch (p = i.yn.dataLabels(),
                                                p.showValue = !0,
                                                p.showSeriesName = !1,
                                                p.showCategoryName = !1,
                                                u = GC.Spread.Sheets.Charts.DataLabelPosition,
                                                b) {
                                                case "dataLabelsNone":
                                                    p.showValue = !1;
                                                    break;
                                                case "dataLabelsCenter":
                                                    p.position = u.center;
                                                    break;
                                                case "dataLabelsInsideEnd":
                                                    p.position = u.insideEnd;
                                                    break;
                                                case "dataLabelsOutsideEnd":
                                                    p.position = u.outsideEnd;
                                                    break;
                                                case "dataLabelsBestFit":
                                                    p.position = u.bestFit;
                                                    break;
                                                case "dataLabelsLeft":
                                                    p.position = u.left;
                                                    break;
                                                case "dataLabelsRight":
                                                    p.position = u.right;
                                                    break;
                                                case "dataLabelsAbove":
                                                    p.position = u.above;
                                                    break;
                                                case "dataLabelsBelow":
                                                    p.position = u.below;
                                                    break;
                                                case "dataLabelsShow":
                                                    p.showValue = !0
                                            }
                                            t.actions.doAction("changeChartElement", t.wrapper.spread, {
                                                dataLabels: p
                                            });
                                            break;
                                        case "gridLines":
                                            switch (h = i.yn.axes(),
                                                b) {
                                                case "gridLinesPrimaryMajorHorizontal":
                                                    h.primaryValue.majorGridLine.visible = !h.primaryValue.majorGridLine.visible;
                                                    break;
                                                case "gridLinesPrimaryMajorVertical":
                                                    h.primaryCategory.majorGridLine.visible = !h.primaryCategory.majorGridLine.visible;
                                                    break;
                                                case "gridLinesPrimaryMinorHorizontal":
                                                    h.primaryValue.minorGridLine.visible = !h.primaryValue.minorGridLine.visible;
                                                    break;
                                                case "gridLinesPrimaryMinorVertical":
                                                    h.primaryCategory.minorGridLine.visible = !h.primaryCategory.minorGridLine.visible;
                                                    break;
                                                case "gridLinesSecondaryMajorHorizontal":
                                                    h.secondaryValue.majorGridLine.visible = !h.secondaryValue.majorGridLine.visible;
                                                    break;
                                                case "gridLinesSecondaryMajorVertical":
                                                    h.secondaryCategory.majorGridLine.visible = !h.secondaryCategory.majorGridLine.visible;
                                                    break;
                                                case "gridLinesSecondaryMinorHorizontal":
                                                    h.secondaryValue.minorGridLine.visible = !h.secondaryValue.minorGridLine.visible;
                                                    break;
                                                case "gridLinesSecondaryMinorVertical":
                                                    h.secondaryCategory.minorGridLine.visible = !h.secondaryCategory.minorGridLine.visible
                                            }
                                            t.actions.doAction("changeChartElement", t.wrapper.spread, {
                                                axes: h
                                            });
                                            break;
                                        case "legend":
                                            switch (f = i.yn.legend(),
                                                f.visible = !0,
                                                g = GC.Spread.Sheets.Charts.LegendPosition,
                                                b) {
                                                case "legendNone":
                                                    f.visible = !1;
                                                    break;
                                                case "legendRight":
                                                    f.position = g.right;
                                                    break;
                                                case "legendTop":
                                                    f.position = g.top;
                                                    break;
                                                case "legendLeft":
                                                    f.position = g.left;
                                                    break;
                                                case "legendBottom":
                                                    f.position = g.bottom
                                            }
                                            t.actions.doAction("changeChartElement", t.wrapper.spread, {
                                                legend: f
                                            })
                                    }
                                    i.On()
                                }
                            })
                    }
                    ,
                    a.prototype.Fn = function(e) {
                        var t, i, o;
                        for (t = 0; t < this.An.length; t++)
                            if (i = this.An[t],
                                    o = this.wn[i] || {},
                                !o[e] || o[e].needShow)
                                return !0;
                        return !1
                    }
                    ,
                    a.prototype.In = function(e, t) {
                        var i, n, r, a, s;
                        if (this.An.length > 0) {
                            if (i = this.An[0],
                                    n = this.wn[i] || {},
                                    r = o.getChartTypeString(this.yn.chartType()),
                                    a = n[e] || {},
                                    s = a.subTitle || {},
                                "doughnut" === r && "dataLabels" === e) {
                                if ("dataLabelsCenter" === t || "dataLabelsInsideEnd" === t || "dataLabelsOutsideEnd" === t || "dataLabelsBestFit" === t)
                                    return !1;
                                if ("dataLabelsShow" === t)
                                    return !0
                            }
                            if (s[t] && !s[t].needShow)
                                return !1
                        }
                        return !0
                    }
                    ,
                    e.exports = a
            }()
        }
        , function(e, t) {
            !function() {
                "use strict";
                function t(e, t) {
                    this.Sn = t,
                        this.Tn = $(e),
                        this._init()
                }
                t.prototype._init = function() {
                    var e, t = this, i = t.Sn, o = t.Tn, n = $("<div>").addClass("chart-colorpicker-container");
                    n.appendTo(o),
                        t.Un = n;
                    for (e in i)
                        i.hasOwnProperty(e) && t.Vn(e)
                }
                    ,
                    t.prototype.Vn = function(e) {
                        var t, i, o, n, r, a = this, s = a.Un, l = a.Sn, c = l[e], d = c.name, p = c.colors, u = $("<div>").addClass("header-container").appendTo(s);
                        for ($("<span>").text(d).appendTo(u),
                                 t = $("<div>").addClass("group-content").appendTo(s),
                                 i = 0; i < p.length; i++)
                            o = p[i],
                                n = $("<div>").addClass("color-items-container " + e).attr("title", o.tip).appendTo(t).data("index", i),
                                n.click(function(t) {
                                    a.Wn(e, $(t.currentTarget).data("index"))
                                }),
                                r = o.items,
                                r.forEach(function(e) {
                                    $("<div>").addClass("color-item").css({
                                        "background-color": e
                                    }).appendTo(n)
                                })
                    }
                    ,
                    t.prototype.Wn = function(e, t) {
                        var i = this;
                        i.Xn = e,
                            i.Yn = t,
                            i.onSelectedColorChanged({
                                group: e,
                                index: t
                            }),
                            i.Zn()
                    }
                    ,
                    t.prototype.onSelectedColorChanged = function(e) {}
                    ,
                    t.prototype.setSelectedItem = function(e, t) {
                        var i = this;
                        i.Xn = e,
                            i.Yn = t,
                            i.Zn()
                    }
                    ,
                    t.prototype.Zn = function() {
                        var e, t = this, i = t.Tn, o = t.Xn, n = t.Yn;
                        i.find(".color-items-container").removeClass("selected"),
                            e = i.find("." + o)[n],
                            $(e).addClass("selected"),
                            e.scrollIntoView()
                    }
                    ,
                    e.exports = t
            }()
        }
        , function(e, t) {
            !function() {
                "use strict";
                var t = GC.Spread.Sheets.Charts.LegendPosition
                    , i = GC.Spread.Sheets.Charts.DataLabelPosition;
                function o(e, o, n) {
                    this.Un = e,
                        this.$n = n,
                        this._n = o,
                        this.options = {
                            selectedChartType: "ColumnGroup",
                            chartLayoutsData: {
                                ColumnGroup: [{
                                    name: "layout1",
                                    description: "Layout1\nChart Title\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout2",
                                    description: "Layout2\nChart Title\nLegend(Top)\nHorizontal Axis\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.top,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !1,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout3",
                                    description: "Layout3\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout4",
                                    description: "Layout4\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout5",
                                    description: "Layout5\nChart Title\nVertical Axis Title\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout6",
                                    description: "Layout6\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout7",
                                    description: "Layout7\nChart Title\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout8",
                                    description: "Layout8\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout9",
                                    description: "Layout9\nChart Title\nLegend(Right)\nDataLabels(Inside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        dataLabels: {
                                            position: i.insideEnd,
                                            showValue: !0
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout10",
                                    description: "Layout10\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        dataLabels: {
                                            position: i.insideEnd,
                                            showValue: !1
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }],
                                LineGroup: [{
                                    name: "layout1",
                                    description: "Layout1\nChart Title\nLegend(Right)\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout2",
                                    description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Center)\nHorizontal Axis\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.top,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !1,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout3",
                                    description: "Layout3\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout4",
                                    description: "Layout4\nLegend(Bottom)\nHorizontal Axis\nVertical Axis",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout5",
                                    description: "Layout5\nChart Title\nVertical Axis Title\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout6",
                                    description: "Layout6\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout7",
                                    description: "Layout7\nChart Title\nLegend(Bottom)\nDataLabels(Center)\nHorizontal Axis",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !1,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout8",
                                    description: "Layout8\nChart Title\nLegend(Right)\nDataLabels(Center)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout9",
                                    description: "Layout9\nOnly Series",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        dataLabels: {
                                            position: i.insideEnd,
                                            showValue: !1
                                        },
                                        legend: {
                                            visible: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !1,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !1,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout10",
                                    description: "Layout10\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }],
                                PieGroup: [{
                                    name: "layout1",
                                    description: "Layout1\nChart Title\nLegend(Right)\nDataLabels(Value and Percentage)\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !0,
                                            showPercentage: !0,
                                            showCategoryName: !1,
                                            showSeriesName: !1
                                        }
                                    }
                                }, {
                                    name: "layout2",
                                    description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Value and Percentage)\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.top,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !0,
                                            showPercentage: !0,
                                            showCategoryName: !1,
                                            showSeriesName: !1
                                        }
                                    }
                                }, {
                                    name: "layout3",
                                    description: "Layout3\nChart Title\nLegend(Bottom)\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1,
                                            showPercentage: !1,
                                            showCategoryName: !1,
                                            showSeriesName: !1
                                        }
                                    }
                                }, {
                                    name: "layout4",
                                    description: "Layout4\nLegend(Bottom)\nDataLabels(Category and Value)\n",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !0,
                                            showPercentage: !1,
                                            showCategoryName: !0,
                                            showSeriesName: !1
                                        }
                                    }
                                }, {
                                    name: "layout5",
                                    description: "Layout5\nChart Title\nDataLabels(Category)\n",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !1,
                                            showPercentage: !1,
                                            showCategoryName: !0,
                                            showSeriesName: !1
                                        }
                                    }
                                }, {
                                    name: "layout6",
                                    description: "Layout6\nChart Title\nLegend(Right)\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1,
                                            showPercentage: !1,
                                            showCategoryName: !1,
                                            showSeriesName: !1
                                        }
                                    }
                                }, {
                                    name: "layout7",
                                    description: "Layout7\nChart Title\nLegend(Right)\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        dataLabels: {
                                            position: i.insideEnd,
                                            showValue: !1,
                                            showPercentage: !1,
                                            showCategoryName: !1,
                                            showSeriesName: !1
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        }
                                    }
                                }],
                                BarGroup: [{
                                    name: "layout1",
                                    description: "Layout1\nChart Title\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout2",
                                    description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Outside End)\nVertical Axis\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.top,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !1,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout3",
                                    description: "Layout3\nChart Title\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout4",
                                    description: "Layout4\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout5",
                                    description: "Layout5\nChart Title\nHorizontal Axis Title\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout6",
                                    description: "Layout6\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout7",
                                    description: "Layout7\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout8",
                                    description: "Layout8\nChart Title\nLegend(Right)\nDataLabels(Inside End)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.insideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout9",
                                    description: "Layout9\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }],
                                AreaGroup: [{
                                    name: "layout1",
                                    description: "Layout1\nChart Title\nLegend(Right)\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout2",
                                    description: "Layout2\nChart Title\nLegend(Top)\nHorizontal Axis\nVertical Axis\nMajor Gridlines\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.top,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout3",
                                    description: "Layout3\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout4",
                                    description: "Layout4\nLegend(Bottom)\nDataLabels(Outside End)\nHorizontal Axis\nVertical Axis",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout5",
                                    description: "Layout5\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout6",
                                    description: "Layout6\nChart Title\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout7",
                                    description: "Layout7\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }],
                                ScatterGroup: [{
                                    name: "layout1",
                                    description: "Layout1\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout2",
                                    description: "Layout2\nChart Title\nLegend(Top)\nDataLabels(Center)\nHorizontal Axis\n",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.top,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !1,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout3",
                                    description: "Layout3\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nHorizontal Axis Major Gridlines\nHorizontal Axis Minor Gridlines\nVertical Axis Major Gridlines\nVertical Axis Minor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout4",
                                    description: "Layout4\nLegend(Bottom)\nHorizontal Axis\nVertical Axis",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout5",
                                    description: "Layout5\nChart Title\nLegend(Right)\nX and Y DataLabels(Above)\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.above,
                                            showCategory: !0,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout6",
                                    description: "Layout6\nChart Title\nLegend(Right)\nHorizontal Axis Title\nVertical Axis Title\nDataLabels(Above)\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.above,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout7",
                                    description: "Layout7\nChart Title\nLegend(Right)\nX and Y DataLabels(Above)\nHorizontal Axis\nVertical AxisHorizontal Axis Major Gridlines\nVertical Axis Major Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.above,
                                            showCategory: !0,
                                            showValue: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout8",
                                    description: "Layout8\nChart Title\nLegend(Bottom)\nHorizontal Axis\nVertical Axis\nHorizontal Axis Major Gridlines\nVertical Axis Major Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: ""
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout9",
                                    description: "Layout9\nLegend(Right)\nHorizontal Axis\nVertical Axis\nVertical Axis Major Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        dataLabels: {
                                            position: i.insideEnd,
                                            showValue: !1
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            }
                                        }
                                    }
                                }],
                                StockGroup: [{
                                    name: "layout1",
                                    description: "Layout1\nChart Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout2",
                                    description: "Layout2\nHorizontal Axis\nVertical Axis",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.top,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout3",
                                    description: "Layout3\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines\nMinor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !0
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout4",
                                    description: "Layout4\nChart Title\nHorizontal Axis Title\nVertical Axis Title\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: "Chart Title"
                                        },
                                        legend: {
                                            position: t.bottom,
                                            visible: !1
                                        },
                                        dataLabels: {
                                            position: i.center,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                },
                                                title: {
                                                    text: "Axis Title"
                                                }
                                            }
                                        }
                                    }
                                }, {
                                    name: "layout5",
                                    description: "Layout5\nLegend(Right)\nHorizontal Axis\nVertical Axis\nMajor Gridlines",
                                    value: {
                                        title: {
                                            text: ""
                                        },
                                        legend: {
                                            position: t.right,
                                            visible: !0
                                        },
                                        dataLabels: {
                                            position: i.outsideEnd,
                                            showValue: !1
                                        },
                                        axes: {
                                            primaryCategory: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !1
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            },
                                            primaryValue: {
                                                visible: !0,
                                                majorGridLine: {
                                                    visible: !0
                                                },
                                                minorGridLine: {
                                                    visible: !1
                                                }
                                            }
                                        }
                                    }
                                }]
                            }
                        },
                        this.ao()
                }
                o.prototype.ao = function() {
                    var e = this
                        , t = e._n || e.options.selectedChartType;
                    e.bo(t),
                        e.Un.bind("selectstart", function() {
                            return !1
                        })
                }
                    ,
                    o.prototype.bo = function(e) {
                        var t, i, o, n, r = this, a = r.options;
                        if (e || a.chartLayoutsData[e]) {
                            for (r.co(),
                                     r.Un.empty(),
                                     t = $("<ul class='chart-layout-list'></ul>"),
                                     t.addClass("chart-layout-" + e),
                                     i = a.chartLayoutsData[e],
                                     o = 0; o < i.length; o++)
                                n = r.do(e, i[o]),
                                    n.appendTo(t);
                            t.appendTo(r.Un),
                                r.eo()
                        }
                    }
                    ,
                    o.prototype._setOption = function(e) {
                        var t = this;
                        t._n = e,
                            t.bo(e)
                    }
                    ,
                    o.prototype.do = function(e, t) {
                        var i = $("<li class='chart-layout-list-item'></li>")
                            , o = $("<span></span>");
                        return o.addClass("chart-layout-icon"),
                            o.addClass(t.name),
                            i.attr("title", t.description),
                            i.attr("data-name", e),
                            o.appendTo(i),
                            i
                    }
                    ,
                    o.prototype.eo = function() {
                        var e = this;
                        this.Un.find(".chart-layout-list-item").on("mouseover.chartlayoutpicker", function(t) {
                            e.Un.find(".chart-layout-list-item").removeClass("chart-layout-hover"),
                                $(t.currentTarget).addClass("chart-layout-hover")
                        }),
                            this.Un.find(".chart-layout-list-item").click(function(t) {
                                var i, o, n, r = e.Un.find(".chart-layout-list-item");
                                r.removeClass("chart-layout-selected"),
                                    $(t.currentTarget).addClass("chart-layout-selected"),
                                    i = $(t.currentTarget).data("name"),
                                    o = r.index($(t.currentTarget)),
                                    n = e.options.chartLayoutsData[i][o].value,
                                    e.fo(t, n)
                            })
                    }
                    ,
                    o.prototype.fo = function(e, t) {
                        var i = this;
                        i.$n && i.$n instanceof Function && i.$n.call(i, e, t)
                    }
                    ,
                    o.prototype.dispose = function() {
                        this.co(),
                            this.Un = null,
                            this.$n = null,
                            this.ho = null
                    }
                    ,
                    o.prototype.co = function() {
                        this.Un.find(".chart-layout-list-item").off("chartlayoutpicker")
                    }
                    ,
                    e.exports = o
            }()
        }
        , function(e, t) {
            !function() {
                "use strict";
                var t = GC.Spread.Sheets.Designer;
                function i(e, i) {
                    this.Un = e,
                        this.$n = i,
                        this.options = {
                            chartTypeData: {
                                columnType: {
                                    icon: "select-series-type-column",
                                    text: t.res.selectChartDialog.column,
                                    items: [{
                                        icon: "clustered-column-icon",
                                        tag: t.res.selectChartDialog.columnClustered,
                                        value: "columnClustered"
                                    }, {
                                        icon: "stacked-column-icon",
                                        tag: t.res.selectChartDialog.columnStacked,
                                        value: "columnStacked"
                                    }, {
                                        icon: "stacked100-column-icon",
                                        tag: t.res.selectChartDialog.columnClustered,
                                        value: "columnStacked100"
                                    }]
                                },
                                barType: {
                                    icon: "select-series-type-bar",
                                    text: t.res.selectChartDialog.bar,
                                    items: [{
                                        icon: "clustered-bar-icon",
                                        tag: t.res.selectChartDialog.barClustered,
                                        value: "barClustered"
                                    }, {
                                        icon: "stacked-bar-icon",
                                        tag: t.res.selectChartDialog.barStacked,
                                        value: "barStacked"
                                    }, {
                                        icon: "stacked100-bar-icon",
                                        tag: t.res.selectChartDialog.barStacked100,
                                        value: "barStacked100"
                                    }]
                                },
                                lineType: {
                                    icon: "select-series-type-line",
                                    text: t.res.selectChartDialog.line,
                                    items: [{
                                        icon: "line-icon",
                                        tag: t.res.selectChartDialog.line,
                                        value: "line"
                                    }, {
                                        icon: "stacked-line-icon",
                                        tag: t.res.selectChartDialog.lineStacked,
                                        value: "lineStacked"
                                    }, {
                                        icon: "stacked100-line-icon",
                                        tag: t.res.selectChartDialog.lineStacked100,
                                        value: "lineStacked100"
                                    }, {
                                        icon: "line-with-markers-icon",
                                        tag: t.res.selectChartDialog.lineMarkers,
                                        value: "lineMarkers"
                                    }, {
                                        icon: "stacked-line-with-markers-icon",
                                        tag: t.res.selectChartDialog.lineMarkersStacked,
                                        value: "lineMarkersStacked"
                                    }, {
                                        icon: "stacked100-line-with-markers-icon",
                                        tag: t.res.selectChartDialog.lineMarkersStacked100,
                                        value: "lineMarkersStacked100"
                                    }]
                                },
                                areaType: {
                                    icon: "select-series-type-area",
                                    text: t.res.selectChartDialog.area,
                                    items: [{
                                        icon: "area-icon",
                                        tag: t.res.selectChartDialog.area,
                                        value: "area"
                                    }, {
                                        icon: "stacked-area-icon",
                                        tag: t.res.selectChartDialog.areaStacked,
                                        value: "areaStacked"
                                    }, {
                                        icon: "stacked100-area-icon",
                                        tag: t.res.selectChartDialog.areaStacked100,
                                        value: "areaStacked100"
                                    }]
                                },
                                scatterType: {
                                    icon: "select-series-type-scatter",
                                    text: t.res.selectChartDialog.xyScatter,
                                    items: [{
                                        icon: "scatter-icon",
                                        tag: t.res.selectChartDialog.xyScatter,
                                        value: "xyScatter"
                                    }, {
                                        icon: "scatter-with-smooth-lines-and-markers-icon",
                                        tag: t.res.selectChartDialog.xyScatterSmooth,
                                        value: "xyScatterSmooth"
                                    }, {
                                        icon: "scatter-with-smooth-lines-icon",
                                        tag: t.res.selectChartDialog.xyScatterSmoothNoMarkers,
                                        value: "xyScatterSmoothNoMarkers"
                                    }, {
                                        icon: "scatter-with-straight-lines-and-markers-icon",
                                        tag: t.res.selectChartDialog.xyScatterLines,
                                        value: "xyScatterLines"
                                    }, {
                                        icon: "scatter-with-straight-lines-icon",
                                        tag: t.res.selectChartDialog.xyScatterLinesNoMarkers,
                                        value: "xyScatterLinesNoMarkers"
                                    }]
                                }
                            }
                        },
                        this.io()
                }
                i.prototype.io = function() {
                    var e = this
                        , t = e.jo();
                    t.appendTo(e.Un),
                        e.updateSelectedStatus(GC.Spread.Sheets.Charts.ChartType.columnClustered),
                        e.Un.bind("selectstart", function() {
                            return !1
                        }),
                        e.eo()
                }
                    ,
                    i.prototype.jo = function() {
                        var e, t, i = this.options, o = $("<ul class='series-chart-types-list'></ul>");
                        for (e in i.chartTypeData)
                            i.chartTypeData.hasOwnProperty(e) && (t = this.ko(i.chartTypeData[e]),
                                t.appendTo(o));
                        return o
                    }
                    ,
                    i.prototype.ko = function(e) {
                        var t, i, o, n = $("<li class='series-chart-types-list-item column-type'></li>"), r = $("<div class='series-chart-types-list-item-title'></div>"), a = $("<span class='series-chart-types-list-item-title-icon'></span>");
                        for (a.addClass(e.icon),
                                 a.appendTo(r),
                                 t = $("<span class='series-chart-types-list-item-title-text'></span>"),
                                 t.text(e.text),
                                 t.appendTo(r),
                                 r.appendTo(n),
                                 i = 0; i < e.items.length; i++)
                            o = this.lo(e.items[i]),
                                o.appendTo(n);
                        return n
                    }
                    ,
                    i.prototype.lo = function(e) {
                        var t, i = $("<div class='series-chart-type-item'></div>");
                        return i.attr("data-name", e.value),
                            i.attr("data-bind", e.tag),
                            t = $("<span class='chart-type-subtype-icon'></span>"),
                            t.addClass(e.icon),
                            t.appendTo(i),
                            i
                    }
                    ,
                    i.prototype.eo = function() {
                        var e = this;
                        e.Un.find(".series-chart-type-item").on("mouseover.chartTypePicker", function(t) {
                            e.Un.find(".series-chart-type-item").removeClass("chart-type-hover"),
                                $(t.currentTarget).addClass("chart-type-hover")
                        }),
                            e.Un.find(".series-chart-type-item").on("mousedown.chartTypePicker", function(t) {
                                e.Un.find(".series-chart-type-item").removeClass("chart-type-selected"),
                                    $(t.currentTarget).addClass("chart-type-selected");
                                var i = $(t.currentTarget).data("name");
                                e.fo(t, i)
                            })
                    }
                    ,
                    i.prototype.fo = function(e, t) {
                        var i = this;
                        i.$n && i.$n instanceof Function && i.$n.call(i, e, t)
                    }
                    ,
                    i.prototype.updateSelectedStatus = function(e) {
                        this.Un.find(".series-chart-type-item").removeClass("chart-ui-selected"),
                            this.Un.find(".series-chart-type-item").removeClass("chart-type-hover"),
                            this.Un.find(".series-chart-type-item").removeClass("chart-type-selected"),
                            this.Un.find("[data-name=" + e + "]").addClass("chart-ui-selected")
                    }
                    ,
                    i.prototype.dispose = function() {
                        this.co(),
                            this.Un = null,
                            this.$n = null,
                            this.ho = null
                    }
                    ,
                    i.prototype.co = function() {
                        this.Un.find(".series-chart-type-item").off("chartTypePicker")
                    }
                    ,
                    e.exports = i
            }()
        }
        , function(e, t, i) {
            var o = i(0).app
                , n = GC.Spread.Sheets.Designer;
            !function(e) {
                "use strict";
                var t, i;
                e.rootFolder = "../",
                    t = [];
                function r(e) {
                    i || (ko.applyBindings({
                        res: n.res
                    }, document.body),
                        ko.applyBindings({
                            res: n.res
                        }, document.head));
                    for (var r = 0; r < t.length; r++)
                        t[r]();
                    t = [],
                        i ? (e.find(".loading-placeholder").addClass("hidden"),
                            o.notifyReady()) : setTimeout(function() {
                            e.find(".loading-placeholder").addClass("hidden"),
                                o.notifyReady()
                        }, 0),
                        i = !0
                }
                function a(e) {
                    t.push(e)
                }
                e.ready = a;
                function s() {
                    if (!e.rootFolder)
                        return "./";
                    var t = e.rootFolder.trim();
                    return "/" !== t.slice(-1) && (t += "/"),
                        t
                }
                function l(e) {
                    var t, i, o, a;
                    return void 0 === e && (e = $(document)),
                        t = s(),
                        i = e.find("[data-include]"),
                        o = [],
                        a = [],
                        i.each(function() {
                            var e = $(this)
                                , i = e.data("include")
                                , r = n.util.resolveHtmlPath(t + i, i + ".html");
                            o.push(n.util.loadHtml(r, "." + i, e))
                        }),
                        $.when.apply($, o).then(function() {
                            if (n.ribbon.addLocalFonts(),
                                0 !== a.length) {
                                var t = a.map(function(e) {
                                    return n.util.loadScript(e + ".js")
                                });
                                $.when.apply($, t).then(function() {
                                    r(e)
                                })
                            } else
                                r(e)
                        })
                }
                e.loadContent = l,
                    n.loader = e
            }(n.loader || {})
        }
        , function(e, t) {
            !function() {
                "use strict";
                var e = GC.Spread.Sheets.Designer
                    , t = function() {
                    function e() {}
                    return e.isThemeColor = function(e, t) {
                        return e.getColor(t) !== t
                    }
                        ,
                        e.hexToRgba = function(e) {
                            var t, i, o = [], n = [];
                            if (e = e.replace(/#/, ""),
                                3 === e.length) {
                                for (i = [],
                                         t = 0; t < 3; t++)
                                    i.push(e.charAt(t) + e.charAt(t));
                                e = i.join("")
                            }
                            for (t = 0; t < 3; t++)
                                o[t] = "0x" + e.substr(2 * t, 2),
                                    n.push(parseInt(+o[t]));
                            return "rgba(" + n.join(",") + ",1)"
                        }
                        ,
                        e.parse = function(t, i) {
                            var o, n, r, a, s, l;
                            if (!t)
                                return null;
                            if (e.rrggbbPattern.test(t) || e.rgbPattern.test(t) || e.rgbFunctionPattern.test(t) || e.rgbaFunctionPattern.test(t) || e.standardColorNames.indexOf(t.toLowerCase()) > -1)
                                return {
                                    baseColor: t,
                                    color: t
                                };
                            if (n = -1,
                                    r = t.split(" ")) {
                                if (r.length > 1) {
                                    if (void 0 === r[0] || null === r[0])
                                        throw "invalid color name.";
                                    if ("background" === (a = r[0].toLowerCase()))
                                        n = parseInt(r[1], 10) - 1;
                                    else if ("text" === a)
                                        n = parseInt(r[1], 10) + 1;
                                    else {
                                        if ("accent" !== a)
                                            throw "invalid color name.";
                                        n = parseInt(r[1], 10) + 3
                                    }
                                    o = r[0] + " " + r[1]
                                } else if (1 === r.length) {
                                    if (void 0 === r[0] || null === r[0])
                                        throw "invalid color name.";
                                    if ("transparent" === (s = r[0].toLowerCase()))
                                        return {
                                            color: "rgba(0,0,0,0)"
                                        };
                                    if ("hyperlink" !== s && "followedHyperlink" !== s)
                                        throw "invalid color name.";
                                    o = r[0]
                                }
                                if (l = 0,
                                    r.length > 2 && (l = parseInt(r[2], 10)),
                                    n >= 0 && n <= 11)
                                    return {
                                        name: t,
                                        baseColor: i.getColor(o),
                                        tint: l,
                                        color: i.getColor(t)
                                    }
                            }
                            throw "invalid color name."
                        }
                        ,
                        e.rrggbbPattern = /^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,
                        e.rgbPattern = /^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,
                        e.rgbFunctionPattern = /^rgb\(([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,
                        e.rgbaFunctionPattern = /^rgba\(([\s\d]*),([\s\d]*),([\s\d]*),([\s\d]*)\)$/i,
                        e.standardColorNames = ["aliceblue", "antiquewhite", "aqua", "aquamarine", "azure", "beige", "bisque", "black", "blanchedalmond", "blue", "blueviolet", "brown", "burlywood", "cadetblue", "chartreuse", "chocolate", "coral", "cornflowerblue", "cornsilk", "crimson", "cyan", "darkblue", "darkcyan", "darkgoldenrod", "darkgray", "darkgreen", "darkkhaki", "darkmagenta", "darkolivegreen", "darkorange", "darkorchid", "darkred", "darksalmon", "darkseagreen", "darkslateblue", "darkslategray", "darkturquoise", "darkviolet", "deeppink", "deepskyblue", "dimgray", "dodgerblue", "firebrick", "floralwhite", "forestgreen", "fuchsia", "gainsboro", "ghostwhite", "gold", "goldenrod", "gray", "green", "greenyellow", "honeydew", "hotpink", "indianred?", "indigo?", "ivory", "khaki", "lavender", "lavenderblush", "lawngreen", "lemonchiffon", "lightblue", "lightcoral", "lightcyan", "lightgoldenrodyellow", "lightgray", "lightgreen", "lightpink", "lightsalmon", "lightseagreen", "lightskyblue", "lightslategray", "lightsteelblue", "lightyellow", "lime", "limegreen", "linen", "magenta", "maroon", "mediumaquamarine", "mediumblue", "mediumorchid", "mediumpurple", "mediumseagreen", "mediumslateblue", "mediumspringgreen", "mediumturquoise", "mediumvioletred", "midnightblue", "mintcream", "mistyrose", "moccasin", "navajowhite", "navy", "oldlace", "olive", "olivedrab", "orange", "orangered", "orchid", "palegoldenrod", "palegreen", "paleturquoise", "palevioletred", "papayawhip", "peachpuff", "peru", "pink", "plum", "powderblue", "purple", "red", "rosybrown", "royalblue", "saddlebrown", "salmon", "sandybrown", "seagreen", "seashell", "sienna", "silver", "skyblue", "slateblue", "slategray", "snow", "springgreen", "steelblue", "tan", "teal", "thistle", "tomato", "turquoise", "violet", "wheat", "white", "whitesmoke", "yellow", "yellowgreen"],
                        e
                }();
                e.ColorHelper = t
            }()
        }
        , function(e, t) {
            !function() {
                "use strict";
                var e, t, i, o, n, r = GC.Spread.Sheets.Designer, a = GC.Spread.Sheets, s = void 0;
                r.PrimitiveTypes = {
                    STRING: "string",
                    NUMBER: "number",
                    BOOLEAN: "boolean",
                    OBJECT: "object",
                    FUNCTION: "function",
                    UNDEFINED: "undefined"
                },
                    e = function() {
                        function e(e, t, i) {
                            this.mo = e,
                                this.oo = t,
                                this.po = i
                        }
                        return e.prototype.qo = function(e) {
                            var t, i = this.oo.properties[e], o = i.getter;
                            if (void 0 !== o) {
                                if (typeof o === r.PrimitiveTypes.STRING) {
                                    if (typeof (t = this.mo[o]) !== r.PrimitiveTypes.FUNCTION)
                                        throw 'metadata invalide. source object "' + this.mo + '" have no a function named "' + o + '".';
                                    o = t
                                }
                                if (typeof o !== r.PrimitiveTypes.FUNCTION)
                                    throw 'metadata invalide. expect a "function" for getter of property "' + e + '" of type "' + this.oo + '", but actual is a "' + typeof o + '"'
                            } else
                                typeof (o = this.mo[e]) !== r.PrimitiveTypes.FUNCTION && (o = function() {
                                        return this[e]
                                    }
                                );
                            return o.apply(this.mo)
                        }
                            ,
                            e.prototype.ro = function(t, i) {
                                var o, n = this.oo.properties[t], a = n.setter;
                                if (void 0 !== a) {
                                    if (typeof a === r.PrimitiveTypes.STRING) {
                                        if (typeof (o = this.mo[a]) !== r.PrimitiveTypes.FUNCTION)
                                            throw 'metadata invalide. source object "' + this.mo + '" have no a function named "' + a + '".';
                                        a = o
                                    }
                                    if (typeof a !== r.PrimitiveTypes.FUNCTION)
                                        throw 'metadata invalide. expect a "function" for setter of property "' + t + '" of type "' + this.oo + '", but actual is a "' + typeof a + '"'
                                } else
                                    typeof (a = this.mo[t]) !== r.PrimitiveTypes.FUNCTION && (a = function(e) {
                                            this[t] = e
                                        }
                                    );
                                typeof i !== n.type && (i = e.so(i, n.type)),
                                    a.call(this.mo, i)
                            }
                            ,
                            e.so = function(e, t) {
                                if (void 0 === e || null === e)
                                    return e;
                                switch (t) {
                                    case r.PrimitiveTypes.NUMBER:
                                        return parseFloat(e);
                                    case r.PrimitiveTypes.BOOLEAN:
                                        return !!e;
                                    case r.PrimitiveTypes.STRING:
                                        return "" + e;
                                    default:
                                        return e
                                }
                            }
                            ,
                            e.prototype.to = function() {
                                var e = this;
                                Object.getOwnPropertyNames(this.oo.properties).forEach(function(t) {
                                    e[t] = e.uo(t)
                                })
                            }
                            ,
                            e.prototype.uo = function() {
                                throw "not implemented."
                            }
                            ,
                            e.undefinedValue = {},
                            e.indeterminateValue = {},
                            e
                    }(),
                    r.BaseMetaObject = e,
                    t = function(t) {
                        r.extends(i, t);
                        function i(e, i, o) {
                            t.call(this, e, i, o),
                                this.vo = {},
                                this.to()
                        }
                        return i.prototype._h = function(t, o) {
                            var n, r;
                            if (void 0 === o) {
                                if (void 0 === (o = this.vo[t]))
                                    return o = this.qo(t),
                                        n = this.po[this.oo.properties[t].type],
                                    void 0 !== n && (o = this.vo[t] = new i(o,n,this.po)),
                                        o;
                                if (o === e.undefinedValue)
                                    return;
                                return o
                            }
                            return r = this.oo.properties[t].type,
                            typeof o !== r && (o = e.so(o, r)),
                                this.vo[t] = o,
                                $(this).trigger($.Event("change", {
                                    property: t
                                })),
                                this
                        }
                            ,
                            i.prototype.reset = function(e) {
                                this.vo[e] = s
                            }
                            ,
                            i.prototype.commit = function() {
                                var t = this;
                                Object.getOwnPropertyNames(this.vo).forEach(function(o) {
                                    var n = t.vo[o];
                                    if (void 0 !== n) {
                                        if (n instanceof i)
                                            return void n.commit();
                                        n === e.undefinedValue && (n = s),
                                            t.ro(o, n)
                                    }
                                })
                            }
                            ,
                            i.prototype.uo = function(e) {
                                return this._h.bind(this, e)
                            }
                            ,
                            i
                    }(e),
                    i = function(t) {
                        r.extends(i, t);
                        function i(e, i, o) {
                            t.call(this, e, i, o),
                                this.to()
                        }
                        return i.prototype.uo = function(t) {
                            var o = this
                                , n = this.po[this.oo.properties[t].type];
                            return function(r) {
                                var a, s;
                                if (void 0 === r)
                                    return a = o.qo(t),
                                        void 0 !== n ? new i(a,n,o.po) : a;
                                if (void 0 !== n)
                                    throw "Complex property don't support set.";
                                return s = o.oo.properties[t].type,
                                typeof r !== s && (r = e.so(r, s)),
                                    o.ro(t, r),
                                    $(o).trigger($.Event("change", {
                                        property: t
                                    })),
                                    this
                            }
                        }
                            ,
                            i
                    }(e),
                    o = function(t) {
                        r.extends(i, t);
                        function i(e, i, o) {
                            t.call(this, e, i, o),
                                this.vo = {},
                                this.to()
                        }
                        return i.prototype.reset = function(e) {
                            this.vo[e] = s
                        }
                            ,
                            i.prototype.commit = function() {
                                var t = this;
                                Object.getOwnPropertyNames(this.vo).forEach(function(o) {
                                    var n = t.vo[o];
                                    if (void 0 !== n) {
                                        if (n instanceof i)
                                            return void n.commit();
                                        n === e.undefinedValue && (n = s),
                                            t.ro(o, n)
                                    }
                                })
                            }
                            ,
                            i.prototype.uo = function(t) {
                                var i = this
                                    , o = this.oo.properties[t];
                                return ko.computed({
                                    read: function() {
                                        var o = i.vo[t];
                                        return void 0 === o ? i.qo(t) : o === e.undefinedValue ? void 0 : o
                                    },
                                    write: function(n) {
                                        var r = n;
                                        void 0 === r ? r = e.undefinedValue : typeof r !== o.type && (r = e.so(r, o.type)),
                                            i.vo[t] = r
                                    }
                                })
                            }
                            ,
                            i
                    }(e),
                    n = function() {
                        function e(e) {
                            this.po = e
                        }
                        return e.prototype.genWrapper = function(t, o) {
                            var n, r = t[e.internalWrapper];
                            return void 0 !== r ? r : void 0 === (n = this.po[o]) ? t : (r = new i(t,n,this.po),
                                t[e.internalWrapper] = r,
                                r)
                        }
                            ,
                            e.prototype.genShadow = function(e, i) {
                                var o = this.po[i];
                                return void 0 === o ? e : new t(e,o,this.po)
                            }
                            ,
                            e.prototype.genKoShadow = function(e, t) {
                                var i = this.po[t];
                                return void 0 === i ? e : new o(e,i,this.po)
                            }
                            ,
                            e.internalWrapper = "__gc_metadata_wrapper",
                            e
                    }(),
                    r.MetaFactor = n
            }()
        }
        , function(e, t, i) {
            var o = GC.Spread.Sheets
                , n = o.Designer
                , r = o.Charts
                , a = i(1)
                , s = o.CalcEngine.formulaToRange
                , l = r.Chart
                , c = n.ColorHelper;
            !function(e) {
                "use strict";
                var t, i, o, l, d, p, u, h, f, g, m = null, b = void 0, v = 6, y = 2;
                e.clipboard = {};
                function x(e) {
                    console.warn("SpreadDesigner: ", e)
                }
                e.warn = x;
                function w(e) {
                    console.error("SpreadDesigner: ", e)
                }
                e.error = w;
                function C(e, t) {
                    if (!e)
                        throw "SpreadDeisgner Assertion: " + t
                }
                e.assert = C;
                function S(e) {
                    var t, i, o = [];
                    for (i = 0; i < arguments.length - 1; i++)
                        o[i] = arguments[i + 1];
                    return 1 === o.length && "object" == typeof o[0] ? (t = /{([^{}]+)}/gm,
                        e.replace(t, function(e, t) {
                            return o[0][t]
                        })) : (t = /{(\d+)}/gm,
                        e.replace(t, function(e, t) {
                            return o[~~t]
                        }))
                }
                e.format = S;
                function k(e) {
                    e.preventDefault ? (e.preventDefault(),
                        e.stopPropagation()) : (e.cancelBubble = !1,
                        e.returnValue = !1)
                }
                e.cancelDefault = k;
                function T(e) {
                    var t = e.getHost()
                        , i = t.id;
                    return i ? document.getElementById(i + "vp_vp") : $(t).find("canvas[id='vp_vp']")[0]
                }
                e.getCanvas = T;
                function A() {
                    return document.getElementById(n.wrapper.spread.getHost().id + "_tabStrip")
                }
                e.getTabStripCanvas = A;
                function I(e, t, i) {
                    var o, n, r, a;
                    if (e && (o = e.getSelections()))
                        for (n = 0,
                                 r = o.length; n < r; n++)
                            if (a = o[n],
                                    a.contains(t, i))
                                return a;
                    return m
                }
                e.findSelection = I,
                    t = {
                        UppercaseLetter: 0,
                        LowercaseLetter: 1,
                        DecimalDigitNumber: 8,
                        OtherNumber: 10,
                        SpaceSeparator: 11,
                        Control: 14,
                        ConnectorPunctuation: 18,
                        DashPunctuation: 19,
                        OpenPunctuation: 20,
                        ClosePunctuation: 21,
                        InitialQuotePunctuation: 22,
                        FinalQuotePunctuation: 23,
                        OtherPunctuation: 24,
                        MathSymbol: 25,
                        currencySymbol: 26,
                        ModifierSymbol: 27,
                        OtherSymbol: 28
                    },
                    i = [14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 11, 24, 24, 24, 26, 24, 24, 24, 20, 21, 24, 25, 24, 19, 24, 24, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 24, 24, 25, 25, 25, 24, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 24, 21, 27, 18, 27, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 20, 25, 21, 25, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 11, 24, 26, 26, 26, 26, 28, 28, 27, 28, 1, 22, 25, 19, 28, 27, 28, 25, 10, 10, 27, 1, 28, 24, 27, 10, 1, 23, 10, 10, 10, 24, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 25, 1, 1, 1, 1, 1, 1, 1, 1];
                function D(e) {
                    return e <= 255
                }
                function F(e) {
                    return e <= 127
                }
                function L(e) {
                    var t = e.charCodeAt(0);
                    return t >= 48 && t <= 57
                }
                function R(e) {
                    var o = e.charCodeAt(0);
                    return !D(o) || (F(o) ? (o |= 32) >= 96 && o <= 122 : i[o] === t.UppercaseLetter || i[o] === t.LowercaseLetter)
                }
                function B(e) {
                    var o = e.charCodeAt(0);
                    return !D(o) || (F(o) ? o <= 57 ? o >= 48 : (o |= 32) >= 96 && o <= 122 : i[o] === t.UppercaseLetter || i[o] === t.LowercaseLetter)
                }
                function N(e) {
                    var o = e.charCodeAt(0);
                    return !!D(o) && (i[o] === t.MathSymbol || i[o] === t.currencySymbol || i[o] === t.ModifierSymbol || i[o] === t.OtherSymbol)
                }
                function E(e) {
                    var o = e.charCodeAt(0);
                    return F(o) ? o >= 48 && o <= 57 : i[o] === t.DecimalDigitNumber || i[o] === t.OtherNumber
                }
                function V(e) {
                    var t, i, o;
                    if (e === b || e === m || "" === e)
                        return !1;
                    if (1 === (t = e.length) && ("R" === e || "r" === e || "C" === e || "c" === e))
                        return !1;
                    if ("_" !== (i = e.charAt(0)) && "\\" !== i && !R(i) && !N(i))
                        return !1;
                    for (o = 1; o < t; o++)
                        if ("_" !== (i = e.charAt(o)) && "\\" !== i && "?" !== i && "." !== i && !B(i) && !N(i))
                            return !1;
                    return !0
                }
                e.isValidateName = V,
                    o = "\\+-*/^&=><: ,";
                function P(e, t, i) {
                    var n, r, a;
                    if (e === b || e === m || "" === e)
                        return !0;
                    if (!i && L(e.charAt(0)))
                        return !1;
                    if (n = z(e, t),
                        !i && n.success && n.endIndex === e.length)
                        return !1;
                    for (a = 0; a < e.length; a++)
                        if (r = e.charAt(a),
                                i) {
                            if ("*" === r || ":" === r || "[" === r || "]" === r || "?" === r || "\\" === r || "/" === r)
                                return !1
                        } else if ("'" === r || "[" === r || "]" === r || "?" === r || "\\" === r || "%" === r || '"' === r || -1 !== o.indexOf(r))
                            return !1;
                    return !0
                }
                e.isValidateSheetName = P;
                function z(e, t) {
                    return t ? M(e) : j(e)
                }
                l = -2147483648,
                    d = 16384,
                    p = 1048576,
                    u = [1, 26, 676];
                function j(e) {
                    var t, i, o, n, r, a, s, c, d = l, p = {
                        startRow: d,
                        startColumn: d,
                        endRow: d,
                        endColumn: d,
                        startRowRelative: !0,
                        startColumnRelative: !0,
                        endRowRelative: !0,
                        endColumnRelative: !0,
                        success: !1,
                        endIndex: 0
                    };
                    return e = e.replace(" ", ""),
                        t = e.length,
                        i = O(e, 0),
                        p.endIndex = i.endIndex,
                        !i.success || p.endIndex > t ? p : i.isRow ? (p.startRow = i.elementIndex,
                            p.startRowRelative = i.isRelative,
                            ":" === e.charAt(p.endIndex) ? (p.endIndex++,
                                o = O(e, p.endIndex),
                                p.endIndex = o.endIndex,
                                o.success && o.isRow ? (p.endRow = o.elementIndex,
                                    p.endRowRelative = o.isRelative,
                                    p.success = !0,
                                    p) : p) : p) : (p.startColumn = i.elementIndex,
                            p.startColumnRelative = i.isRelative,
                            ":" === e.charAt(p.endIndex) ? (p.endIndex++,
                                o = O(e, p.endIndex),
                                p.endIndex = o.endIndex,
                                !o.success || o.isRow ? p : (p.endColumn = o.elementIndex,
                                    p.endColumnRelative = o.isRelative,
                                    p.success = !0,
                                    p)) : E(e.charAt(p.endIndex)) || "$" === e.charAt(p.endIndex) ? (o = O(e, p.endIndex),
                                p.endIndex = o.endIndex,
                                o.success && o.isRow ? (p.startRow = o.elementIndex,
                                    p.startRowRelative = o.isRelative,
                                    n = p.endIndex,
                                    p.endIndex < t - 1 && ":" === e.charAt(p.endIndex) ? "'" === e.charAt(p.endIndex + 1) ? (p.success = !0,
                                        p) : (r = e.indexOf("!", p.endIndex + 1),
                                        a = e.indexOf(":", p.endIndex + 1),
                                        -1 !== r && (-1 === a || a > r) ? (p.success = !0,
                                            p) : (p.endIndex++,
                                            s = O(e, p.endIndex),
                                            !s.success || s.isRow ? (p.endIndex = n,
                                                p.success = !0,
                                                p) : (p.endIndex = s.endIndex,
                                                p.endColumn = s.elementIndex,
                                                p.endColumnRelative = s.isRelative,
                                                c = O(e, p.endIndex),
                                                c.success && c.isRow ? (p.endIndex = c.endIndex,
                                                    p.endRow = c.elementIndex,
                                                    p.endRowRelative = c.isRelative,
                                                    p.success = !0,
                                                    p) : (p.endIndex = n,
                                                    p.endColumn = d,
                                                    p.success = !0,
                                                    p)))) : (p.success = !0,
                                        p)) : p) : p)
                }
                function M(e, t, i) {
                    var o, n, r, a, s, c, d, p, u = l, h = {
                        startRow: u,
                        startColumn: u,
                        endRow: u,
                        endColumn: u,
                        startRowRelative: !0,
                        startColumnRelative: !0,
                        endRowRelative: !0,
                        endColumnRelative: !0,
                        success: !1,
                        endIndex: 0
                    };
                    return e = e.replace(" ", ""),
                        o = e.length,
                        n = G(e, t, i, 0),
                        h.endIndex = n.endIndex,
                        n.success ? n.isRow ? (h.startRow = n.elementIndex,
                            h.startRowRelative = n.isRelative,
                            h.endIndex >= o ? (h.success = !0,
                                h) : ":" === e.charAt(h.endIndex) ? (h.endIndex++,
                                r = G(e, t, i, h.endIndex),
                                h.endIndex = r.endIndex,
                                r.success && r.isRow ? (h.endRow = r.elementIndex,
                                    h.endRowRelative = r.isRelative,
                                    h.success = !0,
                                    h) : h) : "C" === e.charAt(h.endIndex) || "c" === e.charAt(h.endIndex) ? (r = G(e, t, i, h.endIndex),
                                h.endIndex = r.endIndex,
                                !r.success || r.isRow ? h : (h.startColumn = r.elementIndex,
                                    h.startColumnRelative = r.isRelative,
                                    a = h.endIndex,
                                    h.endIndex < o - 1 && ":" === e.charAt(h.endIndex) ? "'" === e.charAt(h.endIndex + 1) ? (h.success = !0,
                                        h) : (s = e.indexOf("!", h.endIndex + 1),
                                        c = e.indexOf(":", h.endIndex + 1),
                                        -1 !== s && (-1 === c || c > s) ? (h.success = !0,
                                            h) : (h.endIndex++,
                                            d = G(e, t, i, h.endIndex),
                                            d.success && d.isRow ? (h.endIndex = d.endIndex,
                                                h.endRow = d.elementIndex,
                                                h.endRowRelative = d.isRelative,
                                                p = G(e, t, i, h.endIndex),
                                                !p.success || p.isRow ? (h.endIndex = a,
                                                    h.success = !0,
                                                    h) : (h.endIndex = p.endIndex,
                                                    h.endColumn = p.elementIndex,
                                                    h.endColumnRelative = p.isRelative,
                                                    h.success = !0,
                                                    h)) : (h.endIndex = a,
                                                h.success = !0,
                                                h))) : (h.success = !0,
                                        h))) : h) : (h.startColumn = n.elementIndex,
                            h.startColumnRelative = n.isRelative,
                            h.endIndex >= o ? (h.success = !0,
                                h) : ":" === e.charAt(h.endIndex) ? (h.endIndex++,
                                r = G(e, t, i, h.endIndex),
                                h.endIndex = r.endIndex,
                                !r.success || r.isRow ? h : (h.endColumn = r.elementIndex,
                                    h.endColumnRelative = r.isRelative,
                                    h.success = !0,
                                    h)) : h) : h
                }
                function O(e, t) {
                    var i, o, n, r, a, s = l, c = {
                        endIndex: t,
                        elementIndex: s,
                        isRow: !0,
                        isRelative: !0,
                        success: !1
                    }, h = e.length;
                    if (t >= h)
                        return c;
                    if ("$" === e.charAt(t) && (c.isRelative = !1,
                            t++),
                        t >= h)
                        return c;
                    if (i = t,
                            n = e.charAt(i),
                        E(n) && "0" !== n) {
                        for (c.isRow = !0; i < h && E(n); )
                            ++i < h && (n = e.charAt(i));
                        if ((o = parseInt(e.substr(t, i - t), 10)) >= 1 && o <= p)
                            return c.elementIndex = o - 1,
                                c.endIndex = i,
                                c.success = !0,
                                c
                    } else if (R(n)) {
                        for (c.isRow = !1; i < h && R(n); )
                            ++i < h && (n = e.charAt(i));
                        if (r = e.substr(t, i - t),
                            r.length > 3)
                            return c;
                        for (r = r.toUpperCase(),
                                 o = 0,
                                 a = r.length - 1; a >= 0; a--)
                            o += (r.charCodeAt(a) - 65 + 1) * u[r.length - a - 1];
                        if (o <= d)
                            return c.elementIndex = o - 1,
                                c.endIndex = i,
                                c.success = !0,
                                c
                    }
                    return c
                }
                function G(e, t, i, o) {
                    var n, r, a, s, c, u = l, h = {
                        endIndex: o,
                        elementIndex: u,
                        isRow: !0,
                        isRelative: !1,
                        success: !1
                    }, f = e.length;
                    if (o >= f)
                        return h;
                    if (n = o,
                        "R" === (r = e.charAt(n)) || "r" === r)
                        h.isRow = !0,
                            a = t;
                    else {
                        if ("C" !== r && "c" !== r)
                            return h;
                        h.isRow = !1,
                            a = i
                    }
                    if (o++,
                            n++,
                        o >= f)
                        return h.endIndex = o,
                            h.elementIndex = a,
                            h.isRelative = !0,
                            h.success = !0,
                            h;
                    if (r = e.charAt(n),
                        "[" === r && (o++,
                            n++,
                            h.isRelative = !0),
                        o >= f)
                        return h;
                    if (s = !1,
                            r = e.charAt(n),
                        h.isRelative && "-" === r && (o++,
                            n++,
                            s = !0),
                        o >= f)
                        return h;
                    if (r = e.charAt(n),
                            !E(r))
                        return h.isRelative ? h : (h.endIndex = o,
                            h.elementIndex = a,
                            h.isRelative = !0,
                            h.success = !0,
                            h);
                    for (; n < f && E(r); )
                        ++n < f && (r = e.charAt(n));
                    if (c = parseInt(e.substr(o, n - o), 10),
                            h.isRelative) {
                        if (n >= f || "]" !== e.charAt(n))
                            return h;
                        n++
                    }
                    return c < (h.isRow ? p : d) ? (h.isRelative ? (c = s ? -c : c,
                        h.elementIndex = c + a) : h.elementIndex = c - 1,
                        h.endIndex = n,
                        h.success = !0,
                        h) : void 0
                }
                function H(e, t) {
                    var i, o, n, r, a = GC.Spread.CalcEngine.Functions.findGlobalFunction(e);
                    if (a) {
                        for (i = [],
                                 o = t.length,
                                 n = 0; n < o; n++) {
                            if (!((r = t[n])instanceof GC.Spread.Sheets.Range))
                                return m;
                            i[n] = W(r.row, r.col, r.row + r.rowCount - 1, r.col + r.colCount - 1)
                        }
                        return U(a, i)
                    }
                    return m
                }
                function U(e, t) {
                    var i = new GC.Spread.CalcEngine.Expression(7);
                    return i.function = e,
                        i.arguments = t,
                        i.functionName = e.name,
                        i
                }
                function W(e, t, i, o, n, r, a, s) {
                    var c = new GC.Spread.CalcEngine.Expression(1), d;
                    return c.isFullRow = t === l,
                        c.isFullColumn = e === l,
                    e > i && (d = e,
                        e = i,
                        i = d,
                        d = n,
                        n = a,
                        a = d),
                    t > o && (d = t,
                        t = o,
                        o = d,
                        d = r,
                        r = s,
                        s = d),
                        c.row = e,
                        c.column = t,
                        c.endRow = i,
                        c.endColumn = o,
                        c.rowRelative = n,
                        c.columnRelative = r,
                        c.endRowRelative = a,
                        c.endColumnRelative = s,
                        c
                }
                e.createStatisticalExpression = H;
                function _(e, t, i) {
                    e && n.wrapper.spreadElement.trigger(t, i)
                }
                e.triggerSheetEvent = _;
                function q(e, t) {
                    $(n).trigger(e, t)
                }
                e.triggerDesignerEvent = q;
                function K(e, t) {
                    $(n).bind(e, t)
                }
                e.bindDesignerEvent = K;
                function Y(e, t, i) {
                    var o = $.Deferred();
                    return $.get(e).done(function(e) {
                        i.empty(),
                            i.append($("<div></div>").append($.parseHTML(e)).find(t)),
                            o.resolve(i)
                    }).fail(function(e, t) {
                        i.empty(),
                            i.append($("<div></div>").addClass("error").text("Loading failed with error: " + t)),
                            o.reject([e, t])
                    }),
                        o
                }
                e.loadHtml = Y;
                function X(e) {
                    var t, i, o = $.Deferred();
                    if (0 !== $('script[src="' + e + '"]').length)
                        return void o.resolve();
                    t = document.createElement("script"),
                        t.type = "text/javascript",
                        t.charset = "utf-8",
                        t.async = !0;
                    function n() {
                        o.resolve()
                    }
                    function r() {
                        o.reject()
                    }
                    return !t.attachEvent || t.attachEvent.toString && ("" + t.attachEvent).indexOf("[native code") < 0 || "undefined" != typeof opera && "" + opera == "[object Opera]" ? (t.addEventListener("load", n, !1),
                        t.addEventListener("error", r, !1)) : t.attachEvent("onreadystatechange", n),
                        t.src = e,
                        i = document.getElementsByTagName("head")[0],
                        i.appendChild(t),
                        o
                }
                e.loadScript = X;
                function J(e) {
                    var t, i = $.Deferred();
                    return 0 === $('link[href="' + e + '"]').length && (t = $("<link>"),
                        t.attr("href", e),
                        t.attr("type", "text/css"),
                        t.attr("rel", "stylesheet"),
                        $("head").append(t)),
                        i.resolve(),
                        i
                }
                e.loadCss = J,
                    e.resolveHtmlPath = function(e, t) {
                        return location.pathname.indexOf("/content/") >= 0 ? t : e + "/" + t
                    }
                ;
                function Q(e) {
                    for (var t, i, o = null, n = null, r = "normal", a = "normal", s = "normal", l = "normal", c = e.split(/\s+/); t = c.shift(); )
                        switch (t) {
                            case "normal":
                                break;
                            case "italic":
                            case "oblique":
                                r = t;
                                break;
                            case "small-caps":
                                s = t;
                                break;
                            case "bold":
                            case "bolder":
                            case "lighter":
                            case "100":
                            case "200":
                            case "300":
                            case "400":
                            case "500":
                            case "600":
                            case "700":
                            case "800":
                            case "900":
                                a = t;
                                break;
                            default:
                                if (!n) {
                                    i = t.split("/"),
                                        n = i[0],
                                    -1 !== n.indexOf("px") && (n = ee(parseFloat(n)) + "pt"),
                                    i.length > 1 && (l = i[1],
                                    -1 !== l.indexOf("px") && (l = ee(parseFloat(l)) + "pt"));
                                    break
                                }
                                return o = t,
                                c.length && (o += " " + c.join(" ")),
                                    {
                                        fontStyle: r,
                                        fontVariant: s,
                                        fontWeight: a,
                                        fontSize: n,
                                        lineHeight: l,
                                        fontFamily: o
                                    }
                        }
                    return {
                        fontStyle: r,
                        fontVariant: s,
                        fontWeight: a,
                        fontSize: n,
                        lineHeight: l,
                        fontFamily: o
                    }
                }
                e.parseFont = Q;
                function Z(e) {
                    var t, i, o, n, r = [0, 0, 0, 0];
                    return e && "string" == typeof e ? (t = e.split(" ", 4),
                        i = t.length,
                        1 === i ? (o = t[0],
                            r = [o, o, o, o]) : 2 === i ? (o = t[0],
                            n = t[1],
                            r = [o, n, o, n]) : 3 === i ? (n = t[1],
                            r = [t[0], n, t[2], n]) : 4 === i && (r = [t[0], t[1], t[2], t[3]]),
                        r) : r
                }
                e.parsePadding = Z,
                    h = $("<span></span>");
                function ee(e) {
                    var t, i;
                    return h.css({
                        "font-size": "96pt",
                        display: "none"
                    }),
                        h.appendTo($(document.body)),
                        t = h.css("font-size"),
                        -1 !== t.indexOf("px") ? (i = parseFloat(t),
                            Math.round(96 * e / i)) : Math.round(72 * e / 96)
                }
                e.px2pt = ee;
                function te(e) {
                    var t = n.wrapper.spread.getActiveSheet().currentTheme();
                    if (t && e) {
                        if ("Body" === e)
                            return t.bodyFont();
                        if ("Headings" === e)
                            return t.headerFont()
                    }
                    return null
                }
                e.getThemeFont = te;
                function ie(e) {
                    var t = "";
                    if (0 !== e)
                        return 1 & e && (t += "underline "),
                        2 & e && (t += "line-through "),
                        4 & e && (t += "overline "),
                            t
                }
                e.toCSSTextDecoration = ie;
                function oe(e, t) {
                    var i, o, r, a, s = n.wrapper.spread.getActiveSheet();
                    if (!s)
                        return null;
                    if (!(i = s.getFormula(e, t)))
                        return null;
                    o = s.getCalcService();
                    try {
                        if (r = o.parse(null, i, e, t),
                            r.type === GC.Spread.CalcEngine.ExpressionType.function && (a = r.functionName) && n.wrapper.spread.getSparklineEx(a))
                            return r
                    } catch (e) {}
                    return null
                }
                e.parseFormulaSparkline = oe;
                function ne(e, t, i) {
                    var o, r = n.wrapper.spread.getActiveSheet();
                    return r ? (o = r.getCalcService(),
                        o.unparse(null, e, t, i)) : null
                }
                e.unParseFormula = ne,
                    e.DataFieldType = {
                        checkbox: "checkbox",
                        hyperlink: "hyperlink",
                        combox: "combox",
                        button: "button",
                        text: "text",
                        table: "table"
                    },
                    e.BasicDataType = {
                        Array: "array",
                        Boolean: "boolean",
                        Integer: "integer",
                        Number: "number",
                        Null: "null",
                        Object: "object",
                        String: "string"
                    },
                    e.DefaultTypeDic = {
                        array: e.DataFieldType.table,
                        boolean: e.DataFieldType.checkbox,
                        integer: e.DataFieldType.text,
                        number: e.DataFieldType.text,
                        null: e.DataFieldType.text,
                        object: e.DataFieldType.text,
                        string: e.DataFieldType.text
                    },
                    e.DefaultDataFieldTypeDic = {
                        checkbox: e.BasicDataType.Boolean,
                        hyperlink: e.BasicDataType.String,
                        combox: e.BasicDataType.String,
                        button: e.BasicDataType.String,
                        text: e.BasicDataType.String,
                        table: e.BasicDataType.Array
                    };
                function re(e) {
                    var t, i, o;
                    return e.$schema ? (t = [],
                        i = $.extend({}, e),
                        o = i.definitions,
                        ae(o, e, !0),
                        ae(i, e, !1),
                        se(i, t),
                        t) : null
                }
                e.parseJsonSchema = re,
                    f = [];
                function ae(e, t, i) {
                    var o, n, r, a, s, l, c, d;
                    if (e) {
                        if ((o = e.$ref) && "string" == typeof o) {
                            if (0 === o.indexOf("#")) {
                                for (r = o.split("/"),
                                         a = r.length,
                                         s = $.extend({}, t),
                                         l = 1; l < a && s; l++)
                                    s = s[r[l]];
                                s && (n = s)
                            }
                            if (n) {
                                if (-1 !== f.join("/").indexOf(o))
                                    return;
                                delete e.$ref,
                                    $.extend(e, n)
                            }
                        }
                        if (e.properties)
                            f.push("properties"),
                                ae(e.properties, t);
                        else
                            for (c in e)
                                if ("patternProperties" !== c && "allOf" !== c && "anyOf" !== c && "oneOf" !== c && "not" !== c && e.hasOwnProperty(c) && "object" == typeof e[c]) {
                                    if (i && (f = ["#", "definitions"]),
                                        -1 !== f.indexOf(c) && (d = "#/definitions/" + c,
                                        -1 !== f.join("/").indexOf(d)))
                                        return;
                                    f.push(c),
                                        ae(e[c], t)
                                }
                    }
                }
                function se(e, t) {
                    var i, o, n, r, a, s, l, c;
                    if (e && (e.properties || e.items || e.definitions)) {
                        i = {},
                        e.items && (i.items = e.items),
                        e.properties && (i.properties = e.properties),
                        e.definitions && (i.definitions = e.definitions);
                        for (o in i)
                            if (i.hasOwnProperty(o)) {
                                n = i[o];
                                for (r in n)
                                    if (n.hasOwnProperty(r)) {
                                        if (a = {},
                                                a.name = r,
                                            "object" == typeof n[r]) {
                                            if (n[r].type && (a.type = n[r].type),
                                                n[r].dataFieldType && (a.dataFieldType = n[r].dataFieldType),
                                                    n[r].enum)
                                                for (s = n[r].enum,
                                                         a.enum = s,
                                                         a.children = [],
                                                         l = s.length,
                                                         c = 0; c < l; c++)
                                                    a.children.push({
                                                        name: s[c]
                                                    });
                                            n[r].properties && (a.children = [],
                                                se(n[r], a.children)),
                                            n[r].items && (a.children = [],
                                                se(n[r].items, a.children))
                                        }
                                        t.push(a)
                                    }
                            }
                    }
                }
                function le(t) {
                    if (t.constructor === Array.prototype.constructor) {
                        var i = {};
                        return i.$schema = "http://json-schema.org/draft-04/schema#",
                            i.properties = {},
                            i.type = e.BasicDataType.Object,
                            ce(t, i.properties),
                            i
                    }
                }
                e.saveJSONSchema = le;
                function ce(t, i) {
                    var o, n, r, a, s, l, c, d = t.length;
                    if (d)
                        for (o = 0; o < d; o++)
                            n = t[o],
                                r = n.name,
                                a = n.type,
                                s = n.dataFieldType,
                                l = n.children,
                                c = n.enum,
                            r && (i[r] || (i[r] = {}),
                            s && (i[r].dataFieldType = s,
                            a || (a = e.DefaultDataFieldTypeDic[s])),
                                i[r].type = a || e.BasicDataType.String,
                            c && (i[r].enum = c),
                            l && !c && (a || (i[r].type = e.BasicDataType.Object),
                                a === e.BasicDataType.Array ? (i[r].items || (i[r].items = {}),
                                    i[r].items.type = e.BasicDataType.Object,
                                i[r].items.properties || (i[r].items.properties = {}),
                                    ce(l, i[r].items.properties)) : (i[r].properties || (i[r].properties = {}),
                                    ce(l, i[r].properties))))
                }
                function de(e, t, i, o, n) {
                    var r, a, s, l, c, d;
                    for (r = 0,
                             a = t.length; r < a; r++)
                        if (s = t[r],
                            i > s.row && i < s.row + s.rowCount && (l = e.getStyle(s.row, s.col, n)))
                            for (c = i; c < i + o; c++)
                                for (d = s.col; d < s.col + s.colCount; d++)
                                    e.setStyle(c, d, l, n)
                }
                function pe(e, t, i, o, n) {
                    var r, a, s, l, c, d;
                    for (r = 0,
                             a = t.length; r < a; r++)
                        if (s = t[r],
                            i > s.col && i < s.col + s.colCount && (l = e.getStyle(s.row, s.col, n)))
                            for (c = i; c < i + o; c++)
                                for (d = s.row; d < s.row + s.rowCount; d++)
                                    e.setStyle(d, c, l, n)
                }
                function ue(e, t, i, o) {
                    if (e) {
                        var n = e.getSpans(void 0, 3);
                        t >= 0 ? (de(e, n, t, o, 3),
                            de(e, e.getSpans(void 0, 2), t, o, 2)) : i >= 0 && (pe(e, n, i, o, 3),
                            pe(e, e.getSpans(void 0, 1), i, o, 1))
                    }
                }
                e.setSpanStyleWhenInsertRowsColumns = ue;
                function he(e) {
                    if (!$.isNumeric(e))
                        return 0;
                    var t = parseFloat(e);
                    return Math.round(t)
                }
                e.formatNumber = he;
                function fe(e) {
                    var t, i, o;
                    if (!e)
                        return null;
                    if (!(t = e.slicers.all()) || $.isEmptyObject(t))
                        return null;
                    i = [];
                    for (o in t)
                        t[o].isSelected() && i.push(t[o]);
                    return i
                }
                e.getSelectedSlicers = fe;
                function ge(e, t) {
                    e <= 0 && (e = 1);
                    var i = Math.round((t - 2 * v - (e - 1) * y) / e);
                    return i < 0 ? 0 : i
                }
                e.getSlicerItemWidth = ge;
                function me(e, t) {
                    return e <= 0 && (e = 1),
                        Math.round(t * e + (e - 1) * y + 2 * v)
                }
                e.getSlicerWidthFromItem = me;
                function be(t) {
                    if (!t)
                        return !1;
                    var i = e.getSelectedSlicers(t);
                    return !(!i || 0 === i.length)
                }
                e.isSlicerSelected = be;
                function ve(e) {
                    return e.substr(4).split(",").map(function(e) {
                        return parseInt(e)
                    })
                }
                e.parseColorString = ve;
                function ye(e, t) {
                    var i, o = n.yi;
                    return o || (o = n.yi = {}),
                        i = o[e],
                    i || (i = o[e] = t()),
                        i
                }
                e.getFromCache = ye;
                function xe(e) {
                    return e.split(" ")[2] || 0
                }
                function we(e, t) {
                    var i = e.split(" ");
                    return i[2] = t,
                        i.join(" ")
                }
                g = {
                    chartTypeDict: {
                        0: {
                            chartType: "combo",
                            chartGroup: "ComboGroup"
                        },
                        1: {
                            chartType: "xyScatter",
                            chartGroup: "ScatterGroup"
                        },
                        2: {
                            chartType: "xyScatter",
                            chartGroup: "ScatterGroup"
                        },
                        3: {
                            chartType: "doughnut",
                            chartGroup: "PieGroup"
                        },
                        8: {
                            chartType: "area",
                            chartGroup: "AreaGroup"
                        },
                        9: {
                            chartType: "line",
                            chartGroup: "LineGroup"
                        },
                        10: {
                            chartType: "pie",
                            chartGroup: "PieGroup"
                        },
                        11: {
                            chartType: "bubble",
                            chartGroup: "ScatterGroup"
                        },
                        12: {
                            chartType: "columnClustered",
                            chartGroup: "ColumnGroup"
                        },
                        13: {
                            chartType: "columnStacked",
                            chartGroup: "ColumnGroup"
                        },
                        14: {
                            chartType: "columnStacked100",
                            chartGroup: "ColumnGroup"
                        },
                        18: {
                            chartType: "barClustered",
                            chartGroup: "BarGroup"
                        },
                        19: {
                            chartType: "barStacked",
                            chartGroup: "BarGroup"
                        },
                        20: {
                            chartType: "barStacked100",
                            chartGroup: "BarGroup"
                        },
                        24: {
                            chartType: "lineStacked",
                            chartGroup: "LineGroup"
                        },
                        25: {
                            chartType: "lineStacked100",
                            chartGroup: "LineGroup"
                        },
                        26: {
                            chartType: "lineMarkers",
                            chartGroup: "LineGroup"
                        },
                        27: {
                            chartType: "lineMarkersStacked",
                            chartGroup: "LineGroup"
                        },
                        28: {
                            chartType: "lineMarkersStacked100",
                            chartGroup: "LineGroup"
                        },
                        33: {
                            chartType: "xyScatterSmooth",
                            chartGroup: "ScatterGroup"
                        },
                        34: {
                            chartType: "xyScatterSmoothNoMarkers",
                            chartGroup: "ScatterGroup"
                        },
                        35: {
                            chartType: "xyScatterLines",
                            chartGroup: "ScatterGroup"
                        },
                        36: {
                            chartType: "xyScatterLinesNoMarkers",
                            chartGroup: "ScatterGroup"
                        },
                        37: {
                            chartType: "areaStacked",
                            chartGroup: "AreaGroup"
                        },
                        38: {
                            chartType: "areaStacked100",
                            chartGroup: "AreaGroup"
                        },
                        49: {
                            chartType: "stockHLC",
                            chartGroup: "StockGroup"
                        },
                        50: {
                            chartType: "stockOHLC",
                            chartGroup: "StockGroup"
                        },
                        51: {
                            chartType: "stockVHLC",
                            chartGroup: "StockGroup"
                        },
                        52: {
                            chartType: "stockVOHLC",
                            chartGroup: "StockGroup"
                        }
                    },
                    getChartGroupString: function(e) {
                        var t = this.chartTypeDict[e];
                        if (t && t.chartGroup)
                            return t.chartGroup
                    },
                    getChartTypeString: function(e) {
                        var t = this.chartTypeDict[e];
                        if (t && t.chartType)
                            return t.chartType
                    },
                    getGradientThemeColor: function(e, t, i, o) {
                        var n, r, a, s, l;
                        if (0 === o)
                            return e;
                        if (o === i - 1)
                            return t;
                        if (n = parseFloat(xe(e)),
                                r = parseFloat(xe(t)),
                                a = (r - n) / (i - 1),
                                s = 0,
                            o !== b)
                            return s = n + a * o,
                                we(e, s);
                        for (l = [],
                                 l.push(e),
                                 o = 1; o < i - 1; o++)
                            s = n + a * o,
                                l.push(we(e, s));
                        return l.push(t),
                            l
                    },
                    getSelectedChart: function(e) {
                        var t, i, o = e.charts, n = o.all();
                        for (t = 0; t < n.length; t++)
                            if (i = n[t],
                                    i.isSelected())
                                return i
                    },
                    resetChartsFocus: function(e) {
                        var t, i = e.charts.all();
                        if (i && i.length > 0)
                            for (t = 0; t < i.length; t++)
                                i[t].isSelected(!1)
                    },
                    applyChartSeriesTheme: function(e, t) {
                        var i, o, n, r, s, l, c = this, d = t.group || "colorful", p = t.index || 0, u = a.chartColors, h = u[d].colors[p].items, f = e.series(), m = f.get(), b = m.length;
                        for (i = 0; i < b; i++)
                            o = m[i],
                                r = GC.Spread.Sheets.Charts.ChartType,
                                e.chartType() === r.pie || e.chartType() === r.doughnut ? (s = g.getPieColorArray(o.backColor)) && s.length > 0 && (l = s.length,
                                    n = c.generateColor(h, l).join(",")) : n = c.generateColor(h, b, i),
                                t.type ? "backColor" === t.type && o.backColor ? o.backColor = n : "borderColor" === t.type && o.border && (o.border.color = n) : (o.backColor && (o.backColor = n),
                                o.border && (o.border.color = n)),
                                f.set(i, o)
                    },
                    getPieColorArray: function(e) {
                        return e.match(/transparent|rgba\(\d+, *\d+, *\d+, *\d+\.?\d?\)|\w+ \d ?-?\d*/g)
                    },
                    generateColor: function(e, t, i) {
                        var o, n, r, a = this;
                        if (e instanceof Array) {
                            if (o = e.length,
                                i !== b)
                                return e[i % o];
                            for (n = [],
                                     r = 0; r < t; r++)
                                n.push(e[r % o]);
                            return n
                        }
                        if (e instanceof Object)
                            return a.getGradientThemeColor(e.startColor, e.stopColor, t, i)
                    },
                    getChartSeriesNames: function(e) {
                        var t, i, o, n, r, a, l = [], c = e.series().get();
                        for (t = 0; t < c.length; t++)
                            i = c[t],
                                o = g.getDataSourceSheetBySeries(i),
                            i.name && (n = "",
                                '"' === i.name.substr(0, 1) && '"' === i.name.substr(i.name.length - 1, 1) ? n = i.name : (r = s(o, i.name),
                                    a = o.getCell(r.row, r.col),
                                    n = a.value()),
                                l.push(n));
                        return l
                    },
                    getDataSourceSheetBySeries: function(e) {
                        var t;
                        return e.name && '"' !== e.name.substr(0, 1) || '"' !== e.name.substr(e.name.length - 1, 1) ? t = e.name : e.yValues ? t = e.yValues : e.xValues && (t = e.xValues),
                            g.getSheetFromFormula(t)
                    },
                    getSheetFromFormula: function(e) {
                        var t, i, o = n.wrapper.spread.getActiveSheet(), r = n.wrapper.spread, a = {};
                        return e && "=" !== e && (a = GC.Spread.Sheets.CalcEngine.formulaToExpression(o, e)),
                            a && a.source ? (i = a.source.getName(),
                                t = r.getSheetFromName(i)) : t = o,
                            t
                    },
                    judegeSeriesNameIsFormula: function(e) {
                        return '"' !== e.substr(0, 1) || '"' !== e.substr(e.length - 1, 1)
                    },
                    rangeToFormuls: function(e, t) {
                        var i, o, r = GC.Spread.Sheets.CalcEngine.rangeToFormula(e);
                        return t && (i = t.name(),
                            o = n.wrapper.spread.options.referenceStyle,
                        !n.util.isValidateSheetName(i, o, !1) && n.util.isValidateSheetName(i, o, !0) && (i = "'" + i + "'"),
                            r = i + "!" + r),
                            r
                    },
                    getActualChartStyle: function(e, t, i) {
                        var o, n, r = JSON.parse(JSON.stringify(t)), a = [];
                        for (o = 0; o < r.length; o++)
                            n = g.getMergedChartStyle(e, r[o]),
                                n.colorAndStyle = i,
                                a.push(n);
                        return a
                    },
                    getMergedChartStyle: function(e, t) {
                        var i = JSON.parse(JSON.stringify(e));
                        return t && (t.series && g.handleSeriesStyleMerge(i, t.series),
                            t.series = null,
                            g.mergeObject(i, t)),
                            i
                    },
                    handleSeriesStyleMerge: function(e, t) {
                        var i, o, a, s, l, d, p = {
                            transparent: "0",
                            halfTransparent: "0.5"
                        }, u = e.series, h = n.wrapper.spread.getActiveSheet().currentTheme();
                        for (i = 0; i < u.length; i++)
                            if (l = u[i].backColor,
                                u[i].chartType === r.ChartType.pie || u[i].chartType === r.ChartType.doughnut) {
                                if (s = l.charAt(0),
                                        l = "a" === s ? l.split(",") : l.match(/rgba\(\d+,\d+,\d+,\d+\.?\d?\)|[#\w ]+/g),
                                    "halfTransparent" === t.backColor) {
                                    for (d = 0; d < l.length; d++)
                                        c.isThemeColor(h, l[d]) && (l[d] = c.hexToRgba(c.parse(l[d], h).color)),
                                            o = l[d].split(","),
                                            o[o.length - 1] = o[o.length - 1].replace("1", "0.5"),
                                            a = o.join(","),
                                            l[d] = a;
                                    u[i].backColor = l.join(",")
                                } else if ("rgba(255,255,255,1)" === t.backColor) {
                                    for (d = 0; d < l.length; d++)
                                        l[d] = t.backColor;
                                    u[i].border.color = "rgba(0,0,0,0)",
                                        u[i].border.width = t.border.width
                                }
                            } else
                                t.border && "seriesBackColor" === t.border.color && (u[i].border.color = l,
                                    u[i].border.width = t.border.width),
                                c.isThemeColor(h, l) && (l = c.hexToRgba(c.parse(l, h).color)),
                                    o = l.split(","),
                                    o[o.length - 1] = o[o.length - 1].replace("1", p[t.backColor] ? p[t.backColor] : "1"),
                                    a = o.join(","),
                                    u[i].backColor = a
                    },
                    mergeObject: function(e, t) {
                        for (var i in t)
                            t.hasOwnProperty(i) && ("object" == typeof t[i] ? (e[i] || (e[i] = {}),
                                g.mergeObject(e[i], t[i])) : null !== t[i] && (e[i] = t[i]))
                    },
                    getSeriesWithoutStyle: function(e) {
                        for (var t, i = 0, o = e.length, n = []; i < o; i++)
                            t = {
                                chartType: e[i].chartType,
                                axisGroup: e[i].axisGroup,
                                name: e[i].name,
                                xValues: e[i].xValues,
                                yValues: e[i].yValues,
                                bubbleSizes: e[i].bubbleSizes
                            },
                                n.push(t);
                        return n
                    },
                    getImageFromChart: function(e) {
                        var t, i, o = e.getHost();
                        return o[0] && (i = o[0].getElementsByTagName("canvas")[0],
                            t = i.toDataURL("image/png")),
                            t
                    },
                    getSeriesColor: function(e, t, i) {
                        var o = this
                            , r = e ? e.color.group : "colorful"
                            , s = e ? e.color.index : 0
                            , l = a.chartColors
                            , d = l[r].colors[s].items
                            , p = o.generateColor(d, t, i)
                            , u = n.wrapper.spread.getActiveSheet().currentTheme();
                        return c.isThemeColor(u, p) && (p = c.hexToRgba(c.parse(p, u).color)),
                            p
                    },
                    axesItemEnum: {
                        axesPrimaryHorizontal: 0,
                        axesPrimaryVertical: 1,
                        axesSecondaryHorizontal: 2,
                        axesSecondaryVertical: 3
                    },
                    isBarGroup: function(e) {
                        var t, i, o, n, r = e.chartType(), a = !1, s = g.getChartGroupString(r);
                        if ("BarGroup" === s && (a = !0),
                            "ComboGroup" === s)
                            for (t = e.series().get(),
                                     i = 0; i < t.length; i++) {
                                if (o = t[i],
                                    "BarGroup" !== (n = g.getChartGroupString(o.chartType))) {
                                    a = !1;
                                    break
                                }
                                a = !0
                            }
                        return a
                    },
                    getChartAxesItem: function(e, t) {
                        var i = g.isBarGroup(e)
                            , o = e.axes();
                        if (i)
                            switch (t) {
                                case 0:
                                    return o.primaryValue;
                                case 1:
                                    return o.primaryCategory;
                                case 2:
                                    return o.secondaryValue;
                                case 3:
                                    return o.secondaryCategory
                            }
                        else
                            switch (t) {
                                case 0:
                                    return o.primaryCategory;
                                case 1:
                                    return o.primaryValue;
                                case 2:
                                    return o.secondaryCategory;
                                case 3:
                                    return o.secondaryValue
                            }
                    },
                    setChartAxesItem: function(e, t, i) {
                        var o = g.isBarGroup(e)
                            , n = e.axes();
                        if (o)
                            switch (t) {
                                case 0:
                                    n.primaryValue = i;
                                    break;
                                case 1:
                                    n.primaryCategory = i;
                                    break;
                                case 2:
                                    n.secondaryValue = i;
                                    break;
                                case 3:
                                    n.secondaryCategory = i
                            }
                        else
                            switch (t) {
                                case 0:
                                    n.primaryCategory = i;
                                    break;
                                case 1:
                                    n.primaryValue = i;
                                    break;
                                case 2:
                                    n.secondaryCategory = i;
                                    break;
                                case 3:
                                    n.secondaryValue = i
                            }
                        return n
                    },
                    chartElementType: ["series", "axis", b, "legend", "dataLabels", "chartTitle", b, "chartArea", "chartArea"]
                },
                    e.chartHelper = g,
                    n.util = e
            }(n.util || {})
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer
                , o = i.util.chartHelper;
            !function(e) {
                "use strict";
                var t = "separator"
                    , n = "designer."
                    , r = "gc-spread-"
                    , a = "gc.spread."
                    , s = "gc.spread.contextMenu."
                    , l = "removeSlicer"
                    , c = "toggleComment"
                    , d = "deleteComment"
                    , p = "editComment"
                    , u = "unhideSheet"
                    , h = "hideSheet"
                    , f = "unhideRows"
                    , g = "unhideColumns"
                    , m = "sortAscend"
                    , b = "sortDescend"
                    , v = "sort"
                    , y = "filter"
                    , x = "insertComment"
                    , w = "deleteSheet"
                    , C = "insertSheet"
                    , S = "clearContents"
                    , k = "paste"
                    , T = "pasteOptions"
                    , A = "pasteFormatting"
                    , I = "pasteValues"
                    , D = "pasteFormula"
                    , F = "pasteAll"
                    , L = "cut"
                    , R = "copy"
                    , B = "groupHeader"
                    , N = "protectSheet"
                    , E = "customSort"
                    , V = "formatCells"
                    , P = "defineName"
                    , z = "cellTag"
                    , j = "rowHeight"
                    , M = "columnWidth"
                    , O = "sheetTag"
                    , G = "rowTag"
                    , H = "colTag"
                    , U = "hideRows"
                    , W = "hideColumns"
                    , _ = "tabColor"
                    , q = "showTabColor"
                    , K = "formatComment"
                    , Y = "slicerCut"
                    , X = "slicerCopy"
                    , J = "slicerPasteOptions"
                    , Q = "slicerPaste"
                    , Z = "slicerSortAscend"
                    , ee = "slicerSortDescend"
                    , te = "slicerProperty"
                    , ie = "slicerSetting"
                    , oe = "insertColumns"
                    , ne = "insertRows"
                    , re = "deleteColumns"
                    , ae = "deleteRows"
                    , se = "insert_dialog"
                    , le = "delete_dialog"
                    , ce = "columnHeaders"
                    , de = "rowHeaders"
                    , pe = "changeChartTypeDialog"
                    , ue = "selectChartDataDialog"
                    , he = "formatChart"
                    , fe = "moveChartDialog"
                    , ge = "floatingObjectCut"
                    , me = "floatingObjectCopy"
                    , be = "resetChartColor"
                    , ve = "viewport"
                    , ye = "colHeader"
                    , xe = "rowHeader"
                    , we = "corner"
                    , Ce = "slicer"
                    , Se = "sheetTab"
                    , ke = "chart";
                function Te(e) {
                    return void 0 === e || null === e
                }
                function Ae(e, t, i) {
                    for (var o = e.length, n = 0; n < o; n++)
                        if (!Te(e[n])) {
                            if (t === e[n].name)
                                return void i(e, n);
                            e[n].subMenu && Ae(e[n].subMenu, t, i)
                        }
                }
                function Ie(e, t, i, o, n) {
                    var r, a;
                    for (t = t < 0 ? 0 : t,
                             i = i < 0 ? 0 : i,
                             r = t; r < t + o; r++)
                        for (a = i; a < i + n; a++)
                            if (e.getCell(r, a).locked())
                                return !0
                }
                function De(e) {
                    var t, i = e.getSelections(), o = !1;
                    for (t = 0; t < i.length; t++)
                        Ie(e, i[t].row, i[t].col, i[t].rowCount, i[t].colCount) && (o = !0);
                    return o
                }
                function $e(e) {
                    var t, i = e.getSelections();
                    for (t = 0; t < i.length; t++)
                        if (-1 !== i[t].col)
                            return !1;
                    return !0
                }
                function Fe(e) {
                    var t, i = e.getSelections();
                    for (t = 0; t < i.length; t++)
                        if (-1 !== i[t].row)
                            return !1;
                    return !0
                }
                function Le() {
                    var e, Te = i.wrapper.spread;
                    function Ie() {}
                    Ie.prototype = new GC.Spread.Sheets.ContextMenu.ContextMenu,
                        Ie.prototype.onOpenMenu = function(e, t, r, a) {
                            var s, l, c, d, p, h, f, g, m, b, v = this;
                            if (r.tabStripHitInfo) {
                                for (s = a.sheets,
                                         l = 0; l < s.length; l++)
                                    if (!s[l].visible())
                                        return void Ae(t, n + u, function(e, t) {
                                            e[t].disable = !1
                                        });
                                Ae(t, n + u, function(e, t) {
                                    e[t].disable = !0
                                })
                            } else
                                c = a.getActiveSheet(),
                                    d = c.getActiveRowIndex(),
                                    p = c.getActiveColumnIndex(),
                                (h = c.comments.get(d, p)) || Ae(t, n + K, function(e, t) {
                                    e.splice(t, 1)
                                });
                            f = r.worksheetHitInfo,
                            f && (g = f.floatingObjectHitInfo && f.floatingObjectHitInfo.floatingObject)instanceof GC.Spread.Sheets.Charts.Chart && (m = g.hitTest(r.x, r.y)) && (b = o.chartElementType,
                                Ae(t, n + he, function(e, t) {
                                    e[t].text = i.res.contextMenu.formatChart[b[m.elementType]],
                                        e[t].options = m
                                })),
                                v.checkAvailableByCurrentSelections(t, a),
                                v.checkAvailableByProtectionSettings(t, a),
                                v.trimNullObject(t),
                                v.trimSeparatorLine(t)
                        }
                        ,
                        Ie.prototype.checkAvailableByCurrentSelections = function(e, t) {
                            var i, o = this, r = t.getActiveSheet();
                            for (i = 0; i < e.length; i++)
                                if (e[i]) {
                                    switch (e[i].name) {
                                        case n + ne:
                                        case n + ae:
                                            $e(r) || (e[i].disable = !0);
                                            break;
                                        case n + oe:
                                        case n + re:
                                            Fe(r) || (e[i].disable = !0)
                                    }
                                    e[i] && e[i].subMenu && o.checkAvailableByCurrentSelections(e[i].subMenu, Te)
                                }
                        }
                        ,
                        Ie.prototype.checkAvailableByProtectionSettings = function(e, t) {
                            var i, o = this, r = t.getActiveSheet(), a = r.options.isProtected, s = r.options.protectionOptions;
                            if (a && s)
                                for (i = 0; i < e.length; i++)
                                    if (e[i]) {
                                        switch (e[i].name) {
                                            case n + ge:
                                            case n + me:
                                            case n + be:
                                            case n + pe:
                                            case n + ue:
                                            case n + fe:
                                            case n + he:
                                            case n + Y:
                                            case n + X:
                                            case n + Q:
                                            case n + Z:
                                            case n + ee:
                                            case n + l:
                                            case n + te:
                                            case n + ie:
                                                s.allowEditObjects || e.splice(0, e.length);
                                                break;
                                            case n + K:
                                                s.allowEditObjects || (e[i] = null);
                                                break;
                                            case n + j:
                                                s.allowResizeRows || (e[i].disable = !0);
                                                break;
                                            case n + M:
                                                s.allowResizeColumns || (e[i].disable = !0);
                                                break;
                                            case n + se:
                                            case n + le:
                                            case n + V:
                                            case n + P:
                                            case n + z:
                                            case n + G:
                                            case n + H:
                                            case n + U:
                                            case n + f:
                                            case n + W:
                                            case n + g:
                                            case n + ce:
                                            case n + de:
                                                e[i].disable = !0;
                                                break;
                                            case n + ne:
                                                s.allowInsertRows || (e[i].disable = !0);
                                                break;
                                            case n + oe:
                                                s.allowInsertColumns || (e[i].disable = !0);
                                                break;
                                            case n + re:
                                                s.allowDeleteColumns || (e[i].disable = !0);
                                                break;
                                            case n + ae:
                                                s.allowDeleteRows || (e[i].disable = !0);
                                                break;
                                            case n + y:
                                                s.allowFilter || (e[i].disable = !0);
                                                break;
                                            case n + m:
                                            case n + b:
                                            case n + E:
                                                s.allowSort && !De(r) || (e[i].disable = !0)
                                        }
                                        e[i] && e[i].subMenu && o.checkAvailableByProtectionSettings(e[i].subMenu, t)
                                    }
                        }
                        ,
                        Ie.prototype.trimNullObject = function(e) {
                            var t, i = this, o = e.length;
                            for (t = o - 1; t > 0; t--)
                                e[t] ? e[t].subMenu && i.trimNullObject(e[t].subMenu) : e.splice(t, 1);
                            return e
                        }
                        ,
                        Ie.prototype.trimSeparatorLine = function(e) {
                            var i, o, n, r, a, s = [], l = e.length;
                            for (i = 0; i < l; i++)
                                e[i] && e[i].type === t && e[i + 1] && e[i + 1].type === t || s.push(e[i]);
                            for (l = s.length,
                                     o = 0,
                                     n = 0,
                                     r = !0,
                                     a = !0,
                                     i = 0; i < l && (r && s[i].type === t ? o++ : r = !1,
                                a && s[l - 1 - i].type === t ? n++ : a = !1,
                            r || a); i++)
                                ;
                            for (s.splice(l - n, n),
                                     s.splice(0, o),
                                     e.splice(0, e.length),
                                     i = 0; i < s.length; i++)
                                e.push(s[i]);
                            return e
                        }
                        ,
                        Te.contextMenu = new Ie,
                        e = i.res.contextMenu,
                        Te.contextMenu.menuData = [{
                            text: e.cut,
                            name: n + L,
                            command: n + L,
                            iconClass: r + L,
                            workArea: ve + ye + xe + we
                        }, {
                            name: n + R,
                            text: e.copy,
                            command: n + R,
                            iconClass: r + R,
                            workArea: ve + ye + xe + we
                        }, {
                            text: e.paste,
                            name: n + k,
                            iconClass: r + T,
                            type: B,
                            workArea: ve + ye + xe + we
                        }, {
                            command: n + F,
                            name: n + F,
                            iconClass: r + F,
                            group: n + k,
                            text: e.pasteAll,
                            workArea: ve + ye + xe + we
                        }, {
                            command: n + D,
                            name: n + D,
                            iconClass: r + D,
                            group: n + k,
                            text: e.pasteFormula,
                            workArea: ve + ye + xe + we
                        }, {
                            command: n + I,
                            name: n + I,
                            iconClass: r + I,
                            group: n + k,
                            text: e.pasteValue,
                            workArea: ve + ye + xe + we
                        }, {
                            command: n + A,
                            name: n + A,
                            iconClass: r + A,
                            group: n + k,
                            text: e.pasteFormatting,
                            workArea: ve + ye + xe + we
                        }, {
                            text: e.cut,
                            name: n + ge,
                            command: n + ge,
                            iconClass: r + L,
                            workArea: ke
                        }, {
                            name: n + me,
                            text: e.copy,
                            command: n + me,
                            iconClass: r + R,
                            workArea: ke
                        }, {
                            type: t
                        }, {
                            text: e.resetChartColor,
                            name: n + be,
                            iconClass: r + be,
                            command: n + be,
                            workArea: ke
                        }, {
                            text: e.changeChartType,
                            name: n + pe,
                            iconClass: r + pe,
                            command: n + pe,
                            workArea: ke
                        }, {
                            text: e.selectData,
                            name: n + ue,
                            iconClass: r + ue,
                            command: n + ue,
                            workArea: ke
                        }, {
                            text: e.moveChart,
                            name: n + fe,
                            iconClass: r + fe,
                            command: n + fe,
                            workArea: ke
                        }, {
                            text: e.formatChart.chartArea,
                            name: n + he,
                            iconClass: r + he,
                            command: n + he,
                            workArea: ke
                        }, {
                            type: t
                        }, {
                            text: e.insertDialog,
                            name: n + se,
                            command: n + se,
                            workArea: ve + we
                        }, {
                            text: e.deleteDialog,
                            name: n + le,
                            command: n + le,
                            workArea: ve + we
                        }, {
                            text: e.insert,
                            name: n + oe,
                            command: s + oe,
                            workArea: ye
                        }, {
                            text: e.delete,
                            name: n + re,
                            command: s + re,
                            workArea: ye
                        }, {
                            text: e.insert,
                            name: n + ne,
                            command: s + ne,
                            workArea: xe
                        }, {
                            text: e.delete,
                            name: n + ae,
                            command: s + ae,
                            workArea: xe
                        }, {
                            text: e.clearcontents,
                            command: s + S,
                            name: n + S,
                            workArea: ve + ye + xe + we
                        }, {
                            type: t
                        }, {
                            text: e.insert,
                            name: n + C,
                            command: s + C,
                            workArea: Se
                        }, {
                            text: e.delete,
                            name: n + w,
                            command: s + w,
                            workArea: Se
                        }, {
                            text: e.protectsheet,
                            name: n + N,
                            command: n + N,
                            iconClass: r + N,
                            workArea: Se
                        }, {
                            type: t
                        }, {
                            text: e.filter,
                            name: n + y,
                            command: s + y,
                            workArea: ve + we
                        }, {
                            text: e.sort,
                            name: n + v,
                            subMenu: [{
                                text: e.sortAToZ,
                                name: n + m,
                                command: s + m,
                                iconClass: r + m
                            }, {
                                text: e.sortZToA,
                                name: n + b,
                                command: s + b,
                                iconClass: r + b
                            }, {
                                text: e.customSort,
                                name: n + E,
                                command: n + E,
                                iconClass: r + E
                            }],
                            workArea: ve + we
                        }, {
                            type: t
                        }, {
                            text: e.insertComment,
                            name: a + x,
                            command: s + x,
                            iconClass: r + x,
                            workArea: ve + we
                        }, {
                            text: e.editComment,
                            name: a + p,
                            command: s + p,
                            iconClass: r + p,
                            workArea: ve + we
                        }, {
                            text: e.deleteComment,
                            name: a + d,
                            command: s + d,
                            iconClass: r + d,
                            workArea: ve + we
                        }, {
                            text: e.unHideComment,
                            name: a + c,
                            command: s + c,
                            workArea: ve + we
                        }, {
                            text: e.formatComment,
                            name: n + K,
                            command: n + K,
                            iconClass: r + K,
                            workArea: ve + we
                        }, {
                            type: t
                        }, {
                            text: e.formatCells,
                            name: n + V,
                            command: n + V,
                            iconClass: r + V,
                            workArea: ve + ye + xe + we
                        }, {
                            text: e.defineName,
                            name: n + P,
                            command: n + P,
                            workArea: ve + we
                        }, {
                            text: e.tag,
                            name: n + z,
                            command: n + z,
                            workArea: ve + we
                        }, {
                            text: e.tag,
                            name: n + G,
                            command: n + G,
                            workArea: xe
                        }, {
                            text: e.tag,
                            name: n + H,
                            command: n + H,
                            workArea: ye
                        }, {
                            text: e.rowHeight,
                            name: n + j,
                            command: n + j,
                            workArea: xe
                        }, {
                            text: e.columnWidth,
                            name: n + M,
                            command: n + M,
                            workArea: ye
                        }, {
                            text: e.hide,
                            name: n + U,
                            command: s + U,
                            workArea: xe
                        }, {
                            text: e.hide,
                            name: n + W,
                            command: s + W,
                            workArea: ye
                        }, {
                            text: e.unhide,
                            name: n + g,
                            command: s + g,
                            workArea: ye
                        }, {
                            text: e.unhide,
                            name: n + f,
                            command: s + f,
                            workArea: xe
                        }, {
                            text: e.headers,
                            name: n + ce,
                            command: n + ce,
                            workArea: ye
                        }, {
                            text: e.headers,
                            name: n + de,
                            command: n + de,
                            workArea: xe
                        }, {
                            type: t
                        }, {
                            text: e.sheetTabColor,
                            name: n + q,
                            subMenu: [{
                                name: n + _,
                                command: n + _
                            }],
                            workArea: Se
                        }, {
                            text: e.hide,
                            name: n + h,
                            command: s + h,
                            workArea: Se
                        }, {
                            text: e.unhide,
                            name: n + u,
                            command: s + u,
                            workArea: Se
                        }, {
                            text: e.tag,
                            name: n + O,
                            command: n + O,
                            workArea: Se
                        }, {
                            type: t
                        }, {
                            text: e.cut,
                            name: n + Y,
                            iconClass: r + L,
                            command: s + L,
                            workArea: Ce
                        }, {
                            text: e.copy,
                            name: n + X,
                            iconClass: r + R,
                            command: s + R,
                            workArea: Ce
                        }, {
                            text: e.paste,
                            name: n + J,
                            iconClass: r + T,
                            type: B,
                            workArea: Ce
                        }, {
                            command: s + F,
                            name: n + Q,
                            iconClass: r + F,
                            group: n + J,
                            text: e.pasteAll,
                            workArea: Ce
                        }, {
                            text: e.sortAToZ,
                            name: n + Z,
                            iconClass: r + m,
                            command: s + Z,
                            workArea: Ce
                        }, {
                            text: e.sortZToA,
                            name: n + ee,
                            iconClass: r + b,
                            command: s + ee,
                            workArea: Ce
                        }, {
                            text: e.remove,
                            name: n + l,
                            command: s + l,
                            workArea: Ce
                        }, {
                            text: e.slicerProperty,
                            name: n + te,
                            command: n + te,
                            iconClass: r + te,
                            workArea: Ce
                        }, {
                            text: e.slicerSetting,
                            name: n + ie,
                            command: n + ie,
                            iconClass: r + ie,
                            workArea: Ce
                        }];
                    function Le() {}
                    Le.prototype = new GC.Spread.Sheets.ContextMenu.MenuView,
                        Le.prototype.createMenuItemElement = function(t) {
                            var o, r, a, s = this;
                            return t.name === n + _ ? (r = GC.Spread.Sheets.ContextMenu.MenuView.prototype.createMenuItemElement.call(s, t),
                                r.empty(),
                                $(r[0]).colorpicker({
                                    valueChanged: function(e, t) {
                                        t.isSetColorDirectly ? i.actions.doAction("setSheetTabColor", i.wrapper.spread, t.color) : $(r[0]).data("selectedColor", t)
                                    }
                                }),
                                $(r[0]).colorpicker("option", "themeColors", i.wrapper.getThemeColors()),
                                r.css({
                                    margin: "0",
                                    padding: "0"
                                }),
                                r.css("background", "white"),
                                r) : t.name === n + N ? (a = i.wrapper.spread.getActiveSheet(),
                                a.options.isProtected ? t.text = e.unprotectsheet : t.text = e.protectsheet,
                                o = GC.Spread.Sheets.ContextMenu.MenuView.prototype.createMenuItemElement.call(s, t)) : o = GC.Spread.Sheets.ContextMenu.MenuView.prototype.createMenuItemElement.call(s, t)
                        }
                        ,
                        Le.prototype.getCommandOptions = function(e, t, i) {
                            return e.name === n + _ ? {
                                value: $(t).children().data("selectedColor")
                            } : e.name === n + he ? e.options : void 0
                        }
                        ,
                        Te.contextMenu.menuView = new Le,
                        i.spreadActions.initDesignerCommands(Te.commandManager())
                }
                e.initContextMenu = Le,
                    i.loader.ready(function() {
                        i.wrapper.spread.notWorking || Le()
                    }),
                    i.contextMenu = e
            }(i.contextMenu || {})
        }
        , function(e, t) {
            !function() {
                "use strict";
                var e = GC.Spread.Sheets.Designer
                    , t = function() {
                    function t() {
                        this.res = e.res
                    }
                    return t.Instance = new t,
                        t
                }()
                    , i = function() {
                    function i(e, t) {
                        if (this.ho = this.wo(),
                                this.ho.autoOpen)
                            throw "AutoOpen is not support.";
                        this.updateOptions(),
                            this.xo = $("<div></div>"),
                            void 0 !== e ? this.xo.load(e + " " + t, this.onLoad.bind(this)) : this.yo = !0
                    }
                    return i.prototype.wo = function() {
                        return null
                    }
                        ,
                        i.prototype.open = function() {
                            var e, t = [];
                            for (e = 0; e < arguments.length - 0; e++)
                                t[e] = arguments[e + 0];
                            this.zo || (this.Ao = t,
                                this.zo = !0,
                            this.yo && this.openReally())
                        }
                        ,
                        i.prototype.close = function() {
                            this.zo && (this.zo = !1,
                            this.yo && this.xo.dialog("close"))
                        }
                        ,
                        i.prototype.destroy = function() {
                            this.yo && this.xo.dialog("destroy")
                        }
                        ,
                        i.prototype.Bo = function(e) {}
                        ,
                        i.prototype.Co = function() {}
                        ,
                        i.prototype.Do = function() {
                            return t.Instance
                        }
                        ,
                        i.prototype._init = function() {}
                        ,
                        i.prototype.openReally = function() {
                            this.Eo || this.onInit(),
                                this.Bo.call(this, this.Ao),
                                this.xo.dialog("open")
                        }
                        ,
                        i.prototype.onLoad = function() {
                            this.yo = !0,
                            this.zo && this.openReally()
                        }
                        ,
                        i.prototype.onInit = function() {
                            var e = this;
                            this.Eo = !0,
                                this.Fo = this.Do(),
                                this.xo.dialog(this.ho),
                                this.Go = this.xo.parent(),
                                this._init(),
                            void 0 !== this.Fo && ko.applyBindings(e.Fo, e.xo[0]),
                            this.ho.preventDefaultOkButton || this.xo.parent().on("keypress", function(t) {
                                var i, o, n;
                                13 === t.keyCode && (i = e.xo.parent().find("button:focus").length > 0,
                                    o = e.xo.parent().find("button[dialogToBeFocused='true']"),
                                i || (n = e.Ho()) && n.click && !o.is(":focus") && n.click.call(e))
                            }),
                                this.xo.dialog({
                                    open: function() {
                                        e.xo.parent().trigger("mousedown"),
                                            e.xo.parent().find("button[dialogToBeFocused='true']").focus()
                                    }
                                })
                        }
                        ,
                        i.prototype.Ho = function() {
                            var e, t, i = this, o = i.ho.buttons;
                            for (e = 0; e < o.length; e++)
                                if (t = o[e],
                                        t.isDefault)
                                    return t;
                            return o[0]
                        }
                        ,
                        i.prototype.onClose = function(e, t) {
                            this.zo = !1,
                            void 0 !== this.Io && this.Io.call(this.xo, e, t),
                                this.Co()
                        }
                        ,
                        i.prototype.updateOptions = function() {
                            this.ho.autoOpen = !1,
                                this.ho.closeText = e.res.close,
                                this.ho.resizable = !1,
                                this.Io = this.ho.close,
                                this.ho.close = this.onClose.bind(this),
                            this.ho.buttons && this.ho.buttons[0] && (this.ho.buttons[0].dialogToBeFocused = "true")
                        }
                        ,
                        i.prototype.getActiveSelection = function(e) {
                            return e.getSelections()[0]
                        }
                        ,
                        i.prototype.Jo = function(t, i, o, n) {
                            return this.Ko || (this.Ko = e.wrapper.spread.getActiveSheet().getCalcService()),
                                this.Ko.unparse(t, i, o, n)
                        }
                        ,
                        i.prototype.Lo = function(t, i, o, n, r, a) {
                            return this.Ko || (this.Ko = e.wrapper.spread.calcService),
                                this.Ko.parse(t, i, o, n, r, a)
                        }
                        ,
                        i.prototype.Mo = function(e) {
                            return !(!e || "string" != typeof e) && "=" == ("" + e)[0]
                        }
                        ,
                        i.prototype.No = function(t) {
                            var i, o, n, r, a, s, l, c, d;
                            if (this.Mo(t)) {
                                if (i = e.wrapper.spread.getActiveSheet(),
                                        o = i.getActiveRowIndex(),
                                        n = i.getActiveColumnIndex(),
                                    !(r = i.getSelections()) || !r.length)
                                    return t;
                                for (a = r[0].row,
                                         s = r[0].col,
                                         l = 1; l < r.length; l++)
                                    c = r[l],
                                        a = a <= c.row ? a : c.row,
                                        s = s <= c.col ? s : c.col;
                                return a = a < 0 ? 0 : a,
                                    s = s < 0 ? 0 : s,
                                    d = GC.Spread.Sheets.CalcEngine.formulaToExpression(i, t, o, n),
                                "=" + GC.Spread.Sheets.CalcEngine.expressionToFormula(i, d, a, s)
                            }
                            return t
                        }
                        ,
                        i.prototype.Oo = function(e, t) {
                            var i = this.xo.find(".textBox-cell" + t).val()
                                , o = ("" + (i || "")).toUpperCase();
                            return i = "TRUE" === o || "FALSE" !== o && this.No(i)
                        }
                        ,
                        i.prototype.hide = function() {
                            var e = $(".ui-widget-overlay");
                            this.Go.hide(),
                            e && e.hide()
                        }
                        ,
                        i.prototype.show = function() {
                            var e = $(".ui-widget-overlay");
                            e && e.show(),
                                this.Go.show()
                        }
                        ,
                        i
                }();
                e.BaseDialog = i
            }()
        }
        , function(e, t, i) {
            var o = GC.Spread.Sheets.Designer
                , n = o.util.resolveHtmlPath("../dialogs", "chartDialogs.html")
                , r = i(1)
                , a = i(14)
                , s = GC.Spread.Sheets.Charts
                , l = s.Chart
                , c = GC.Spread.Sheets.CalcEngine.rangeToFormula
                , d = GC.Spread.Sheets.CalcEngine.formulaToRange
                , p = GC.Spread.Sheets.CalcEngine.formulaToRanges
                , u = o.util.chartHelper
                , h = o.ColorHelper;
            !function() {
                "use strict";
                var e, t, i, r, h = function(e) {
                    var t, i;
                    o.extends(r, e),
                        t = {
                            0: 1,
                            1: 0
                        },
                        i = function(e, t) {
                            return (e !== s.ChartType.columnClustered && e !== s.ChartType.columnStacked && e !== s.ChartType.columnStacked100 || t !== s.ChartType.columnClustered && t !== s.ChartType.columnStacked && t !== s.ChartType.columnStacked100) && ((e !== s.ChartType.line && e !== s.ChartType.lineStacked && e !== s.ChartType.lineStacked100 || t !== s.ChartType.line && t !== s.ChartType.lineStacked && t !== s.ChartType.lineStacked100) && ((e !== s.ChartType.lineMarkers && e !== s.ChartType.lineMarkersStacked && e !== s.ChartType.lineMarkersStacked100 || t !== s.ChartType.lineMarkers && t !== s.ChartType.lineMarkersStacked && t !== s.ChartType.lineMarkersStacked100) && ((e !== s.ChartType.barClustered && e !== s.ChartType.barStacked && e !== s.ChartType.barStacked100 || t !== s.ChartType.barClustered && t !== s.ChartType.barStacked && t !== s.ChartType.barStacked100) && (e !== s.ChartType.area && e !== s.ChartType.areaStacked && e !== s.ChartType.areaStacked100 || t !== s.ChartType.area && t !== s.ChartType.areaStacked && t !== s.ChartType.areaStacked100))))
                        }
                    ;
                    function r() {
                        e.call(this, n, ".select-chart-dialog"),
                            this.u = {
                                category: null,
                                chartType: null,
                                dataOrientation: null
                            },
                            this.Po = [],
                            this.Qo = r.dialogType.insertChart,
                            this.j = null,
                            this.Ro = null,
                            this.So = null,
                            this.To = !0
                    }
                    return r.prototype.wo = function() {
                        var e = this;
                        return {
                            width: "650px",
                            resizable: !1,
                            modal: !0,
                            title: o.res.selectChartDialog.title,
                            buttons: [{
                                text: o.res.ok,
                                click: function() {
                                    e.Uo(),
                                        e.close()
                                }
                            }, {
                                text: o.res.cancel,
                                click: function() {
                                    e.close(),
                                        o.wrapper.setFocusToSpread()
                                }
                            }]
                        }
                    }
                        ,
                        r.prototype._init = function() {
                            this.En()
                        }
                        ,
                        r.prototype.Co = function() {
                            this.u = {
                                category: null,
                                chartType: null,
                                dataOrientation: null
                            },
                                this.Po = [],
                                this.Qo = r.dialogType.insertChart,
                                this.j = null,
                                this.So = null,
                                this.To = !0
                        }
                        ,
                        r.prototype.Bo = function(e) {
                            var t = this;
                            t.Qo = e[0],
                                t.Po = [],
                                o.chartPreviewer.synchronizeData(o.wrapper.spread),
                                t.Qo === r.dialogType.insertChart ? t.Vo() : t.Wo(e[1]),
                                t.Zn(),
                                t.Xo()
                        }
                        ,
                        r.prototype.Vo = function() {
                            var e = this
                                , t = e.xo;
                            t.dialog("option", "title", o.res.selectChartDialog.insertChart),
                                e.u = {
                                    category: "ColumnGroup",
                                    chartType: "columnClustered",
                                    dataOrientation: s.RowCol.columns
                                },
                                e.Yo()
                        }
                        ,
                        r.prototype.Yo = function() {
                            var e, t, i, n, r = this, a = o.wrapper.spread, l = a.getActiveSheet(), d = l.getSelections()[0];
                            r.So = c(d),
                                e = r.Zo(r.So, s.RowCol.rows),
                                t = r.Zo(r.So, s.RowCol.columns),
                                i = u.getSeriesWithoutStyle(e),
                                n = u.getSeriesWithoutStyle(t),
                                r.Po.push(n),
                                r.Po.push(i)
                        }
                        ,
                        r.prototype.Zo = function(e, t) {
                            var i = o.wrapper.spread.getActiveSheet()
                                , n = new l(i,"",s.ChartType.columnClustered,20,20,480,288,e,t);
                            return n.series().get()
                        }
                        ,
                        r.prototype.Wo = function(e) {
                            var t, i, n, r, a, l, c, d = this, p = d.xo;
                            d.j = e,
                                p.dialog("option", "title", o.res.selectChartDialog.changeChartType),
                                t = e.chartType(),
                                i = u.getChartGroupString(t),
                                r = e.series().get(),
                                d.So = e.dataRange(),
                                n = e.getDataOrientation(),
                                t = t === s.ChartType.combo ? "customCombination" : u.getChartTypeString(t),
                                d.u = {
                                    category: i,
                                    chartType: t,
                                    dataOrientation: n || s.RowCol.columns
                                },
                                a = u.getSeriesWithoutStyle(r),
                                d.Po.push(a),
                            (l = d.$o(r)) && (c = u.getSeriesWithoutStyle(l),
                                d.Po.push(c))
                        }
                        ,
                        r.prototype.$o = function(e) {
                            var t, i = o.wrapper.spread.getActiveSheet(), n = new s.Chart(i,"chartForGetSwitchedSeries",void 0,20,20,480,288,null);
                            return n.series().add(e),
                                t = n.switchDataOrientation(),
                                t ? n.series().get() : null
                        }
                        ,
                        r.prototype.Uo = function() {
                            var e, i, n = this;
                            n.To && (n.Qo === r.dialogType.insertChart ? o.actions.doAction("insertChart", o.wrapper.spread, {
                                chartType: n.u.chartType,
                                dataOrientation: n.u.dataOrientation,
                                dataFormula: n.So,
                                category: n.u.category,
                                series: n.Po[t[n.u.dataOrientation]]
                            }) : (e = n.u.dataOrientation !== s.RowCol.columns,
                                o.actions.doAction("changeChartType", o.wrapper.spread, {
                                    chartType: n.u.chartType,
                                    isSwitchDataOrientation: e,
                                    dataFormula: n.So,
                                    category: n.u.category,
                                    series: n.Po[t[n.u.dataOrientation]],
                                    chart: n.j
                                })),
                                i = o.wrapper.spread.getActiveSheet(),
                                i.clearSelection())
                        }
                        ,
                        r.prototype.En = function() {
                            var e, t, i, o = this, n = o.xo, r = n.find(".chart-type-category");
                            r.on("click", function(e) {
                                var t = $(e.currentTarget)
                                    , i = t.data("name")
                                    , r = n.find("[data-group=" + i + "]")
                                    , a = $(r[0]).data("name");
                                o.u.category = i,
                                    o.u.chartType = a,
                                    o.u.dataOrientation = s.RowCol.columns,
                                    o._o(),
                                    o.Zn(),
                                    o.Xo()
                            }),
                                e = n.find(".select-chart-type-subtype-item"),
                                e.on("click", function(e) {
                                    var t = $(e.currentTarget)
                                        , i = t.data("name");
                                    o.u.chartType = i,
                                        o.u.dataOrientation = s.RowCol.columns,
                                        o._o(),
                                        o.Zn(),
                                        o.Xo()
                                }),
                                t = n.find(".select-chart-type-preview-item"),
                                t.on("click", function(e) {
                                    var t = $(e.currentTarget)
                                        , i = t.data("name");
                                    o.u.dataOrientation = s.RowCol[i],
                                        o.Zn()
                                }),
                                i = n.find(".series-content-items"),
                                i.on("click", function(e) {
                                    var t, i, n, r, l, c = $(e.target), d = $(".series-item");
                                    for (d.removeClass("series-item-modifying"),
                                             d.removeClass("series-item-selected"),
                                             i = 0; i < d.length; i++)
                                        $(d[i]).find(c).length > 0 && (t = $(d[i]),
                                            o.ap = i);
                                    t && ("series-chart-type-container" === c.attr("class") || "series-chart-type-container" === c.parent().attr("class") ? (n = $(".series-chart-type-list-container"),
                                    o.Ro || (o.Ro = new a(n,function(e, t) {
                                            o.Po[0][o.ap].chartType !== s.ChartType[t] && (o.u.chartType = "customCombination",
                                                o.bp(o.ap, s.ChartType[t]),
                                                o.cp.gcuipopup("hide"),
                                                o.dp(),
                                                o.Xo())
                                        }
                                    )),
                                        r = u.getChartTypeString(o.Po[0][o.ap].chartType),
                                        o.Ro.updateSelectedStatus(r),
                                        o.cp = $(".series-chart-type-list-popup").gcuipopup({
                                            autoHide: !0,
                                            position: {
                                                of: c,
                                                my: "left bottom",
                                                at: "left top"
                                            }
                                        }),
                                        o.cp.gcuipopup("show"),
                                        t.addClass("series-item-modifying")) : "series-secondary-axis-checkbox" === c.attr("class") ? (t.addClass("series-item-modifying"),
                                        l = c[0].checked,
                                        o.ep(l),
                                        o.dp(),
                                        o.Xo()) : t.addClass("series-item-selected"))
                                })
                        }
                        ,
                        r.prototype.ep = function(e) {
                            var t, i, o, n, r = this, a = r.Po[0];
                            if (!e)
                                return void (a[r.ap].axisGroup = s.AxisGroup.primary);
                            for (i = a.length,
                                     t = 0; t < i; t++)
                                if (a[t].axisGroup === s.AxisGroup.primary) {
                                    if (t !== r.ap)
                                        return void (a[r.ap].axisGroup = s.AxisGroup.secondary);
                                    for (o = t + 1; o < i; o++)
                                        if (a[o].axisGroup === s.AxisGroup.primary)
                                            return void (a[r.ap].axisGroup = s.AxisGroup.secondary)
                                }
                            for (n = $(".series-secondary-axis-checkbox"),
                                     t = 0; t < i; t++)
                                a[t].axisGroup = s.AxisGroup.primary,
                                    n[t].checked = !1
                        }
                        ,
                        r.prototype.Zn = function() {
                            var e, t, i, o, n = this, r = n.xo, a = n.u.category, l = n.u.chartType, c = n.u.dataOrientation === s.RowCol.rows ? "rows" : "columns", d = r.find(".chart-type-category"), p = r.find("[data-name=" + a + "]");
                            n.fp(d, p),
                                e = r.find(".select-chart-type-subtype-item"),
                                t = r.find("[data-name=" + l + "]"),
                                n.fp(e, t),
                                i = r.find(".select-chart-type-preview-item"),
                                o = r.find("[data-name=" + c + "]"),
                                n.fp(i, o),
                                n.gp(l),
                                n.hp(a)
                        }
                        ,
                        r.prototype.dp = function() {
                            var e, t, i, n, r, a, l, c, d, p, h, f, g = this, m = g.xo, b = g.u.chartType, v = m.find(".select-chart-type-subtype-item"), y = m.find("[data-name=" + b + "]");
                            for (g.fp(v, y),
                                     e = g.u.dataOrientation === s.RowCol.rows ? "rows" : "columns",
                                     t = m.find(".select-chart-type-preview-item"),
                                     i = m.find("[data-name=" + e + "]"),
                                     g.fp(t, i),
                                     g.gp(b),
                                     m.find(".select-chart-type-preview-item").addClass("hidden"),
                                     n = m.find("[data-group=" + b + "]"),
                                     n.removeClass("hidden"),
                                     r = $(".series-item"),
                                     a = g.Po[0],
                                     l = 0,
                                     c = a.length; l < c; l++)
                                d = r[l],
                                    p = a[l],
                                    h = $(d).find(".series-chart-type-selected"),
                                    h.text(o.res.selectChartDialog[u.getChartTypeString(p.chartType)]),
                                    f = $(d).find(".series-secondary-axis-checkbox"),
                                    f[0].checked = p.axisGroup === s.AxisGroup.primary ? "" : "checked"
                        }
                        ,
                        r.prototype.gp = function(e) {
                            $(".select-chart-type-title").text(o.res.selectChartDialog[e])
                        }
                        ,
                        r.prototype.fp = function(e, t) {
                            e.removeClass("chart-ui-selected"),
                                t.addClass("chart-ui-selected")
                        }
                        ,
                        r.prototype.hp = function(e) {
                            var t, i = this, o = i.xo;
                            o.find(".select-chart-type-subtype-item").addClass("hidden"),
                                t = o.find("[data-group=" + e + "]"),
                                t.removeClass("hidden")
                        }
                        ,
                        r.prototype.ip = function() {
                            $(".series-container").show(),
                                this.jp()
                        }
                        ,
                        r.prototype.kp = function() {
                            $(".series-container").hide()
                        }
                        ,
                        r.prototype.Xo = function() {
                            var e, t, i, n, r, a, l, c, d, p, h = this, f = h.xo;
                            for (f.find(".select-chart-type-preview-item").addClass("hidden"),
                                     h.lp() ? h.ip() : h.kp(),
                                     t = h.u.chartType,
                                     i = h.mp(),
                                     n = o.chartPreviewer.getChartPreviewCharts(i),
                                     r = f.find("[data-group=" + h.u.chartType + "]"),
                                     a = $(".select-chart-type-error-message"),
                                     e = 0; e < r.length; e++) {
                                if (l = n[e]) {
                                    if (!(l instanceof s.Chart))
                                        return p = o.res.selectChartDialog.errorPrompt[t + "ErrorMsg"],
                                            a.text(p),
                                            a.show(),
                                            r.addClass("hidden"),
                                            void (h.To = !1);
                                    a.hide(),
                                        $(r[e]).removeClass("hidden"),
                                        c = u.getImageFromChart(l),
                                        d = $($(r[e]).find(".chart-type-preview-icon")),
                                        h.lp() ? d.css("background-size", "330px") : d.css("background-size", "190px"),
                                        d.css("background-image", "url('" + c + "')")
                                }
                                h.To = !0
                            }
                        }
                        ,
                        r.prototype._o = function() {
                            var e, t, i, o = this;
                            if (o.lp())
                                o.np();
                            else
                                for (e = o.u.chartType,
                                         t = 0; t < o.Po.length; t++)
                                    for (i = 0; i < o.Po[t].length; i++)
                                        o.pp(t, i, s.ChartType[e])
                        }
                        ,
                        r.prototype.np = function() {
                            var e, t, i, o, n, r, a, l = this, c = l.u.chartType;
                            if ("columnClusteredAndLine" === c)
                                e = s.ChartType.columnClustered,
                                    t = s.ChartType.line,
                                    i = o = s.AxisGroup.primary;
                            else if ("columnClusteredAndLineOnSecondaryAxis" === c)
                                e = s.ChartType.columnClustered,
                                    t = s.ChartType.lineMarkers,
                                    i = s.AxisGroup.primary,
                                    o = s.AxisGroup.secondary;
                            else {
                                if ("stackedAreaAndColumnClustered" !== c)
                                    return;
                                e = s.ChartType.areaStacked,
                                    t = s.ChartType.columnClustered,
                                    i = o = s.AxisGroup.primary
                            }
                            for (r = l.Po[0].length,
                                     a = r / 2,
                                     n = 0; n < r; n++)
                                n < a ? (l.Po[0][n].chartType = e,
                                    l.Po[0][n].axisGroup = i) : (l.Po[0][n].chartType = t,
                                    l.Po[0][n].axisGroup = o)
                        }
                        ,
                        r.prototype.pp = function(e, t, i) {
                            this.Po[e][t].chartType = i
                        }
                        ,
                        r.prototype.bp = function(e, t) {
                            var o, n, r = this, a = r.Po[0];
                            for (a[e].chartType = t,
                                     o = a.length,
                                     n = 0; n < o; n++)
                                i(t, a[n].chartType) || (a[n].chartType = t)
                        }
                        ,
                        r.prototype.mp = function() {
                            var e, t, i, o, n, a, l, c, d, p = this, u = [];
                            for (p.Qo === r.dialogType.changeChartType && p.j.colorAndStyle && p.j.colorAndStyle.color && (e = p.j.colorAndStyle),
                                     t = p.lp() || p.qp() || p.rp() ? 1 : p.Po.length,
                                 p.j && (i = p.j.axes(),
                                     o = p.j.dataLabels(),
                                     n = p.j.chartArea(),
                                     a = p.j.legend(),
                                     l = p.j.getDataOrientation(),
                                     c = p.j.title()),
                                     d = 0; d < t; d++)
                                l = void 0 !== l && null !== l ? 0 === d ? l : Math.abs(l - 1) : 0 === d ? s.RowCol.columns : s.RowCol.rows,
                                p.Qo === r.dialogType.insertChart && p.rp() && (l = null),
                                    u.push({
                                        chartType: p.u.chartType,
                                        dataFormula: p.So,
                                        colorAndStyle: e,
                                        series: p.Po[d],
                                        category: p.u.category,
                                        dataOrientation: l,
                                        axes: i,
                                        dataLabels: o,
                                        chartArea: n,
                                        legend: a,
                                        title: c
                                    });
                            return u
                        }
                        ,
                        r.prototype.lp = function() {
                            if (this.u.category === u.chartTypeDict[0].chartGroup)
                                return !0
                        }
                        ,
                        r.prototype.qp = function() {
                            if (this.u.category === u.chartTypeDict[50].chartGroup)
                                return !0
                        }
                        ,
                        r.prototype.rp = function() {
                            if (this.u.chartType === u.chartTypeDict[10].chartType)
                                return !0
                        }
                        ,
                        r.prototype.jp = function() {
                            var e, t, i, n, r, a, l, c, p, h, f, g, m, b, v, y, x = this, w = x.xo, C = o.wrapper.spread.getActiveSheet(), S = w.find(".series-content-items");
                            for (S.empty(),
                                 x.j && (e = x.j.colorAndStyle),
                                     t = x.Po[0],
                                     i = t.length,
                                     n = 0; n < i; n++)
                                r = t[n],
                                    a = r.name,
                                    '"' === a.substr(0, 1) && '"' === a.substr(a.length - 1, 1) ? l = a : (c = d(C, a.substring(a.indexOf("!") + 1)),
                                        l = C.getCell(c.row, c.col).text()),
                                    p = r.axisGroup === s.AxisGroup.primary ? "" : "checked",
                                    h = u.getChartTypeString(r.chartType),
                                    f = o.res.selectChartDialog[h],
                                    g = u.getSeriesColor(e, i, n),
                                    m = $("<div class='series-item'></div>"),
                                    b = $("<div class='series-name'><span class='series-item-color' style='background-color:" + g + "'></span><span class='series-item-name'>" + l + "</span></div>"),
                                    v = $("<div class='series-chart-type-container'><div class='series-chart-type-selected'>" + f + "</div></div>"),
                                    y = $("<div class='series-secondary-axis'><input type='checkbox' class='series-secondary-axis-checkbox'" + p + "/></div>"),
                                    b.appendTo(m),
                                    v.appendTo(m),
                                    y.appendTo(m),
                                    m.appendTo(S)
                        }
                        ,
                        r
                }(o.BaseDialog);
                h.dialogType = {
                    insertChart: 0,
                    changeChartType: 1
                },
                    o.SelectChartDialog = h,
                    e = function(e) {
                        o.extends(t, e);
                        function t() {
                            e.call(this, n, ".move-chart-dialog"),
                                this.sp = t.sheetType.existingSheets
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "650px",
                                resizable: !1,
                                modal: !0,
                                title: o.res.moveChartDialog.title,
                                buttons: [{
                                    text: o.res.ok,
                                    click: function() {
                                        e.Uo(),
                                            e.close()
                                    }
                                }, {
                                    text: o.res.cancel,
                                    click: function() {
                                        e.close(),
                                            o.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                e.En()
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t = this
                                    , i = o.wrapper.spread
                                    , n = i.sheets
                                    , r = u.getSelectedChart(i.getActiveSheet());
                                t.tp(r, n),
                                    t.up(n),
                                    t.vp()
                            }
                            ,
                            t.prototype.up = function(e) {
                                var t, i, o, n = $("#existingSheetName");
                                for (n.empty(),
                                         t = 0; t < e.length; t++)
                                    i = e[t].name(),
                                        o = $("<option></option>"),
                                        o.attr("value", i),
                                        o.text(i),
                                        o.appendTo(n)
                            }
                            ,
                            t.prototype.tp = function(e, t) {
                                for (var i = e.name(), o = 1; !this.wp(i, t); )
                                    i = "Chart " + o,
                                        o++;
                                $("#chartSheetName").val(i)
                            }
                            ,
                            t.prototype.wp = function(e, t) {
                                var i, o;
                                for (i = 0; i < t.length; i++)
                                    if (o = t[i],
                                        e === o.name())
                                        return !1;
                                return !0
                            }
                            ,
                            t.prototype.vp = function() {
                                this.sp === t.sheetType.newSheet ? $("#moveToNewSheet").prop("checked", !0) : $("#moveToExistingSheet").prop("checked", !0)
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = {};
                                this.sp === t.sheetType.newSheet ? (e.targetSheetName = $("#chartSheetName").val(),
                                    e.type = "newSheet") : (e.targetSheetName = $("#existingSheetName").val(),
                                    e.type = "existingSheet"),
                                    o.actions.doAction("moveChart", o.wrapper.spread, e)
                            }
                            ,
                            t.prototype.En = function() {
                                var e = this;
                                $("#chartSheetName").on("click", function() {
                                    e.sp = t.sheetType.newSheet,
                                        e.vp()
                                }),
                                    $("#existingSheetName").on("click", function() {
                                        e.sp = t.sheetType.existingSheets,
                                            e.vp()
                                    }),
                                    $("input:radio[name=moveToSheetType]").change(function() {
                                        e.sp = t.sheetType[this.value]
                                    })
                            }
                            ,
                            t
                    }(o.BaseDialog),
                    o.MoveChartDialog = e,
                    e.sheetType = {
                        newSheet: 0,
                        existingSheets: 1
                    },
                    t = {
                        RECHOOSE: 0,
                        EDIT: 1,
                        REMOVE: 2,
                        REORDER: 3,
                        ADD: 4
                    },
                    i = function(e) {
                        o.extends(i, e);
                        function i() {
                            e.call(this, n, ".chart-select-data"),
                                this.xp = null,
                                this.yp = null,
                                this.series = null
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "650px",
                                resizable: !1,
                                modal: !0,
                                title: o.res.selectData.selectDataSource,
                                buttons: [{
                                    text: o.res.ok,
                                    click: function() {
                                        var t = e.zp();
                                        e.close(),
                                            o.wrapper.setFocusToSpread(),
                                        t && o.actions.doAction("updateChartAllSeries", o.wrapper.spread, {
                                            seriesArray: e.yp,
                                            chart: e.yn
                                        })
                                    }
                                }, {
                                    text: o.res.cancel,
                                    click: function() {
                                        e.close(),
                                            o.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype._init = function() {
                                var e = this;
                                this.En(),
                                e.Ap || (e.Ap = new o.RangeSelectDialog(e,{
                                    absoluteReference: !0
                                }))
                            }
                            ,
                            i.prototype.Bo = function(e) {
                                this.yn = e[0],
                                    this.Po = this.yn.series(),
                                    this.yp = this.Po.get(),
                                    this.Bp = this.yn.dataRange(),
                                    this.j = this.Cp(this.yn.series().get()),
                                    this.xp = null,
                                    this.Dp = null,
                                    this.Ep = [],
                                    this.Fp(),
                                    this.Gp(),
                                    this.Hp(t.RECHOOSE),
                                    this.Ip(),
                                    this.Jp()
                            }
                            ,
                            i.prototype.Kp = function(e, t, i) {
                                var o, n, r = document.createElement("div");
                                return r.className = t,
                                    o = document.createElement("input"),
                                    o.type = "checkbox",
                                    n = document.createElement("span"),
                                    n.className = "chart-select-data-select-text",
                                null !== e && void 0 !== e || (e = ""),
                                    e = "" + e,
                                    n.innerHTML = e.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"),
                                    r.appendChild(n),
                                    r
                            }
                            ,
                            i.prototype.Cp = function(e) {
                                var t = o.wrapper.spread.getActiveSheet()
                                    , i = new GC.Spread.Sheets.Charts.Chart(t,"middleChart",void 0,0,0,100,100,null);
                                return e.forEach(function(e, t) {
                                    i.series().add(e)
                                }),
                                    i
                            }
                            ,
                            i.prototype.Lp = function(e, i) {
                                var n, r, a, s, l, c, d, p, h;
                                if (e < this.yp.length) {
                                    if (n = this.yp[e],
                                            r = this.Mp(n.yValues),
                                            a = this.Mp(i.yValues),
                                            s = u.getChartGroupString(this.yn.chartType()),
                                            l = u.getChartTypeString(this.yn.chartType()),
                                        "ScatterGroup" === s) {
                                        if (c = this.Mp(n.xValues),
                                                d = this.Mp(i.xValues),
                                            c.rowCount !== d.rowCount || c.colCount !== d.colCount)
                                            return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                                        if (n.xValues = i.xValues,
                                            "bubble" === l) {
                                            if (p = this.Mp(n.bubbleSizes),
                                                    h = this.Mp(i.bubbleSizes),
                                                p.rowCount !== h.rowCount || p.colCount !== h.colCount)
                                                return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                                            n.bubbleSizes = i.bubbleSizes
                                        }
                                    }
                                    if (r.rowCount !== a.rowCount || r.colCount !== a.colCount)
                                        return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                                    n.name = i.name,
                                        n.yValues = i.yValues,
                                        this.j.series().set(e, n),
                                        this.j.series().set(e, n)
                                }
                                this.Np(t.EDIT)
                            }
                            ,
                            i.prototype.Op = function(e) {
                                var i, n, r = {};
                                if (this.yp.length > 0 ? r = this.yp[0] : this.Po.get().length > 0 && (r = this.Po.get()[0]),
                                        r.yValues) {
                                    if (i = this.Mp(r.yValues),
                                            n = this.Mp(e.yValues),
                                        i.rowCount !== n.rowCount || i.colCount !== n.colCount)
                                        return void o.MessageBox.show(o.res.selectData.errorPrompt.seriesValueIsIllegal, "Error", 2);
                                    e.xValues = r.xValues,
                                        this.j.series().add(e),
                                        this.Np(t.ADD)
                                }
                            }
                            ,
                            i.prototype.Pp = function(e) {
                                this.j.series().remove(e),
                                    this.Np(t.REMOVE)
                            }
                            ,
                            i.prototype.Qp = function(e, i) {
                                if (e < this.yp.length && i < this.yp.length) {
                                    var o = this.yp[e];
                                    this.j.series().set(e, this.yp[i]),
                                        this.j.series().set(i, o),
                                        this.Np(t.REORDER)
                                }
                            }
                            ,
                            i.prototype.Rp = function(e, t) {
                                var i = this.yp[e];
                                i.xValues = t,
                                    this.j.series().set(e, i)
                            }
                            ,
                            i.prototype.Sp = function(e) {
                                this.j.dataRange(e),
                                    this.Np(t.RECHOOSE)
                            }
                            ,
                            i.prototype.Np = function(e) {
                                this.Tp(),
                                    this.Up(),
                                    this.Gp(),
                                    this.Hp(e),
                                    this.Ip(),
                                    this.Fp(),
                                    this.Jp()
                            }
                            ,
                            i.prototype.Tp = function() {
                                this.yp = this.j.series().get()
                            }
                            ,
                            i.prototype.Up = function() {
                                this.Bp = this.j.dataRange()
                            }
                            ,
                            i.prototype.Fp = function() {
                                var e = this.Bp || "";
                                "" === e ? this.xo.find(".chart-select-data-range-noShow-desc").css({
                                    visibility: "visible"
                                }) : this.xo.find(".chart-select-data-range-noShow-desc").css({
                                    visibility: "hidden"
                                }),
                                    this.xo.find(".chart-select-data-range-input").val(e)
                            }
                            ,
                            i.prototype.Gp = function() {
                                var e, t, i, o, n, r, a, s = document.getElementById("itemBox0");
                                for (s.innerHTML = "",
                                         this.Ep = [],
                                         e = 0; e < this.yp.length; e++)
                                    t = this.yp[e],
                                    t.name && (i = "",
                                        '"' === t.name.substr(0, 1) && '"' === t.name.substr(t.name.length - 1, 1) ? i = t.name : (o = this.Mp(t.name),
                                            n = u.getSheetFromFormula(t.name),
                                            r = n.getCell(o.row, o.col),
                                            i = r.text()),
                                        a = this.Kp(i, "chart-select-data-select-series", !1),
                                        a.dataset.seriesIndex = e,
                                        s.appendChild(a),
                                        this.Ep.push($(a)));
                                this.Vp()
                            }
                            ,
                            i.prototype.Hp = function(e) {
                                var i, o;
                                switch (e) {
                                    case t.RECHOOSE:
                                        this.xp = this.Ep[0];
                                        break;
                                    case t.EDIT:
                                        this.xp = this.Ep[this.xp.data("seriesIndex")];
                                        break;
                                    case t.REMOVE:
                                        0 === this.xp.data("seriesIndex") ? this.xp = this.Ep[0] : this.Ep.length > this.xp.data("seriesIndex") - 1 ? this.xp = this.Ep[this.xp.data("seriesIndex") - 1] : this.xp = null;
                                        break;
                                    case t.ADD:
                                        this.xp = this.Ep[this.Ep.length - 1];
                                        break;
                                    case t.REORDER:
                                        for (i = 0; i < this.Ep.length; i++)
                                            if (o = this.Ep[i],
                                                o.context.innerText === this.xp.context.innerText) {
                                                this.xp = o;
                                                break
                                            }
                                }
                                this.Wp(null, this.xp, "chart-select-data-cell-selected")
                            }
                            ,
                            i.prototype.Ip = function() {
                                var e, t, i, o, n, r, a, s, l, c, d, p, h, f = document.getElementById("itemBox1");
                                if (f.innerHTML = "",
                                        e = [],
                                        t = [],
                                    this.xp && this.yp && (i = this.xp.data("seriesIndex"),
                                    this.yp.length > i))
                                    if (o = this.yp[i].xValues)
                                        l = this.Mp(o),
                                            c = u.getSheetFromFormula(o),
                                        l && (t = this.Xp(l, c));
                                    else if (n = this.yp[i].yValues,
                                            r = this.Mp(n))
                                        for (a = r.rowCount > r.colCount ? r.rowCount : r.colCount,
                                                 s = 0; s < a; s++)
                                            t.push(s + 1);
                                if (t)
                                    for (d = 0; d < t.length; d++)
                                        p = t[d],
                                            h = this.Kp(p, "chart-select-data-select-category", !1),
                                            h.dataset.categoryIndex = d,
                                            f.appendChild(h),
                                            e.push($(h));
                                this.Yp()
                            }
                            ,
                            i.prototype.Wp = function(e, t, i) {
                                e && e.removeClass(i),
                                t && t.addClass(i)
                            }
                            ,
                            i.prototype.Jp = function() {
                                var e, t, i;
                                this.xp && (e = this.xp.data("seriesIndex"),
                                    t = document.getElementById("upBtnTrangle"),
                                    i = document.getElementById("downBtnTrangle"),
                                    t.className = "chart-select-data-option-upBtn-normal-trangle",
                                    i.className = "chart-select-data-option-downBtn-normal-trangle",
                                    0 === e ? t.className = "chart-select-data-option-upBtn-UnClick-trangle" : e === this.yp.length - 1 && (i.className = "chart-select-data-option-downBtn-unclick-trangle"))
                            }
                            ,
                            i.prototype.Mp = function(e) {
                                if (e) {
                                    var t = u.getSheetFromFormula(e);
                                    return p(t, e, 0, 0)[0].ranges[0]
                                }
                            }
                            ,
                            i.prototype.Xp = function(e, t) {
                                var i, o, n = [];
                                if (e)
                                    if (1 === e.rowCount)
                                        for (i = 0; i < e.colCount; i++)
                                            n.push(t.getCell(e.row, e.col + i).text());
                                    else if (1 === e.colCount)
                                        for (o = 0; o < e.rowCount; o++)
                                            n.push(t.getCell(e.row + o, e.col).text());
                                return n
                            }
                            ,
                            i.prototype.En = function() {
                                var e = this
                                    , i = e.xo
                                    , n = $(".chart-select-data-range-input")
                                    , r = i.find(".rangeSelectButton")
                                    , a = i.find(".chart-select-data-switch-box-middle")
                                    , s = i.find(".chart-select-data-option-one-btn-box")
                                    , l = i.find(".chart-select-data-option-upDown-btn");
                                n.focusout(function() {
                                    e.Zp(n[0].value)
                                }),
                                    r.click(function() {
                                        var t = e.Bp || "";
                                        e.hide(),
                                            e.Ap.open(o.res.selectData.selectDataSource, e.Zp, t)
                                    }),
                                    a.click(function(i) {
                                        var n, r;
                                        u.getChartGroupString(e.yn.chartType()) !== u.chartTypeDict[50].chartGroup ? (n = e.j.switchDataOrientation(),
                                            n ? (r = e.yn.colorAndStyle && e.yn.colorAndStyle.color,
                                            r && u.applyChartSeriesTheme(e.j, r),
                                                e.Np(t.RECHOOSE)) : o.MessageBox.show(o.res.selectData.errorPrompt.cantSwitchRowColumn, o.res.title, 2)) : o.MessageBox.show(o.res.selectData.errorPrompt.cantSwitchRowColumn, o.res.title, 2)
                                    }),
                                    l.click(function(t) {
                                        var i, o;
                                        e.xp && (i = $(t.currentTarget),
                                            o = e.xp.data("seriesIndex"),
                                            "Up" === i.data("name") ? o > 0 && e.Qp(o, o - 1) : "Down" === i.data("name") && o + 1 < e.yp.length && e.Qp(o, o + 1))
                                    }),
                                    s.click(function(t) {
                                        var i, n, r, a = $(t.currentTarget), s = e.yp[e.xp.data("seriesIndex")], l = e.yn.chartType();
                                        "Remove" === a.data("name") ? e.xp && e.yp && (1 === e.yp.length ? o.MessageBox.show(o.res.selectData.errorPrompt.cantRemoveLastSeries, "Error", 2) : null !== (i = e.xp.data("seriesIndex")) && void 0 !== i && e.Pp(i)) : "Add" === a.data("name") ? (n = new o.ChartEditSeries(e,e.$p,{},!0,l),
                                            e.hide(),
                                            n.open()) : "Edit" === a.data("name") ? (r = new o.ChartEditSeries(e,e._p,{
                                            name: s.name,
                                            yValue: s.yValues,
                                            xValue: s.xValues,
                                            size: s.bubbleSizes || null
                                        },!1,l),
                                            e.hide(),
                                            r.open()) : "EditCategory" === a.data("name") && (e.hide(),
                                            e.Ap.open("Select Data Source", e.aq, s.xValues))
                                    })
                            }
                            ,
                            i.prototype.Vp = function() {
                                var e = this
                                    , t = e.xo
                                    , i = t.find(".chart-select-data-select-series");
                                i.click(function(t) {
                                    e.xp = $(t.currentTarget),
                                        e.Wp(i, e.xp, "chart-select-data-cell-selected"),
                                        e.Dp = null,
                                        e.Ip(),
                                        e.Jp()
                                })
                            }
                            ,
                            i.prototype.Yp = function() {
                                var e = this
                                    , t = e.xo
                                    , i = t.find(".chart-select-data-select-category");
                                i.click(function(t) {
                                    e.Dp = $(t.currentTarget),
                                        e.Wp(i, e.Dp, "chart-select-data-cell-selected")
                                })
                            }
                            ,
                            i.prototype.Zp = function(e) {
                                var t = this.Bp || "";
                                "" !== (e = this.bq(e)) && "=" !== e && t !== e && "=" + t !== e && this.Sp(e)
                            }
                            ,
                            i.prototype.$p = function(e) {
                                var t, i;
                                if (e) {
                                    t = {};
                                    for (i in e)
                                        t[i] = this.bq(e[i]);
                                    this.Op(t)
                                }
                            }
                            ,
                            i.prototype.aq = function(e) {
                                var i, n, r, a, s, l, c, p, h;
                                e && "=" !== e ? (i = this,
                                    e = this.bq(e),
                                    n = u.getSheetFromFormula(e),
                                    r = d(n, e),
                                    a = i.yp[i.xp.data("seriesIndex")],
                                    s = u.getSheetFromFormula(a.xValues),
                                    l = d(s, a.xValues),
                                    c = d(s, a.yValues),
                                    p = l && r.rowCount === l.rowCount && r.colCount === l.colCount,
                                    h = !l && c && r.rowCount === c.rowCount && r.colCount === c.colCount,
                                    p || h ? (this.yp.forEach(function(t, o) {
                                        i.Rp(o, e)
                                    }),
                                        this.Np(t.EDIT)) : o.MessageBox.show(o.res.selectData.errorPrompt.categoryValueIsIllegal, "Error", 2)) : o.MessageBox.show(o.res.selectData.errorPrompt.categoryValueIsIllegal, "Error", 2)
                            }
                            ,
                            i.prototype._p = function(e) {
                                var t, i;
                                if (this.xp) {
                                    t = {};
                                    for (i in e)
                                        t[i] = this.bq(e[i]);
                                    this.Lp(this.xp.data("seriesIndex"), t)
                                }
                            }
                            ,
                            i.prototype.zp = function() {
                                var e, t, i, o = this.yp, n = this.yn.series().get();
                                if (o.length === n.length) {
                                    for (e = 0; e < o.length; e++)
                                        if (t = o[e],
                                                i = n[e],
                                            t.name !== i.name || t.xValues !== i.xValues || t.yValues !== i.yValues || t.bubbleSizes !== i.bubbleSizes)
                                            return !0;
                                    return !1
                                }
                                return !0
                            }
                            ,
                            i.prototype.bq = function(e) {
                                var t = o.wrapper.spread.getActiveSheet()
                                    , i = {}
                                    , n = e;
                                return e && "=" !== e && (i = GC.Spread.Sheets.CalcEngine.formulaToExpression(t, e),
                                    n = GC.Spread.Sheets.CalcEngine.expressionToFormula(t, i, 0, 0, !1, !0)),
                                    n
                            }
                            ,
                            i
                    }(o.BaseDialog),
                    o.ChartSelectDataDialog = i,
                    r = function(e) {
                        o.extends(t, e);
                        function t(t, i, o, r, a) {
                            this.cq = t,
                                this.dq = i,
                                this.fq = o ? o.name || "" : "",
                                this.gq = o ? o.yValue || "" : "",
                                this.hq = o ? o.xValue || "" : "",
                                this.iq = o ? o.size || "" : "",
                                this.jq = r,
                                this.kq = u.getChartGroupString(a),
                                this.lq = u.getChartTypeString(a),
                                e.call(this, n, ".chart-edit-series")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "350px",
                                resizable: !1,
                                modal: !0,
                                title: e.jq ? o.res.selectData.addSeries : o.res.selectData.editSeries,
                                buttons: [{
                                    text: o.res.ok,
                                    click: function() {
                                        if (e.dq) {
                                            var t = {};
                                            t = "" === e.iq || "=" === e.iq || void 0 === e.iq || null === e.iq ? {
                                                name: e.fq,
                                                yValues: e.gq,
                                                xValues: e.hq
                                            } : {
                                                name: e.fq,
                                                yValues: e.gq,
                                                xValues: e.hq,
                                                bubbleSizes: e.iq
                                            },
                                                e.dq.apply(e.cq, [t])
                                        }
                                        e.close()
                                    }
                                }, {
                                    text: o.res.cancel,
                                    click: function() {
                                        e.close()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.En = function() {
                                var e = this
                                    , t = e.xo
                                    , i = t.find("#nameRangeSelectBtn")
                                    , n = t.find("#valueRangeSelectBtn")
                                    , r = t.find("#xValueRangeSelectBtn")
                                    , a = t.find("#sizeRangeSelectBtn");
                                e.mq.focusout(function() {
                                    e.nq(e.mq[0].value)
                                }),
                                    e.oq.focusout(function() {
                                        e.pq(e.oq[0].value)
                                    }),
                                    e.qq.focusout(function() {
                                        e.rq(e.qq[0].value)
                                    }),
                                    e.sq.focusout(function() {
                                        e.tq(e.sq[0].value)
                                    }),
                                    i.click(function() {
                                        e.hide(),
                                            e.Ap.open(o.res.selectData.editSeriesName, e.nq, e.fq)
                                    }),
                                    n.click(function() {
                                        e.hide(),
                                            e.Ap.open(o.res.selectData.editSeriesValue, e.pq, e.gq)
                                    }),
                                    r.click(function() {
                                        e.hide(),
                                            e.Ap.open(o.res.selectData.editSeriesName, e.rq, e.hq)
                                    }),
                                    a.click(function() {
                                        e.hide(),
                                            e.Ap.open(o.res.selectData.editSeriesValue, e.tq, e.iq)
                                    })
                            }
                            ,
                            t.prototype._init = function() {
                                var e = this
                                    , t = e.xo;
                                "ScatterGroup" !== this.kq ? (t.find("#xValueContainer").hide(),
                                    t.find("#xValueDesc").hide(),
                                    t.find("#sizeContainer").hide(),
                                    t.find("#sizeDesc").hide()) : "bubble" !== this.lq && (t.find("#sizeContainer").hide(),
                                    t.find("#sizeDesc").hide()),
                                    this.mq = t.find("#name"),
                                    this.oq = t.find("#value"),
                                    this.qq = t.find("#xValue"),
                                    this.sq = t.find("#seriesSize"),
                                    this.mq.val(this.fq),
                                    this.oq.val(this.gq),
                                    this.qq.val(this.hq),
                                    this.sq.val(this.iq),
                                    this.En(),
                                e.Ap || (e.Ap = new o.RangeSelectDialog(e,{
                                    absoluteReference: !0
                                }))
                            }
                            ,
                            t.prototype.nq = function(e) {
                                this.fq = e,
                                    this.mq.val(this.fq)
                            }
                            ,
                            t.prototype.pq = function(e) {
                                this.gq = e,
                                    this.oq.val(this.gq)
                            }
                            ,
                            t.prototype.rq = function(e) {
                                this.hq = e,
                                    this.qq.val(this.hq)
                            }
                            ,
                            t.prototype.tq = function(e) {
                                this.iq = e,
                                    this.sq.val(this.iq)
                            }
                            ,
                            t.prototype.Co = function() {
                                this.cq && this.cq.show()
                            }
                            ,
                            t
                    }(o.BaseDialog),
                    o.ChartEditSeries = r
            }()
        }
        , function(e, t) {
            var i = void 0
                , o = GC.Spread.Sheets
                , n = o.Designer;
            !function() {
                "use strict";
                var e, t, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D, F, L, R, B, N, E, V, P, z, j, M, O, G, H, U, W, _, q, K, Y, X, J, Q, Z;
                !function(e) {
                    e[e.none = 0] = "none",
                        e[e.info = 1] = "info",
                        e[e.warning = 2] = "warning",
                        e[e.error = 3] = "error",
                        e[e.question = 4] = "question",
                        n.MessageBoxIcon = e
                }(n.MessageBoxIcon || {}),
                    function(e) {
                        e[e.ok = 0] = "ok",
                            e[e.okCancel = 1] = "okCancel",
                            e[e.yesNoCancel = 2] = "yesNoCancel",
                            n.MessageBoxButtons = e
                    }(n.MessageBoxButtons || {}),
                    function(e) {
                        e[e.none = 0] = "none",
                            e[e.ok = 1] = "ok",
                            e[e.yes = 2] = "yes",
                            e[e.no = 3] = "no",
                            e[e.cancel = 4] = "cancel",
                            n.MessageBoxResult = e
                    }(n.MessageBoxResult || {}),
                    e = function() {
                        function e() {}
                        return e.uq = function() {
                            var e = $("<span></span>");
                            return e.css("background-color", "rgba(0,0,0,0)"),
                                e.css("background-color")
                        }
                            ,
                            e.loadXML = function(e) {
                                var t;
                                return $.ajax({
                                    url: e,
                                    async: !1,
                                    type: "GET",
                                    dataType: "xml",
                                    success: function(e) {
                                        t = e
                                    }
                                }),
                                    t
                            }
                            ,
                            e
                    }(),
                    t = function() {
                        function e() {}
                        return e.vq = function(t, i, o) {
                            return {
                                text: t,
                                click: function(t) {
                                    e.wq = !0,
                                        e.xo.dialog("close", t),
                                    void 0 !== o && o(t, i)
                                }
                            }
                        }
                            ,
                            e.show = function(t, i, o, r, a) {
                                var s, l, c, d, p, u, h, f, g, m;
                                for (void 0 === o && (o = 0),
                                     void 0 === r && (r = 0),
                                         s = t.split("\n"),
                                         void 0 === e.xo ? (e.xo = $("<div></div>").addClass("message-box"),
                                             $("<span></span>").addClass("message-box-icon").appendTo(e.xo),
                                             $("<div></div>").addClass("message-box-text-container").appendTo(e.xo),
                                             $("<div></div>").addClass("clear-float").appendTo(e.xo),
                                             e.xo.dialog({
                                                 modal: !0,
                                                 autoSize: !0,
                                                 autoOpen: !1,
                                                 resizable: !1,
                                                 minWidth: 330,
                                                 close: function(t) {
                                                     !e.wq && a && a(t, 0),
                                                         e.wq = !1
                                                 }
                                             })) : (e.xo.dialog("destroy"),
                                             e.xo.dialog({
                                                 modal: !0,
                                                 autoSize: !0,
                                                 autoOpen: !1,
                                                 resizable: !1,
                                                 minWidth: 330,
                                                 close: function(t) {
                                                     !e.wq && a && a(t, 0),
                                                         e.wq = !1
                                                 }
                                             })),
                                         l = e.xo,
                                         c = l.find(".message-box-icon"),
                                         c.attr("class", "message-box-icon"),
                                         c.addClass("message-box-icon-" + n.MessageBoxIcon[o]),
                                         d = l.find(".message-box-text-container"),
                                         d.empty(),
                                         p = 0; p < s.length; p++)
                                    u = $("<span></span>").addClass("message-box-text"),
                                        u.text(s[p]),
                                        u.appendTo(d);
                                switch (l.dialog("option", "title", i),
                                    h = e.vq(n.res.ok, 1, a),
                                    f = e.vq(n.res.cancel, 4, a),
                                    g = e.vq(n.res.yes, 2, a),
                                    m = e.vq(n.res.no, 3, a),
                                    r) {
                                    case 0:
                                        l.dialog("option", "buttons", [h]);
                                        break;
                                    case 1:
                                        l.dialog("option", "buttons", [h, f]);
                                        break;
                                    case 2:
                                        l.dialog("option", "buttons", [g, m, f])
                                }
                                l.dialog("open"),
                                    setTimeout(function() {
                                        return l.parent().find(".ui-dialog-titlebar").trigger("mousedown")
                                    }, 100)
                            }
                            ,
                            e
                    }(),
                    n.MessageBox = t,
                    r = n.util.resolveHtmlPath("../dialogs", "dialogs.html"),
                    a = function(e) {
                        n.extends(i, e);
                        function i() {
                            e.call(this, r, ".row-height-dialog")
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.rowHeightDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var i, o, r = e.xo.find("[name=row-height]").val();
                                        r.match(/^[0-9\.]*$/) ? (i = e.xq(r)) && (o = parseInt(r),
                                            n.actions.doAction("setRowsHeight", n.wrapper.spread, o),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()) : t.show(n.res.rowHeightDialog.exception, n.res.title, 2)
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype.Bo = function() {
                                var e = n.wrapper.spread.getActiveSheet()
                                    , t = e.getRowHeight(e.getActiveRowIndex());
                                this.xo.find("[name=row-height]").val(t)
                            }
                            ,
                            i.prototype.xq = function(e) {
                                var i = !0;
                                return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.rowHeightDialog.exception2, n.res.title, 2),
                                    i = !1),
                                    i
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.RowHeightDialog = a,
                    s = function(e) {
                        n.extends(i, e);
                        function i() {
                            e.call(this, r, ".column-width-dialog")
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.columnWidthDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var i, o, r = e.xo.find("[name=column-width]").val();
                                        r.match(/^[0-9\.]*$/) ? (i = e.xq(r)) && (o = parseInt(r),
                                            n.actions.doAction("setColumnsWidth", n.wrapper.spread, o),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()) : t.show(n.res.columnWidthDialog.exception, n.res.title, 2)
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype.Bo = function() {
                                var e = n.wrapper.spread.getActiveSheet()
                                    , t = e.getColumnWidth(e.getActiveColumnIndex());
                                this.xo.find("[name=column-width]").val(t)
                            }
                            ,
                            i.prototype.xq = function(e) {
                                var i = !0;
                                return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.columnWidthDialog.exception2, n.res.title, 2),
                                    i = !1),
                                    i
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.ColumnWidthDialog = s,
                    l = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".font-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: 475,
                                autoOpen: !1,
                                resizable: !1,
                                modal: !0,
                                title: n.res.fontPickerDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.yq(event, e.zq()),
                                            e.close()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                this.xo.find(".font-picker").fontpicker({
                                    changed: function(t, i) {
                                        switch (i.name) {
                                            case "family":
                                                e.Aq = i.value;
                                                break;
                                            case "style":
                                                e.Bq = i.value;
                                                break;
                                            case "size":
                                                e.Cq = i.value;
                                                break;
                                            case "weight":
                                                e.Dq = i.value
                                        }
                                    },
                                    isColorVisible: !1
                                })
                            }
                            ,
                            t.prototype.zq = function() {
                                var e;
                                return void 0 === this.Aq && void 0 === this.Bq && void 0 === this.Cq && void 0 === this.Dq ? e = "" : (e = this.Bq ? this.Bq : "normal",
                                    this.Dq ? e += " " + this.Dq : e += " normal",
                                    this.Cq ? e += " " + this.Cq + "pt" : e += " " + n.res.defaultFont.split(" ")[0],
                                    this.Aq ? e += " " + this.Aq : e += " " + n.res.defaultFont.split(" ")[1]),
                                    e
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                if (void 0 !== e[0] && null !== e[0] && "" !== e[0]) {
                                    var t = n.util.parseFont(e[0]);
                                    this.xo.find(".font-picker").fontpicker("family", t.fontFamily),
                                        this.xo.find(".font-picker").fontpicker("style", t.fontStyle),
                                        this.xo.find(".font-picker").fontpicker("size", "" + parseFloat(t.fontSize)),
                                        this.xo.find(".font-picker").fontpicker("weight", t.fontWeight)
                                } else
                                    this.xo.find(".font-picker").fontpicker("family", ""),
                                        this.xo.find(".font-picker").fontpicker("style", ""),
                                        this.xo.find(".font-picker").fontpicker("size", ""),
                                        this.xo.find(".font-picker").fontpicker("weight", ""),
                                        this.Aq = i,
                                        this.Bq = i,
                                        this.Cq = i,
                                        this.Dq = i
                            }
                            ,
                            t.prototype.yq = function(e, t) {
                                $(this).trigger("dialogClose", t)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.FontPickerDialog = l,
                    c = function(e) {
                        n.extends(i, e);
                        function i() {
                            e.call(this, r, ".standard-width-dialog")
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.standardWidthDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var i, o, r = e.xo.find("[name=standard-column-width]").val();
                                        r.match(/^[0-9\.]*$/) ? (i = e.xq(r)) && (o = parseInt(r),
                                            n.actions.doAction("defaultColumnWidth", n.wrapper.spread, o),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()) : t.show(n.res.standardWidthDialog.exception, n.res.title, 2)
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype.Bo = function() {
                                var e = n.wrapper.spread.getActiveSheet()
                                    , t = e.defaults.colWidth;
                                this.xo.find("[name=standard-column-width]").val(t)
                            }
                            ,
                            i.prototype.xq = function(e) {
                                var i = !0;
                                return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.columnWidthDialog.exception2, n.res.title, 2),
                                    i = !1),
                                    i
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.StandardColumnWidthDialog = c,
                    d = function(e) {
                        n.extends(i, e);
                        function i() {
                            e.call(this, r, ".standard-height-dialog")
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.standardHeightDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var i, o, r = e.xo.find("[name=standard-row-height]").val();
                                        r.match(/^[0-9\.]*$/) ? (i = e.xq(r)) && (o = parseInt(r),
                                            n.actions.doAction("defaultRowHeight", n.wrapper.spread, o),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()) : t.show(n.res.standardHeightDialog.exception, n.res.title, 2)
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype.Bo = function() {
                                var e = n.wrapper.spread.getActiveSheet()
                                    , t = e.defaults.rowHeight;
                                this.xo.find("[name=standard-row-height]").val(t)
                            }
                            ,
                            i.prototype.xq = function(e) {
                                var i = !0;
                                return (parseFloat(e) > 9999999 || parseFloat(e) < 0) && (t.show(n.res.rowHeightDialog.exception2, n.res.title, 2),
                                    i = !1),
                                    i
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.StandardRowHeightDialog = d,
                    p = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".insert-cells-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                width: "auto",
                                modal: !0,
                                title: n.res.insertCellsDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xo.find("input[name='insert-type']:checked").val();
                                        "shiftcellsright" === t ? n.actions.doAction("insertRightCells", n.wrapper.spread) : "shiftcellsdown" === t ? n.actions.doAction("insertDownCells", n.wrapper.spread) : "entirerow" === t ? n.actions.doAction("insertRows", n.wrapper.spread) : "entirecolumn" === t && n.actions.doAction("insertColumns", n.wrapper.spread),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                this.xo.find("input[type='radio']").prop("checked", !1),
                                    this.xo.find(".default-radio").prop("checked", !0).attr("autofocus", !0)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.InsertCellsDialog = p,
                    u = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".delete-cells-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                width: "auto",
                                modal: !0,
                                title: n.res.deleteCellsDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xo.find("input[name='delete-type']:checked").val();
                                        "shiftcellsleft" === t ? n.actions.doAction("deleteLeftCells", n.wrapper.spread) : "shiftcellsup" === t ? n.actions.doAction("deleteUpCells", n.wrapper.spread) : "entirerow" === t ? n.actions.doAction("deleteRows", n.wrapper.spread) : "entirecolumn" === t && n.actions.doAction("deleteColumns", n.wrapper.spread),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                this.xo.find("input[type='radio']").prop("checked", !1),
                                    this.xo.find(".default-radio").prop("checked", !0).attr("autofocus", !0)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.DeleteCellsDialog = u,
                    h = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".group-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                width: "auto",
                                modal: !0,
                                title: n.res.groupDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xo.find("input[name='group-type']:checked").val();
                                        "rows" === t ? n.actions.doAction("groupRows", n.wrapper.spread) : "columns" === t && n.actions.doAction("groupColumns", n.wrapper.spread),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                this.xo.find("input[type='radio']").prop("checked", !1),
                                    this.xo.find(".default-radio").prop("checked", !0).attr("autofocus", !0)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.GroupDialog = h,
                    f = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".ungroup-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                width: "auto",
                                modal: !0,
                                title: n.res.ungroupDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xo.find("input[name='group-type']:checked").val();
                                        "rows" === t ? n.actions.doAction("ungroupRows", n.wrapper.spread) : "columns" === t && n.actions.doAction("ungroupColumns", n.wrapper.spread),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                this.xo.find("input[type='radio']").prop("checked", !1),
                                    this.xo.find(".default-radio").prop("checked", !0).attr("autofocus", !0)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.UnGroupDialog = f,
                    g = function() {
                        function e() {}
                        return e.SearchInformation = function(e, t, i, o, n) {
                            this.WithinWorksheet = e,
                                this.SearchString = t,
                                this.SearchFlags = i,
                                this.SearchOrder = o,
                                this.SearchFoundFlags = n
                        }
                            ,
                            e
                    }(),
                    n.SearchInformation = g,
                    m = function() {
                        function e(e, t, i, o, n) {
                            this.Eq = e,
                                this.Fq = t,
                                this.Gq = i,
                                this._h = o,
                                this.Hq = n
                        }
                        return e
                    }(),
                    n.FindResultInformation = m,
                    b = function(e) {
                        n.extends(i, e);
                        function i() {
                            e.call(this, r, ".find-dialog")
                        }
                        return i.prototype.wo = function() {
                            return {
                                resizable: !1,
                                width: "auto",
                                modal: !0,
                                title: n.res.findDialog.title
                            }
                        }
                            ,
                            i.prototype.Iq = function() {
                                var e = this
                                    , t = function(t, i) {
                                    var o, r, a;
                                    void 0 !== e.Jq && (o = i.addedCells.sk[0].Ki,
                                        r = e.Jq[o],
                                        a = n.wrapper.spread.getSheetFromName(r.sheet.name()),
                                        n.wrapper.spread.setActiveSheetIndex(n.wrapper.spread.sheets.indexOf(a)),
                                        n.wrapper.spread.getActiveSheet().setActiveCell(r.row, r.col),
                                        n.wrapper.spread.getActiveSheet().showCell(r.row, r.col, 3, 3))
                                };
                                this.xo.find(".findall-grid").gcuigrid({
                                    scrollMode: "auto",
                                    allowColMoving: !1,
                                    allowColSizing: !0,
                                    staticColumnIndex: -1,
                                    staticRowIndex: -1,
                                    columns: [{
                                        headerText: "Book",
                                        dataType: "string"
                                    }, {
                                        headerText: "Sheet",
                                        dataType: "string"
                                    }, {
                                        headerText: "Cell",
                                        dataType: "string"
                                    }, {
                                        headerText: "Value",
                                        dataType: "string"
                                    }, {
                                        headerText: "Formula",
                                        dataType: "string"
                                    }],
                                    selectionChanged: t
                                })
                            }
                            ,
                            i.prototype.Kq = function(e) {
                                var t = this.Lq(e);
                                this.xo.find(".findall-grid-container").addClass("show"),
                                    this.xo.find(".findall-grid").addClass("show"),
                                    this.xo.find(".findall-grid").gcuigrid({
                                        data: t
                                    }),
                                    this.xo.find(".findall-description-label").addClass("show").text(t.length + " cell(s) found")
                            }
                            ,
                            i.prototype.Lq = function(e) {
                                var t, i = [];
                                for (t = 0; t < e.length; t++)
                                    i.push({
                                        Book: e[t].Eq,
                                        Sheet: e[t].Fq,
                                        Cell: e[t].Gq,
                                        Value: e[t]._h,
                                        Formula: e[t].Hq
                                    });
                                return i
                            }
                            ,
                            i.prototype._init = function() {
                                var e = this;
                                this.Mq = this.xo.find(".findwhat-input")[0],
                                    this.Nq = this.xo.find("select[name='within']")[0],
                                    this.Oq = this.xo.find("select[name='search']")[0],
                                    this.Pq = this.xo.find("select[name='lookin']")[0],
                                    this.Qq = this.xo.find(".matchcase-editor"),
                                    this.Rq = this.xo.find(".matchexactly-editor"),
                                    this.Sq = this.xo.find(".usewildcards-editor"),
                                    this.Tq = this.xo.find("button[name='option']"),
                                    this.xo.find(".findall-button").button(),
                                    this.xo.find(".findnext-button").button(),
                                    this.xo.find(".close-button").button(),
                                    this.Tq.button(),
                                    this.Iq(),
                                    this.Tq.click(function() {
                                        e.xo.find(".column1,.column2,.column3,.column4").toggleClass("column-hidden"),
                                            e.xo.find(".row2,.row3").toggleClass("row-hidden"),
                                            e.Uq(),
                                            e.Tq[0].children[0].textContent = n.res.findDialog.option + e.Vq
                                    }),
                                    this.xo.find(".findall-button").click(function() {
                                        var i;
                                        e.Wq(),
                                        null != g && void 0 !== g.SearchString && (i = 0 === e.Nq.selectedIndex ? e.Xq(n.wrapper.spread.getActiveSheet()) : e.Xq(),
                                            i.length > 0 ? e.Kq(i) : (e.xo.find(".findall-grid").gcuigrid("option", "data", []),
                                                t.show(n.res.findDialog.exception, n.res.title, 2),
                                                e.xo.find(".findall-description-label").addClass("show").text("0cell(s) found")))
                                    }),
                                    this.xo.find(".findnext-button").click(function() {
                                        if (e.Wq(),
                                            null != g && void 0 !== g.SearchString) {
                                            var i = e.Yq();
                                            !0 !== i && t.show(n.res.findDialog.exception, n.res.title, 2)
                                        }
                                    }),
                                    this.xo.find(".close-button").click(function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    })
                            }
                            ,
                            i.prototype.Uq = function() {
                                ">>" === this.Vq ? this.Vq = "<<" : this.Vq = ">>"
                            }
                            ,
                            i.prototype.Bo = function() {
                                g.SearchInformation(void 0, void 0, void 0, void 0, void 0),
                                    this.Zq = !1,
                                    this.$q = n.wrapper.spread.getActiveSheetIndex(),
                                    this._q = n.wrapper.spread.getActiveSheet().getActiveRowIndex(),
                                    this.ar = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(),
                                "<<" === this.Vq && (this.xo.find(".column1,.column2,.column3,.column4").addClass("column-hidden"),
                                    this.xo.find(".row2,.row3").addClass("row-hidden"),
                                    this.Uq()),
                                    this.Vq = ">>",
                                    this.Tq[0].children[0].textContent = n.res.findDialog.option + this.Vq,
                                    this.Mq.value = "",
                                    this.Nq.selectedIndex = 0,
                                    this.Oq.selectedIndex = 0,
                                    this.Pq.selectedIndex = 0,
                                    this.Qq.removeAttr("checked"),
                                    this.Rq.removeAttr("checked"),
                                    this.Sq.removeAttr("checked"),
                                    this.xo.find(".findall-grid-container").removeClass("show"),
                                    this.xo.find(".findall-description-label").removeClass("show")
                            }
                            ,
                            i.prototype.Yq = function() {
                                if ("" === g.SearchString)
                                    return this.br = -1,
                                        this.dr = -1,
                                        this.er = -1,
                                        !0;
                                var e = !1;
                                if (this.Zq) {
                                    if (!this.gr())
                                        return this.br = -1,
                                            this.dr = -1,
                                            this.er = -1,
                                            !1;
                                    e = 1 === n.wrapper.spread.getActiveSheet().getSelections().length ? this.hr() : this.ir(),
                                        this.er = n.wrapper.spread.getActiveSheetIndex()
                                } else if (g.WithinWorksheet) {
                                    if (!this.jr(n.wrapper.spread.getActiveSheet()))
                                        return this.br = -1,
                                            this.dr = -1,
                                            this.er = -1,
                                            !1;
                                    e = this.kr(n.wrapper.spread.getActiveSheet()),
                                    e && (this.ar = this.dr,
                                        this._q = this.br,
                                        n.wrapper.spread.getActiveSheet().addSelection(this.br, this.dr, 1, 1),
                                        n.wrapper.spread.getActiveSheet().setActiveCell(this.br, this.dr),
                                        n.wrapper.spread.getActiveSheet().showCell(this.br, this.dr, 3, 3)),
                                        this.er = n.wrapper.spread.getActiveSheetIndex()
                                } else
                                    e = this.lr();
                                return e
                            }
                            ,
                            i.prototype.jr = function(e) {
                                var t, i, n, r = new o.Search.SearchCondition;
                                return r.searchString = g.SearchString,
                                    r.searchFlags = 8 | g.SearchFlags,
                                    r.searchOrder = g.SearchOrder,
                                    r.searchTarget = g.SearchFoundFlags,
                                    r.sheetArea = 3,
                                    n = e.search(r),
                                    t = n.foundRowIndex,
                                    i = n.foundColumnIndex,
                                -1 !== t && -1 !== i
                            }
                            ,
                            i.prototype.gr = function() {
                                var e, t, i, r, a, s, l, c, d, p, u = n.wrapper.spread.getActiveSheet().getSelections();
                                for (e = 0; e < u.length; e++)
                                    if (t = u[e],
                                            i = t.row,
                                            r = t.col,
                                            a = t.row + t.rowCount - 1,
                                            s = t.col + t.colCount - 1,
                                            d = new o.Search.SearchCondition,
                                            d.searchString = g.SearchString,
                                            d.searchFlags = 8 | g.SearchFlags,
                                            d.searchOrder = g.SearchOrder,
                                            d.searchTarget = g.SearchFoundFlags,
                                            d.sheetArea = 3,
                                            d.rowStart = i,
                                            d.columnStart = r,
                                            d.rowEnd = a,
                                            d.columnEnd = s,
                                            p = n.wrapper.spread.getActiveSheet().search(d),
                                            l = p.foundRowIndex,
                                            c = p.foundColumnIndex,
                                        -1 !== l && -1 !== c)
                                        return !0;
                                return !1
                            }
                            ,
                            i.prototype.Wq = function() {
                                var e, t, i, o, n = this.Mq.value;
                                return "" === n ? null : (t = 0,
                                    "<<" === this.Vq ? (e = 0 === this.Nq.selectedIndex,
                                    !0 !== this.Qq.prop("checked") && (t |= 1),
                                    !0 === this.Rq.prop("checked") && (t |= 2),
                                    !0 === this.Sq.prop("checked") && (t |= 4),
                                        i = 0 === this.Oq.selectedIndex ? 0 : 1,
                                        0 === this.Pq.selectedIndex ? o = 1 : 1 === this.Pq.selectedIndex && (o = 8,
                                            n = "=" === n.charAt(0) ? n.substr(1, n.length) : n)) : (e = !0,
                                        t = 1,
                                        i = 0,
                                        o = 1),
                                    g.SearchInformation(e, n, t, i, o))
                            }
                            ,
                            i.prototype.mr = function(e, t) {
                                var i, o, n, r;
                                t && (i = t.row,
                                    o = t.col,
                                    n = t.row + t.rowCount - 1,
                                    r = t.col + t.colCount - 1,
                                    0 === e ? -1 === this.ar && -1 === this._q ? (this.nr = 0,
                                        this.or = 0) : this.ar < r ? (this.nr = this._q,
                                        this.or = this.ar + 1) : this.ar === r ? (this.nr = this._q + 1,
                                        this.or = 0) : (this.nr = i,
                                        this.or = o) : -1 === this.ar && -1 === this._q ? (this.nr = 0,
                                        this.or = 0) : this._q < n ? (this.nr = this._q + 1,
                                        this.or = this.ar) : this._q === n ? (this.nr = 0,
                                        this.or = this.ar + 1) : (this.nr = i,
                                        this.or = o))
                            }
                            ,
                            i.prototype.pr = function() {
                                var e, t, i = [], o = this.$q;
                                for (e = o; e < n.wrapper.spread.getSheetCount(); e++)
                                    i.push(n.wrapper.spread.sheets[e]);
                                for (t = 0; t < o; t++)
                                    i.push(n.wrapper.spread.sheets[t]);
                                return i
                            }
                            ,
                            i.prototype.qr = function(e) {
                                var t, i, r, a, s, l;
                                return !!e && (this.mr(g.SearchOrder, e),
                                    r = e.row + e.rowCount - 1,
                                    a = e.col + e.colCount - 1,
                                    s = new o.Search.SearchCondition,
                                    s.searchString = g.SearchString,
                                    s.searchFlags = g.SearchFlags,
                                    s.searchOrder = g.SearchOrder,
                                    s.searchTarget = g.SearchFoundFlags,
                                    s.sheetArea = 3,
                                    s.rowStart = t,
                                    s.columnStart = i,
                                    s.rowEnd = r,
                                    s.columnEnd = a,
                                    l = n.wrapper.spread.getActiveSheet().search(s),
                                    this.br = l.foundRowIndex,
                                    this.dr = l.foundColumnIndex,
                                    !(-1 === this.br || -1 === this.dr))
                            }
                            ,
                            i.prototype.rr = function(e) {
                                var t, i, n, r;
                                return this.mr(g.SearchOrder, new o.Range(0,0,e.getRowCount(),e.getColumnCount())),
                                    t = e.getRowCount() - 1,
                                    i = e.getColumnCount() - 1,
                                    n = new o.Search.SearchCondition,
                                    n.searchString = g.SearchString,
                                    n.searchFlags = g.SearchFlags,
                                    n.searchOrder = g.SearchOrder,
                                    n.searchTarget = g.SearchFoundFlags,
                                    n.sheetArea = 3,
                                    n.rowStart = this.nr,
                                    n.columnStart = this.or,
                                    n.rowEnd = t,
                                    n.columnEnd = i,
                                    r = e.search(n),
                                    this.br = r.foundRowIndex,
                                    this.dr = r.foundColumnIndex,
                                -1 !== this.br && -1 !== this.dr
                            }
                            ,
                            i.prototype.hr = function() {
                                var e, t;
                                return this.br = -1,
                                    this.dr = -1,
                                !!(e = n.wrapper.spread.getActiveSheet().getSelections()[0]) && (t = this.qr(e),
                                    t ? this.sr(e, this.br, this.dr) ? (this._q = this.br,
                                        this.ar = this.dr,
                                        n.wrapper.spread.getActiveSheet().setActiveCell(this.br, this.dr),
                                        n.wrapper.spread.getActiveSheet().showCell(this.br, this.dr, 3, 3),
                                        !0) : (0 === g.SearchOrder ? (this._q++,
                                        this.ar = e.col - 1) : (this.ar++,
                                        this._q = e.row - 1),
                                        this.hr()) : (0 === g.SearchOrder ? (this._q = e.row,
                                        this.ar = e.col - 1) : (this._q = e.row - 1,
                                        this.ar = e.col),
                                        this.hr()))
                            }
                            ,
                            i.prototype.ir = function() {
                                var e, t, i;
                                return this.br = -1,
                                    this.dr = -1,
                                !!(e = this.tr) && (t = new o.Range(e.row,e.col,e.rowCount,e.colCount),
                                    i = this.qr(t),
                                    i ? this.ur(this.br, this.dr) ? (this._q = this.br,
                                        this.ar = this.dr,
                                        n.wrapper.spread.getActiveSheet().setActiveCell(this.br, this.dr),
                                        n.wrapper.spread.getActiveSheet().showCell(this.br, this.dr, 3, 3),
                                        !0) : (0 === g.SearchOrder ? (this._q++,
                                        this.ar = e.col) : (this.ar++,
                                        this._q = e.row),
                                        this.ir()) : (0 === g.SearchOrder ? (this._q = e.row,
                                        this.ar = e.col - 1) : (this._q = e.row - 1,
                                        this.ar = e.col),
                                        this.ir()))
                            }
                            ,
                            i.prototype.kr = function(e) {
                                this.br = -1,
                                    this.dr = -1;
                                var t = this.rr(e);
                                return t ? (this._q = this.br,
                                    this.ar = this.dr,
                                    n.wrapper.spread.getActiveSheet().addSelection(this.br, this.dr, 1, 1),
                                    n.wrapper.spread.getActiveSheet().showCell(this.br, this.dr, 3, 3),
                                    !0) : (this._q = -1,
                                    this.ar = -1,
                                    this.rr(e))
                            }
                            ,
                            i.prototype.lr = function() {
                                var e, t, i, o, r = this.pr();
                                for (this.br = -1,
                                         this.dr = -1,
                                         this.er = -1,
                                         e = 0; e < r.length; e++)
                                    if (t = r[e],
                                            i = n.wrapper.spread.sheets.indexOf(t),
                                        i !== n.wrapper.spread.getActiveSheetIndex() && (this._q = -1,
                                            this.ar = -1),
                                            o = this.rr(t)) {
                                        this.er = i;
                                        break
                                    }
                                return -1 !== this.er && (this.$q = this.er,
                                    this._q = this.br,
                                    this.ar = this.dr,
                                    n.wrapper.spread.setActiveSheetIndex(this.er),
                                    n.wrapper.spread.getActiveSheet().setActiveCell(this.br, this.dr),
                                    n.wrapper.spread.getActiveSheet().showCell(this.br, this.dr, 3, 3),
                                    !0)
                            }
                            ,
                            i.prototype.sr = function(e, t, i) {
                                return !!e && (t >= e.row && t <= e.row + e.rowCount && i >= e.col && i <= e.col + e.colCount)
                            }
                            ,
                            i.prototype.ur = function(e, t) {
                                var i, o, r = n.wrapper.spread.getActiveSheet().getSelections();
                                for (i = 0; i < r.length; i++)
                                    if (o = r[i],
                                            this.sr(o, e, t))
                                        return !0;
                                return !1
                            }
                            ,
                            i.prototype.Xq = function(e) {
                                this.Jq = [];
                                var t;
                                return t = void 0 === e ? this.vr(n.wrapper.spread) : this.wr(e)
                            }
                            ,
                            i.prototype.wr = function(e) {
                                var t, i, r, a, s, l = [], c = 0, d = 0, p = e.getRowCount() - 1, u = e.getColumnCount() - 1, h = -1, f = -1, b = new o.Search.SearchCondition;
                                for (b.searchString = g.SearchString,
                                         b.searchFlags = g.SearchFlags,
                                         b.searchOrder = g.SearchOrder,
                                         b.searchTarget = g.SearchFoundFlags,
                                         b.sheetArea = 3,
                                         b.rowStart = c,
                                         b.columnStart = d,
                                         b.rowEnd = p,
                                         b.columnEnd = u,
                                         t = e.search(b),
                                         h = t.foundRowIndex,
                                         f = t.foundColumnIndex; -1 !== h && -1 !== f; )
                                    i = e.getCell(h, f),
                                        r = "" === n.wrapper.spread.name || null === n.wrapper.spread.name ? "Default" : n.wrapper.spread.name,
                                        a = o.CalcEngine.rangeToFormula(i, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute),
                                        s = new m(r,e.name(),a,i.text(),i.formula()),
                                        l.push(s),
                                        this.Jq.push(i),
                                        0 === g.SearchOrder ? (c = h,
                                        (d = f + 1) >= e.getColumnCount() && c < e.getRowCount() && (c = h + 1,
                                            d = 0)) : (c = h + 1,
                                            d = f,
                                        c >= e.getRowCount() && d < e.getColumnCount() && (c = 0,
                                            d = f + 1)),
                                        b = new o.Search.SearchCondition,
                                        b.searchString = g.SearchString,
                                        b.searchFlags = g.SearchFlags,
                                        b.searchOrder = g.SearchOrder,
                                        b.searchTarget = g.SearchFoundFlags,
                                        b.sheetArea = 3,
                                        b.rowStart = c,
                                        b.columnStart = d,
                                        b.rowEnd = p,
                                        b.columnEnd = u,
                                        t = e.search(b),
                                        h = t.foundRowIndex,
                                        f = t.foundColumnIndex;
                                return l
                            }
                            ,
                            i.prototype.vr = function(e) {
                                var t, i, r, a, s, l = [], c = 0, d = 0, p = -1, u = -1, h = -1, f = new o.Search.SearchCondition;
                                for (f.startSheetIndex = 0,
                                         f.endSheetIndex = e.getSheetCount() - 1,
                                         f.searchString = g.SearchString,
                                         f.searchFlags = g.SearchFlags,
                                         f.searchOrder = g.SearchOrder,
                                         f.searchTarget = g.SearchFoundFlags,
                                         f.sheetArea = 3,
                                         t = e.search(f),
                                         p = t.foundRowIndex,
                                         u = t.foundColumnIndex,
                                         h = t.foundSheetIndex; -1 !== p && -1 !== u || h <= e.getSheetCount() - 1 && -1 !== h; )
                                    f = new o.Search.SearchCondition,
                                        -1 !== p && -1 !== u ? (i = e.sheets[h].getCell(p, u),
                                            r = "" === n.wrapper.spread.name || null === n.wrapper.spread.name ? "Default" : n.wrapper.spread.name,
                                            a = o.CalcEngine.rangeToFormula(i, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute),
                                            s = new m(r,e.sheets[h].name(),a,i.text(),i.formula()),
                                            l.push(s),
                                            this.Jq.push(i),
                                            0 === g.SearchOrder ? (c = p,
                                            (d = u + 1) >= e.sheets[h].getColumnCount() && c < e.sheets[h].getRowCount() && (c = p + 1,
                                                d = 0)) : (c = p + 1,
                                                d = u,
                                            c >= e.sheets[h].getRowCount() && d < e.sheets[h].getColumnCount() && (c = 0,
                                                d = u + 1)),
                                            f.rowStart = c,
                                            f.columnStart = d) : (f.rowStart = 0,
                                            f.columnStart = 0,
                                            f.rowEnd = e.sheets[h].getRowCount() - 1,
                                            f.columnEnd = e.sheets[h].getColumnCount() - 1),
                                        f.searchString = g.SearchString,
                                        f.searchFlags = g.SearchFlags,
                                        f.searchOrder = g.SearchOrder,
                                        f.searchTarget = g.SearchFoundFlags,
                                        f.sheetArea = 3,
                                        f.startSheetIndex = h,
                                        f.endSheetIndex = h,
                                        f.sheetArea = 3,
                                        t = e.search(f),
                                        p = t.foundRowIndex,
                                        u = t.foundColumnIndex,
                                        -1 !== t.foundSheetIndex ? h = t.foundSheetIndex : h++;
                                return l
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.FindDialog = b,
                    v = function(e) {
                        n.extends(i, e);
                        function i() {
                            e.call(this, r, ".goto-dialog")
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                width: "auto",
                                modal: !0,
                                title: n.res.gotoDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var i = e.xo.find(".goto-value-input").val()
                                            , o = e.xr(i);
                                        !0 === o ? e.close() : t.show(n.res.gotoDialog.exception, n.res.title, 3),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype._init = function() {
                                var e = this;
                                this.xo.find(".goto-list").change(function(t) {
                                    var i = t.target || t.srcElement
                                        , o = i;
                                    e.xo.find(".goto-value-input").prop("value", o.value)
                                })
                            }
                            ,
                            i.prototype.Bo = function() {
                                var e, t, i, o, r = this.xo.find(".goto-list")[0].options;
                                for (this.xo.find(".goto-list").empty(),
                                         this.xo.find(".goto-value-input").prop("value", ""),
                                         e = 0,
                                         t = 0; t < n.wrapper.spread.sheets.length; t++)
                                    if (void 0 !== (o = n.wrapper.spread.sheets[t].getCustomNames()))
                                        for (i = 0; i < o.length; i++)
                                            r[e++] = new Option(o[i].getName());
                                if (void 0 !== (o = n.wrapper.spread.getCustomNames()))
                                    for (i = 0; i < o.length; i++)
                                        r[e++] = new Option(o[i].getName())
                            }
                            ,
                            i.prototype.xr = function(e) {
                                var t, i, o, r, a, s, l, c = -1;
                                if (void 0 === e || "" === e)
                                    return !1;
                                for (o = this.xo.find(".goto-list")[0].options,
                                         r = !1,
                                         a = 0; a < o.length; a++)
                                    if (e === o[a].textContent) {
                                        r = !0;
                                        break
                                    }
                                if (r) {
                                    for (s = n.wrapper.spread.getCustomName(e),
                                             a = 0; a < n.wrapper.spread.sheets.length; a++)
                                        if (s || (s = n.wrapper.spread.sheets[a].getCustomName(e)),
                                                s) {
                                            c = a;
                                            break
                                        }
                                    t = s.getExpression()
                                } else
                                    l = n.wrapper.spread.getActiveSheet(),
                                        t = GC.Spread.Sheets.CalcEngine.formulaToExpression(l, e);
                                if (this.yr = null,
                                        i = this.zr(t),
                                    null == this.yr)
                                    return !1;
                                for (a = 0; a < n.wrapper.spread.sheets.length; a++)
                                    if (n.wrapper.spread.sheets[a].name() === this.yr.name()) {
                                        c = a;
                                        break
                                    }
                                return -1 !== c && n.wrapper.spread.setActiveSheetIndex(c),
                                    n.wrapper.spread.getActiveSheet().clearSelection(),
                                    n.wrapper.spread.getActiveSheet().setSelection(i.row, i.col, i.rowCount, i.colCount),
                                    n.wrapper.spread.getActiveSheet().showCell(i.row, i.col, 3, 3),
                                    !0
                            }
                            ,
                            i.prototype.zr = function(e) {
                                var t = n.wrapper.spread.getActiveSheet();
                                return this.yr = e.source ? e.source.getSheet() : t,
                                    e.getRange(0, 0)
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.GoToDialog = v,
                    y = {},
                    ["#NULL!", "#DIV/0!", "#VALUE!", "#REF!", "#NAME?", "#N/A", "#NUM!"].forEach(function(e) {
                        y[e] = !0
                    }),
                    x = function(e) {
                        n.extends(i, e);
                        function i(t) {
                            e.call(this, r, ".new-name-dialog"),
                            void 0 !== t && (this.Ar = t)
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                autoOpen: !1,
                                width: "auto",
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.Br(),
                                            e.close()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype._init = function() {
                                var e = this;
                                e.xo.find(".rangeSelectButton").click(function() {
                                    e.Cr || (e.Cr = new n.RangeSelectDialog(e,{
                                        absoluteReference: !0
                                    }));
                                    var t = e.xo.dialog("option", "title") + "-" + n.res.newNameDialog.referTo;
                                    e.hide(),
                                        e.Cr.open(t, e.Dr, e.xo.find(".referTo").val(), [".referTo"])
                                })
                            }
                            ,
                            i.prototype.Co = function() {
                                void 0 !== this.Ar && this.Ar.open()
                            }
                            ,
                            i.prototype.Dr = function(e, t) {
                                this.xo.find(e).val(t)
                            }
                            ,
                            i.prototype.Er = function(e) {
                                var t = n.wrapper.spread.options.referenceStyle;
                                return n.util.isValidateSheetName(e, t, !1) ? e : n.util.isValidateSheetName(e, t, !0) ? "'" + e + "'" : null
                            }
                            ,
                            i.prototype.Bo = function(e) {
                                var t, i, r, a, s, l, c, d, p, u, h = this;
                                for (h.Fr = e,
                                         t = this.xo.find(".name-input"),
                                         i = this.xo.find(".scope-select"),
                                         r = this.xo.find(".referTo"),
                                         a = this.xo.find(".comment-input"),
                                         s = i[0].options,
                                         i.empty(),
                                         s.add(new Option(n.res.newNameDialog.scope.workbook)),
                                         l = 0; l < n.wrapper.spread.sheets.length; l++)
                                    s.add(new Option(n.wrapper.spread.sheets[l].name()));
                                if ("new" === e[0]) {
                                    for ($(".scope-select").removeAttr("disabled"),
                                             this.xo.dialog("option", "title", n.res.newNameDialog.titleNew),
                                             this.xo.dialog("option", "modal", !0),
                                             t.prop("value", ""),
                                             i.prop("selectedIndex", 0),
                                             c = n.wrapper.spread.sheets[n.wrapper.spread.getActiveSheetIndex()].getSelections(),
                                             d = "=",
                                             l = 0; l < c.length; l++)
                                        p = c[l],
                                            u = o.CalcEngine.rangeToFormula(p, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute),
                                            u = this.Er(n.wrapper.spread.getActiveSheet().name()) + "!" + u,
                                            d += u + ",";
                                    d = d.slice(0, d.length - 1),
                                        r.prop("value", d),
                                        a.prop("value", "")
                                } else if ("edit" === e[0]) {
                                    for ($(".scope-select").attr("disabled", "disabled"),
                                             this.selectedItem = e[1],
                                             this.xo.dialog("option", "title", n.res.newNameDialog.titleEdit),
                                             this.xo.dialog("option", "modal", !0),
                                             t.prop("value", this.selectedItem.name),
                                             r.prop("value", this.selectedItem.refersTo),
                                             l = 0; l < s.length; l++)
                                        s[l].innerText === this.selectedItem.scope && $(s[l]).prop("selected", !0);
                                    a.prop("value", this.selectedItem.comment)
                                }
                            }
                            ,
                            i.prototype.Br = function() {
                                var e, i, o, r, a = this, s = a.Fr, l = a.xo.find(".scope-select"), c = a.xo.find(".name-input"), d = this.xo.find(".comment-input"), p = this.xo.find(".referTo"), u = 0 === l[0].selectedIndex, h = l[0].selectedIndex - 1;
                                if ("" === c.val())
                                    t.show(n.res.nameManagerDialog.exception1, n.res.title, 2, 0);
                                else if (void 0 !== a.selectedItem && null !== a.selectedItem || "new" === s[0]) {
                                    if (void 0 !== a.selectedItem && null !== a.selectedItem && (e = a.selectedItem.name),
                                        ("edit" !== s[0] || c.val() !== e) && null !== (i = u ? n.wrapper.spread.getCustomName(c.val()) : n.wrapper.spread.sheets[h].getCustomName(c.val())) && void 0 !== i)
                                        return void t.show(n.res.nameManagerDialog.exception2, n.res.title, 2, 0);
                                    n.util.isValidateName(c.val()) ? (o = n.wrapper.spread.getActiveSheet(),
                                        r = {
                                            arg: s[0],
                                            scope: a.selectedItem ? a.selectedItem.scope : void 0,
                                            name: a.selectedItem ? a.selectedItem.name : void 0,
                                            commentValue: d.val(),
                                            nameValue: c.val(),
                                            referToValue: p.val(),
                                            sheetIndex: h,
                                            inWorkbook: u,
                                            activeRowIndex: o.getActiveRowIndex(),
                                            activeColumnIndex: o.getActiveColumnIndex()
                                        },
                                        n.actions.doAction("baseDialogCommand", n.wrapper.spread, {
                                            value: r,
                                            execute: n.spreadActions.dialogAction.newNameDialoagApplySetting
                                        }),
                                        a.close()) : t.show(n.res.newNameDialog.wrongName, n.res.title, 3)
                                }
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.NewNameDialog = x,
                    w = function(e) {
                        n.extends(i, e);
                        function i() {
                            e.call(this, r, ".name-manager-dialog")
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                height: 550,
                                width: 640,
                                minWidth: 640,
                                maxWidth: 640,
                                minHeight: 550,
                                maxHeight: 550,
                                modal: !0,
                                title: n.res.nameManagerDialog.title,
                                buttons: [{
                                    text: n.res.close,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype.Bo = function() {
                                var e = this
                                    , t = this.xo.find(".edit-button")
                                    , i = this.xo.find(".delete-button")
                                    , o = this.xo.find(".names-grid");
                                this.Gr(),
                                    o.gcuigrid("option", "data", this.Lq()),
                                    this.Hr.length > 0 ? ($(t).button("enable"),
                                        $(i).button("enable")) : ($(t).button("disable"),
                                        $(i).button("disable")),
                                    setTimeout(function() {
                                        o.gcuigrid("doRefresh", e.Lq())
                                    }, 0)
                            }
                            ,
                            i.prototype._init = function() {
                                var e, i, o = this, r = this.xo.find(".names-grid"), a = this.xo.find(".edit-button"), s = this.xo.find(".delete-button"), l = this.xo.find(".filter-select"), c = function(e, t) {
                                    o.Ir = t.addedCells.sk[0].Ki
                                }, d = function(e, t) {
                                    var i = o.xo.find(".gcui-gcuigrid-scroller")
                                        , n = o.xo.find(".gcui-superpanel-statecontainer")
                                        , a = parseInt(n.css("width")) >= 605
                                        , s = parseInt(n.css("height"));
                                    a ? (i.css("height", s + 18 + "px"),
                                        n.css("height", s + 18 + "px")) : r.gcuigrid("doRefresh")
                                };
                                r.gcuigrid({
                                    scrollMode: "horizontal",
                                    allowColMoving: !1,
                                    allowColSizing: !0,
                                    height: "auto",
                                    columns: [{
                                        headerText: n.res.nameManagerDialog.nameColumn,
                                        dataType: "string",
                                        width: 120,
                                        ensurePxWidth: !0
                                    }, {
                                        headerText: n.res.nameManagerDialog.valueColumn,
                                        dataType: "string",
                                        width: 122,
                                        ensurePxWidth: !0
                                    }, {
                                        headerText: n.res.nameManagerDialog.refersToColumn,
                                        dataType: "string",
                                        width: 120,
                                        ensurePxWidth: !0
                                    }, {
                                        headerText: n.res.nameManagerDialog.scopeColumn,
                                        dataType: "string",
                                        width: 120,
                                        ensurePxWidth: !0
                                    }, {
                                        headerText: n.res.nameManagerDialog.commentColumn,
                                        dataType: "string",
                                        width: 120,
                                        ensurePxWidth: !0
                                    }],
                                    selectionChanged: c,
                                    columnResized: d
                                }),
                                    e = this,
                                    i = this.xo.find(".filter-select")[0].options,
                                    i.add(new Option(n.res.nameManagerDialog.filterWith.clearFilter)),
                                    i.add(new Option(n.res.nameManagerDialog.filterWith.nameScopedToWorkbook)),
                                    i.add(new Option(n.res.nameManagerDialog.filterWith.nameScopedToWorksheet)),
                                    i.add(new Option(n.res.nameManagerDialog.filterWith.nameWithErrors)),
                                    i.add(new Option(n.res.nameManagerDialog.filterWith.nameWithoutErrors)),
                                    this.xo.find(".new-button").button(),
                                    a.button(),
                                    s.button(),
                                    this.Jr = new x(this),
                                    this.xo.find(".new-button").click(function() {
                                        o.close(),
                                            o.Jr.open("new", void 0)
                                    }),
                                    a.click(function() {
                                        o.close(),
                                            o.Jr.open("edit", o.Hr[o.Ir])
                                    }),
                                    s.click(function() {
                                        t.show(n.util.format(n.res.nameManagerDialog.deleteAlert, o.Hr[o.Ir].name), "Spread Designer", 2, 1, function(e, t) {
                                            var i, l;
                                            if (1 === t) {
                                                if ("Workbook" === o.Hr[o.Ir].scope)
                                                    n.wrapper.spread.removeCustomName(o.Hr[o.Ir].name);
                                                else {
                                                    for (l = 0; l < n.wrapper.spread.sheets.length; l++)
                                                        if (n.wrapper.spread.sheets[l].name() === o.Hr[o.Ir].scope) {
                                                            i = l;
                                                            break
                                                        }
                                                    n.wrapper.spread.sheets[i].removeCustomName(o.Hr[o.Ir].name)
                                                }
                                                o.Gr(),
                                                    r.gcuigrid("option", "data", o.Lq()),
                                                0 === o.Hr.length && ($(a).button("disable"),
                                                    $(s).button("disable"))
                                            }
                                        })
                                    }),
                                    l.change(function() {
                                        r = e.xo.find(".names-grid"),
                                            o.Gr(),
                                            r.gcuigrid("option", "data", o.Lq()),
                                            0 === o.Hr.length ? ($(a).button("disable"),
                                                $(s).button("disable")) : ($(a).button("enable"),
                                                $(s).button("enable"))
                                    })
                            }
                            ,
                            i.prototype.Lq = function() {
                                var e, t, i, o = [];
                                for (e = 0; e < this.Hr.length; e++)
                                    t = {
                                        Name: this.Hr[e].name,
                                        Value: this.Hr[e].value,
                                        "Refers To": this.Hr[e].refersTo,
                                        Scope: this.Hr[e].scope
                                    },
                                        i = this.Hr[e].comment,
                                    i && (t.Comment = ("" + i).replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;")),
                                        o.push(t);
                                return this.k = new n.gcui.data.ArrayDataView(o),
                                    this.k
                            }
                            ,
                            i.prototype.Kr = function(e) {
                                var t, i, o, r, a, s, l, c, d, p = "";
                                if (e.type === GC.Spread.CalcEngine.ExpressionType.operator)
                                    p = "{...}";
                                else {
                                    if (e.source instanceof GC.Spread.CalcEngine.ErrorSource)
                                        return "{...}";
                                    if (t = e.source ? e.source.getSheet() : n.wrapper.spread.getActiveSheet(),
                                            i = e.column,
                                            o = e.row,
                                            r = e.endColumn ? e.endColumn - i + 1 : 1,
                                            a = e.endRow ? e.endRow - o + 1 : 1,
                                        i < 0 && (i = 0,
                                            r = t.getColumnCount()),
                                        o < 0 && (o = 0,
                                            a = t.getRowCount()),
                                            e.endRow) {
                                        for (s = t.getArray(o, i, a, r),
                                                 l = !1,
                                                 c = 0; c < s.length; c++) {
                                            for (d = 0; d < s[c].length; d++)
                                                null === s[c][d] ? p += '"",' : p += '"' + s[c][d] + '",';
                                            if (p = p.substring(0, p.length - 1),
                                                    p += ";",
                                                p.length > 50) {
                                                l = !0;
                                                break
                                            }
                                        }
                                        p = p.substring(0, p.length - 1),
                                            p = "{" + p + (l ? "..." : "}")
                                    } else
                                        null !== (p = t.getValue(o, i)) && (p = "" + p)
                                }
                                return p
                            }
                            ,
                            i.prototype.Lr = function(e) {
                                var t, i, o, r, a, s, l, c;
                                if (!e.getRange)
                                    return !1;
                                for (t = n.wrapper.spread.getActiveSheet(),
                                         i = e.getRange(0, 0),
                                         o = i.row,
                                         r = i.col,
                                         a = i.row + i.rowCount,
                                         s = i.col + i.colCount,
                                         l = o; l < a; l++)
                                    for (c = r; c < s; c++)
                                        if (t.getValue(l, c)instanceof GC.Spread.CalcEngine.CalcError)
                                            return !0;
                                return !1
                            }
                            ,
                            i.prototype.Gr = function() {
                                var e, t, i, o, r, a, s, l = this.xo.find(".filter-select"), c = n.wrapper.spread.getActiveSheet();
                                if (this.Hr = [],
                                        t = [],
                                        i = [],
                                        o = 0,
                                    l.val() !== n.res.nameManagerDialog.filterWith.nameScopedToWorksheet && void 0 !== (e = n.wrapper.spread.getCustomNames()))
                                    for (o; o < e.length; o++)
                                        r = this.Jo(null, e[o].getExpression(), c.getActiveRowIndex(), c.getActiveColumnIndex()),
                                            a = this.Kr(e[o].getExpression()),
                                            this.Hr.push({
                                                name: e[o].getName(),
                                                refersTo: r,
                                                scope: "Workbook",
                                                value: a,
                                                comment: e[o].getComment()
                                            }),
                                            this.Lr(e[o].getExpression()) ? t.push(this.Hr[this.Hr.length - 1]) : i.push(this.Hr[this.Hr.length - 1]);
                                if (l.val() !== n.res.nameManagerDialog.filterWith.nameScopedToWorkbook)
                                    for (s = 0; s < n.wrapper.spread.sheets.length; s++)
                                        if (void 0 !== (e = n.wrapper.spread.sheets[s].getCustomNames()))
                                            for (o = 0; o < e.length; o++)
                                                r = this.Jo(null, e[o].getExpression(), c.getActiveRowIndex(), c.getActiveColumnIndex()),
                                                    a = this.Kr(e[o].getExpression()),
                                                    this.Hr.push({
                                                        name: e[o].getName(),
                                                        refersTo: r,
                                                        scope: n.wrapper.spread.sheets[s].name(),
                                                        value: a,
                                                        comment: e[o].getComment()
                                                    }),
                                                    this.Lr(e[o].getExpression()) ? t.push(this.Hr[this.Hr.length - 1]) : i.push(this.Hr[this.Hr.length - 1]);
                                l.val() === n.res.nameManagerDialog.filterWith.nameWithoutErrors && (this.Hr = i),
                                l.val() === n.res.nameManagerDialog.filterWith.nameWithErrors && (this.Hr = t)
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.NameManagerDialog = w,
                    C = function(e) {
                        n.extends(t, e);
                        function t(t) {
                            e.call(this, r, ".tag-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                autoOpen: !1,
                                width: "auto",
                                modal: !0,
                                preventDefaultOkButton: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.Uo(),
                                            e.close()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function(e) {
                                var t = this
                                    , i = n.wrapper.spread.getActiveSheet()
                                    , o = ""
                                    , r = i.getSelections()[0];
                                switch (e[0]) {
                                    case "sheet":
                                        this.xo.dialog("option", "title", n.res.tagDialog.sheetTagTitle),
                                            o = i.tag() || "";
                                        break;
                                    case "cell":
                                        this.xo.dialog("option", "title", n.res.tagDialog.cellTagTitle),
                                        r && (o = i.getRange(r.row, r.col, r.rowCount, r.colCount).tag() || "");
                                        break;
                                    case "row":
                                        this.xo.dialog("option", "title", n.res.tagDialog.rowTagTitle),
                                        r && (o = i.getTag(r.row, r.col) || "");
                                        break;
                                    case "column":
                                        this.xo.dialog("option", "title", n.res.tagDialog.columnTagTitle),
                                        r && (o = i.getTag(r.row, r.col) || "")
                                }
                                this.xo.dialog("option", "open", function() {
                                    t.xo.find(".tag-input").focus()
                                }),
                                    this.xo.find(".tag-input").val(o)
                            }
                            ,
                            t.prototype.Uo = function() {
                                switch (this.Ao[0]) {
                                    case "sheet":
                                        n.actions.doAction("setTag", n.wrapper.spread, [this.xo.find(".tag-input").val(), "sheet"]);
                                        break;
                                    case "cell":
                                        n.actions.doAction("setTag", n.wrapper.spread, [this.xo.find(".tag-input").val(), "cell"]);
                                        break;
                                    case "row":
                                        n.actions.doAction("setTag", n.wrapper.spread, [this.xo.find(".tag-input").val(), "row"]);
                                        break;
                                    case "column":
                                        n.actions.doAction("setTag", n.wrapper.spread, [this.xo.find(".tag-input").val(), "column"])
                                }
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.TagDialog = C,
                    S = ["DAVERAGE", "DCOUNT", "DCOUNTA", "DGET", "DMAX", "DMIN", "DPRODUCT", "DSTDEV", "DSTDEVP", "DSUM", "DVAR", "DVARP"],
                    k = ["DATE", "DATEDIF", "DATEVALUE", "DAY", "DAYS360", "EDATE", "EOMONTH", "HOUR", "MINUTE", "MONTH", "NETWORKDAYS", "NOW", "SECOND", "TIME", "TIMEVALUE", "TODAY", "WEEKDAY", "WEEKNUM", "WORKDAY", "YEAR", "YEARFRAC"],
                    T = ["BESSELI", "BESSELJ", "BESSELK", "BESSELY", "BIN2DEC", "BIN2HEX", "BIN2OCT", "COMPLEX", "CONVERT", "DEC2BIN", "DEC2HEX", "DEC2OCT", "DELTA", "ERF", "ERFC", "GESTEP", "HEX2BIN", "HEX2DEC", "HEX2OCT", "IMABS", "IMAGINARY", "IMARGUMENT", "IMCONJUGATE", "IMCOS", "IMDIV", "IMEXP", "IMLN", "IMLOG10", "IMLOG2", "IMPOWER", "IMPRODUCT", "IMREAL", "IMSIN", "IMSQRT", "IMSUB", "IMSUM", "OCT2BIN", "OCT2DEC", "OCT2HEX"],
                    A = ["ACCRINT", "ACCRINTM", "AMORDEGRC", "AMORLINC", "COUPDAYBS", "COUPDAYS", "COUPDAYSNC", "COUPNCD", "COUPNUM", "COUPPCD", "CUMIPMT", "CUMPRINC", "DB", "DDB", "DISC", "DOLLARDE", "DOLLARFR", "DURATION", "EFFECT", "FV", "FVSCHEDULE", "INTRATE", "IPMT", "IRR", "ISPMT", "MDURATION", "MIRR", "NOMINAL", "NPER", "NPV", "ODDFPRICE", "ODDFYIELD", "ODDLPRICE", "ODDLYIELD", "EURO", "EUROCONVERT", "PMT", "PPMT", "PRICE", "PRICEDISC", "PRICEMAT", "PV", "RATE", "RECEIVED", "SLN", "SYD", "TBILLEQ", "TBILLPRICE", "TBILLYIELD", "VDB", "XIRR", "XNPV", "YIELD", "YIELDDISC", "YIELDMAT"],
                    I = ["ERROR.TYPE", "ISBLANK", "ISERR", "ISERROR", "ISEVEN", "ISLOGICAL", "ISNA", "ISNONTEXT", "ISNUMBER", "ISODD", "ISREF", "ISTEXT", "N", "NA", "TYPE"],
                    D = ["AND", "FALSE", "IF", "IFERROR", "NOT", "OR", "TRUE"],
                    F = ["ADDRESS", "CHOOSE", "COLUMN", "COLUMNS", "HLOOKUP", "INDEX", "LOOKUP", "MATCH", "OFFSET", "ROW", "ROWS", "TRANSPOSE", "VLOOKUP"],
                    L = ["ABS", "ACOS", "ACOSH", "ASIN", "ASINH", "ATAN", "ATAN2", "ATANH", "CEILING", "COMBIN", "COS", "COSH", "DEGREES", "EVEN", "EXP", "FACT", "FACTDOUBLE", "FLOOR", "GCD", "INT", "LCM", "LN", "LOG", "LOG10", "MDETERM", "MINVERSE", "MMULT", "MOD", "MROUND", "MULTINOMIAL", "ODD", "PI", "POWER", "PRODUCT", "QUOTIENT", "RADIANS", "RAND", "RANDBETWEEN", "ROMAN", "ROUND", "ROUNDDOWN", "ROUNDUP", "SERIESSUM", "SIGN", "SIN", "SINH", "SQRT", "SQRTPI", "SUBTOTAL", "SUM", "SUMIF", "SUMIFS", "SUMPRODUCT", "SUMSQ", "SUMX2MY2", "SUMX2PY2", "SUMXMY2", "TAN", "TANH", "TRUNC"],
                    R = ["AVEDEV", "AVERAGE", "AVERAGEA", "AVERAGEIF", "AVERAGEIFS", "BETADIST", "BETAINV", "BINOMDIST", "CHIDIST", "CHIINV", "CHITEST", "CONFIDENCE", "CORREL", "COUNT", "COUNTA", "COUNTBLANK", "COUNTIF", "COUNTIFS", "COVAR", "CRITBINOM", "DEVSQ", "EXPONDIST", "FDIST", "FINV", "FISHER", "FISHERINV", "FORECAST", "FREQUENCY", "FTEST", "GAMMADIST", "GAMMAINV", "GAMMALN", "GEOMEAN", "GROWTH", "HARMEAN", "HYPGEOMDIST", "INTERCEPT", "KURT", "LARGE", "LINEST", "LOGEST", "LOGINV", "LOGNORMDIST", "MAX", "MAXA", "MEDIAN", "MIN", "MINA", "MODE", "NEGBINOMDIST", "NORMDIST", "NORMINV", "NORMSDIST", "NORMSINV", "PEARSON", "PERCENTILE", "PERCENTRANK", "PERMUT", "POISSON", "PROB", "QUARTILE", "RANK", "RSQ", "SKEW", "SLOPE", "SMALL", "STANDARDIZE", "STDEV", "STDEVA", "STDEVP", "STDEVPA", "STEYX", "TDIST", "TINV", "TREND", "TRIMMEAN", "TTEST", "VAR", "VARA", "VARP", "VARPA", "WEIBULL", "ZTEST"],
                    B = ["CHAR", "CLEAN", "CODE", "CONCATENATE", "DOLLAR", "EXACT", "FIND", "FIXED", "LEFT", "LEN", "LOWER", "MID", "PROPER", "REPLACE", "REPT", "RIGHT", "SEARCH", "SUBSTITUTE", "T", "TEXT", "TRIM", "UPPER", "VALUE"],
                    N = [].concat(S, k, T, A, I, D, F, L, R, B),
                    E = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".insert-function-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                width: "470px",
                                modal: !0,
                                title: n.res.insertFunctionDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t, i, o = e.xo.find(".formula").val(), r = $("#formulaBarText");
                                        "=" !== o.substring(0, 1) && (o = "=" + o),
                                            r.text(o),
                                            t = n.wrapper.spread.getActiveSheet(),
                                            i = {
                                                txt: o,
                                                activeRowIndex: t.getActiveRowIndex(),
                                                activeColumnIndex: t.getActiveColumnIndex()
                                            },
                                            n.actions.doAction("baseDialogCommand", n.wrapper.spread, {
                                                value: i,
                                                execute: n.spreadActions.dialogAction.insertFunctionDiaplogApplySetting
                                            }),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e, t, i, o, r, a, s, l = this;
                                for (this.Mr = n.res.insertFunctionDialog.functionCategorys.split(","),
                                         N.sort(),
                                         e = this.xo.find(".function-list-select"),
                                         t = e[0].options,
                                         i = this.xo.find(".formula"),
                                         o = this.xo.find(".function-category-select"),
                                         r = o[0].options,
                                         o.empty(),
                                         a = 0; a < this.Mr.length; a++)
                                    r.add(new Option(this.Mr[a]));
                                e.change(function(e) {
                                    var t, i, o, n = e.target || e.srcElement, r = n, a = GC.Spread.CalcEngine.Functions.findGlobalFunction(r.value);
                                    a && (o = a.description(),
                                        i = o.description,
                                        t = o.parameters.map(function(e) {
                                            return e.name
                                        }).join(",")),
                                        l.xo.find(".function-name").text(r.value + "(" + t + ")"),
                                        l.xo.find(".function-description").text(i)
                                }),
                                    e.dblclick(function(e) {
                                        var t, o, n = e.target || e.srcElement, r = n;
                                        "" === i.prop("value") ? (i.prop("value", r.value + "()"),
                                            i.attr("caretIndex", i.prop("value").length - 1),
                                            l.xo.find(".formula").focus(),
                                            i[0].selectionStart = parseInt(i.attr("caretIndex")),
                                            i[0].selectionEnd = parseInt(i.attr("caretIndex"))) : (t = i.prop("value"),
                                            o = parseInt(i.attr("caretIndex")),
                                            t = t.substring(0, o) + r.value + "()" + t.substring(o, t.length),
                                            i.prop("value", t),
                                            i.attr("caretIndex", o + r.value.length + 1),
                                            l.xo.find(".formula").focus(),
                                            i[0].selectionStart = parseInt(i.attr("caretIndex")),
                                            i[0].selectionEnd = parseInt(i.attr("caretIndex")))
                                    }),
                                    s = function() {
                                        var e = i[0].selectionStart;
                                        i.attr("caretIndex", e)
                                    }
                                    ,
                                    i.select(s),
                                    i.click(s),
                                    i.keyup(s),
                                    o.change(function(i) {
                                        var o = i.target || i.srcElement
                                            , n = o;
                                        if (e.empty(),
                                            n.value === l.Mr[0])
                                            for (a = 0; a < N.length; a++)
                                                t.add(new Option(N[a]));
                                        else if (n.value === l.Mr[1])
                                            for (a = 0; a < S.length; a++)
                                                t.add(new Option(S[a]));
                                        else if (n.value === l.Mr[2])
                                            for (a = 0; a < k.length; a++)
                                                t.add(new Option(k[a]));
                                        else if (n.value === l.Mr[3])
                                            for (a = 0; a < T.length; a++)
                                                t.add(new Option(T[a]));
                                        else if (n.value === l.Mr[4])
                                            for (a = 0; a < A.length; a++)
                                                t.add(new Option(A[a]));
                                        else if (n.value === l.Mr[5])
                                            for (a = 0; a < I.length; a++)
                                                t.add(new Option(I[a]));
                                        else if (n.value === l.Mr[6])
                                            for (a = 0; a < D.length; a++)
                                                t.add(new Option(D[a]));
                                        else if (n.value === l.Mr[7])
                                            for (a = 0; a < F.length; a++)
                                                t.add(new Option(F[a]));
                                        else if (n.value === l.Mr[8])
                                            for (a = 0; a < L.length; a++)
                                                t.add(new Option(L[a]));
                                        else if (n.value === l.Mr[9])
                                            for (a = 0; a < R.length; a++)
                                                t.add(new Option(R[a]));
                                        else if (n.value === l.Mr[10])
                                            for (a = 0; a < B.length; a++)
                                                t.add(new Option(B[a]));
                                        $(t[0]).prop("selected", !0),
                                            e.trigger("change")
                                    })
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e, t, i, o, r, a, s, l, c, d = $("#formulaBarText"), p = d.text(), u = d[0].selectionStart;
                                for (void 0 !== p && ("=" === p.substring(0, 1) ? (e = p.substring(1, p.length),
                                    t = u - 1) : t = u),
                                         i = this.xo.find(".function-list-select"),
                                         o = i[0].options,
                                         i.empty(),
                                         r = 0; r < N.length; r++)
                                    o.add(new Option(N[r]));
                                this.xo.find(".function-category-select").prop("selectedIndex", 0),
                                    this.xo.find(".function-list-select").prop("selectedIndex", 0),
                                    this.xo.find(".function-list-select").trigger("change"),
                                    a = n.wrapper.spread.getActiveSheet().getActiveRowIndex(),
                                    s = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(),
                                    l = n.wrapper.spread.getActiveSheet().getCell(a, s).formula(),
                                    c = this.xo.find(".formula"),
                                    void 0 !== e ? (c.prop("value", e),
                                        c.attr("caretIndex", t),
                                        c[0].selectionStart = t,
                                        c[0].selectionEnd = t) : void 0 !== l && null !== l ? (c.prop("value", l),
                                        c.attr("caretIndex", l.length),
                                        c[0].selectionStart = parseInt(c.attr("caretIndex")),
                                        c[0].selectionEnd = parseInt(c.attr("caretIndex"))) : (c.prop("value", ""),
                                        c.attr("caretIndex", 0))
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.InsertFunctionDialog = E,
                    V = function(t) {
                        n.extends(i, t);
                        function i() {
                            t.call(this, r, ".button-celltype-dialog")
                        }
                        return i.prototype.wo = function() {
                            var t = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.buttonCellTypeDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var i = t.xo.find(".margin-left")
                                            , r = t.xo.find(".margin-top")
                                            , a = t.xo.find(".margin-right")
                                            , s = t.xo.find(".margin-bottom")
                                            , l = t.xo.find(".button-text")
                                            , c = t.xo.find(".color-span")
                                            , d = new o.CellTypes.Button;
                                        "" !== i.val() && d.marginLeft(parseFloat(i.val())),
                                        "" !== r.val() && d.marginTop(parseFloat(r.val())),
                                        "" !== a.val() && d.marginRight(parseFloat(a.val())),
                                        "" !== s.val() && d.marginBottom(parseFloat(s.val())),
                                        "" !== l.val() && d.text(l.val()),
                                        c.css("background-color") !== e.uq() && d.buttonBackColor(c.css("background-color")),
                                            n.actions.doAction("setCellType", n.wrapper.spread, d),
                                            t.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        t.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype._init = function() {
                                var e = this;
                                $(".button-backcolor-color-picker").colorpicker({
                                    valueChanged: function(t, i) {
                                        void 0 === i.color ? e.xo.find(".color-span").css("background-color", "") : e.xo.find(".color-span").css("background-color", i.color)
                                    },
                                    choosedColor: function(t, i) {
                                        e.xo.find(".color-frame").comboframe("close")
                                    },
                                    openColorDialog: function(t, i) {
                                        e.xo.find(".color-frame").comboframe("close")
                                    }
                                }),
                                    this.xo.find(".color-frame").comboframe()
                            }
                            ,
                            i.prototype.Bo = function() {
                                var e, t, i, r, a, s, l = this.xo.find(".margin-left"), c = this.xo.find(".margin-top"), d = this.xo.find(".margin-right"), p = this.xo.find(".margin-bottom"), u = this.xo.find(".button-text"), h = this.xo.find(".color-span"), f = $(".button-backcolor-color-picker");
                                $(".button-backcolor-color-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors()),
                                    e = n.wrapper.spread.getActiveSheet().getActiveRowIndex(),
                                    t = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(),
                                    i = n.wrapper.spread.getActiveSheet().getCell(e, t),
                                    r = i.cellType(),
                                    a = r instanceof o.CellTypes.Button ? r : new o.CellTypes.Button,
                                    l.val(a.Nr),
                                    c.val(a.Or),
                                    d.val(a.Pr),
                                    p.val(a.Qr),
                                    u.val(a.Rr),
                                    a.Sr ? (s = n.ColorHelper.parse(a.Sr, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        f.colorpicker("option", "selectedItem", s),
                                        h.css("background-color", s.color)) : (f.colorpicker("option", "selectedItem", null),
                                        h.css("background-color", "transparent"))
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.ButtonCellTypeDialog = V,
                    P = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".checkbox-celltype-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.checkBoxCellTypeDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xo.find(".text-true")
                                            , i = e.xo.find(".text-indeterminate")
                                            , r = e.xo.find(".text-false")
                                            , a = e.xo.find(".text-align")
                                            , s = e.xo.find(".caption")
                                            , l = e.xo.find(".isThreeState")
                                            , c = new o.CellTypes.CheckBox;
                                        "" !== t.val() && c.textTrue(t.val()),
                                        "" !== i.val() && c.textIndeterminate(i.val()),
                                        "" !== r.val() && c.textFalse(r.val()),
                                        "" !== s.val() && c.caption(s.val()),
                                            c.textAlign(parseInt(a.val())),
                                            c.isThreeState(l.prop("checked")),
                                            n.actions.doAction("setCellType", n.wrapper.spread, c),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this.xo.find(".text-align")
                                    , t = e[0].options;
                                t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.top,"0")),
                                    t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.bottom,"1")),
                                    t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.left,"2")),
                                    t.add(new Option(n.res.checkBoxCellTypeDialog.checkBoxTextAlign.right,"3"))
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e, t = this.xo.find(".text-true"), i = this.xo.find(".text-indeterminate"), r = this.xo.find(".text-false"), a = this.xo.find(".text-align"), s = a[0].options, l = this.xo.find(".caption"), c = this.xo.find(".isThreeState"), d = n.wrapper.spread.getActiveSheet().getActiveRowIndex(), p = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(), u = n.wrapper.spread.getActiveSheet().getCell(d, p), h = u.cellType();
                                e = h instanceof o.CellTypes.CheckBox ? h : new o.CellTypes.CheckBox,
                                    t.val(e.textTrue()),
                                    i.val(e.textIndeterminate()),
                                    r.val(e.textFalse()),
                                    l.val(e.caption()),
                                    $(s[parseInt(e.textAlign())]).prop("selected", !0),
                                    a.prop("selected", e.textAlign()),
                                    c.prop("checked", e.isThreeState())
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.CheckBoxCellTypeDialog = P,
                    z = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".combobox-celltype-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                width: "auto",
                                modal: !0,
                                title: n.res.comboBoxCellTypeDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t, i, r, a, s, l = e.xo.find(".text"), c = e.xo.find(".value");
                                        -1 !== e.selectedIndex && e.selectedIndex < e.items.length && (e.items[e.selectedIndex] = {
                                            text: l.val(),
                                            value: c.val()
                                        }),
                                            t = e.xo.find(".editor-valuetype"),
                                            i = new o.CellTypes.ComboBox,
                                            i.editorValueType(parseInt(t.val())),
                                            r = e.xo.find("#combox-editable"),
                                            i.editable(r.prop("checked")),
                                            a = e.xo.find(".combo-item-height"),
                                            s = parseFloat(a.val()),
                                        isNaN(s) || i.itemHeight(s),
                                        null !== e.items && void 0 !== e.items && i.items(e.items),
                                            n.actions.doAction("setCellType", n.wrapper.spread, i),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e, t, i, o, r, a, s, l, c = this;
                                this.selectedIndex = -1,
                                    e = this.xo.find(".editor-valuetype"),
                                    t = e[0].options,
                                    t.add(new Option(n.res.comboBoxCellTypeDialog.editorValueType.text,"0")),
                                    t.add(new Option(n.res.comboBoxCellTypeDialog.editorValueType.index,"1")),
                                    t.add(new Option(n.res.comboBoxCellTypeDialog.editorValueType.value,"2")),
                                    i = this.xo.find(".items"),
                                    o = i[0].options,
                                    r = this.xo.find(".text"),
                                    a = this.xo.find(".value"),
                                    s = this.xo.find(".add-button"),
                                    l = this.xo.find(".remove-button"),
                                    s.button(),
                                    l.button(),
                                    s.click(function() {
                                        o[o.length] = new Option("ListItem" + o.length),
                                        null === c.items && (c.items = []),
                                            c.items.push({
                                                text: "",
                                                value: ""
                                            }),
                                            r.removeAttr("disabled"),
                                            a.removeAttr("disabled"),
                                            i.trigger("change", {
                                                selectMoveTo: c.items.length - 1,
                                                action: "add"
                                            })
                                    }),
                                    l.click(function() {
                                        o.remove(c.selectedIndex),
                                            c.items.splice(c.selectedIndex, 1);
                                        var e;
                                        c.items.length > c.selectedIndex ? e = c.selectedIndex : c.items.length > 0 ? e = c.selectedIndex - 1 : (e = -1,
                                            r.val(""),
                                            a.val(""),
                                            r.attr("disabled", !0),
                                            a.attr("disabled", !0)),
                                            i.trigger("change", {
                                                selectMoveTo: e,
                                                action: "remove"
                                            })
                                    }),
                                    i.change(function(e, t) {
                                        var i, n = e.target || e.srcElement, s = n;
                                        (void 0 === t || "add" === t.action) && -1 !== c.selectedIndex && c.selectedIndex < c.items.length && (c.items[c.selectedIndex] = {
                                            text: r.val(),
                                            value: a.val()
                                        }),
                                            void 0 === t ? (i = s.value.substring(8),
                                                c.selectedIndex = parseInt(i)) : c.selectedIndex = t.selectMoveTo,
                                        -1 !== c.selectedIndex && ($(o[c.selectedIndex]).prop("selected", !0),
                                            r.val(c.items[c.selectedIndex].text),
                                            a.val(c.items[c.selectedIndex].value))
                                    })
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e, t, i = this.xo.find(".editor-valuetype"), r = i[0].options, a = this.xo.find(".items"), s = a[0].options, l = this.xo.find(".text"), c = this.xo.find(".value"), d = this.xo.find(".combo-item-height"), p = this.xo.find("#combox-editable"), u = n.wrapper.spread.getActiveSheet().getActiveRowIndex(), h = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(), f = n.wrapper.spread.getActiveSheet().getCell(u, h), g = f.cellType();
                                if (e = g instanceof o.CellTypes.ComboBox ? g : new o.CellTypes.ComboBox,
                                        d.val(e.itemHeight()),
                                        p.prop("checked", e.editable()),
                                        $(r[parseInt(e.editorValueType())]).prop("selected", !0),
                                        this.items = e.items(),
                                        a.empty(),
                                    null !== this.items && void 0 !== this.items && 0 !== this.items.length) {
                                    for (t = 0; t < this.items.length; t++)
                                        s[s.length] = new Option("ListItem" + s.length);
                                    l.removeAttr("disabled"),
                                        c.removeAttr("disabled"),
                                        $(s[0]).prop("selected", !0),
                                        l.val(this.items[0].text),
                                        c.val(this.items[0].value),
                                        this.selectedIndex = 0
                                } else
                                    l.val(""),
                                        c.val(""),
                                        l.attr("disabled", !0),
                                        c.attr("disabled", !0)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.ComboBoxCellTypeDialog = z,
                    j = function(t) {
                        n.extends(i, t);
                        function i() {
                            t.call(this, r, ".hyperLink-celltype-dialog")
                        }
                        return i.prototype.wo = function() {
                            var t = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.hyperLinkCellTypeDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var i = t.xo.find(".text")
                                            , r = t.xo.find(".linktooltip")
                                            , a = t.xo.find(".link-color-span")
                                            , s = t.xo.find(".visitedlink-color-span")
                                            , l = new o.CellTypes.HyperLink;
                                        "" !== i.val() && l.text(i.val()),
                                        "" !== r.val() && l.linkToolTip(r.val()),
                                        a.css("background-color") !== e.uq() && l.linkColor(a.css("background-color")),
                                        s.css("background-color") !== e.uq() && l.visitedLinkColor(s.css("background-color")),
                                            n.actions.doAction("setCellType", n.wrapper.spread, l),
                                            t.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        t.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype._init = function() {
                                var e = this;
                                $(".link-color-picker").colorpicker({
                                    valueChanged: function(t, i) {
                                        void 0 === i.color ? e.xo.find(".link-color-span").css("background-color", "") : e.xo.find(".link-color-span").css("background-color", i.color)
                                    },
                                    choosedColor: function(t, i) {
                                        e.xo.find(".link-color-frame").comboframe("close")
                                    },
                                    openColorDialog: function(t, i) {
                                        e.xo.find(".link-color-frame").comboframe("close")
                                    }
                                }),
                                    this.xo.find(".link-color-frame").comboframe(),
                                    $(".visitedlink-color-picker").colorpicker({
                                        valueChanged: function(t, i) {
                                            void 0 === i.color ? e.xo.find(".visitedlink-color-span").css("background-color", "") : e.xo.find(".visitedlink-color-span").css("background-color", i.color)
                                        },
                                        choosedColor: function(t, i) {
                                            e.xo.find(".visitedlink-color-frame").comboframe("close")
                                        },
                                        openColorDialog: function(t, i) {
                                            e.xo.find(".visitedlink-color-frame").comboframe("close")
                                        }
                                    }),
                                    this.xo.find(".visitedlink-color-frame").comboframe()
                            }
                            ,
                            i.prototype.Bo = function() {
                                var e, t, i, r, a, s, l = this.xo.find(".text"), c = this.xo.find(".linktooltip"), d = this.xo.find(".link-color-span"), p = $(".link-color-picker"), u = this.xo.find(".visitedlink-color-span"), h = $(".visitedlink-color-picker");
                                p.colorpicker("option", "themeColors", n.wrapper.getThemeColors()),
                                    h.colorpicker("option", "themeColors", n.wrapper.getThemeColors()),
                                    e = n.wrapper.spread.getActiveSheet().getActiveRowIndex(),
                                    t = n.wrapper.spread.getActiveSheet().getActiveColumnIndex(),
                                    i = n.wrapper.spread.getActiveSheet().getCell(e, t),
                                    r = i.cellType(),
                                    a = r instanceof o.CellTypes.HyperLink ? r : new o.CellTypes.HyperLink,
                                    c.val(a.Tr),
                                    l.val(a.Rr),
                                    a.Ur ? (s = n.ColorHelper.parse(a.Ur, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        p.colorpicker("option", "selectedItem", s),
                                        d.css("background-color", s.color)) : (p.colorpicker("option", "selectedItem", null),
                                        d.css("background-color", "transparent")),
                                    a.Vr ? (s = n.ColorHelper.parse(a.Vr, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        h.colorpicker("option", "selectedItem", s),
                                        u.css("background-color", s.color)) : (h.colorpicker("option", "selectedItem", null),
                                        u.css("background-color", "transparent"))
                            }
                            ,
                            i
                    }(n.BaseDialog),
                    n.HyperLinkCellTypeDialog = j,
                    M = function(e) {
                        n.extends(a, e);
                        function a() {
                            e.call(this, r, ".header-cells-dialog")
                        }
                        var s = {
                            0: "empty",
                            1: "thin",
                            2: "medium",
                            3: "dashed",
                            4: "dotted",
                            5: "thick",
                            6: "double",
                            7: "hair",
                            8: "mediumDashed",
                            9: "dashDot",
                            10: "mediumDashDot",
                            11: "dashDotDot",
                            12: "mediumDashDotDot",
                            13: "slantedDashDot"
                        };
                        a.prototype.wo = function() {
                            var e = this;
                            return {
                                width: 740,
                                height: 720,
                                resizable: !1,
                                modal: !0,
                                title: n.res.headerCellsDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.Wr(e.Xr),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                        ;
                        function c(e) {
                            e.sheets[0].selectionPolicy(1),
                                e.options.tabStripVisible = !1,
                                e.options.allowContextMenu = !1
                        }
                        return a.prototype._init = function() {
                            var e, t, i, r, a, s, l, d, p, u, h;
                            this.Yr = !1,
                                this.xo.find(".font-popup").button(),
                                this.Zr = this.xo.find(".header-tab").tabs(),
                                this.$r = new o.Workbook(this.xo.find("#rowHeaderTab")[0],{
                                    sheetCount: 1
                                }),
                                this._r = new o.Workbook(this.xo.find("#columnHeaderTab")[0],{
                                    sheetCount: 1
                                }),
                                e = this.$r,
                                e.options.allowContextMenu = !1,
                                t = this._r,
                                t.options.allowContextMenu = !1,
                                c(e),
                                c(t),
                                i = this.xo.find(".hAlign"),
                                r = this.xo.find(".vAlign");
                            for (a in o.HorizontalAlign)
                                o.HorizontalAlign.hasOwnProperty(a) && i.append($("<option></option>").val(a).text(n.res.headerCellsDialog[a]));
                            for (a in o.VerticalAlign)
                                o.VerticalAlign.hasOwnProperty(a) && r.append($("<option></option>").val(a).text(n.res.headerCellsDialog[a]));
                            this.as(e, t),
                                this.xo.find(".backColor-colorframe").comboframe(),
                                this.xo.find(".foreColor-colorframe").comboframe(),
                                this.xo.find(".borderBottom-borderframe").comboframe(),
                                this.xo.find(".borderLeft-borderframe").comboframe(),
                                this.xo.find(".borderRight-borderframe").comboframe(),
                                this.xo.find(".borderTop-borderframe").comboframe(),
                                this.xo.find(".diagonalUp-borderframe").comboframe(),
                                this.xo.find(".diagonalDown-borderframe").comboframe(),
                                s = $(".borderBottom-borderpicker"),
                                l = $(".borderLeft-borderpicker"),
                                d = $(".borderRight-borderpicker"),
                                p = $(".borderTop-borderpicker"),
                                u = $(".diagonalUp-borderpicker"),
                                h = $(".diagonalDown-borderpicker"),
                                s.borderpicker("option", "colorOptions", {
                                    showMoreColors: !1,
                                    showNoFill: !1
                                }),
                                l.borderpicker("option", "colorOptions", {
                                    showMoreColors: !1,
                                    showNoFill: !1
                                }),
                                d.borderpicker("option", "colorOptions", {
                                    showMoreColors: !1,
                                    showNoFill: !1
                                }),
                                p.borderpicker("option", "colorOptions", {
                                    showMoreColors: !1,
                                    showNoFill: !1
                                }),
                                u.borderpicker("option", "colorOptions", {
                                    showMoreColors: !1,
                                    showNoFill: !1
                                }),
                                h.borderpicker("option", "colorOptions", {
                                    showMoreColors: !1,
                                    showNoFill: !1
                                })
                        }
                            ,
                            a.prototype.Bo = function(e) {
                                var t, i, r, a, s, l = this;
                                switch (this.od || (this.od = !0,
                                    this.xo.find(".button-set").gcuiribbon({
                                        click: function(e, t) {
                                            var i, o, r, a, s = l.bs.getActiveSheet();
                                            switch (t.commandName) {
                                                case "merge":
                                                    n.actions.doAction("mergeCells", l.bs);
                                                    break;
                                                case "unmerge":
                                                    n.actions.doAction("unmergeCells", l.bs);
                                                    break;
                                                case "insertrows":
                                                    n.actions.doAction("insertRows", l.bs);
                                                    break;
                                                case "addrows":
                                                    for (i = new n.spreadActions.InsertAndDeleteBase(l.bs,{
                                                        sheetName: s.sheetName,
                                                        selections: s.getSelections()
                                                    }),
                                                             r = i.getSortedRowSelections(),
                                                             o = 0; o < r.length; o++)
                                                        l.bs.sheets[0].addRows(l.bs.sheets[0].getRowCount(), r[o].rowCount);
                                                    break;
                                                case "deleterows":
                                                    n.actions.doAction("deleteRows", l.bs);
                                                    break;
                                                case "insertcolumns":
                                                    n.actions.doAction("insertColumns", l.bs);
                                                    break;
                                                case "addcolumns":
                                                    for (i = new n.spreadActions.InsertAndDeleteBase(l.bs,{
                                                        sheetName: s.sheetName,
                                                        selections: s.getSelections()
                                                    }),
                                                             a = i.getSortedColumnSelections(),
                                                             o = 0; o < a.length; o++)
                                                        l.bs.sheets[0].addColumns(l.bs.sheets[0].getColumnCount(), a[o].colCount);
                                                    break;
                                                case "deletecolumns":
                                                    n.actions.doAction("deleteColumns", l.bs);
                                                    break;
                                                case "clear":
                                                    n.actions.doAction("clearAll", l.bs)
                                            }
                                        }
                                    })),
                                    this.xo.find(".gcui-ribbon-list").removeClass("gcui-gcuitabs-hide"),
                                    i = this.$r,
                                    r = this._r,
                                    e[0]) {
                                    case "row":
                                        t = 0,
                                            this.bs = i,
                                            this.Xr = 2,
                                            this.cs("row"),
                                            n.util.triggerSheetEvent(i.sheets[0], o.Events.SelectionChanged),
                                            setTimeout(function() {
                                                i.refresh()
                                            }, 0);
                                        break;
                                    case "col":
                                        t = 1,
                                            this.bs = r,
                                            this.Xr = 1,
                                            this.cs("col"),
                                            n.util.triggerSheetEvent(r.sheets[0], o.Events.SelectionChanged),
                                            setTimeout(function() {
                                                r.refresh()
                                            }, 0)
                                }
                                this.ds(e[0]),
                                    this.Zr.tabs("option", "active", t),
                                    this.es(i, r),
                                    this.fs(1, r),
                                    this.fs(2, i),
                                    this.cs(e[0]),
                                    this.gs("cell"),
                                    a = $(".backColor-colorpicker"),
                                    s = $(".foreColor-colorpicker"),
                                    a.colorpicker("option", "themeColors", n.wrapper.getThemeColors()),
                                    s.colorpicker("option", "themeColors", n.wrapper.getThemeColors())
                            }
                            ,
                            a.prototype.es = function(e, t, i) {
                                var o, r, a, s, l, c, d, p;
                                i ? (o = e.sheets[0].getColumnCount(3),
                                    r = t.sheets[0].getColumnCount(3),
                                    a = e.sheets[0].getRowCount(3),
                                    s = t.sheets[0].getRowCount(3),
                                    n.wrapper.spread.getActiveSheet().setColumnCount(o, 2),
                                    n.wrapper.spread.getActiveSheet().setRowCount(a, 2),
                                    n.wrapper.spread.getActiveSheet().setColumnCount(r, 1),
                                    n.wrapper.spread.getActiveSheet().setRowCount(s, 1)) : (l = n.wrapper.spread.getActiveSheet().getColumnCount(2),
                                    c = n.wrapper.spread.getActiveSheet().getColumnCount(1),
                                    d = n.wrapper.spread.getActiveSheet().getRowCount(2),
                                    p = n.wrapper.spread.getActiveSheet().getRowCount(1),
                                    e.sheets[0].setColumnCount(l),
                                    e.sheets[0].setRowCount(d),
                                    t.sheets[0].setColumnCount(c),
                                    t.sheets[0].setRowCount(p))
                            }
                            ,
                            a.prototype.cs = function(e) {
                                var t = 0
                                    , i = 0;
                                switch (e) {
                                    case "row":
                                        t = n.wrapper.spread.getActiveSheet().getActiveRowIndex();
                                        break;
                                    case "col":
                                        i = n.wrapper.spread.getActiveSheet().getActiveColumnIndex()
                                }
                                this.bs.sheets[0].setActiveCell(t, i)
                            }
                            ,
                            a.prototype.gs = function(e) {
                                var t, i, o, r, a, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D = this.bs.sheets[0], F = D.getActiveColumnIndex(), L = D.getActiveRowIndex(), R = D.getValue(L, F, 3), B = D.getColumnWidth(F, 3), N = D.getRowHeight(L, 3), E = D.getColumnVisible(F, 3), V = D.getRowVisible(L, 3), P = D.getColumnResizable(F, 3), z = D.getRowResizable(L, 3), j = this.xo.find(".height"), M = this.xo.find(".value"), O = this.xo.find(".visible"), G = this.xo.find(".width"), H = this.xo.find(".resizable");
                                switch (j.val(N),
                                    null !== R ? M.val("" + R) : M.val(""),
                                    G.val(B),
                                    e) {
                                    case "row":
                                        H.prop("checked", z),
                                            O.prop("checked", V),
                                            t = D.getStyle(L, -1, 3);
                                        break;
                                    case "col":
                                        H.prop("checked", P),
                                            O.prop("checked", E),
                                            t = D.getStyle(-1, F, 3);
                                        break;
                                    case "cell":
                                        t = D.getStyle(L, F, 3);
                                        break;
                                    case "sheet":
                                        t = D.getStyle(-1, -1, 3)
                                }
                                i = this.xo.find(".backColor-colorspan"),
                                    o = $(".backColor-colorpicker"),
                                    r = this.xo.find(".foreColor-colorspan"),
                                    a = $(".foreColor-colorpicker"),
                                    l = this.xo.find(".borderBottom-borderspan"),
                                    c = this.xo.find(".borderLeft-borderspan"),
                                    d = this.xo.find(".borderRight-borderspan"),
                                    p = this.xo.find(".borderTop-borderspan"),
                                    u = this.xo.find(".diagonalUp-borderspan"),
                                    h = this.xo.find(".diagonalDown-borderspan"),
                                    f = this.xo.find(".font"),
                                    g = this.xo.find(".formatter"),
                                    m = this.xo.find(".hAlign"),
                                    b = this.xo.find(".locked"),
                                    v = this.xo.find(".verticalText"),
                                    y = this.xo.find(".shrinkToFit"),
                                    x = this.xo.find(".textIndent"),
                                    w = this.xo.find(".vAlign"),
                                    C = this.xo.find(".wordWrap"),
                                    S = m[0].options,
                                    k = w[0].options,
                                    null !== t && void 0 !== t ? (void 0 !== t.backColor ? (T = n.ColorHelper.parse(t.backColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        o.colorpicker("option", "selectedItem", T),
                                        i.css("background-color", T.color)) : (o.colorpicker("option", "selectedItem", null),
                                        i.css("background-color", "transparent")),
                                        void 0 !== t.foreColor ? (T = n.ColorHelper.parse(t.foreColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                            a.colorpicker("option", "selectedItem", T),
                                            r.css("background-color", T.color)) : (a.colorpicker("option", "selectedItem", null),
                                            r.css("background-color", "transparent")),
                                        void 0 !== t.borderBottom ? (A = t.borderBottom,
                                            I = "",
                                        void 0 !== A.color && null !== A.color && (I = A.color),
                                        void 0 !== A.style && null !== A.style && (I += ";" + s[A.style]),
                                            l.val(I)) : l.val(""),
                                        void 0 !== t.borderLeft ? (A = t.borderLeft,
                                            I = "",
                                        void 0 !== A.color && null !== A.color && (I = A.color),
                                        void 0 !== A.style && null !== A.style && (I += ";" + s[A.style]),
                                            c.val(I)) : c.val(""),
                                        void 0 !== t.borderRight ? (A = t.borderRight,
                                            I = "",
                                        void 0 !== A.color && null !== A.color && (I = A.color),
                                        void 0 !== A.style && null !== A.style && (I += ";" + s[A.style]),
                                            d.val(I)) : d.val(""),
                                        void 0 !== t.borderTop ? (A = t.borderTop,
                                            I = "",
                                        void 0 !== A.color && null !== A.color && (I = A.color),
                                        void 0 !== A.style && null !== A.style && (I += ";" + s[A.style]),
                                            p.val(I)) : p.val(""),
                                        void 0 !== t.diagonalUp ? (A = t.diagonalUp,
                                            I = "",
                                        void 0 !== A.color && null !== A.color && (I = A.color),
                                        void 0 !== A.style && null !== A.style && (I += ";" + s[A.style]),
                                            u.val(I)) : u.val(""),
                                        void 0 !== t.diagonalDown ? (A = t.diagonalDown,
                                            I = "",
                                        void 0 !== A.color && null !== A.color && (I = A.color),
                                        void 0 !== A.style && null !== A.style && (I += ";" + s[A.style]),
                                            h.val(I)) : h.val(""),
                                        void 0 !== t.font ? f.val(t.font) : f.val(""),
                                        void 0 !== t.formatter ? g.val(t.formatter) : g.val(""),
                                        void 0 !== t.textIndent ? x.val(t.textIndent) : x.val(""),
                                        void 0 !== t.locked ? b.prop("checked", t.locked) : b.prop("checked", !0),
                                        void 0 !== t.wordWrap ? C.prop("checked", t.wordWrap) : C.prop("checked", !1),
                                        void 0 !== t.shrinkToFit ? y.prop("checked", t.shrinkToFit) : y.prop("checked", !1),
                                        void 0 !== t.isVerticalText ? v.prop("checked", t.isVerticalText) : v.prop("checked", !1),
                                        void 0 !== t.hAlign ? $(S[parseInt(t.hAlign)]).prop("selected", !0) : $(S[3]).prop("selected", !0),
                                        void 0 !== t.vAlign ? $(k[parseInt(t.vAlign)]).prop("selected", !0) : $(k[1]).prop("selected", !0)) : (o.colorpicker("option", "selectedItem", null),
                                        i.css("background-color", "transparent"),
                                        a.colorpicker("option", "selectedItem", null),
                                        r.css("background-color", "transparent"),
                                        l.val(""),
                                        c.val(""),
                                        d.val(""),
                                        p.val(""),
                                        u.val(""),
                                        h.val(""),
                                        f.val(""),
                                        g.val(""),
                                        x.val(""),
                                        b.prop("checked", !0),
                                        C.prop("checked", !1),
                                        y.prop("checked", !1),
                                        v.prop("checked", !1),
                                        $(S[3]).prop("selected", !0),
                                        $(k[1]).prop("selected", !0))
                            }
                            ,
                            a.prototype.fs = function(e, t) {
                                var i, o, r, a, s;
                                i = t || this.bs,
                                    i.suspendPaint();
                                try {
                                    for (o = n.wrapper.spread.getActiveSheet(),
                                             r = i.sheets[0],
                                             a = 0; a < r.getRowCount(); a++)
                                        for (s = 0; s < r.getColumnCount(); s++)
                                            this.hs(o, r, a, s, e, 3);
                                    for (a = 0; a < r.getColumnCount(); a++)
                                        this.hs(o, r, -1, a, e, 3);
                                    for (a = 0; a < r.getRowCount(); a++)
                                        this.hs(o, r, a, -1, e, 3);
                                    this.hs(o, r, -1, -1, e, 3),
                                        this.js(o, r, e, 3)
                                } catch (e) {
                                    i.resumePaint()
                                }
                                i.resumePaint()
                            }
                            ,
                            a.prototype.Wr = function(e) {
                                var i, o, r, a, s;
                                if (this.Yr)
                                    return void t.show(n.res.headerCellsDialog.exception, n.res.title, 3, 0);
                                n.wrapper.spread.suspendPaint();
                                try {
                                    i = this.$r.sheets[0],
                                        o = this._r.sheets[0],
                                        r = new GC.Spread.Sheets.Worksheet("rowSheetTemp"),
                                        r.fromJSON(i.toJSON()),
                                        a = new GC.Spread.Sheets.Worksheet("colSheetTemp"),
                                        a.fromJSON(o.toJSON()),
                                        s = {
                                            rowSheet: r,
                                            colSheet: a
                                        },
                                        n.actions.doAction("baseDialogCommand", n.wrapper.spread, {
                                            value: s,
                                            execute: n.spreadActions.dialogAction.headerCellsApplySetting
                                        })
                                } catch (e) {
                                    n.wrapper.spread.resumePaint()
                                }
                                n.wrapper.spread.resumePaint(),
                                    this.close()
                            }
                            ,
                            a.prototype.hs = function(e, t, i, o, n, r) {
                                var a, s, l, c, d, p, u, h, f = e.getStyle(i, o, n);
                                t.setStyle(i, o, f, r),
                                    a = e.getValue(i, o, n),
                                    s = t.getValue(i, o, r),
                                a !== s && t.setValue(i, o, a, r),
                                    l = e.getColumnWidth(o, n),
                                void 0 !== l && l >= 0 && t.setColumnWidth(o, l, r),
                                    c = e.getRowHeight(i, n),
                                void 0 !== c && c >= 0 && t.setRowHeight(i, c, r),
                                    d = e.getColumnVisible(o, n),
                                    t.setColumnVisible(o, d, r),
                                    p = e.getRowVisible(i, n),
                                    t.setRowVisible(i, p, r),
                                    u = e.getColumnResizable(o, n),
                                    t.setColumnResizable(o, u, r),
                                    h = e.getRowResizable(i, n),
                                    t.setRowResizable(i, h, r)
                            }
                            ,
                            a.prototype.js = function(e, t, i, o) {
                                var n, r = t.getSpans(void 0, o);
                                for (n = 0; n < r.length; n++)
                                    t.removeSpan(r[n].row, r[n].col, o);
                                if (r = e.getSpans(void 0, i),
                                    0 !== r.length)
                                    for (n = 0; n < r.length; n++)
                                        t.addSpan(r[n].row, r[n].col, r[n].rowCount, r[n].colCount, o)
                            }
                            ,
                            a.prototype.ds = function(e) {
                                var t = this.xo.find(".property-grid-container")
                                    , i = this.xo.find(".property-grid")
                                    , o = this.xo.find(".header-tab");
                                switch (e) {
                                    case "row":
                                        o.addClass("rowheader-sheet"),
                                            o.removeClass("columnheader-sheet"),
                                            i.addClass("rowheader-porpertygird"),
                                            i.removeClass("columnheader-porpertygird"),
                                            t.removeClass("columnheader-property-grid-container");
                                        break;
                                    case "col":
                                        o.addClass("columnheader-sheet"),
                                            o.removeClass("rowheader-sheet"),
                                            i.addClass("columnheader-porpertygird"),
                                            i.removeClass("rowheader-porpertygird"),
                                            t.addClass("columnheader-property-grid-container")
                                }
                            }
                            ,
                            a.prototype.ks = function(e) {
                                var t, i, r, a = new o.Style;
                                switch (e) {
                                    case "bottom":
                                        t = $(".borderBottom-borderspan").val();
                                        break;
                                    case "top":
                                        t = $(".borderTop-borderspan").val();
                                        break;
                                    case "left":
                                        t = $(".borderLeft-borderspan").val();
                                        break;
                                    case "right":
                                        t = $(".borderRight-borderspan").val();
                                        break;
                                    case "diagonalUp":
                                        t = $(".diagonalUp-borderspan").val();
                                        break;
                                    case "diagonalDown":
                                        t = $(".diagonalDown-borderspan").val()
                                }
                                switch (t && (i = t.split(";")[0],
                                    r = t.split(";")[1]),
                                    e) {
                                    case "bottom":
                                        a.borderBottom = new o.LineBorder(i,o.LineStyle[r]);
                                        break;
                                    case "top":
                                        a.borderTop = new o.LineBorder(i,o.LineStyle[r]);
                                        break;
                                    case "left":
                                        a.borderLeft = new o.LineBorder(i,o.LineStyle[r]);
                                        break;
                                    case "right":
                                        a.borderRight = new o.LineBorder(i,o.LineStyle[r]);
                                        break;
                                    case "diagonalUp":
                                        a.diagonalUp = new o.LineBorder(i,o.LineStyle[r]);
                                        break;
                                    case "diagonalDown":
                                        a.diagonalDown = new o.LineBorder(i,o.LineStyle[r])
                                }
                                n.actions.doAction("setStyle", this.bs, a)
                            }
                            ,
                            a.prototype.as = function(e, t) {
                                var r, a, d, p, u = this, h = $(".backColor-colorpicker"), f = $(".foreColor-colorpicker"), g = this.xo.find(".borderBottom-borderspan"), m = $(".borderBottom-borderpicker"), b = this.xo.find(".borderLeft-borderspan"), v = $(".borderLeft-borderpicker"), y = this.xo.find(".borderRight-borderspan"), x = $(".borderRight-borderpicker"), w = this.xo.find(".borderTop-borderspan"), C = $(".borderTop-borderpicker"), S = this.xo.find(".diagonalUp-borderspan"), k = $(".diagonalUp-borderpicker"), T = this.xo.find(".diagonalDown-borderspan"), A = $(".diagonalDown-borderpicker"), I = this.xo.find(".font"), D = this.xo.find(".formatter"), F = this.xo.find(".hAlign"), L = this.xo.find(".locked"), R = this.xo.find(".shrinkToFit"), B = this.xo.find(".verticalText"), N = this.xo.find(".textIndent"), E = this.xo.find(".vAlign"), V = this.xo.find(".wordWrap"), P = this.xo.find(".height"), z = this.xo.find(".value"), j = this.xo.find(".visible"), M = this.xo.find(".width"), O = this.xo.find(".resizable"), G = this;
                                h.colorpicker({
                                    valueChanged: function(e, t) {
                                        if (void 0 === t.color)
                                            G.xo.find(".backColor-colorspan").css("background-color", ""),
                                                n.actions.doAction("setBackColor", G.bs, void 0);
                                        else {
                                            G.xo.find(".backColor-colorspan").css("background-color", t.color);
                                            var i = new o.Style;
                                            i.backColor = t.color,
                                                n.actions.doAction("setStyle", G.bs, i)
                                        }
                                    },
                                    choosedColor: function(e, t) {
                                        G.xo.find(".backColor-colorframe").comboframe("close")
                                    },
                                    openColorDialog: function(e, t) {
                                        G.xo.find(".backColor-colorframe").comboframe("close")
                                    }
                                }),
                                    f.colorpicker({
                                        valueChanged: function(e, t) {
                                            if (void 0 === t.color)
                                                G.xo.find(".foreColor-colorspan").css("background-color", ""),
                                                    n.actions.doAction("setForeColor", G.bs, void 0);
                                            else {
                                                G.xo.find(".foreColor-colorspan").css("background-color", t.color);
                                                var i = new o.Style;
                                                i.foreColor = t.color,
                                                    n.actions.doAction("setStyle", G.bs, i)
                                            }
                                        },
                                        choosedColor: function(e, t) {
                                            G.xo.find(".foreColor-colorframe").comboframe("close")
                                        },
                                        openColorDialog: function(e, t) {
                                            G.xo.find(".foreColor-colorframe").comboframe("close")
                                        }
                                    }),
                                    m.borderpicker({
                                        colorChanged: function(e, t) {
                                            g.val(t.color + ";" + s[m.borderpicker("option", "lineStyle")]),
                                                G.ks("bottom")
                                        },
                                        lineStyleChanged: function(e, t) {
                                            g.val(m.borderpicker("option", "borderColor").color + ";" + s[t]),
                                                G.ks("bottom")
                                        }
                                    }),
                                    v.borderpicker({
                                        colorChanged: function(e, t) {
                                            b.val(t.color + ";" + s[v.borderpicker("option", "lineStyle")]),
                                                G.ks("left")
                                        },
                                        lineStyleChanged: function(e, t) {
                                            b.val(v.borderpicker("option", "borderColor").color + ";" + s[t]),
                                                G.ks("left")
                                        }
                                    }),
                                    x.borderpicker({
                                        colorChanged: function(e, t) {
                                            y.val(t.color + ";" + s[x.borderpicker("option", "lineStyle")]),
                                                G.ks("right")
                                        },
                                        lineStyleChanged: function(e, t) {
                                            y.val(x.borderpicker("option", "borderColor").color + ";" + s[t]),
                                                G.ks("right")
                                        }
                                    }),
                                    C.borderpicker({
                                        colorChanged: function(e, t) {
                                            w.val(t.color + ";" + s[C.borderpicker("option", "lineStyle")]),
                                                G.ks("top")
                                        },
                                        lineStyleChanged: function(e, t) {
                                            w.val(C.borderpicker("option", "borderColor").color + ";" + s[t]),
                                                G.ks("top")
                                        }
                                    }),
                                    k.borderpicker({
                                        colorChanged: function(e, t) {
                                            S.val(t.color + ";" + s[k.borderpicker("option", "lineStyle")]),
                                                G.ks("diagonalUp")
                                        },
                                        lineStyleChanged: function(e, t) {
                                            S.val(k.borderpicker("option", "borderColor").color + ";" + s[t]),
                                                G.ks("diagonalUp")
                                        }
                                    }),
                                    A.borderpicker({
                                        colorChanged: function(e, t) {
                                            T.val(t.color + ";" + s[A.borderpicker("option", "lineStyle")]),
                                                G.ks("diagonalDown")
                                        },
                                        lineStyleChanged: function(e, t) {
                                            T.val(A.borderpicker("option", "borderColor").color + ";" + s[t]),
                                                G.ks("diagonalDown")
                                        }
                                    }),
                                    D.change(function() {
                                        n.actions.doAction("setFormatter", u.bs, D.val())
                                    }),
                                    P.change(function() {
                                        P.removeClass("ui-state-error"),
                                            u.Yr = !1,
                                            $.isNumeric(P.val()) && parseInt(P.val()) >= 0 && parseInt(P.val()) === parseFloat(P.val()) ? n.actions.doAction("setRowsHeight", u.bs, parseInt(P.val())) : (P.addClass("ui-state-error"),
                                                u.Yr = !0)
                                    }),
                                    O.change(function() {
                                        var e = n.spreadActions.getSelectionType(u.bs);
                                        switch (e) {
                                            case 2:
                                                n.spreadActions.DesignerActionBase.prototype.execInSelectionsForCol(G.bs.sheets[0], function(e, t) {
                                                    G.bs.sheets[0].setColumnResizable(t, O.prop("checked"), 1)
                                                });
                                                break;
                                            case 1:
                                                n.spreadActions.DesignerActionBase.prototype.execInSelectionsForRow(G.bs.sheets[0], function(e, t) {
                                                    G.bs.sheets[0].setRowResizable(t, O.prop("checked"), 2)
                                                })
                                        }
                                    }),
                                    z.change(function(e) {
                                        var t = z.val()
                                            , i = G.bs.sheets[0];
                                        G.bs.suspendPaint();
                                        try {
                                            n.spreadActions.DesignerActionBase.prototype.execInSelections(i, "", function(e, i, o) {
                                                e.getCell(i, o).text(t)
                                            })
                                        } catch (e) {
                                            G.bs.resumePaint()
                                        }
                                        G.bs.resumePaint()
                                    }),
                                    j.change(function() {
                                        var e, t = n.spreadActions.getSelectionType(u.bs);
                                        switch (t) {
                                            case 2:
                                                e = !0 === j.prop("checked") ? "unHideColumns" : "hideColumns";
                                                break;
                                            case 1:
                                                e = !0 === j.prop("checked") ? "unHideRows" : "hideRows"
                                        }
                                        n.actions.doAction(e, u.bs, j.val())
                                    }),
                                    M.change(function() {
                                        M.removeClass("ui-state-error"),
                                            u.Yr = !1,
                                            $.isNumeric(M.val()) && parseInt(M.val()) >= 0 && parseInt(M.val()) === parseFloat(M.val()) ? n.actions.doAction("setColumnsWidth", u.bs, parseInt(M.val())) : (M.addClass("ui-state-error"),
                                                u.Yr = !0)
                                    }),
                                    r = function(e) {
                                        var t = e.target || e.srcElement
                                            , r = new o.Style;
                                        switch (t.id) {
                                            case "hAlign":
                                                r.hAlign = parseInt(o.HorizontalAlign[F.val()]);
                                                break;
                                            case "locked":
                                                r.locked = L.prop("checked");
                                                break;
                                            case "shrinkToFit":
                                                r.shrinkToFit = R.prop("checked");
                                                break;
                                            case "verticalText":
                                                r.isVerticalText = B.prop("checked");
                                                break;
                                            case "textIndent":
                                                N.removeClass("ui-state-error"),
                                                    u.Yr = !1,
                                                    $.isNumeric(N.val()) && parseInt(N.val()) >= 0 && parseInt(N.val()) === parseFloat(N.val()) ? r.textIndent = parseInt(N.val()) : "" === N.val() ? r.textIndent = i : (N.addClass("ui-state-error"),
                                                        u.Yr = !0);
                                                break;
                                            case "vAlign":
                                                r.vAlign = parseInt(o.VerticalAlign[E.val()]);
                                                break;
                                            case "wordWrap":
                                                r.wordWrap = V.prop("checked");
                                                break;
                                            case "font":
                                                r.font = I.val()
                                        }
                                        n.actions.doAction("setStyle", u.bs, r)
                                    }
                                    ,
                                    F.change(r),
                                    L.change(r),
                                    R.change(r),
                                    B.change(r),
                                    N.change(r),
                                    E.change(r),
                                    V.change(r),
                                    I.change(r),
                                    a = function(e, t) {
                                        var i = n.spreadActions.getSelectionType(u.bs);
                                        switch (i) {
                                            case 2:
                                                u.xo.find(".resizable-row").removeClass("hidden"),
                                                    u.xo.find(".visible-row").removeClass("hidden"),
                                                    u.xo.find(".width-row").removeClass("hidden"),
                                                    u.xo.find(".resizable-row").addClass("visible"),
                                                    u.xo.find(".visible-row").addClass("visible"),
                                                    u.xo.find(".width-row").addClass("visible"),
                                                    u.xo.find(".height-row").removeClass("visible"),
                                                    u.xo.find(".value-row").removeClass("visible"),
                                                    u.xo.find(".height-row").addClass("hidden"),
                                                    u.xo.find(".value-row").addClass("hidden"),
                                                    u.gs("col");
                                                break;
                                            case 1:
                                                u.xo.find(".resizable-row").removeClass("hidden"),
                                                    u.xo.find(".visible-row").removeClass("hidden"),
                                                    u.xo.find(".width-row").removeClass("visible"),
                                                    u.xo.find(".resizable-row").addClass("visible"),
                                                    u.xo.find(".visible-row").addClass("visible"),
                                                    u.xo.find(".width-row").addClass("hidden"),
                                                    u.xo.find(".height-row").removeClass("hidden"),
                                                    u.xo.find(".value-row").removeClass("visible"),
                                                    u.xo.find(".height-row").addClass("visible"),
                                                    u.xo.find(".value-row").addClass("hidden"),
                                                    u.gs("row");
                                                break;
                                            case 3:
                                                u.xo.find(".resizable-row").removeClass("visible"),
                                                    u.xo.find(".visible-row").removeClass("visible"),
                                                    u.xo.find(".width-row").removeClass("visible"),
                                                    u.xo.find(".resizable-row").addClass("hidden"),
                                                    u.xo.find(".visible-row").addClass("hidden"),
                                                    u.xo.find(".width-row").addClass("hidden"),
                                                    u.xo.find(".height-row").removeClass("visible"),
                                                    u.xo.find(".value-row").removeClass("hidden"),
                                                    u.xo.find(".height-row").addClass("hidden"),
                                                    u.xo.find(".value-row").addClass("visible"),
                                                    u.gs("cell");
                                                break;
                                            default:
                                                u.xo.find(".resizable-row").removeClass("visible"),
                                                    u.xo.find(".visible-row").removeClass("visible"),
                                                    u.xo.find(".width-row").removeClass("visible"),
                                                    u.xo.find(".resizable-row").addClass("hidden"),
                                                    u.xo.find(".visible-row").addClass("hidden"),
                                                    u.xo.find(".width-row").addClass("hidden"),
                                                    u.xo.find(".height-row").removeClass("visible"),
                                                    u.xo.find(".value-row").removeClass("visible"),
                                                    u.xo.find(".height-row").addClass("hidden"),
                                                    u.xo.find(".value-row").addClass("hidden"),
                                                    u.gs("sheet")
                                        }
                                        P.removeClass("ui-state-error"),
                                            M.removeClass("ui-state-error"),
                                            N.removeClass("ui-state-error"),
                                            u.Yr = !1
                                    }
                                    ,
                                    e.sheets[0].bind(o.Events.SelectionChanged, a),
                                    t.sheets[0].bind(o.Events.SelectionChanged, a),
                                    d = function(i, o) {
                                        return "columnHeaderTab" === o.newPanel[0].id ? (u.bs = t,
                                            u.Xr = 1,
                                            u.ds("col"),
                                            a(),
                                            void setTimeout(function() {
                                                t.refresh()
                                            }, 0)) : "rowHeaderTab" === o.newPanel[0].id ? (u.bs = e,
                                            u.Xr = 2,
                                            u.ds("row"),
                                            a(),
                                            void setTimeout(function() {
                                                e.refresh()
                                            }, 0)) : void 0
                                    }
                                    ,
                                    this.Zr.on("tabsactivate", d),
                                    this.xo.find(".property-grid").click(function(e) {
                                        $(u.xo.find(".property-grid").children()[0].children).removeClass("ui-state-focus");
                                        var t = e.target || e.srcElement;
                                        $(t).parents("tr").addClass("ui-state-focus")
                                    }),
                                void 0 === this.ls && (p = new l,
                                    this.xo.find(".font-popup").click(function() {
                                        p.open(I.val())
                                    }),
                                    $(p).on("dialogClose", function(e, t) {
                                        I.val(t),
                                            I.trigger("change")
                                    })),
                                    $(document).mousedown(function(e) {
                                        var t, i = e.target || e.srcElement, o = $(".gcui-borderpicker-color-picker"), n = !1;
                                        for (t = 0; t < o.length; t++)
                                            if (o[t].contains(i)) {
                                                n = !0;
                                                break
                                            }
                                        n || ($(".borderBottom-borderpicker")[0].contains(i) || u.xo.find(".borderBottom-borderframe").comboframe("close"),
                                        $(".borderLeft-borderpicker")[0].contains(i) || u.xo.find(".borderLeft-borderframe").comboframe("close"),
                                        $(".borderRight-borderpicker")[0].contains(i) || u.xo.find(".borderRight-borderframe").comboframe("close"),
                                        $(".borderTop-borderpicker")[0].contains(i) || u.xo.find(".borderTop-borderframe").comboframe("close"),
                                        $(".diagonalUp-borderpicker")[0].contains(i) || u.xo.find(".diagonalUp-borderframe").comboframe("close"),
                                        $(".diagonalDown-borderpicker")[0].contains(i) || u.xo.find(".diagonalDown-borderframe").comboframe("close"),
                                            $(".gcui-borderpicker-color").comboframe("close"))
                                    }),
                                    n.wrapper.spread.bind(o.Events.ActiveSheetChanged, function() {
                                        var i = u.xo.find("#rowHeaderTab")
                                            , n = u.xo.find("#columnHeaderTab");
                                        e.destroy(),
                                            i.empty(),
                                            t.destroy(),
                                            n.empty(),
                                            u.$r = e = new o.Workbook(i[0],{
                                                sheetCount: 1
                                            }),
                                            u._r = t = new o.Workbook(n[0],{
                                                sheetCount: 1
                                            }),
                                            c(e),
                                            c(t),
                                            e.sheets[0].bind(o.Events.SelectionChanged, a),
                                            t.sheets[0].bind(o.Events.SelectionChanged, a)
                                    })
                            }
                            ,
                            a
                    }(n.BaseDialog),
                    n.HeaderCellsDialog = M,
                    O = function() {
                        function e() {}
                        return e.ms = function(e, t) {
                            var i, r, a, s, l, c, d = new o.Style;
                            switch (e) {
                                case 0:
                                    d.backColor = "#FFB6C1",
                                        d.foreColor = "#8B0000";
                                    break;
                                case 1:
                                    d.backColor = "#F0E68C",
                                        d.foreColor = "#BDB76B";
                                    break;
                                case 2:
                                    d.backColor = "#90EE90",
                                        d.foreColor = "#006400";
                                    break;
                                case 3:
                                    d.backColor = "#FFB6C1";
                                    break;
                                case 4:
                                    d.foreColor = "#8B0000";
                                    break;
                                case 5:
                                    d.borderBottom = new o.LineBorder("#8B0000",1),
                                        d.borderLeft = new o.LineBorder("#8B0000",1),
                                        d.borderTop = new o.LineBorder("#8B0000",1),
                                        d.borderRight = new o.LineBorder("#8B0000",1);
                                    break;
                                case 6:
                                    d = t,
                                    "" !== t.font && void 0 !== t.font && (i = n.wrapper.spread.getActiveSheet(),
                                        r = i.getActiveColumnIndex(),
                                        a = i.getActiveRowIndex(),
                                        s = i.getActualStyle(a, r, 3),
                                        l = $("<span></span>"),
                                        void 0 !== s.font ? ("" !== t.font && (l.css("font", t.font),
                                            c = l.css("font-style")),
                                            l.css("font", s.font),
                                        c && l.css("font-style", c)) : "" !== t.font && l.css("font", t.font + n.res.defaultFont),
                                        d.font = l.css("font"))
                            }
                            return d
                        }
                            ,
                            e.ns = function(e, t, i, o) {
                                void 0 === o ? (e.css("background-image", "linear-gradient(to right, " + t + ", " + i + ")"),
                                    e.css("background-image", "-o-linear-gradient(to right, " + t + ", " + i + ")"),
                                    e.css("background-image", "-moz-linear-gradient(to right, " + t + ", " + i + ")"),
                                    e.css("background-image", "-webkit-linear-gradient(to right, " + t + ", " + i + ")"),
                                    e.css("background-image", "-ms-linear-gradient(to right, " + t + ", " + i + ")"),
                                    e.css("background-image", "-webkit-gradient(linear, left top, right top, color-stop(0, " + t + "),  color-stop(1, " + i + "))")) : (e.css("background-image", "linear-gradient(to right, " + t + ", " + i + ", " + o + ")"),
                                    e.css("background-image", "-o-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"),
                                    e.css("background-image", "-moz-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"),
                                    e.css("background-image", "-webkit-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"),
                                    e.css("background-image", "-ms-linear-gradient(to right, " + t + ", " + i + ", " + o + ")"),
                                    e.css("background-image", "-webkit-gradient(linear, left top, right top, from(" + t + "), to(" + o + "),  color-stop(50%, " + i + "))"))
                            }
                            ,
                            e.os = function(t, i) {
                                var o, r, a, s;
                                void 0 === i || null === i ? (t.text(n.res.conditionalFormatting.newFormattingRule.preview.noFormat),
                                    t.css("background-color", ""),
                                    t.css("color", "black"),
                                    t.css("font-style", "normal"),
                                    t.css("text-decoration", "none")) : (t.text(n.res.conditionalFormatting.newFormattingRule.preview.hasFormat),
                                    o = e.ps(i.backColor),
                                void 0 === o && (o = i.backColor),
                                null === o && (o = ""),
                                    t.css("background-color", o),
                                    r = e.ps(i.foreColor),
                                void 0 === r && (r = i.foreColor),
                                    t.css("color", r),
                                void 0 !== i.font && "" !== i.font && (a = n.util.parseFont(i.font),
                                    t.css("font-style", a.fontStyle)),
                                i.textDecoration && (s = n.util.toCSSTextDecoration(i.textDecoration),
                                    t.css("text-decoration", s)))
                            }
                            ,
                            e.ps = function(e) {
                                var t = n.wrapper.spread.getActiveSheet().currentTheme().colors();
                                return t.getColor(e)
                            }
                            ,
                            e.qs = function(e) {
                                var t, i, o, r, a, s, l = e, c = n.wrapper.spread.getActiveSheet(), d = l.style(), p = GC.Spread.Sheets.CalcEngine.formulaToExpression(c, l.formula());
                                return p.type === GC.Spread.CalcEngine.ExpressionType.function && (o = p,
                                    r = o.functionName,
                                    "ISBLANK" === r ? (t = 1,
                                        i = 3) : "ISERROR" === r ? (t = 1,
                                        i = 5) : "NOT" === r && 1 === o.args.length && (a = o.args[0],
                                        s = a.getFunctionName(),
                                        "ISBLANK" === s ? (t = 1,
                                            i = 4) : "ISERROR" === s && (t = 1,
                                            i = 6))),
                                void 0 === t && (t = 5),
                                    {
                                        ruleType: t,
                                        selectorIndex: i,
                                        style: d,
                                        formula: l.formula()
                                    }
                            }
                            ,
                            e.parseValue = function(e) {
                                return !isNaN(e) && isFinite(e) ? parseFloat(e) : e
                            }
                            ,
                            e.rs = function(t, i, o, n) {
                                switch (i) {
                                    case 15:
                                        e.ss(t, ["up-arrow-green", "right-up-arrow-yellow", "right-arrow-yellow", "right-down-arrow-yellow", "down-arrow-red"], o, n);
                                        break;
                                    case 16:
                                        e.ss(t, ["up-arrow-gray", "right-up-arrow-gray", "right-arrow-gray", "right-down-arrow-gray", "down-arrow-gray"], o, n);
                                        break;
                                    case 19:
                                        e.ss(t, ["box-4", "box-3", "box-2", "box-1", "box-0"], o, n);
                                        break;
                                    case 18:
                                        e.ss(t, ["quarters-4", "quarters-3", "quarters-2", "quarters-1", "quarters-0"], o, n);
                                        break;
                                    case 17:
                                        e.ss(t, ["rating-4", "rating-3", "rating-2", "rating-1", "rating-0"], o, n);
                                        break;
                                    case 10:
                                        e.ss(t, ["up-arrow-green", "right-up-arrow-yellow", "right-down-arrow-yellow", "down-arrow-red"], o, n);
                                        break;
                                    case 11:
                                        e.ss(t, ["up-arrow-gray", "right-up-arrow-gray", "right-down-arrow-gray", "down-arrow-gray"], o, n);
                                        break;
                                    case 13:
                                        e.ss(t, ["rating-3", "rating-2", "rating-1", "rating-0"], o, n);
                                        break;
                                    case 12:
                                        e.ss(t, ["ball-red", "ball-pink", "ball-gray", "ball-black"], o, n);
                                        break;
                                    case 14:
                                        e.ss(t, ["traffic-light-green", "traffic-light-yellow", "traffic-light-red", "traffic-light-black"], o, n);
                                        break;
                                    case 0:
                                        e.ss(t, ["up-arrow-green", "right-arrow-yellow", "down-arrow-red"], o, n);
                                        break;
                                    case 1:
                                        e.ss(t, ["up-arrow-gray", "right-arrow-gray", "down-arrow-gray"], o, n);
                                        break;
                                    case 4:
                                        e.ss(t, ["flag-green", "flag-yellow", "flag-red"], o, n);
                                        break;
                                    case 7:
                                        e.ss(t, ["traffic-light-green", "up-triangle-yellow", "down-rhombus-red"], o, n);
                                        break;
                                    case 3:
                                        e.ss(t, ["star-solid", "star-half", "star-hollow"], o, n);
                                        break;
                                    case 8:
                                        e.ss(t, ["check-circled-green", "notice-circled-yellow", "close-circled-red"], o, n);
                                        break;
                                    case 9:
                                        e.ss(t, ["check-uncircled-green", "notice-uncircled-yellow", "close-uncircled-red"], o, n);
                                        break;
                                    case 6:
                                        e.ss(t, ["traffic-light-rimmed-green", "traffic-light-rimmed-yellow", "traffic-light-rimmed-red"], o, n);
                                        break;
                                    case 5:
                                        e.ss(t, ["traffic-light-green", "traffic-light-yellow", "traffic-light-red"], o, n);
                                        break;
                                    case 2:
                                        e.ss(t, ["up-triangle-green", "minus-yellow", "down-triangle-red"], o, n)
                                }
                            }
                            ,
                            e.ts = function(t, i, o) {
                                var n, r = [];
                                for (n = i.length - 1; n >= 0; n--)
                                    r.push(e.us(i[n]));
                                e.ss(t, r, o)
                            }
                            ,
                            e.ss = function(e, t, i, o) {
                                var n, r;
                                for (o && t.reverse(),
                                         n = 0; n < t.length; n++)
                                    r = $("<span>").addClass("iconSetsIcons").addClass("" + t[n]),
                                    i && r.css(i),
                                        e.append(r)
                            }
                            ,
                            e.us = function(e) {
                                var t = [["down-arrow-red", "right-arrow-yellow", "up-arrow-green"], ["down-arrow-gray", "right-arrow-gray", "up-arrow-gray"], ["down-triangle-red", "minus-yellow", "up-triangle-green"], ["star-hollow", "star-half", "star-solid"], ["flag-red", "flag-yellow", "flag-green"], ["traffic-light-red", "traffic-light-yellow", "traffic-light-green"], ["traffic-light-rimmed-red", "traffic-light-rimmed-yellow", "traffic-light-rimmed-green"], ["down-rhombus-red", "up-triangle-yellow", "traffic-light-green"], ["close-circled-red", "notice-circled-yellow", "check-circled-green"], ["close-uncircled-red", "notice-uncircled-yellow", "check-uncircled-green"], ["down-arrow-red", "right-down-arrow-yellow", "right-up-arrow-yellow", "up-arrow-green"], ["down-arrow-gray", "right-down-arrow-gray", "right-up-arrow-gray", "up-arrow-gray"], ["ball-black", "ball-gray", "ball-pink", "ball-red"], ["rating-0", "rating-1", "rating-2", "rating-3"], ["traffic-light-black", "traffic-light-red", "traffic-light-yellow", "traffic-light-green"], ["down-arrow-red", "right-down-arrow-yellow", "right-arrow-yellow", "right-up-arrow-yellow", "up-arrow-green"], ["down-arrow-gray", "right-down-arrow-gray", "right-arrow-gray", "right-up-arrow-gray", "up-arrow-gray"], ["rating-0", "rating-1", "rating-2", "rating-3", "rating-4"], ["quarters-0", "quarters-1", "quarters-2", "quarters-3", "quarters-4"], ["box-0", "box-1", "box-2", "box-3", "box-4"], ["no-cell-icon"]];
                                return t[e.iconSetType][e.iconIndex]
                            }
                            ,
                            e
                    }(),
                    n.RuleFormatHelper = O,
                    function(e) {
                        e[e.greaterThan = 0] = "greaterThan",
                            e[e.lessThan = 1] = "lessThan",
                            e[e.between = 2] = "between",
                            e[e.equalTo = 3] = "equalTo",
                            e[e.top = 4] = "top",
                            e[e.bottom = 5] = "bottom",
                            e[e.above = 6] = "above",
                            e[e.below = 7] = "below",
                            n.OpenType = e
                    }(n.OpenType || {}),
                    G = function(e) {
                        n.extends(o, e);
                        function o() {
                            e.call(this, r, ".cellValueRuleFormat-dialog")
                        }
                        return o.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xq();
                                        t && (e.vs(),
                                            e.close(),
                                            n.wrapper.setFocusToSpread())
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            o.prototype._init = function() {
                                var e = this;
                                void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog),
                                    this.xo.find(".withStyle").change(function(t) {
                                        var i = t.target || t.srcElement
                                            , o = i;
                                        o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = {
                                            numbers: !0,
                                            font: !0,
                                            border: !0,
                                            fill: !0
                                        },
                                            e.formatCellDialog.setFormatDirectly(!1),
                                            e.formatCellDialog.open("font", {
                                                family: "disabled",
                                                size: "disabled",
                                                weight: "disabled"
                                            }, e.ws, !0))
                                    }),
                                    $(this.formatCellDialog).on("okClicked", function(t, i) {
                                        e.ws = i
                                    }),
                                    e.xs()
                            }
                            ,
                            o.prototype.xs = function() {
                                var e = this;
                                e.xo.find(".rangeSelectButton").click(function() {
                                    if (e.ys || (e.ys = new n.RangeSelectDialog(e,{
                                            absoluteReference: !0,
                                            needSheetName: !1
                                        })),
                                        "disabled" !== $(this).attr("disabled")) {
                                        var t = e.xo.dialog("option", "title"), i = e.zs, o;
                                        switch (e.hide(),
                                            $(this).data("name")) {
                                            case "textBox-cell1":
                                                o = e.xo.find(".textBox-cell1").val(),
                                                    e.ys.open(t, i, o, [".textBox-cell1"]);
                                                break;
                                            case "textBox-cell2":
                                                o = e.xo.find(".textBox-cell2").val(),
                                                    e.ys.open(t, i, o, [".textBox-cell2"]);
                                                break;
                                            default:
                                                e.show()
                                        }
                                    }
                                })
                            }
                            ,
                            o.prototype.zs = function(e, t) {
                                this.xo.find(e).val(t),
                                    this.xo.find(e).change()
                            }
                            ,
                            o.prototype.Bo = function(e) {
                                var t, o, r = e[0];
                                switch (this.ws = i,
                                    this.As = r,
                                    r) {
                                    case 2:
                                        t = n.res.conditionalFormatting.between.title,
                                            o = n.res.conditionalFormatting.between.description,
                                            this.Bs(!0);
                                        break;
                                    case 3:
                                        t = n.res.conditionalFormatting.equalTo.title,
                                            o = n.res.conditionalFormatting.equalTo.description,
                                            this.Bs(!1);
                                        break;
                                    case 0:
                                        t = n.res.conditionalFormatting.greaterThan.title,
                                            o = n.res.conditionalFormatting.greaterThan.description,
                                            this.Bs(!1);
                                        break;
                                    case 1:
                                        t = n.res.conditionalFormatting.lessThan.title,
                                            o = n.res.conditionalFormatting.lessThan.description,
                                            this.Bs(!1)
                                }
                                this.xo.dialog("option", "title", t),
                                    this.xo.find(".description").text(o),
                                    this.Cs(),
                                    $(this.xo.find(".withStyle").children()[0]).prop("selected", !0)
                            }
                            ,
                            o.prototype.Bs = function(e) {
                                var t = this.xo.find(".label-and")
                                    , i = this.xo.find(".textBox-cell2-container");
                                e ? (t.removeClass("hidden"),
                                    i.show()) : (t.addClass("hidden"),
                                    i.hide())
                            }
                            ,
                            o.prototype.ms = function() {
                                var e = parseInt(this.xo.find(".withStyle").prop("selectedIndex"));
                                return O.ms(e, this.ws)
                            }
                            ,
                            o.prototype.vs = function() {
                                var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getSelections(), r = this.Oo(this.xo, 1), a = this.Oo(this.xo, 2), s = this.ms();
                                switch (this.As) {
                                    case 2:
                                        t = 6;
                                        break;
                                    case 3:
                                        t = 0;
                                        break;
                                    case 0:
                                        t = 2;
                                        break;
                                    case 1:
                                        t = 4
                                }
                                e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(1,o,s,t,r,a),
                                    n.actions.doAction("addRule", n.wrapper.spread, e)
                            }
                            ,
                            o.prototype.Cs = function() {
                                var e, t, i, o, r = n.wrapper.spread.getActiveSheet(), a = r.getSelections(), s = this.xo.find(".textBox-cell1"), l = this.xo.find(".textBox-cell2"), c = n.util.createStatisticalExpression("AVERAGE", a), d = GC.Spread.Sheets.CalcEngine.evaluateExpression(r, c, 0, 0);
                                d instanceof GC.Spread.CalcEngine.CalcError && (d = 0),
                                    2 === this.As ? (e = n.util.createStatisticalExpression("MIN", a),
                                        t = GC.Spread.Sheets.CalcEngine.evaluateExpression(r, e, 0, 0),
                                        i = d - t,
                                        o = d + t,
                                        s.val(i),
                                        l.val(o)) : s.val(d)
                            }
                            ,
                            o.prototype.xq = function() {
                                var e = this.xo.find(".textBox-cell1").val()
                                    , i = this.xo.find(".textBox-cell2").val()
                                    , o = !0;
                                switch (this.As) {
                                    case 2:
                                        "" !== e && "" !== i || (t.show(n.res.conditionalFormatting.exceptions.e1, n.res.title, 2),
                                            o = !1);
                                        break;
                                    case 3:
                                    case 0:
                                    case 1:
                                        "" === e && (t.show(n.res.conditionalFormatting.exceptions.e1, n.res.title, 2),
                                            o = !1)
                                }
                                return o
                            }
                            ,
                            o
                    }(n.BaseDialog),
                    n.CellValueRuleFormatDialog = G,
                    H = function(e) {
                        n.extends(o, e);
                        function o() {
                            e.call(this, r, ".textRuleFormat-dialog")
                        }
                        return o.prototype.wo = function() {
                            var e = this;
                            return {
                                title: n.res.conditionalFormatting.textThatCotains.title,
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xq();
                                        t && (e.vs(),
                                            e.close(),
                                            n.wrapper.setFocusToSpread())
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            o.prototype._init = function() {
                                var e = this;
                                void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog),
                                    this.xo.find(".withStyle").change(function(t) {
                                        var i = t.target || t.srcElement
                                            , o = i;
                                        o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = {
                                            numbers: !0,
                                            font: !0,
                                            border: !0,
                                            fill: !0
                                        },
                                            e.formatCellDialog.setFormatDirectly(!1),
                                            e.formatCellDialog.open("font", {
                                                family: "disabled",
                                                size: "disabled",
                                                weight: "disabled"
                                            }, e.ws, !0))
                                    }),
                                    $(this.formatCellDialog).on("okClicked", function(t, i) {
                                        e.ws = i
                                    }),
                                    e.xs()
                            }
                            ,
                            o.prototype.xs = function() {
                                var e = this;
                                e.xo.find(".rangeSelectButton").click(function() {
                                    if (e.ys || (e.ys = new n.RangeSelectDialog(e,{
                                            absoluteReference: !0,
                                            needSheetName: !1
                                        })),
                                        "disabled" !== $(this).attr("disabled")) {
                                        var t = e.xo.dialog("option", "title"), i = e.zs, o;
                                        e.hide(),
                                            o = e.xo.find(".textBox-cell1").val(),
                                            e.ys.open(t, i, o, [".textBox-cell1"])
                                    }
                                })
                            }
                            ,
                            o.prototype.zs = function(e, t) {
                                this.xo.find(e).val(t),
                                    this.xo.find(e).change()
                            }
                            ,
                            o.prototype.Bo = function() {
                                this.ws = i,
                                    this.Cs(),
                                    $(this.xo.find(".withStyle").children()[0]).prop("selected", !0)
                            }
                            ,
                            o.prototype.ms = function() {
                                var e = parseInt(this.xo.find(".withStyle").prop("selectedIndex"));
                                return O.ms(e, this.ws)
                            }
                            ,
                            o.prototype.vs = function() {
                                var e = n.wrapper.spread.getActiveSheet()
                                    , t = e.getSelections()
                                    , i = this.Oo(this.xo, 1)
                                    , o = this.ms()
                                    , r = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(2,t,o,0,null,null,i);
                                n.actions.doAction("addRule", n.wrapper.spread, r)
                            }
                            ,
                            o.prototype.Cs = function() {
                                var e = n.wrapper.spread.getActiveSheet()
                                    , t = e.getActiveColumnIndex()
                                    , i = e.getActiveRowIndex()
                                    , o = e.getCell(i, t)
                                    , r = this.xo.find(".textBox-cell1");
                                r.val(o.text())
                            }
                            ,
                            o.prototype.xq = function() {
                                var e = this.xo.find(".textBox-cell1").val()
                                    , i = !0;
                                return "" === e && (t.show(n.res.conditionalFormatting.exceptions.e2, n.res.title, 2),
                                    i = !1),
                                    i
                            }
                            ,
                            o
                    }(n.BaseDialog),
                    n.TextRuleFormatDialog = H,
                    U = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".dateOccurringFormat-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                title: n.res.conditionalFormatting.dateOccurringFormat.title,
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.vs(),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog),
                                    this.xo.find(".withStyle").change(function(t) {
                                        var i = t.target || t.srcElement
                                            , o = i;
                                        o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = {
                                            numbers: !0,
                                            font: !0,
                                            border: !0,
                                            fill: !0
                                        },
                                            e.formatCellDialog.setFormatDirectly(!1),
                                            e.formatCellDialog.open("font", {
                                                family: "disabled",
                                                size: "disabled",
                                                weight: "disabled"
                                            }, e.ws, !0))
                                    }),
                                    $(this.formatCellDialog).on("okClicked", function(t, i) {
                                        e.ws = i
                                    })
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.ws = i,
                                    $(this.xo.find(".date").children()[0]).prop("selected", !0),
                                    $(this.xo.find(".withStyle").children()[0]).prop("selected", !0)
                            }
                            ,
                            t.prototype.ms = function() {
                                var e = parseInt(this.xo.find(".withStyle").prop("selectedIndex"));
                                return O.ms(e, this.ws)
                            }
                            ,
                            t.prototype.vs = function() {
                                var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getSelections(), r = this.ms(), a = parseInt(this.xo.find(".date").prop("selectedIndex"));
                                switch (a) {
                                    case 0:
                                        e = 1;
                                        break;
                                    case 1:
                                        e = 0;
                                        break;
                                    case 2:
                                        e = 2;
                                        break;
                                    case 3:
                                        e = 3;
                                        break;
                                    case 4:
                                        e = 8;
                                        break;
                                    case 5:
                                        e = 7;
                                        break;
                                    case 6:
                                        e = 9;
                                        break;
                                    case 7:
                                        e = 5;
                                        break;
                                    case 8:
                                        e = 4;
                                        break;
                                    case 9:
                                        e = 6
                                }
                                t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(4,o,r,null,null,null,null,null,e),
                                    n.actions.doAction("addRule", n.wrapper.spread, t)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.DateOccurringFormatDialog = U,
                    W = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".duplicateValuesFormat-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                title: n.res.conditionalFormatting.duplicateValuesFormat.title,
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.vs(),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog),
                                    this.xo.find(".withStyle").change(function(t) {
                                        var i = t.target || t.srcElement
                                            , o = i;
                                        o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = {
                                            numbers: !0,
                                            font: !0,
                                            border: !0,
                                            fill: !0
                                        },
                                            e.formatCellDialog.setFormatDirectly(!1),
                                            e.formatCellDialog.open("font", {
                                                family: "disabled",
                                                size: "disabled",
                                                weight: "disabled"
                                            }, e.ws, !0))
                                    }),
                                    $(this.formatCellDialog).on("okClicked", function(t, i) {
                                        e.ws = i
                                    })
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.ws = i,
                                    $(this.xo.find(".type").children()[0]).prop("selected", !0),
                                    $(this.xo.find(".withStyle").children()[0]).prop("selected", !0)
                            }
                            ,
                            t.prototype.ms = function() {
                                var e = parseInt(this.xo.find(".withStyle").prop("selectedIndex"));
                                return O.ms(e, this.ws)
                            }
                            ,
                            t.prototype.vs = function() {
                                var e, t = n.wrapper.spread.getActiveSheet(), i = t.getSelections(), o = this.ms(), r = parseInt(this.xo.find(".type").prop("selectedIndex"));
                                switch (r) {
                                    case 0:
                                        e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(7,i,o);
                                        break;
                                    case 1:
                                        e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(6,i,o)
                                }
                                n.actions.doAction("addRule", n.wrapper.spread, e)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.DuplicateValuesFormatDialog = W,
                    _ = function(e) {
                        n.extends(o, e);
                        function o() {
                            e.call(this, r, ".top10RuleFormat-dialog")
                        }
                        return o.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xq();
                                        t && (e.vs(),
                                            e.close(),
                                            n.wrapper.setFocusToSpread())
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            o.prototype._init = function() {
                                var e = this;
                                void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog),
                                    this.xo.find(".withStyle").change(function(t) {
                                        var i = t.target || t.srcElement
                                            , o = i;
                                        o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = {
                                            numbers: !0,
                                            font: !0,
                                            border: !0,
                                            fill: !0
                                        },
                                            e.formatCellDialog.setFormatDirectly(!1),
                                            e.formatCellDialog.open("font", {
                                                family: "disabled",
                                                size: "disabled",
                                                weight: "disabled"
                                            }, e.ws, !0))
                                    }),
                                    $(this.formatCellDialog).on("okClicked", function(t, i) {
                                        e.ws = i
                                    })
                            }
                            ,
                            o.prototype.Bo = function(e) {
                                var t, o, r, a = e[0];
                                switch (this.ws = i,
                                    this.As = a,
                                    a) {
                                    case 4:
                                        t = n.res.conditionalFormatting.top10items.title,
                                            o = n.res.conditionalFormatting.top10items.description;
                                        break;
                                    case 5:
                                        t = n.res.conditionalFormatting.bottom10items.title,
                                            o = n.res.conditionalFormatting.bottom10items.description
                                }
                                this.xo.dialog("option", "title", t),
                                    this.xo.find(".description").text(o),
                                    r = this.xo.find(".itemCounts"),
                                    r.spinner({
                                        min: 1,
                                        max: 1e3
                                    }),
                                    r.val(10),
                                    $(this.xo.find(".withStyle").children()[0]).prop("selected", !0)
                            }
                            ,
                            o.prototype.ms = function() {
                                var e = parseInt(this.xo.find(".withStyle").prop("selectedIndex"));
                                return O.ms(e, this.ws)
                            }
                            ,
                            o.prototype.vs = function() {
                                var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getSelections(), r = this.ms(), a = this.xo.find(".itemCounts").val();
                                switch (this.As) {
                                    case 4:
                                        e = 0;
                                        break;
                                    case 5:
                                        e = 1
                                }
                                t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(5,o,r,null,null,null,null,null,e,a),
                                    n.actions.doAction("addRule", n.wrapper.spread, t)
                            }
                            ,
                            o.prototype.xq = function() {
                                var e = parseInt(this.xo.find(".itemCounts").val())
                                    , i = !0;
                                return (isNaN(e) || e > 1e3 || e < 1) && (t.show(n.res.conditionalFormatting.exceptions.e3, n.res.title, 2),
                                    i = !1),
                                    i
                            }
                            ,
                            o
                    }(n.BaseDialog),
                    n.Top10RuleFormatDialog = _,
                    q = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".averageRuleFormat-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.vs(),
                                            e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog),
                                    this.xo.find(".withStyle").change(function(t) {
                                        var i = t.target || t.srcElement
                                            , o = i;
                                        o.value === n.res.conditionalFormatting.withStyle.customFormat && (e.formatCellDialog.selectTabOptions = {
                                            numbers: !0,
                                            font: !0,
                                            border: !0,
                                            fill: !0
                                        },
                                            e.formatCellDialog.setFormatDirectly(!1),
                                            e.formatCellDialog.open("font", {
                                                family: "disabled",
                                                size: "disabled",
                                                weight: "disabled"
                                            }, e.ws, !0))
                                    }),
                                    $(this.formatCellDialog).on("okClicked", function(t, i) {
                                        e.ws = i
                                    })
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, o, r = e[0];
                                switch (this.ws = i,
                                    this.As = r,
                                    r) {
                                    case 6:
                                        t = n.res.conditionalFormatting.aboveAverage.title,
                                            o = n.res.conditionalFormatting.aboveAverage.description;
                                        break;
                                    case 7:
                                        t = n.res.conditionalFormatting.belowAverage.title,
                                            o = n.res.conditionalFormatting.belowAverage.description
                                }
                                this.xo.dialog("option", "title", t),
                                    this.xo.find(".description").text(o),
                                    $(this.xo.find(".withStyle").children()[0]).prop("selected", !0)
                            }
                            ,
                            t.prototype.ms = function() {
                                var e = parseInt(this.xo.find(".withStyle").prop("selectedIndex"));
                                return O.ms(e, this.ws)
                            }
                            ,
                            t.prototype.vs = function() {
                                var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getSelections(), r = this.ms();
                                switch (this.As) {
                                    case 6:
                                        e = 0;
                                        break;
                                    case 7:
                                        e = 1
                                }
                                t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(8,o,r,null,null,null,null,null,e),
                                    n.actions.doAction("addRule", n.wrapper.spread, t)
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.AverageRuleFormatDialog = q,
                    function(e) {
                        e[e.formatOnValue = 0] = "formatOnValue",
                            e[e.formatContain = 1] = "formatContain",
                            e[e.formatRankedValue = 2] = "formatRankedValue",
                            e[e.formatAbove = 3] = "formatAbove",
                            e[e.formatUnique = 4] = "formatUnique",
                            e[e.useFormula = 5] = "useFormula",
                            n.RuleType = e
                    }(n.RuleType || {}),
                    function(e) {
                        e[e.color2 = 0] = "color2",
                            e[e.color3 = 1] = "color3",
                            e[e.dataBar = 2] = "dataBar",
                            e[e.iconSets = 3] = "iconSets",
                            n.FormatStyle = e
                    }(n.FormatStyle || {}),
                    K = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".negativeValueAndAxisSettings-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                title: n.res.conditionalFormatting.newFormattingRule.formatOnValue.dataBar.negativeDialog.title,
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        e.close(),
                                            e.yq(event, e.Ds()),
                                            e.destroy()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            e.yq(event, null),
                                            e.destroy()
                                    }
                                }],
                                beforeClose: function(t, i) {
                                    t.currentTarget && (e.yq(t, null),
                                        e.destroy())
                                }
                            }
                        }
                            ,
                            t.prototype.destroy = function() {
                                var t = $(".fillcolor-picker")
                                    , i = $(".bordercolor-picker")
                                    , o = $(".axiscolor-picker");
                                t.length > 0 && t.children().length > 0 && t.colorpicker("destroy"),
                                i.length > 0 && i.children().length > 0 && i.colorpicker("destroy"),
                                o.length > 0 && o.children().length > 0 && o.colorpicker("destroy"),
                                    t.remove(),
                                    i.remove(),
                                    o.remove(),
                                    e.prototype.destroy.call(this)
                            }
                            ,
                            t.prototype.yq = function(e, t) {
                                $(this).trigger("dialogClose", t)
                            }
                            ,
                            t.prototype._init = function() {
                                var e = this
                                    , t = this;
                                $(".fillcolor-picker").colorpicker({
                                    valueChanged: function(e, i) {
                                        var o;
                                        o = void 0 === i.color ? "red" : i.color,
                                            t.xo.find(".fillcolor-span").css("background-color", o)
                                    },
                                    choosedColor: function(e, i) {
                                        t.xo.find(".fillcolor-frame").comboframe("close")
                                    },
                                    openColorDialog: function(e, i) {
                                        t.xo.find(".fillcolor-frame").comboframe("close")
                                    }
                                }),
                                    this.xo.find(".fillcolor-frame").comboframe(),
                                    $(".fillcolor-picker").colorpicker("option", "value", "red"),
                                    this.xo.find(".fillcolor-span").css("background-color", "red"),
                                    $(".bordercolor-picker").colorpicker({
                                        valueChanged: function(e, i) {
                                            var o;
                                            o = void 0 === i.color ? "black" : i.color,
                                                t.xo.find(".bordercolor-span").css("background-color", o)
                                        },
                                        choosedColor: function(e, i) {
                                            t.xo.find(".bordercolor-frame").comboframe("close")
                                        },
                                        openColorDialog: function(e, i) {
                                            t.xo.find(".bordercolor-frame").comboframe("close")
                                        }
                                    }),
                                    this.xo.find(".bordercolor-frame").comboframe(),
                                    $(".bordercolor-picker").colorpicker("option", "value", "black"),
                                    this.xo.find(".bordercolor-span").css("background-color", "black"),
                                    $(".axiscolor-picker").colorpicker({
                                        valueChanged: function(e, i) {
                                            var o;
                                            o = void 0 === i.color ? "black" : i.color,
                                                t.xo.find(".axiscolor-span").css("background-color", o)
                                        },
                                        choosedColor: function(e, i) {
                                            t.xo.find(".axiscolor-frame").comboframe("close")
                                        },
                                        openColorDialog: function(e, i) {
                                            t.xo.find(".axiscolor-frame").comboframe("close")
                                        }
                                    }),
                                    this.xo.find(".axiscolor-frame").comboframe(),
                                    $(".axiscolor-picker").colorpicker("option", "value", "black"),
                                    this.xo.find(".axiscolor-span").css("background-color", "black"),
                                    this.xo.find(".default-radio").prop("checked", !0).attr("autofocus", !0),
                                    this.xo.find("input[name = 'axis-positon']").change(function() {
                                        "none" === e.xo.find("input[name = 'axis-positon']:checked").val() ? e.xo.find(".axiscolor-frame button").attr("disabled", "disabled") : e.xo.find(".axiscolor-frame button").removeAttr("disabled")
                                    })
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t = e[0]
                                    , i = e[1]
                                    , o = this.xo.find(".borderColor");
                                0 === t ? o.attr("disabled", "disabled") : o.removeAttr("disabled"),
                                i && this.Es(i)
                            }
                            ,
                            t.prototype.Es = function(e) {
                                this.xo.find(".fillcolor-span").css("background-color", e.negativeFillColor),
                                    this.xo.find(".bordercolor-span").css("background-color", e.negativeBorderColor),
                                    this.xo.find(".axiscolor-span").css("background-color", e.axisColor),
                                    e.useNegativeFillColor ? (this.xo.find(".default-radio").prop("checked", !0),
                                        this.xo.find("#fill-color-editor1").prop("checked", !0)) : this.xo.find("#fill-color-editor2").prop("checked", !0),
                                    e.useNegativeBorderColor ? this.xo.find("#border-color-editor1").prop("checked", !0) : this.xo.find("#border-color-editor2").prop("checked", !0),
                                    0 === e.axisPosition ? this.xo.find("#axis-positon-editor1").prop("checked", !0) : 1 === e.axisPosition ? this.xo.find("#axis-positon-editor2").prop("checked", !0) : this.xo.find("#axis-positon-editor3").prop("checked", !0)
                            }
                            ,
                            t.prototype.Ds = function() {
                                var e, t, i, o, n, r = this.xo.find(".fillcolor-span").css("background-color"), a = this.xo.find(".bordercolor-span").css("background-color"), s = this.xo.find(".axiscolor-span").css("background-color"), l = this.xo.find("input[name = 'fill-color']:checked").val();
                                return t = "fillColor" === l,
                                    o = this.xo.find("input[name = 'border-color']:checked").val(),
                                    e = "borderColor" === o,
                                    n = this.xo.find("input[name = 'axis-positon']:checked").val(),
                                    i = "auto" === n ? 0 : "cell" === n ? 1 : 2,
                                    {
                                        negativeBorderColor: a,
                                        negativeFillColor: r,
                                        useNegativeBorderColor: e,
                                        useNegativeFillColor: t,
                                        axisColor: s,
                                        axisPosition: i
                                    }
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.NegativeValueandAxisDialog = K;
                function ee(e) {
                    var t;
                    switch (e) {
                        case "3-arrows-icon-set":
                            t = 0;
                            break;
                        case "3-arrows-gray-icon-set":
                            t = 1;
                            break;
                        case "3-triangles-icon-set":
                            t = 2;
                            break;
                        case "3-traffic-lights-unrimmed-icon-set":
                            t = 5;
                            break;
                        case "3-traffic-lights-rimmed-icon-set":
                            t = 6;
                            break;
                        case "3-signs-icon-set":
                            t = 7;
                            break;
                        case "3-symbols-circled-icon-set":
                            t = 8;
                            break;
                        case "3-symbols-uncircled-icon-set":
                            t = 9;
                            break;
                        case "3-flags-icon-set":
                            t = 4;
                            break;
                        case "3-stars-icon-set":
                            t = 3;
                            break;
                        case "4-arrows-gray-icon-set":
                            t = 11;
                            break;
                        case "4-arrows-icon-set":
                            t = 10;
                            break;
                        case "4-traffic-lights-icon-set":
                            t = 14;
                            break;
                        case "red-to-black-icon-set":
                            t = 12;
                            break;
                        case "4-ratings-icon-set":
                            t = 13;
                            break;
                        case "5-arrows-gray-icon-set":
                            t = 16;
                            break;
                        case "5-arrows-icon-set":
                            t = 15;
                            break;
                        case "5-quarters-icon-set":
                            t = 18;
                            break;
                        case "5-ratings-icon-set":
                            t = 17;
                            break;
                        case "5-boxes-icon-set":
                            t = 19;
                            break;
                        case "noIcons":
                            t = 20
                    }
                    return t
                }
                function te(e, t) {
                    var i, o = !0, n = !0, r = !0;
                    for (i = 0; i < t.length; i++)
                        if (t[i].iconSetType !== e) {
                            o = !1;
                            break
                        }
                    for (i = 0; i < t.length; i++)
                        if (t[i].iconIndex !== i) {
                            n = !1;
                            break
                        }
                    for (i = 0; i < t.length; i++)
                        if (t[i].iconIndex !== t.length - 1 - i) {
                            r = !1;
                            break
                        }
                    return !o || !n && !r
                }
                Y = function(e) {
                    n.extends(a, e);
                    function a() {
                        e.call(this, r, ".newFormattingRule-dialog")
                    }
                    return a.prototype.wo = function() {
                        var e = this;
                        return {
                            width: "auto",
                            height: "auto",
                            resizable: !1,
                            modal: !0,
                            buttons: [{
                                text: n.res.ok,
                                click: function() {
                                    var t = e.xq();
                                    t && (e.vs(),
                                        n.actions.isFileModified = !0,
                                        e.close(),
                                    e.Fs || n.wrapper.setFocusToSpread(),
                                    e.Gs && e.Hs.ranges(e.Gs),
                                        e.yq(event, {
                                            rule: e.Hs,
                                            isCloseByOK: !0
                                        }),
                                        e.destroy())
                                }
                            }, {
                                text: n.res.cancel,
                                click: function() {
                                    e.close(),
                                    e.Fs || n.wrapper.setFocusToSpread(),
                                    e.Gs && e.Hs.ranges(e.Gs),
                                        e.yq(event, {
                                            rule: e.Hs,
                                            isCloseByOK: !1
                                        }),
                                        e.destroy()
                                }
                            }],
                            beforeClose: function(t, i) {
                                t.currentTarget && (e.Gs && e.Hs.ranges(e.Gs),
                                    e.yq(t, {
                                        rule: e.Hs,
                                        isCloseByOK: !1
                                    }),
                                    e.destroy())
                            }
                        }
                    }
                        ,
                        a.prototype.destroy = function() {
                            var t = $(".min-color-picker")
                                , i = $(".max-color-picker")
                                , o = $(".mid-color-picker")
                                , n = $(".barcolor1-picker")
                                , r = $(".barcolor2-picker");
                            t.length > 0 && t.children().length > 0 && t.colorpicker("destroy"),
                            i.length > 0 && i.children().length > 0 && i.colorpicker("destroy"),
                            o.length > 0 && o.children().length > 0 && o.colorpicker("destroy"),
                            n.length > 0 && n.children().length > 0 && n.colorpicker("destroy"),
                            r.length > 0 && r.children().length > 0 && r.colorpicker("destroy"),
                                t.remove(),
                                i.remove(),
                                o.remove(),
                                n.remove(),
                                r.remove(),
                                $("#icon-sets-popup-dialog").remove(),
                                $(".icons-popup-dialog").remove(),
                                this.Is(!1),
                                e.prototype.destroy.call(this)
                        }
                        ,
                        a.prototype._init = function() {
                            var e = this
                                , t = this.xo.find(".ruleType");
                            t.change(function() {
                                var i = parseInt(t.prop("selectedIndex"));
                                e.Js(i),
                                    e.Ks(i),
                                e.Yf && e.Ls(e.Hs)
                            }),
                                this.Fs = !1,
                                this.as()
                        }
                        ,
                        a.prototype.Bo = function(e) {
                            var t = e[0]
                                , o = e[1]
                                , r = e[2]
                                , a = e[3]
                                , s = e[4]
                                , l = e[5];
                            this.ws = i,
                                this.Ms = i,
                                this.Js(t, r, l),
                                this.Ks(t),
                                o ? this.xo.dialog("option", "title", n.res.conditionalFormatting.newFormattingRule.title) : (this.xo.dialog("option", "title", n.res.conditionalFormatting.newFormattingRule.title2),
                                    this.Ls(s),
                                    this.Yf = !0),
                                this.Fs = a
                        }
                        ,
                        a.prototype.zs = function(e, t) {
                            this.xo.find(e).val(t),
                                this.xo.find(e).change()
                        }
                        ,
                        a.prototype.xs = function() {
                            var e = this;
                            e.xo.find(".rangeSelectButton").click(function() {
                                if (e.ys || (e.ys = new n.RangeSelectDialog(e,{
                                        absoluteReference: !0,
                                        needSheetName: !1
                                    })),
                                    "disabled" !== $(this).attr("disabled")) {
                                    var t = e.xo.dialog("option", "title"), i = e.zs, o;
                                    switch (e.hide(),
                                        $(this).data("name")) {
                                        case "minValue":
                                            o = e.xo.find(".minValue").val(),
                                                e.ys.open(t, i, o, [".minValue"]);
                                            break;
                                        case "midValue":
                                            o = e.xo.find(".midValue").val(),
                                                e.ys.open(t, i, o, [".midValue"]);
                                            break;
                                        case "maxValue":
                                            o = e.xo.find(".maxValue").val(),
                                                e.ys.open(t, i, o, [".maxValue"]);
                                            break;
                                        case "minValue2":
                                            o = e.xo.find(".minValue2").val(),
                                                e.ys.open(t, i, o, [".minValue2"]);
                                            break;
                                        case "maxValue2":
                                            o = e.xo.find(".maxValue2").val(),
                                                e.ys.open(t, i, o, [".maxValue2"]);
                                            break;
                                        case "value1":
                                            o = e.xo.find(".value1").val(),
                                                e.ys.open(t, i, o, [".value1"]);
                                            break;
                                        case "value2":
                                            o = e.xo.find(".value2").val(),
                                                e.ys.open(t, i, o, [".value2"]);
                                            break;
                                        case "value3":
                                            o = e.xo.find(".value3").val(),
                                                e.ys.open(t, i, o, [".value3"]);
                                            break;
                                        case "value4":
                                            o = e.xo.find(".value4").val(),
                                                e.ys.open(t, i, o, [".value4"]);
                                            break;
                                        case "textBox-cell1":
                                            o = e.xo.find(".textBox-cell1").val(),
                                                e.ys.open(t, i, o, [".textBox-cell1"]);
                                            break;
                                        case "textBox-cell2":
                                            o = e.xo.find(".textBox-cell2").val(),
                                                e.ys.open(t, i, o, [".textBox-cell2"]);
                                            break;
                                        case "formula-input":
                                            o = e.xo.find(".formula-input").val(),
                                                e.ys.open(t, i, o, [".formula-input"]);
                                            break;
                                        default:
                                            e.show()
                                    }
                                }
                            })
                        }
                        ,
                        a.prototype.as = function() {
                            var e, t, i, o, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A = this, I = this;
                            I.xs(),
                                e = this.xo.find(".formatStyle"),
                                e.change(function() {
                                    var t = parseInt(e.prop("selectedIndex"));
                                    A.Ns(t),
                                    0 !== t && 1 !== t || A.Os()
                                }),
                                t = this.xo.find(".minSelector"),
                                t.change(function() {
                                    var e = parseInt(t.prop("selectedIndex"))
                                        , i = A.xo.find(".minValue")
                                        , o = A.xo.find(".minValueButton");
                                    switch (e) {
                                        case 0:
                                            i.val("(" + t.val() + ")"),
                                                i.attr("disabled", "disabled"),
                                                o.attr("disabled", "disabled");
                                            break;
                                        case 1:
                                        case 2:
                                            i.val(0),
                                                i.removeAttr("disabled"),
                                                o.removeAttr("disabled");
                                            break;
                                        case 3:
                                            i.val(""),
                                                i.removeAttr("disabled"),
                                                o.removeAttr("disabled");
                                            break;
                                        case 4:
                                            i.val(10),
                                                i.removeAttr("disabled"),
                                                o.removeAttr("disabled")
                                    }
                                }),
                                i = this.xo.find(".maxSelector"),
                                i.change(function() {
                                    var e = parseInt(i.prop("selectedIndex"))
                                        , t = A.xo.find(".maxValue")
                                        , o = A.xo.find(".maxValueButton");
                                    switch (e) {
                                        case 0:
                                            t.val("(" + i.val() + ")"),
                                                t.attr("disabled", "disabled"),
                                                o.attr("disabled", "disabled");
                                            break;
                                        case 1:
                                            t.val(0),
                                                t.removeAttr("disabled"),
                                                o.removeAttr("disabled");
                                            break;
                                        case 2:
                                            t.val(100),
                                                t.removeAttr("disabled"),
                                                o.removeAttr("disabled");
                                            break;
                                        case 3:
                                            t.val(""),
                                                t.removeAttr("disabled"),
                                                o.removeAttr("disabled");
                                            break;
                                        case 4:
                                            t.val(90),
                                                t.removeAttr("disabled"),
                                                o.removeAttr("disabled")
                                    }
                                }),
                                o = this.xo.find(".midSelector"),
                                o.change(function() {
                                    var e = parseInt(o.prop("selectedIndex"))
                                        , t = A.xo.find(".midValue");
                                    switch (e) {
                                        case 0:
                                            t.val(0);
                                            break;
                                        case 1:
                                            t.val(50);
                                            break;
                                        case 2:
                                            t.val("");
                                            break;
                                        case 3:
                                            t.val(50)
                                    }
                                }),
                                r = this.xo.find(".minSelector2"),
                                r.change(function() {
                                    var e = parseInt(r.prop("selectedIndex"))
                                        , t = A.xo.find(".minValue2")
                                        , i = A.xo.find(".minValue2Button");
                                    switch (e) {
                                        case 0:
                                        case 5:
                                            t.val("(" + r.val() + ")"),
                                                t.attr("disabled", "disabled"),
                                                i.attr("disabled", "disabled");
                                            break;
                                        case 1:
                                        case 2:
                                            t.val(0),
                                                t.removeAttr("disabled"),
                                                i.removeAttr("disabled");
                                            break;
                                        case 3:
                                            t.val(""),
                                                t.removeAttr("disabled"),
                                                i.removeAttr("disabled");
                                            break;
                                        case 4:
                                            t.val(10),
                                                t.removeAttr("disabled"),
                                                i.removeAttr("disabled")
                                    }
                                }),
                                a = this.xo.find(".maxSelector2"),
                                a.change(function() {
                                    var e = parseInt(a.prop("selectedIndex"))
                                        , t = A.xo.find(".maxValue2")
                                        , i = A.xo.find(".maxValue2Button");
                                    switch (e) {
                                        case 0:
                                        case 5:
                                            t.val("(" + a.val() + ")"),
                                                t.attr("disabled", "disabled"),
                                                i.attr("disabled", "disabled");
                                            break;
                                        case 1:
                                            t.val(0),
                                                t.removeAttr("disabled"),
                                                i.removeAttr("disabled");
                                            break;
                                        case 2:
                                            t.val(100),
                                                t.removeAttr("disabled"),
                                                i.removeAttr("disabled");
                                            break;
                                        case 3:
                                            t.val(""),
                                                t.removeAttr("disabled"),
                                                i.removeAttr("disabled");
                                            break;
                                        case 4:
                                            t.val(90),
                                                t.removeAttr("disabled"),
                                                i.removeAttr("disabled")
                                    }
                                }),
                                s = this.xo.find(".fillSelector"),
                                s.change(function() {
                                    I.Ps()
                                }),
                                l = this.xo.find(".borderSelector"),
                                l.change(function() {
                                    I.Ps(),
                                        0 === l.prop("selectedIndex") ? A.xo.find(".barcolor2-frame button").attr("disabled", "disabled") : A.xo.find(".barcolor2-frame button").removeAttr("disabled")
                                }),
                                c = this.xo.find(".barDirectionSelector"),
                                c.change(function() {
                                    I.Ps()
                                }),
                                d = this.xo.find(".value1"),
                                d.change(function() {
                                    I.Qs(d.val())
                                }),
                                p = this.xo.find(".value2"),
                                p.change(function() {
                                    I.Qs(void 0, p.val())
                                }),
                                u = this.xo.find(".value3"),
                                u.change(function() {
                                    I.Qs(void 0, void 0, u.val())
                                }),
                                h = this.xo.find(".value4"),
                                h.change(function() {
                                    I.Qs(void 0, void 0, void 0, h.val())
                                }),
                                f = this.xo.find(".reverseIconOrder"),
                                f.change(function(e) {
                                    var t, i, o = [];
                                    for (t = 0; t < A.Rs.length; t++)
                                        o.push("" + A.Rs[t]);
                                    i = o.reverse(),
                                        A.Ss.reverse(),
                                        A.Ts(void 0, i)
                                }),
                                $("#icon-sets-popup-dialog button").on("mouseenter", function(e) {
                                    var t = e.currentTarget
                                        , i = $(t).children("span.icon-button-container");
                                    $(i).addClass("ui-state-hover")
                                }),
                                $("#icon-sets-popup-dialog button").on("mouseleave", function(e) {
                                    var t = e.currentTarget
                                        , i = $(t).children("span.icon-button-container");
                                    $(i).removeClass("ui-state-hover")
                                }),
                                $("#icon-sets-popup-dialog button").on("click", function(e) {
                                    var t, i, o, n, r, a, s, l, c;
                                    for (I.xo.find(".iconStyle-frame").comboframe("close"),
                                             t = [],
                                             o = e.currentTarget,
                                             I.Us = o.name,
                                             n = o.childNodes[1].children,
                                             r = 0; r < n.length; r++)
                                        a = n[r].className,
                                            i = "iconSetsIcons horizontal-icon-set-item ",
                                            s = a.substring(i.length, a.length),
                                            t.push(s);
                                    if (I.Ss = [],
                                            I.Vs = !1,
                                            I.Is(!1),
                                            f.prop("checked")) {
                                        for (l = [],
                                                 r = 0; r < t.length; r++)
                                            l.push("" + t[r]);
                                        for (c = l.reverse(),
                                                 r = 0; r < t.length; r++)
                                            I.Ss.push({
                                                iconSetType: ee(o.name),
                                                iconIndex: r
                                            });
                                        I.Ts(t, c)
                                    } else {
                                        for (r = t.length - 1; r >= 0; r--)
                                            I.Ss.push({
                                                iconSetType: ee(o.name),
                                                iconIndex: r
                                            });
                                        I.Ts(t, t)
                                    }
                                    I.Ws(t.length),
                                        I.Xs(o.name)
                                }),
                                $(".icons-popup-dialog .icon-wrapper").on("mouseenter", function(e) {
                                    var t = e.currentTarget;
                                    $(t).addClass("ui-state-hover")
                                }),
                                $(".icons-popup-dialog .icon-wrapper").on("mouseleave", function(e) {
                                    var t = e.currentTarget;
                                    $(t).removeClass("ui-state-hover")
                                }),
                                $(".icons-popup-dialog span").on("click", function(e) {
                                    var t, i, o, r, a, s, l, c, d, p, u, h, f, g = I.xo.find(".icon-frame.ui-state-active");
                                    1 === g.length && (t = I.xo.find(".icon-frame").index(g),
                                        g.comboframe("close"),
                                        i = $(g).children()[0],
                                        o = $(i).children()[0],
                                        r = $(e.currentTarget).hasClass("iconSetsIcons") ? e.currentTarget : $(e.currentTarget).children()[0],
                                        a = r.className,
                                        s = "iconSetsIcons ",
                                        l = a.substring(s.length, a.length),
                                        c = $(o).next("span"),
                                        "no-cell-icon" === l ? c.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.noCellIcon) : c.text(""),
                                        d = "iconX iconSetsIcons ",
                                        p = o.className,
                                    (u = p.substring(d.length, p.length)) !== l && (h = o.className.match(/icon\d+/g),
                                        $(o).removeClass(),
                                        $(o).addClass(h[0]),
                                        $(o).addClass(s),
                                        $(o).addClass(l),
                                        f = r.getAttribute("name"),
                                        I.Rs[t] = l,
                                        f = f.split(","),
                                        I.Ss[t] = {
                                            iconSetType: ee(f[0]),
                                            iconIndex: parseInt(f[1])
                                        },
                                        I.Vs = !0,
                                        I.Is(!0)))
                                }),
                                g = this.xo.find(".value1Selector"),
                                g.change(function() {
                                    I.Xs(I.Us, 1)
                                }),
                                m = this.xo.find(".value2Selector"),
                                m.change(function() {
                                    I.Xs(I.Us, 2)
                                }),
                                b = this.xo.find(".value3Selector"),
                                b.change(function() {
                                    I.Xs(I.Us, 3)
                                }),
                                v = this.xo.find(".value4Selector"),
                                v.change(function() {
                                    I.Xs(I.Us, 4)
                                }),
                                y = this.xo.find(".operator1"),
                                y.change(function() {
                                    I.Qs(d.val())
                                }),
                                x = this.xo.find(".operator2"),
                                x.change(function() {
                                    I.Qs(void 0, p.val())
                                }),
                                w = this.xo.find(".operator3"),
                                w.change(function() {
                                    I.Qs(void 0, void 0, u.val())
                                }),
                                C = this.xo.find(".operator4"),
                                C.change(function() {
                                    I.Qs(void 0, void 0, void 0, h.val())
                                }),
                                S = this.xo.find(".formatContain-type"),
                                k = this.xo.find(".operator"),
                                S.change(function() {
                                    var e = parseInt(S.prop("selectedIndex"));
                                    A.Ys(e),
                                        A.Zs(e),
                                        k.trigger("change")
                                }),
                                k.change(function(e) {
                                    var t = parseInt(S.prop("selectedIndex"));
                                    0 === t && A.$s(k.prop("selectedIndex"))
                                }),
                                T = this.xo.find(".format-button"),
                                T.click(function() {
                                    A.formatCellDialog.selectTabOptions = {
                                        numbers: !0,
                                        font: !0,
                                        border: !0,
                                        fill: !0
                                    },
                                        A.formatCellDialog.setFormatDirectly(!1),
                                        A.formatCellDialog.open("font", {
                                            family: "disabled",
                                            size: "disabled",
                                            weight: "disabled"
                                        }, A.ws, !0)
                                })
                        }
                        ,
                        a.prototype.Ks = function(e) {
                            var t = ".format-rule-sperator-line";
                            0 === e ? this.xo.find(t).css("display", "none") : this.xo.find(t).css("display", "block")
                        }
                        ,
                        a.prototype.yq = function(e, t) {
                            $(this).trigger("dialogClose", t)
                        }
                        ,
                        a.prototype.Ls = function(e) {
                            var t, i, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D, F, L, R, B, N, E, V, P, z, j, M, G, H, U, W, _, q, K, Y, X, J, Q, Z, ee, ie, oe, ne, re, ae, se, le, ce, de, pe, ue, he, fe, ge, me, be, ve, ye, xe;
                            if (this.Gs = e.ranges(),
                                    this.Hs = e,
                                    v = n.wrapper.spread.getActiveSheet(),
                                    y = v.getActiveRowIndex(),
                                    x = v.getActiveColumnIndex(),
                                e.ruleType() === o.ConditionalFormatting.RuleType.twoScaleRule)
                                w = e,
                                    u = w.minType(),
                                    h = w.minValue(),
                                    f = w.minColor(),
                                    g = w.maxType(),
                                    m = w.maxValue(),
                                    b = w.maxColor(),
                                    a = this.xo.find(".minSelector"),
                                    t = this._s(u),
                                    a.prop("selectedIndex", t),
                                    a.trigger("change"),
                                    s = this.xo.find(".maxSelector"),
                                    i = this._s(g),
                                    s.prop("selectedIndex", i),
                                    s.trigger("change"),
                                    $(".min-color-picker").colorpicker("option", "value", f),
                                    this.xo.find(".min-color-span").css("background-color", f),
                                    $(".max-color-picker").colorpicker("option", "value", b),
                                    this.xo.find(".max-color-span").css("background-color", b),
                                0 !== t && this.xo.find(".minValue").val(h),
                                0 !== i && this.xo.find(".maxValue").val(m),
                                    this.Os();
                            else if (e.ruleType() === o.ConditionalFormatting.RuleType.threeScaleRule)
                                C = e,
                                    u = C.minType(),
                                    h = C.minValue(),
                                    f = C.minColor(),
                                    g = C.maxType(),
                                    m = C.maxValue(),
                                    b = C.maxColor(),
                                    S = C.midType(),
                                    k = C.midValue(),
                                    T = C.midColor(),
                                    a = this.xo.find(".minSelector"),
                                    t = this._s(u),
                                    a.prop("selectedIndex", t),
                                    a.trigger("change"),
                                    s = this.xo.find(".maxSelector"),
                                    i = this._s(g),
                                    s.prop("selectedIndex", i),
                                    s.trigger("change"),
                                    A = this.xo.find(".midSelector"),
                                    I = this._s(S) - 1,
                                    A.prop("selectedIndex", I),
                                    A.trigger("change"),
                                    $(".min-color-picker").colorpicker("option", "value", f),
                                    this.xo.find(".min-color-span").css("background-color", f),
                                    $(".max-color-picker").colorpicker("option", "value", b),
                                    this.xo.find(".max-color-span").css("background-color", b),
                                    $(".mid-color-picker").colorpicker("option", "value", T),
                                    this.xo.find(".mid-color-span").css("background-color", T),
                                0 !== t && this.xo.find(".minValue").val(h),
                                0 !== i && this.xo.find(".maxValue").val(m),
                                    this.xo.find(".midValue").val(k),
                                    this.Os();
                            else if (e.ruleType() === o.ConditionalFormatting.RuleType.dataBarRule)
                                D = e,
                                    F = D.minType(),
                                    h = D.minValue(),
                                    L = D.maxType(),
                                    m = D.maxValue(),
                                    R = D.color(),
                                    E = D.borderColor(),
                                    B = D.showBarOnly(),
                                    N = D.gradient(),
                                    V = D.showBorder(),
                                    P = D.dataBarDirection(),
                                    z = D.negativeBorderColor(),
                                    j = D.negativeFillColor(),
                                    M = D.useNegativeBorderColor(),
                                    G = D.useNegativeFillColor(),
                                    H = D.axisColor(),
                                    U = D.axisPosition(),
                                    W = this.xo.find(".minSelector2"),
                                    t = this._s(F),
                                    W.prop("selectedIndex", t),
                                    W.trigger("change"),
                                    _ = this.xo.find(".maxSelector2"),
                                    i = this._s(L),
                                    _.prop("selectedIndex", i),
                                    _.trigger("change"),
                                    this.xo.find(".minValue2").val(h),
                                    this.xo.find(".maxValue2").val(m),
                                    $(".barcolor1-picker").colorpicker("option", "value", R),
                                    $(".barcolor2-picker").colorpicker("option", "value", E),
                                    this.xo.find(".barcolor1-span").css("background-color", R),
                                    this.xo.find(".barcolor2-span").css("background-color", E),
                                    this.xo.find(".showBarOnly").prop("checked", B),
                                    q = this.xo.find(".fillSelector"),
                                    q.prop("selectedIndex", !0 === N ? 1 : 0),
                                    q.trigger("change"),
                                    K = this.xo.find(".borderSelector"),
                                    K.prop("selectedIndex", !0 === V ? 1 : 0),
                                    K.trigger("change"),
                                    this.xo.find(".barDirectionSelector").prop("selectedIndex", 0 === P ? 0 : 1),
                                    this.Ms = {
                                        negativeBorderColor: z,
                                        negativeFillColor: j,
                                        useNegativeBorderColor: M,
                                        useNegativeFillColor: G,
                                        axisColor: H,
                                        axisPosition: U
                                    },
                                    this.Ps();
                            else if (e.ruleType() === o.ConditionalFormatting.RuleType.iconSetRule) {
                                switch (Y = e,
                                    X = Y.iconSetType(),
                                    J = Y.showIconOnly(),
                                    Q = Y.reverseIconOrder(),
                                    Z = Y.iconCriteria(),
                                    X) {
                                    case 0:
                                        ee = "3-arrows-icon-set";
                                        break;
                                    case 1:
                                        ee = "3-arrows-gray-icon-set";
                                        break;
                                    case 2:
                                        ee = "3-triangles-icon-set";
                                        break;
                                    case 5:
                                        ee = "3-traffic-lights-unrimmed-icon-set";
                                        break;
                                    case 6:
                                        ee = "3-traffic-lights-rimmed-icon-set";
                                        break;
                                    case 7:
                                        ee = "3-signs-icon-set";
                                        break;
                                    case 8:
                                        ee = "3-symbols-circled-icon-set";
                                        break;
                                    case 9:
                                        ee = "3-symbols-uncircled-icon-set";
                                        break;
                                    case 4:
                                        ee = "3-flags-icon-set";
                                        break;
                                    case 3:
                                        ee = "3-stars-icon-set";
                                        break;
                                    case 11:
                                        ee = "4-arrows-gray-icon-set";
                                        break;
                                    case 10:
                                        ee = "4-arrows-icon-set";
                                        break;
                                    case 14:
                                        ee = "4-traffic-lights-icon-set";
                                        break;
                                    case 12:
                                        ee = "red-to-black-icon-set";
                                        break;
                                    case 13:
                                        ee = "4-ratings-icon-set";
                                        break;
                                    case 16:
                                        ee = "5-arrows-gray-icon-set";
                                        break;
                                    case 15:
                                        ee = "5-arrows-icon-set";
                                        break;
                                    case 18:
                                        ee = "5-quarters-icon-set";
                                        break;
                                    case 17:
                                        ee = "5-ratings-icon-set";
                                        break;
                                    case 19:
                                        ee = "5-boxes-icon-set"
                                }
                                for (this.Xs(ee),
                                         this.xo.find(".showIconOnly").prop("checked", J),
                                         this.xo.find(".reverseIconOrder").prop("checked", Q),
                                         this.xo.find(".operator1").prop("selectedIndex", !0 === this.bt(Z[Z.length - 1]) ? 0 : 1),
                                         this.xo.find(".operator2").prop("selectedIndex", !0 === this.bt(Z[Z.length - 2]) ? 0 : 1),
                                         this.xo.find(".value1Selector").prop("selectedIndex", this.ct(Z[Z.length - 1])),
                                         this.xo.find(".value2Selector").prop("selectedIndex", this.ct(Z[Z.length - 2])),
                                         ie = this.xo.find(".value1"),
                                         ie.val(this.dt(Z[Z.length - 1])),
                                         oe = this.xo.find(".value2"),
                                         oe.val(this.dt(Z[Z.length - 2])),
                                     Z.length >= 3 && (this.xo.find(".operator3").prop("selectedIndex", !0 === this.bt(Z[Z.length - 3]) ? 0 : 1),
                                         this.xo.find(".value3Selector").prop("selectedIndex", this.ct(Z[Z.length - 3])),
                                         ne = this.xo.find(".value3"),
                                         ne.val(this.dt(Z[Z.length - 3]))),
                                     Z.length >= 4 && (this.xo.find(".operator4").prop("selectedIndex", !0 === this.bt(Z[Z.length - 4]) ? 0 : 1),
                                         this.xo.find(".value4Selector").prop("selectedIndex", this.ct(Z[Z.length - 4])),
                                         re = this.xo.find(".value4"),
                                         re.val(this.dt(Z[Z.length - 4]))),
                                         ae = $("<div></div>"),
                                         O.rs(ae, X),
                                         ae.children().removeClass("iconSetsIcons"),
                                         se = [],
                                         le = [],
                                         ce = 0; ce < ae.children().length; ce++)
                                    se.push(ae.children()[ce].className);
                                if (this.Ss = Y.icons(),
                                        this.Ss)
                                    for (this.Ss = Y.icons().concat(),
                                             this.Ss.reverse(),
                                             ce = 0; ce < ae.children().length; ce++)
                                        le.push(O.us(this.Ss[ce]));
                                else
                                    this.Ss = [],
                                        le = se;
                                this.Vs = Y.Vs || te(X, this.Ss),
                                    this.Is(this.Vs),
                                Q && (this.Ss.reverse(),
                                    le.reverse()),
                                    this.Ts(se, le),
                                    this.Ws(Z.length + 1),
                                    this.Qs(ie.val(), oe.val(), void 0 === ne ? void 0 : ne.val(), void 0 === re ? void 0 : re.val())
                            } else if (e.ruleType() === o.ConditionalFormatting.RuleType.cellValueRule) {
                                switch (de = e,
                                    c = de.operator(),
                                    d = de.value1(y, x),
                                    p = de.value2(y, x),
                                    this.ws = de.style(),
                                    l = this.xo.find(".formatContain-type"),
                                    l.prop("selectedIndex", 0),
                                    l.trigger("change"),
                                    c) {
                                    case 6:
                                        t = 0;
                                        break;
                                    case 7:
                                        t = 1;
                                        break;
                                    case 0:
                                        t = 2;
                                        break;
                                    case 1:
                                        t = 3;
                                        break;
                                    case 2:
                                        t = 4;
                                        break;
                                    case 4:
                                        t = 5;
                                        break;
                                    case 3:
                                        t = 6;
                                        break;
                                    case 5:
                                        t = 7
                                }
                                this.xo.find(".operator").prop("selectedIndex", t),
                                    this.xo.find(".operator").trigger("change"),
                                    this.xo.find(".textBox-cell1").val(d),
                                    this.xo.find(".textBox-cell2").val(p),
                                    this.os()
                            } else if (e.ruleType() === o.ConditionalFormatting.RuleType.specificTextRule) {
                                switch (pe = e,
                                    c = pe.operator(),
                                    d = pe.text(),
                                    this.ws = pe.style(),
                                    l = this.xo.find(".formatContain-type"),
                                    l.prop("selectedIndex", 1),
                                    l.trigger("change"),
                                    c) {
                                    case 0:
                                        t = 0;
                                        break;
                                    case 1:
                                        t = 1;
                                        break;
                                    case 2:
                                        t = 2;
                                        break;
                                    case 3:
                                        t = 3
                                }
                                this.xo.find(".operator").prop("selectedIndex", t),
                                    this.xo.find(".operator").trigger("change"),
                                    this.xo.find(".textBox-cell1").val(d),
                                    this.os()
                            } else if (e.ruleType() === o.ConditionalFormatting.RuleType.dateOccurringRule) {
                                switch (ue = e,
                                    he = ue.type(),
                                    this.ws = ue.style(),
                                    l = this.xo.find(".formatContain-type"),
                                    l.prop("selectedIndex", 2),
                                    l.trigger("change"),
                                    he) {
                                    case 1:
                                        t = 0;
                                        break;
                                    case 0:
                                        t = 1;
                                        break;
                                    case 2:
                                        t = 2;
                                        break;
                                    case 3:
                                        t = 3;
                                        break;
                                    case 8:
                                        t = 4;
                                        break;
                                    case 7:
                                        t = 5;
                                        break;
                                    case 9:
                                        t = 6;
                                        break;
                                    case 5:
                                        t = 7;
                                        break;
                                    case 4:
                                        t = 8;
                                        break;
                                    case 6:
                                        t = 9
                                }
                                this.xo.find(".operator").prop("selectedIndex", t),
                                    this.xo.find(".operator").trigger("change"),
                                    this.os()
                            } else if (e.ruleType() === o.ConditionalFormatting.RuleType.top10Rule)
                                fe = e,
                                    r = fe.type(),
                                    ge = fe.rank(),
                                    this.ws = fe.style(),
                                    this.xo.find(".formatRankedValue-type").prop("selectedIndex", 0 === r ? 0 : 1),
                                    this.xo.find(".formatRankedValue-type").trigger("change"),
                                    this.xo.find(".itemCounts").val(ge),
                                    this.os();
                            else if (e.ruleType() === o.ConditionalFormatting.RuleType.averageRule) {
                                switch (me = e,
                                    r = me.type(),
                                    this.ws = me.style(),
                                    r) {
                                    case 0:
                                        t = 0;
                                        break;
                                    case 1:
                                        t = 1;
                                        break;
                                    case 2:
                                        t = 2;
                                        break;
                                    case 3:
                                        t = 3;
                                        break;
                                    case 4:
                                        t = 4;
                                        break;
                                    case 5:
                                        t = 5;
                                        break;
                                    case 6:
                                        t = 6;
                                        break;
                                    case 7:
                                        t = 7;
                                        break;
                                    case 8:
                                        t = 8;
                                        break;
                                    case 9:
                                        t = 9
                                }
                                this.xo.find(".formatAbove-type").prop("selectedIndex", t),
                                    this.xo.find(".formatAbove-type").trigger("change"),
                                    this.os()
                            } else
                                e.ruleType() === o.ConditionalFormatting.RuleType.duplicateRule ? (be = e,
                                    this.ws = be.style(),
                                    this.xo.find(".formatUnique-type").prop("selectedIndex", 0),
                                    this.os()) : e.ruleType() === o.ConditionalFormatting.RuleType.uniqueRule ? (ve = e,
                                    this.ws = ve.style(),
                                    this.xo.find(".formatUnique-type").prop("selectedIndex", 1),
                                    this.os()) : e.ruleType() === o.ConditionalFormatting.RuleType.formulaRule && (ye = e,
                                    t = ye.selectorIndex,
                                    this.ws = ye.style(),
                                    1 === ye.ruleType() ? (this.xo.find(".formatContain-type").prop("selectedIndex", t),
                                        this.xo.find(".formatContain-type").trigger("change")) : 3 === ye.ruleType() && (xe = ye.formula(),
                                        this.xo.find(".formula-input").val(xe)),
                                    this.os())
                        }
                        ,
                        a.prototype._s = function(e) {
                            var t;
                            switch (e) {
                                case 2:
                                case 1:
                                    t = 0;
                                    break;
                                case 0:
                                    t = 1;
                                    break;
                                case 3:
                                    t = 2;
                                    break;
                                case 6:
                                    t = 3;
                                    break;
                                case 4:
                                    t = 4;
                                    break;
                                case 5:
                                case 7:
                                    t = 5
                            }
                            return t
                        }
                        ,
                        a.prototype.et = function(e, t) {
                            return e[t]
                        }
                        ,
                        a.prototype.bt = function(e) {
                            return this.et(e, "isGreaterThanOrEqualTo")
                        }
                        ,
                        a.prototype.dt = function(e) {
                            return this.et(e, "iconValue")
                        }
                        ,
                        a.prototype.ct = function(e) {
                            var t, i = this.et(e, "iconValueType");
                            switch (i) {
                                case 1:
                                    t = 0;
                                    break;
                                case 4:
                                    t = 1;
                                    break;
                                case 7:
                                    t = 2;
                                    break;
                                case 5:
                                    t = 3
                            }
                            return t
                        }
                        ,
                        a.prototype.ft = function(e) {
                            var t;
                            switch (e) {
                                case 0:
                                    t = 1;
                                    break;
                                case 1:
                                    t = 4;
                                    break;
                                case 2:
                                    t = 7;
                                    break;
                                case 3:
                                    t = 5
                            }
                            return t
                        }
                        ,
                        a.prototype.xq = function() {
                            var e, i, o, r, a, s, l, c, d, p = parseInt(this.xo.find(".ruleType").prop("selectedIndex"));
                            switch (p) {
                                case 0:
                                    break;
                                case 1:
                                    switch (e = parseInt(this.xo.find(".formatContain-type").prop("selectedIndex")),
                                        i = this.xo.find(".operator").prop("selectedIndex"),
                                        o = this.xo.find(".textBox-cell1"),
                                        r = this.xo.find(".textBox-cell2"),
                                        e) {
                                        case 0:
                                            if (0 === i || 1 === i) {
                                                if ("" === o.val() || "" === r.val())
                                                    return t.show(n.res.conditionalFormatting.exceptions.e4, n.res.title, 2),
                                                        !1
                                            } else if ("" === o.val())
                                                return t.show(n.res.conditionalFormatting.exceptions.e4, n.res.title, 2),
                                                    !1;
                                            break;
                                        case 1:
                                            if ("" === o.val())
                                                return t.show(n.res.conditionalFormatting.exceptions.e4, n.res.title, 2),
                                                    !1
                                    }
                                    break;
                                case 2:
                                    return a = parseInt(this.xo.find(".itemCounts").val()),
                                        s = !0,
                                    (isNaN(a) || a > 1e3 || a < 1) && (t.show(n.res.conditionalFormatting.exceptions.e3, n.res.title, 2),
                                        s = !1),
                                        s;
                                case 5:
                                    if (l = this.xo.find(".formula-input").val(),
                                            c = n.wrapper.spread.getActiveSheet(),
                                            d = GC.Spread.Sheets.CalcEngine.formulaToExpression(c, l),
                                        d.type !== GC.Spread.CalcEngine.ExpressionType.function && d.type !== GC.Spread.CalcEngine.ExpressionType.reference && d.type !== GC.Spread.CalcEngine.ExpressionType.operator)
                                        return t.show(n.res.conditionalFormatting.exceptions.e5, n.res.title, 2),
                                            !1
                            }
                            return !0
                        }
                        ,
                        a.prototype.vs = function() {
                            var e, t, i, o = parseInt(this.xo.find(".ruleType").prop("selectedIndex"));
                            switch (o) {
                                case 0:
                                    switch (e = parseInt(this.xo.find(".formatStyle").prop("selectedIndex"))) {
                                        case 0:
                                            this.gt(!1);
                                            break;
                                        case 1:
                                            this.gt(!0);
                                            break;
                                        case 2:
                                            this.ht();
                                            break;
                                        case 3:
                                            this.it()
                                    }
                                    break;
                                case 1:
                                    switch (t = parseInt(this.xo.find(".formatContain-type").prop("selectedIndex"))) {
                                        case 0:
                                            this.jt();
                                            break;
                                        case 1:
                                            this.kt();
                                            break;
                                        case 2:
                                            this.lt();
                                            break;
                                        default:
                                            this.nt(t)
                                    }
                                    break;
                                case 2:
                                    this.ot();
                                    break;
                                case 3:
                                    this.pt();
                                    break;
                                case 4:
                                    this.qt();
                                    break;
                                case 5:
                                    this.rt()
                            }
                            (i = this.Hs) && i.style() && void 0 !== i.style().locked && delete i.style().locked
                        }
                        ,
                        a.prototype.Js = function(e, t, i) {
                            var o = this.xo.find(".formatOnValue")
                                , n = this.xo.find(".formatContain")
                                , r = this.xo.find(".formatRankedValue")
                                , a = this.xo.find(".formatAbove")
                                , s = this.xo.find(".formatUnique")
                                , l = this.xo.find(".useFormula")
                                , c = this.xo.find(".ruleType")
                                , d = this.xo.find(".preview");
                            switch (e) {
                                case 0:
                                    o.removeClass("hidden"),
                                        n.addClass("hidden"),
                                        r.addClass("hidden"),
                                        a.addClass("hidden"),
                                        s.addClass("hidden"),
                                        l.addClass("hidden"),
                                        d.addClass("hidden"),
                                        this.st(t),
                                        c.prop("selectedIndex", 0);
                                    break;
                                case 1:
                                    o.addClass("hidden"),
                                        n.removeClass("hidden"),
                                        r.addClass("hidden"),
                                        a.addClass("hidden"),
                                        s.addClass("hidden"),
                                        l.addClass("hidden"),
                                        d.removeClass("hidden"),
                                        this.tt(i),
                                        this.ut(),
                                        c.prop("selectedIndex", 1);
                                    break;
                                case 2:
                                    o.addClass("hidden"),
                                        n.addClass("hidden"),
                                        r.removeClass("hidden"),
                                        a.addClass("hidden"),
                                        s.addClass("hidden"),
                                        l.addClass("hidden"),
                                        d.removeClass("hidden"),
                                        this.vt(),
                                        this.ut(),
                                        c.prop("selectedIndex", 2);
                                    break;
                                case 3:
                                    o.addClass("hidden"),
                                        n.addClass("hidden"),
                                        r.addClass("hidden"),
                                        a.removeClass("hidden"),
                                        s.addClass("hidden"),
                                        l.addClass("hidden"),
                                        d.removeClass("hidden"),
                                        this.wt(),
                                        this.ut(),
                                        c.prop("selectedIndex", 3);
                                    break;
                                case 4:
                                    o.addClass("hidden"),
                                        n.addClass("hidden"),
                                        r.addClass("hidden"),
                                        a.addClass("hidden"),
                                        s.removeClass("hidden"),
                                        l.addClass("hidden"),
                                        d.removeClass("hidden"),
                                        this.xt(),
                                        this.ut(),
                                        c.prop("selectedIndex", 4);
                                    break;
                                case 5:
                                    o.addClass("hidden"),
                                        n.addClass("hidden"),
                                        r.addClass("hidden"),
                                        a.addClass("hidden"),
                                        s.addClass("hidden"),
                                        l.removeClass("hidden"),
                                        d.removeClass("hidden"),
                                        this.yt(),
                                        this.ut(),
                                        c.prop("selectedIndex", 5)
                            }
                        }
                        ,
                        a.prototype.Os = function() {
                            var e = this.xo.find(".min-color-span").css("background-color")
                                , t = this.xo.find(".mid-color-span").css("background-color")
                                , i = this.xo.find(".max-color-span").css("background-color");
                            0 === this.zt ? this.At(e, i) : this.At(e, t, i)
                        }
                        ,
                        a.prototype.Ps = function() {
                            var e, t, i, o = this.xo.find(".barcolor1-span").css("background-color"), n = this.xo.find(".barcolor2-span").css("background-color"), r = this.xo.find(".fillSelector").prop("selectedIndex"), a = this.xo.find(".borderSelector").prop("selectedIndex"), s = this.xo.find(".barDirectionSelector").prop("selectedIndex"), l = this.xo.find(".previewContainer-dataBar"), c = o;
                            1 === r && (e = "white"),
                            1 === a && (t = n),
                                1 === s ? (i = c,
                                    c = e,
                                    e = i,
                                    l.attr("align", "right")) : l.attr("align", "left"),
                                this.Bt(c, e, t)
                        }
                        ,
                        a.prototype.st = function(e) {
                            var t, i, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D, F, L, R, B = this, N = this;
                            if ($(".min-color-picker").colorpicker({
                                    valueChanged: function(e, t) {
                                        var i;
                                        i = void 0 === t.color ? "red" : t.color,
                                            N.xo.find(".min-color-span").css("background-color", i),
                                            N.Os()
                                    },
                                    choosedColor: function(e, t) {
                                        N.xo.find(".min-color-frame").comboframe("close")
                                    },
                                    openColorDialog: function(e, t) {
                                        N.xo.find(".min-color-frame").comboframe("close")
                                    }
                                }),
                                    this.xo.find(".min-color-frame").comboframe(),
                                    $(".min-color-picker").colorpicker("option", "value", "red"),
                                    this.xo.find(".min-color-span").css("background-color", "red"),
                                    $(".mid-color-picker").colorpicker({
                                        valueChanged: function(e, t) {
                                            void 0 === t.color ? N.xo.find(".mid-color-span").css("background-color", "yellow") : N.xo.find(".mid-color-span").css("background-color", t.color),
                                                N.Os()
                                        },
                                        choosedColor: function(e, t) {
                                            N.xo.find(".mid-color-frame").comboframe("close")
                                        },
                                        openColorDialog: function(e, t) {
                                            N.xo.find(".mid-color-frame").comboframe("close")
                                        }
                                    }),
                                    this.xo.find(".mid-color-frame").comboframe(),
                                    $(".mid-color-picker").colorpicker("option", "value", "yellow"),
                                    this.xo.find(".mid-color-span").css("background-color", "yellow"),
                                    $(".max-color-picker").colorpicker({
                                        valueChanged: function(e, t) {
                                            void 0 === t.color ? N.xo.find(".max-color-span").css("background-color", "green") : N.xo.find(".max-color-span").css("background-color", t.color),
                                                N.Os()
                                        },
                                        choosedColor: function(e, t) {
                                            N.xo.find(".max-color-frame").comboframe("close")
                                        },
                                        openColorDialog: function(e, t) {
                                            N.xo.find(".max-color-frame").comboframe("close")
                                        }
                                    }),
                                    this.xo.find(".max-color-frame").comboframe(),
                                    $(".max-color-picker").colorpicker("option", "value", "green"),
                                    this.xo.find(".max-color-span").css("background-color", "green"),
                                    t = this.xo.find(".formatStyle"),
                                    e)
                                switch (e) {
                                    case 0:
                                        t.prop("selectedIndex", 0);
                                        break;
                                    case 1:
                                        t.prop("selectedIndex", 1);
                                        break;
                                    case 2:
                                        t.prop("selectedIndex", 2);
                                        break;
                                    case 3:
                                        t.prop("selectedIndex", 3)
                                }
                            else
                                t.prop("selectedIndex", 0);
                            for (t.trigger("change"),
                                     i = this.xo.find(".minSelector"),
                                     i.prop("selectedIndex", 0),
                                     i.trigger("change"),
                                     o = this.xo.find(".maxSelector"),
                                     o.prop("selectedIndex", 0),
                                     o.trigger("change"),
                                     n = this.xo.find(".midSelector"),
                                     n.prop("selectedIndex", 3),
                                     n.trigger("change"),
                                     r = this.xo.find(".showBarOnly"),
                                     r.prop("checked", !1),
                                     a = this.xo.find(".minSelector2"),
                                     s = a.prop("selectedIndex"),
                                     a.prop("selectedIndex", 5),
                                 s !== a.prop("selectedIndex") && a.trigger("change"),
                                     l = this.xo.find(".maxSelector2"),
                                     c = l.prop("selectedIndex"),
                                     l.prop("selectedIndex", 5),
                                 c !== l.prop("selectedIndex") && l.trigger("change"),
                                     $(".barcolor1-picker").colorpicker({
                                         valueChanged: function(e, t) {
                                             var i;
                                             i = void 0 === t.color ? "rgb(99,142,198)" : t.color,
                                                 N.xo.find(".barcolor1-span").css("background-color", i),
                                                 N.Ps()
                                         },
                                         choosedColor: function(e, t) {
                                             N.xo.find(".barcolor1-frame").comboframe("close")
                                         },
                                         openColorDialog: function(e, t) {
                                             N.xo.find(".barcolor1-frame").comboframe("close")
                                         }
                                     }),
                                     this.xo.find(".barcolor1-frame").comboframe(),
                                     $(".barcolor1-picker").colorpicker("option", "value", "rgb(99,142,198)"),
                                     this.xo.find(".barcolor1-span").css("background-color", "rgb(99,142,198)"),
                                     $(".barcolor2-picker").colorpicker({
                                         valueChanged: function(e, t) {
                                             var i;
                                             i = void 0 === t.color ? "black" : t.color,
                                                 N.xo.find(".barcolor2-span").css("background-color", i),
                                                 N.Ps()
                                         },
                                         choosedColor: function(e, t) {
                                             N.xo.find(".barcolor2-frame").comboframe("close")
                                         },
                                         openColorDialog: function(e, t) {
                                             N.xo.find(".barcolor2-frame").comboframe("close")
                                         }
                                     }),
                                     this.xo.find(".barcolor2-frame").comboframe(),
                                     $(".barcolor2-picker").colorpicker("option", "value", "black"),
                                     this.xo.find(".barcolor2-span").css("background-color", "black"),
                                     d = this.xo.find(".fillSelector"),
                                     p = d.prop("selectedIndex"),
                                     d.prop("selectedIndex", 0),
                                 p !== d.prop("selectedIndex") && d.trigger("change"),
                                     u = this.xo.find(".borderSelector"),
                                     h = u.prop("selectedIndex"),
                                     u.prop("selectedIndex", 0),
                                 h !== u.prop("selectedIndex") && u.trigger("change"),
                                     f = this.xo.find(".barDirectionSelector"),
                                     g = f.prop("selectedIndex"),
                                     f.prop("selectedIndex", 0),
                                 g !== f.prop("selectedIndex") && f.trigger("change"),
                                     m = this.xo.find(".negativeBtn"),
                                     m.button(),
                                     m.click(function() {
                                         var e = u.prop("selectedIndex");
                                         B.negativeDialog || (B.negativeDialog = new K),
                                             $(B.negativeDialog).on("dialogClose", function(e, t) {
                                                 t && (N.Ms = t),
                                                     N.negativeDialog = null
                                             }),
                                             B.negativeDialog.open(e, B.Ms)
                                     }),
                                     this.Ps(),
                                 void 0 === this.Ct && (this.Ct = []),
                                 void 0 === this.Rs && (this.Rs = []),
                                 void 0 === this.Ss && (this.Ss = [],
                                     this.Vs = !1),
                                     b = this.xo.find(".reverseIconOrder"),
                                 !1 !== b.prop("checked") && (b.prop("checked", !1),
                                     b.trigger("change")),
                                     v = this.xo.find(".showIconOnly"),
                                 !1 !== v.prop("checked") && v.prop("checked", !1),
                                     y = this.xo.find(".iconStyleIcon1-span"),
                                     x = $("#icon-sets-popup-dialog"),
                                     w = x.find("ul"),
                                     x.gcuipopup({
                                         autoHide: !0,
                                         position: {
                                             of: y,
                                             my: "left top",
                                             at: "right top"
                                         },
                                         collision: "fit fit",
                                         showing: function(e, t) {
                                             w.removeClass("hidden")
                                         },
                                         hidden: function(e, t) {
                                             N.xo.find(".iconStyle-frame").comboframe("close")
                                         }
                                     }),
                                     this.xo.find(".iconStyle-frame").comboframe(),
                                     this.xo.find(".icon-frame").comboframe(),
                                     C = ["up-arrow-green", "right-arrow-yellow", "down-arrow-red"],
                                     this.Us = "3-arrows-icon-set",
                                     this.Ss = [],
                                     S = 0; S < 3; S++)
                                this.Ss.push({
                                    iconSetType: ee("3-arrows-icon-set"),
                                    iconIndex: 2 - S
                                });
                            this.Ts(C, C),
                                this.Ws(3),
                                k = this.xo.find(".value1Selector"),
                            1 !== k.prop("selectedIndex") && (k.prop("selectedIndex", 1),
                                k.trigger("change")),
                                T = this.xo.find(".value2Selector"),
                            1 !== T.prop("selectedIndex") && (T.prop("selectedIndex", 1),
                                T.trigger("change")),
                                A = this.xo.find(".value3Selector"),
                            1 !== A.prop("selectedIndex") && (A.prop("selectedIndex", 1),
                                A.trigger("change")),
                                I = this.xo.find(".value4Selector"),
                            1 !== I.prop("selectedIndex") && (I.prop("selectedIndex", 1),
                                I.trigger("change")),
                                N.Xs("3-arrows-icon-set"),
                                D = this.xo.find(".operator1"),
                            0 !== D.prop("selectedIndex") && (D.prop("selectedIndex", 0),
                                D.trigger("change")),
                                F = this.xo.find(".operator2"),
                            0 !== F.prop("selectedIndex") && (F.prop("selectedIndex", 0),
                                F.trigger("change")),
                                L = this.xo.find(".operator3"),
                            0 !== L.prop("selectedIndex") && (L.prop("selectedIndex", 0),
                                L.trigger("change")),
                                R = this.xo.find(".operator4"),
                            0 !== R.prop("selectedIndex") && (R.prop("selectedIndex", 0),
                                R.trigger("change"))
                        }
                        ,
                        a.prototype.Ps = function() {
                            var e, t, i, o = this.xo.find(".barcolor1-span").css("background-color"), n = this.xo.find(".barcolor2-span").css("background-color"), r = this.xo.find(".fillSelector").prop("selectedIndex"), a = this.xo.find(".borderSelector").prop("selectedIndex"), s = this.xo.find(".barDirectionSelector").prop("selectedIndex"), l = this.xo.find(".previewContainer-dataBar"), c = o;
                            1 === r && (e = "white"),
                            1 === a && (t = n),
                                1 === s ? (i = c,
                                    c = e,
                                    e = i,
                                    l.attr("align", "right")) : l.attr("align", "left"),
                                this.Bt(c, e, t)
                        }
                        ,
                        a.prototype.Is = function(e) {
                            e ? ($(".iconStyleIcon").hide(),
                                $(".iconStyle-frame .custom-iconset").remove(),
                                $(".iconStyle-frame .icon-button-container").append($("<span></span>").addClass("custom-iconset").text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.customIconSet))) : ($(".iconStyleIcon").show(),
                                $(".iconStyle-frame .custom-iconset").remove())
                        }
                        ,
                        a.prototype.Xs = function(e, t) {
                            var i, o, n, r, a, s, l, c, d, p, u, h;
                            switch (this.Us = e,
                                i = this.xo.find(".value1Selector").prop("selectedIndex"),
                                o = this.xo.find(".value2Selector").prop("selectedIndex"),
                                n = this.xo.find(".value3Selector").prop("selectedIndex"),
                                r = this.xo.find(".value4Selector").prop("selectedIndex"),
                                e) {
                                case "3-arrows-icon-set":
                                case "3-arrows-gray-icon-set":
                                case "3-triangles-icon-set":
                                case "3-traffic-lights-unrimmed-icon-set":
                                case "3-traffic-lights-rimmed-icon-set":
                                case "3-signs-icon-set":
                                case "3-symbols-circled-icon-set":
                                case "3-symbols-uncircled-icon-set":
                                case "3-flags-icon-set":
                                case "3-stars-icon-set":
                                    switch (i) {
                                        case 0:
                                            a = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            a = 67;
                                            break;
                                        case 2:
                                            a = ""
                                    }
                                    switch (o) {
                                        case 0:
                                            s = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            s = 33;
                                            break;
                                        case 2:
                                            s = ""
                                    }
                                    break;
                                case "4-arrows-gray-icon-set":
                                case "4-arrows-icon-set":
                                case "4-traffic-lights-icon-set":
                                case "red-to-black-icon-set":
                                case "4-ratings-icon-set":
                                    switch (i) {
                                        case 0:
                                            a = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            a = 75;
                                            break;
                                        case 2:
                                            a = ""
                                    }
                                    switch (o) {
                                        case 0:
                                            s = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            s = 50;
                                            break;
                                        case 2:
                                            s = ""
                                    }
                                    switch (n) {
                                        case 0:
                                            l = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            l = 25;
                                            break;
                                        case 2:
                                            l = ""
                                    }
                                    break;
                                case "5-arrows-gray-icon-set":
                                case "5-arrows-icon-set":
                                case "5-quarters-icon-set":
                                case "5-ratings-icon-set":
                                case "5-boxes-icon-set":
                                    switch (i) {
                                        case 0:
                                            a = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            a = 80;
                                            break;
                                        case 2:
                                            a = ""
                                    }
                                    switch (o) {
                                        case 0:
                                            s = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            s = 60;
                                            break;
                                        case 2:
                                            s = ""
                                    }
                                    switch (n) {
                                        case 0:
                                            l = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            l = 40;
                                            break;
                                        case 2:
                                            l = ""
                                    }
                                    switch (r) {
                                        case 0:
                                            c = 0;
                                            break;
                                        case 1:
                                        case 3:
                                            c = 20;
                                            break;
                                        case 2:
                                            c = ""
                                    }
                            }
                            if (d = this.xo.find(".value1"),
                                    p = this.xo.find(".value2"),
                                    u = this.xo.find(".value3"),
                                    h = this.xo.find(".value4"),
                                void 0 !== t)
                                switch (t) {
                                    case 1:
                                        d.val(a);
                                        break;
                                    case 2:
                                        p.val(s);
                                        break;
                                    case 3:
                                        u.val(l);
                                        break;
                                    case 4:
                                        h.val(c)
                                }
                            else
                                d.val(a),
                                    p.val(s),
                                    u.val(l),
                                    h.val(c);
                            this.Qs(d.val(), p.val(), u.val(), h.val())
                        }
                        ,
                        a.prototype.Qs = function(e, t, i, o) {
                            var r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I = this.xo.find(".iconSet-dataRow4"), D = this.xo.find(".iconSet-dataRow5");
                            r = !I.hasClass("hidden"),
                                a = !D.hasClass("hidden"),
                                s = this.xo.find(".des2_iconSet"),
                                l = this.xo.find(".des3_iconSet"),
                                c = this.xo.find(".des4_iconSet"),
                                d = this.xo.find(".des5_iconSet"),
                                p = "",
                                u = this.xo.find(".operator1").prop("selectedIndex"),
                            1 === u && (p = " = "),
                                h = "",
                                f = this.xo.find(".operator2").prop("selectedIndex"),
                            1 === f && (h = " = "),
                                g = "",
                                m = this.xo.find(".operator3").prop("selectedIndex"),
                            1 === m && (g = " = "),
                                b = "",
                                v = this.xo.find(".operator4").prop("selectedIndex"),
                            1 === v && (b = " = "),
                                y = this.xo.find(".value1Selector").prop("selectedIndex"),
                                x = this.xo.find(".value2Selector").prop("selectedIndex"),
                                w = this.xo.find(".value3Selector").prop("selectedIndex"),
                                C = this.xo.find(".value4Selector").prop("selectedIndex"),
                                S = 2 === y || e && 0 === e.indexOf("=") ? "Formula" : e,
                                k = 2 === x || t && 0 === t.indexOf("=") ? "Formula" : t,
                                T = 2 === w || i && 0 === i.indexOf("=") ? "Formula" : i,
                                A = 2 === C || o && 0 === o.indexOf("=") ? "Formula" : o,
                            S && s.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + p + S + " " + n.res.conditionalFormatting.common.and),
                            k && (r ? l.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + h + k + " " + n.res.conditionalFormatting.common.and) : l.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + h + k)),
                                a ? (T && c.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + g + T + " " + n.res.conditionalFormatting.common.and),
                                A && d.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + b + A)) : T && c.text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.description2 + g + T)
                        }
                        ,
                        a.prototype.Ts = function(e, t) {
                            var i, o = this.xo.find(".icon1"), r = this.xo.find(".icon2"), a = this.xo.find(".icon3"), s = this.xo.find(".icon4"), l = this.xo.find(".icon5"), c = this.xo.find(".iconStyleIcon"), d = [o, r, a, s, l];
                            if (e) {
                                for (c.removeClass(),
                                         c.addClass("iconStyleIcon").addClass("horizontal-icon-set-item"),
                                         i = 0; i < e.length; i++)
                                    $(c[i]).addClass(e[i]).addClass("iconSetsIcons");
                                this.Ct = e
                            }
                            if (t) {
                                for (i = 0; i < this.Rs.length; i++)
                                    d[i].removeClass(this.Rs[i]);
                                for (i = 0; i < t.length; i++)
                                    d[i].addClass(t[i]),
                                    i >= 3 && d[i].addClass("iconSetsIcons"),
                                        "no-cell-icon" === t[i] ? $(d[i]).next("span").text(n.res.conditionalFormatting.newFormattingRule.formatOnValue.iconSets.noCellIcon) : $(d[i]).next("span").text("");
                                for (this.Rs = t,
                                         i = t.length; i < 5; i++)
                                    switch (i) {
                                        case 3:
                                            s.removeClass("iconSetsIcons");
                                            break;
                                        case 4:
                                            l.removeClass("iconSetsIcons")
                                    }
                            }
                        }
                        ,
                        a.prototype.At = function(e, t, i) {
                            var o = this.xo.find(".previewOfColor23");
                            O.ns(o, e, t, i)
                        }
                        ,
                        a.prototype.Ns = function(e) {
                            var t, i, o, n;
                            switch (this.zt = e,
                                t = this.xo.find(".color23"),
                                i = this.xo.find(".color3"),
                                o = this.xo.find(".dataBar"),
                                n = this.xo.find(".iconSets"),
                                e) {
                                case 0:
                                    t.removeClass("hidden"),
                                        o.addClass("hidden"),
                                        n.addClass("hidden"),
                                        i.addClass("hidden"),
                                        this.At("red", "green");
                                    break;
                                case 1:
                                    t.removeClass("hidden"),
                                        o.addClass("hidden"),
                                        n.addClass("hidden"),
                                        i.removeClass("hidden"),
                                        this.At("red", "yellow", "green");
                                    break;
                                case 2:
                                    t.addClass("hidden"),
                                        o.removeClass("hidden"),
                                        n.addClass("hidden");
                                    break;
                                case 3:
                                    t.addClass("hidden"),
                                        o.addClass("hidden"),
                                        n.removeClass("hidden")
                            }
                        }
                        ,
                        a.prototype.Ws = function(e) {
                            var t = this.xo.find(".iconSet-dataRow4")
                                , i = this.xo.find(".iconSet-dataRow5")
                                , o = this.xo.find(".row3-mayHiddenParts")
                                , n = this.xo.find(".row4-mayHiddenParts");
                            e <= 3 ? (t.addClass("hidden"),
                                i.addClass("hidden"),
                                o.addClass("hidden"),
                                n.addClass("hidden")) : e <= 4 ? (t.removeClass("hidden"),
                                i.addClass("hidden"),
                                o.removeClass("hidden"),
                                n.addClass("hidden")) : (t.removeClass("hidden"),
                                i.removeClass("hidden"),
                                o.removeClass("hidden"),
                                n.removeClass("hidden"))
                        }
                        ,
                        a.prototype.tt = function(e) {
                            var t, i, o, n = this.xo.find(".formatContain-type");
                            n.prop("selectedIndex", 0),
                                n.trigger("change"),
                                t = this.xo.find(".operator"),
                                e ? t.prop("selectedIndex", e) : t.prop("selectedIndex", 0),
                                t.trigger("change"),
                                i = this.xo.find(".textBox-cell1"),
                                i.val(""),
                                o = this.xo.find(".textBox-cell2"),
                                o.val("")
                        }
                        ,
                        a.prototype.Ys = function(e) {
                            var t = this.xo.find(".operator")
                                , i = t[0].options;
                            switch (t.empty(),
                                e) {
                                case 0:
                                    i[0] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.between),
                                        i[1] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.notBetween),
                                        i[2] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.equalTo),
                                        i[3] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.notEqualTo),
                                        i[4] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.greaterThan),
                                        i[5] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.lessThan),
                                        i[6] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.greaterThanOrEqu),
                                        i[7] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_cellValue.lessThanOrEqu);
                                    break;
                                case 1:
                                    i[0] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.containing),
                                        i[1] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.notContaining),
                                        i[2] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.beginningWith),
                                        i[3] = new Option(n.res.conditionalFormatting.newFormattingRule.formatContain.operator_specificText.endingWith);
                                    break;
                                case 2:
                                    i[0] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.yesterday),
                                        i[1] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.today),
                                        i[2] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.tomorrow),
                                        i[3] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.last7days),
                                        i[4] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.lastweek),
                                        i[5] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.thisweek),
                                        i[6] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.nextweek),
                                        i[7] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.lastmonth),
                                        i[8] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.thismonth),
                                        i[9] = new Option(n.res.conditionalFormatting.dateOccurringFormat.date.nextmonth)
                            }
                        }
                        ,
                        a.prototype.Zs = function(e) {
                            var t = this.xo.find(".operator")
                                , i = this.xo.find(".textBox-cell1-container")
                                , o = this.xo.find(".label-and")
                                , n = this.xo.find(".textBox-cell2-container");
                            switch (e) {
                                case 0:
                                case 1:
                                    t.removeClass("hidden"),
                                        i.show(),
                                        o.addClass("hidden"),
                                        n.hide();
                                    break;
                                case 2:
                                    t.removeClass("hidden"),
                                        i.hide(),
                                        o.addClass("hidden"),
                                        n.hide();
                                    break;
                                case 3:
                                case 4:
                                case 5:
                                case 6:
                                    t.addClass("hidden"),
                                        i.hide(),
                                        o.addClass("hidden"),
                                        n.hide()
                            }
                        }
                        ,
                        a.prototype.$s = function(e) {
                            var t = this.xo.find(".textBox-cell1-container")
                                , i = this.xo.find(".label-and")
                                , o = this.xo.find(".textBox-cell2-container");
                            switch (e) {
                                case 0:
                                case 1:
                                    t.show(),
                                        i.removeClass("hidden"),
                                        o.show();
                                    break;
                                default:
                                    t.show(),
                                        i.addClass("hidden"),
                                        o.hide()
                            }
                        }
                        ,
                        a.prototype.vt = function() {
                            var e, t = this.xo.find(".formatRankedValue-type");
                            t.prop("selectedIndex", 0),
                                e = this.xo.find(".itemCounts"),
                                e.spinner({
                                    min: 1,
                                    max: 1e3
                                }),
                                e.val(10)
                        }
                        ,
                        a.prototype.Bt = function(e, t, i) {
                            var o = this.xo.find(".previewOfDatabar");
                            t ? O.ns(o, e, t) : o.css("background", e),
                                i ? o.css("border", "1px solid " + i) : o.css("border-width", "0px")
                        }
                        ,
                        a.prototype.wt = function() {
                            var e = this.xo.find(".formatAbove-type");
                            e.prop("selectedIndex", 0)
                        }
                        ,
                        a.prototype.xt = function() {
                            var e = this.xo.find(".formatUnique-type");
                            e.prop("selectedIndex", 0)
                        }
                        ,
                        a.prototype.yt = function() {
                            var e = this.xo.find(".formula-input");
                            e.val("")
                        }
                        ,
                        a.prototype.ut = function() {
                            var e = this
                                , t = this.xo.find(".format-button");
                            t.button(),
                            void 0 === this.formatCellDialog && (this.formatCellDialog = new n.FormatDialog,
                                $(this.formatCellDialog).on("okClicked", function(t, i) {
                                    var o, r, a, s, l, c;
                                    e.ws = i,
                                    "" !== i.font && void 0 !== i.font && (o = n.wrapper.spread.getActiveSheet(),
                                        r = o.getActiveColumnIndex(),
                                        a = o.getActiveRowIndex(),
                                        s = o.getActualStyle(a, r, 3),
                                        l = $("<span></span>"),
                                        void 0 !== s.font ? ("" !== e.ws.font && (l.css("font", e.ws.font),
                                            c = l.css("font-style")),
                                            l.css("font", s.font),
                                        c && l.css("font-style", c)) : "" !== i.font && l.css("font", i.font + n.res.defaultFont),
                                        e.ws.font = l.css("font")),
                                        e.os()
                                })),
                                this.ws = i,
                                this.os()
                        }
                        ,
                        a.prototype.os = function() {
                            var e = this.xo.find(".preview-common");
                            O.os(e, this.ws)
                        }
                        ,
                        a.prototype.gt = function(e) {
                            var t, i, r, a, s, l, c, d, p, u, h, f, g, m = n.wrapper.spread.getActiveSheet(), b = m.getSelections(), v = this.xo.find(".minSelector"), y = parseInt(v.prop("selectedIndex"));
                            switch (y) {
                                case 0:
                                    t = 1;
                                    break;
                                case 1:
                                    t = 0;
                                    break;
                                case 2:
                                    t = 3;
                                    break;
                                case 3:
                                    t = 6;
                                    break;
                                case 4:
                                    t = 4
                            }
                            switch (r = this.xo.find(".maxSelector"),
                                y = parseInt(r.prop("selectedIndex"))) {
                                case 0:
                                    i = 2;
                                    break;
                                case 1:
                                    i = 0;
                                    break;
                                case 2:
                                    i = 3;
                                    break;
                                case 3:
                                    i = 6;
                                    break;
                                case 4:
                                    i = 4
                            }
                            if (a = 1 === t ? null : this.xo.find(".minValue").val(),
                                    s = 2 === i ? null : this.xo.find(".maxValue").val(),
                                    l = this.xo.find(".min-color-span").css("background-color"),
                                    c = this.xo.find(".max-color-span").css("background-color"),
                                    e) {
                                switch (p = this.xo.find(".midSelector"),
                                    y = parseInt(p.prop("selectedIndex"))) {
                                    case 0:
                                        d = 0;
                                        break;
                                    case 1:
                                        d = 3;
                                        break;
                                    case 2:
                                        d = 6;
                                        break;
                                    case 3:
                                        d = 4
                                }
                                u = this.xo.find(".midValue").val(),
                                    h = this.xo.find(".mid-color-span").css("background-color"),
                                    f = new o.ConditionalFormatting.ScaleRule(11,t,a,l,d,u,h,i,s,c,b),
                                    this.Fs ? this.Hs = f : n.actions.doAction("addRule", n.wrapper.spread, f)
                            } else
                                g = new o.ConditionalFormatting.ScaleRule(10,t,a,l,null,null,null,i,s,c,b),
                                    this.Fs ? this.Hs = g : n.actions.doAction("addRule", n.wrapper.spread, g)
                        }
                        ,
                        a.prototype.ht = function() {
                            var e, t, i, o, r, a, s, l, c, d, p, u, h, f, g, m;
                            switch (n.wrapper.spread.suspendPaint(),
                                e = n.wrapper.spread.getActiveSheet(),
                                t = e.getSelections(),
                                o = this.xo.find(".minSelector2"),
                                r = parseInt(o.prop("selectedIndex"))) {
                                case 0:
                                    i = 1;
                                    break;
                                case 1:
                                    i = 0;
                                    break;
                                case 2:
                                    i = 3;
                                    break;
                                case 3:
                                    i = 6;
                                    break;
                                case 4:
                                    i = 4;
                                    break;
                                case 5:
                                    i = 5
                            }
                            switch (s = this.xo.find(".maxSelector2"),
                                r = parseInt(s.prop("selectedIndex"))) {
                                case 0:
                                    a = 2;
                                    break;
                                case 1:
                                    a = 0;
                                    break;
                                case 2:
                                    a = 3;
                                    break;
                                case 3:
                                    a = 6;
                                    break;
                                case 4:
                                    a = 4;
                                    break;
                                case 5:
                                    a = 7
                            }
                            l = this.xo.find(".minValue2").val(),
                                c = this.xo.find(".maxValue2").val(),
                                d = this.xo.find(".barcolor1-span").css("background-color"),
                                p = this.xo.find(".barcolor2-span").css("background-color"),
                                u = this.xo.find(".showBarOnly").prop("checked"),
                                h = 0 !== this.xo.find(".fillSelector").prop("selectedIndex"),
                                f = 0 !== this.xo.find(".borderSelector").prop("selectedIndex"),
                                g = 0 === this.xo.find(".barDirectionSelector").prop("selectedIndex") ? 0 : 1,
                                m = new GC.Spread.Sheets.ConditionalFormatting.DataBarRule(i,O.parseValue(l),a,O.parseValue(c),d,t),
                                m.showBarOnly(u),
                                m.gradient(h),
                                m.borderColor(p),
                                m.showBorder(f),
                                m.dataBarDirection(g),
                            this.Ms && (m.negativeBorderColor(this.Ms.negativeBorderColor),
                                m.negativeFillColor(this.Ms.negativeFillColor),
                                m.useNegativeBorderColor(this.Ms.useNegativeBorderColor),
                                m.useNegativeFillColor(this.Ms.useNegativeFillColor),
                                m.axisColor(this.Ms.axisColor),
                                m.axisPosition(this.Ms.axisPosition)),
                                this.Fs ? this.Hs = m : n.actions.doAction("addRule", n.wrapper.spread, m),
                                n.wrapper.spread.resumePaint()
                        }
                        ,
                        a.prototype.it = function() {
                            var e, t, i, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D;
                            if (n.wrapper.spread.suspendPaint(),
                                    e = n.wrapper.spread.getActiveSheet(),
                                    t = e.getSelections(),
                                    r = ee(this.Us),
                                    a = this.xo.find(".showIconOnly").prop("checked"),
                                    s = this.xo.find(".reverseIconOrder").prop("checked"),
                                    l = 0 === this.xo.find(".operator1").prop("selectedIndex"),
                                    c = 0 === this.xo.find(".operator2").prop("selectedIndex"),
                                    d = 0 === this.xo.find(".operator3").prop("selectedIndex"),
                                    p = 0 === this.xo.find(".operator4").prop("selectedIndex"),
                                    u = parseInt(this.xo.find(".value1Selector").prop("selectedIndex")),
                                    h = this.ft(u),
                                    f = parseInt(this.xo.find(".value2Selector").prop("selectedIndex")),
                                    g = this.ft(f),
                                    m = parseInt(this.xo.find(".value3Selector").prop("selectedIndex")),
                                    b = this.ft(m),
                                    v = parseInt(this.xo.find(".value4Selector").prop("selectedIndex")),
                                    y = this.ft(v),
                                    x = this.xo.find(".value1").val(),
                                    w = this.xo.find(".value2").val(),
                                    C = this.xo.find(".value3").val(),
                                    S = this.xo.find(".value4").val(),
                                    k = this.xo.find(".iconSet-dataRow4"),
                                    T = this.xo.find(".iconSet-dataRow5"),
                                    i = new o.ConditionalFormatting.IconSetRule(r,t),
                                    i.showIconOnly(a),
                                    i.reverseIconOrder(s),
                                    A = i.iconCriteria(),
                                    T.hasClass("hidden") || k.hasClass("hidden") ? k.hasClass("hidden") ? (A[0] = 7 !== g ? new o.ConditionalFormatting.IconCriterion(c,g,O.parseValue(w)) : new o.ConditionalFormatting.IconCriterion(c,g,w),
                                        A[1] = 7 !== h ? new o.ConditionalFormatting.IconCriterion(l,h,O.parseValue(x)) : new o.ConditionalFormatting.IconCriterion(l,h,x)) : (A[0] = 7 !== b ? new o.ConditionalFormatting.IconCriterion(d,b,O.parseValue(C)) : new o.ConditionalFormatting.IconCriterion(d,b,C),
                                        A[1] = 7 !== g ? new o.ConditionalFormatting.IconCriterion(c,g,O.parseValue(w)) : new o.ConditionalFormatting.IconCriterion(c,g,w),
                                        A[2] = 7 !== h ? new o.ConditionalFormatting.IconCriterion(l,h,O.parseValue(x)) : new o.ConditionalFormatting.IconCriterion(l,h,x)) : (A[0] = 7 !== y ? new o.ConditionalFormatting.IconCriterion(p,y,O.parseValue(S)) : new o.ConditionalFormatting.IconCriterion(p,y,S),
                                        A[1] = 7 !== b ? new o.ConditionalFormatting.IconCriterion(d,b,O.parseValue(C)) : new o.ConditionalFormatting.IconCriterion(d,b,C),
                                        A[2] = 7 !== g ? new o.ConditionalFormatting.IconCriterion(c,g,O.parseValue(w)) : new o.ConditionalFormatting.IconCriterion(c,g,w),
                                        A[3] = 7 !== h ? new o.ConditionalFormatting.IconCriterion(l,h,O.parseValue(x)) : new o.ConditionalFormatting.IconCriterion(l,h,x)),
                                this.Vs && this.Ss && this.Ss.length > 0)
                                for (i.Vs = !0,
                                         I = i.icons(),
                                     s || this.Ss.reverse(),
                                         D = 0; D < this.Ss.length; D++)
                                    I[D] = {
                                        iconSetType: this.Ss[D].iconSetType,
                                        iconIndex: this.Ss[D].iconIndex
                                    };
                            this.Fs ? this.Hs = i : n.actions.doAction("addRule", n.wrapper.spread, i),
                                n.wrapper.spread.resumePaint()
                        }
                        ,
                        a.prototype.jt = function() {
                            var e, t, i, o, r = n.wrapper.spread.getActiveSheet(), a = r.getSelections(), s = this.xo.find(".operator"), l = parseInt(s.prop("selectedIndex"));
                            switch (l) {
                                case 0:
                                    t = 6;
                                    break;
                                case 1:
                                    t = 7;
                                    break;
                                case 2:
                                    t = 0;
                                    break;
                                case 3:
                                    t = 1;
                                    break;
                                case 4:
                                    t = 2;
                                    break;
                                case 5:
                                    t = 4;
                                    break;
                                case 6:
                                    t = 3;
                                    break;
                                case 7:
                                    t = 5
                            }
                            i = this.Oo(this.xo, 1),
                                o = this.Oo(this.xo, 2),
                                e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(1,a,this.ws,t,i,o),
                                this.Fs ? this.Hs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                        }
                        ,
                        a.prototype.kt = function() {
                            var e, t, i, o = n.wrapper.spread.getActiveSheet(), r = o.getSelections(), a = this.xo.find(".operator"), s = parseInt(a.prop("selectedIndex"));
                            switch (s) {
                                case 0:
                                    t = 0;
                                    break;
                                case 1:
                                    t = 1;
                                    break;
                                case 2:
                                    t = 2;
                                    break;
                                case 3:
                                    t = 3
                            }
                            i = this.Oo(this.xo, 1),
                                e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(2,r,this.ws,t,null,null,i),
                                this.Fs ? this.Hs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                        }
                        ,
                        a.prototype.lt = function() {
                            var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getSelections(), r = parseInt(this.xo.find(".operator").prop("selectedIndex"));
                            switch (r) {
                                case 0:
                                    e = 1;
                                    break;
                                case 1:
                                    e = 0;
                                    break;
                                case 2:
                                    e = 2;
                                    break;
                                case 3:
                                    e = 3;
                                    break;
                                case 4:
                                    e = 8;
                                    break;
                                case 5:
                                    e = 7;
                                    break;
                                case 6:
                                    e = 9;
                                    break;
                                case 7:
                                    e = 5;
                                    break;
                                case 8:
                                    e = 4;
                                    break;
                                case 9:
                                    e = 6
                            }
                            t = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(4,o,this.ws,null,null,null,null,null,e),
                                this.Fs ? this.Hs = t : n.actions.doAction("addRule", n.wrapper.spread, t)
                        }
                        ,
                        a.prototype.nt = function(e) {
                            var i, r, a, s, l = n.wrapper.spread.getActiveSheet(), c = l.getSelections();
                            switch (c.length > 1 && t.show(n.res.conditionalFormatting.exceptions.e6, n.res.title, 2),
                                i = c[0],
                                r = o.CalcEngine.rangeToFormula(i, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute),
                                e) {
                                case 3:
                                    a = "ISBLANK(" + r + ")";
                                    break;
                                case 4:
                                    a = "NOT(ISBLANK(" + r + "))";
                                    break;
                                case 5:
                                    a = "ISERROR(" + r + ")";
                                    break;
                                case 6:
                                    a = "NOT(ISERROR(" + r + "))"
                            }
                            s = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(3,c,this.ws,null,null,null,null,"=" + a),
                                this.Fs ? this.Hs = s : n.actions.doAction("addRule", n.wrapper.spread, s)
                        }
                        ,
                        a.prototype.ot = function() {
                            var e = n.wrapper.spread.getActiveSheet()
                                , t = e.getSelections()
                                , i = 0 === this.xo.find(".formatRankedValue-type").prop("selectedIndex") ? 0 : 1
                                , o = this.xo.find(".itemCounts").val()
                                , r = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(5,t,this.ws,null,null,null,null,null,i,o);
                            this.Fs ? this.Hs = r : n.actions.doAction("addRule", n.wrapper.spread, r)
                        }
                        ,
                        a.prototype.pt = function() {
                            var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getSelections(), r = parseInt(this.xo.find(".formatAbove-type").prop("selectedIndex"));
                            switch (r) {
                                case 0:
                                    t = 0;
                                    break;
                                case 1:
                                    t = 1;
                                    break;
                                case 2:
                                    t = 2;
                                    break;
                                case 3:
                                    t = 3;
                                    break;
                                case 4:
                                    t = 4;
                                    break;
                                case 5:
                                    t = 5;
                                    break;
                                case 6:
                                    t = 6;
                                    break;
                                case 7:
                                    t = 7;
                                    break;
                                case 8:
                                    t = 8;
                                    break;
                                case 9:
                                    t = 9
                            }
                            e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(8,o,this.ws,null,null,null,null,null,t),
                                this.Fs ? this.Hs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                        }
                        ,
                        a.prototype.qt = function() {
                            var e, t = n.wrapper.spread.getActiveSheet(), i = t.getSelections(), o = parseInt(this.xo.find(".formatUnique-type").prop("selectedIndex"));
                            switch (o) {
                                case 0:
                                    e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(7,i,this.ws);
                                    break;
                                case 1:
                                    e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(6,i,this.ws)
                            }
                            this.Fs ? this.Hs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                        }
                        ,
                        a.prototype.rt = function() {
                            var e, t = n.wrapper.spread.getActiveSheet(), i = t.getSelections(), o = this.xo.find(".formula-input").val();
                            o = this.No(o),
                                e = new GC.Spread.Sheets.ConditionalFormatting.NormalConditionRule(3,i,this.ws,null,null,null,null,o),
                                this.Fs ? this.Hs = e : n.actions.doAction("addRule", n.wrapper.spread, e)
                        }
                        ,
                        a.prototype.Dt = function(e) {
                            var t = n.wrapper.spread.getActiveSheet();
                            return GC.Spread.Sheets.CalcEngine.evaluateFormula(t, e, t.getActiveRowIndex(), t.getActiveColumnIndex(), !1)
                        }
                        ,
                        a
                }(n.BaseDialog),
                    n.NewFormattingRuleDialog = Y,
                    X = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".format-rules-manager-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                title: n.res.formattingRulesManagerDialog.title,
                                width: "auto",
                                resizable: !1,
                                modal: !0,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        n.actions.isFileModified = !0,
                                            e.Et(),
                                            n.wrapper.spread.suspendPaint(),
                                            e.close()
                                    }
                                }, {
                                    text: n.res.close,
                                    click: function() {
                                        e.close()
                                    }
                                }, {
                                    text: n.res.apply,
                                    click: function() {
                                        e.Et(),
                                            n.wrapper.spread.suspendPaint()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Et = function() {
                                var e, t, i;
                                if (void 0 !== this.Ft) {
                                    e = n.wrapper.spread.getActiveSheet(),
                                        t = e.conditionalFormats;
                                    try {
                                        i = {
                                            formats: t,
                                            tempFormats: $.extend(!0, {}, this.Ft)
                                        },
                                            n.actions.doAction("baseDialogCommand", n.wrapper.spread, {
                                                value: i,
                                                execute: n.spreadActions.dialogAction.managerRulesApplySetting
                                            })
                                    } catch (e) {
                                        throw n.wrapper.spread.resumePaint(),
                                            e
                                    }
                                    n.wrapper.spread.resumePaint()
                                }
                            }
                            ,
                            t.prototype.Co = function() {
                                var e, t = n.wrapper.spread.getActiveSheet().conditionalFormats, i = t.getRules().concat();
                                for (t.clearRule(),
                                         e = 0; e < i.length; e++)
                                    t.addRule(i[e]);
                                n.wrapper.spread.resumePaint()
                            }
                            ,
                            t.prototype.Gt = function() {
                                var e = this;
                                $("#new-rule").on("click", function() {
                                    e.Ht(),
                                        e.close()
                                }),
                                    $("#edit-rule").on("click", function() {
                                        0 !== $(".format-rules-grid-body .ui-state-default").length && (e.It(),
                                            e.close())
                                    }),
                                    $("#delete-rule").on("click", function() {
                                        return e.Jt()
                                    }),
                                    $("#format-rule-move-up").on("click", function() {
                                        return e.Kt(!0)
                                    }),
                                    $("#format-rule-move-down").on("click", function() {
                                        return e.Kt(!1)
                                    })
                            }
                            ,
                            t.prototype.Ht = function() {
                                var e = this;
                                e.Lt || (e.Lt = new Y,
                                    $(e.Lt).on("dialogClose", function(t, i) {
                                        i.isCloseByOK && e.Ft.addRule(i.rule),
                                            e.Lt = null,
                                            e.open(!0)
                                    })),
                                    e.Lt.open(0, !0, 0, !0)
                            }
                            ,
                            t.prototype.It = function() {
                                var e, t, i, n, r, a;
                                void 0 !== this.Ft && 0 !== this.Ft.count() && (e = $(".format-rules-grid-body .ui-state-default").index(),
                                    t = this.Ft.count() - 1 - e,
                                    i = this.Ft.getRule(t),
                                    i.ruleType() === o.ConditionalFormatting.RuleType.cellValueRule ? n = 1 : i.ruleType() === o.ConditionalFormatting.RuleType.specificTextRule ? n = 1 : i.ruleType() === o.ConditionalFormatting.RuleType.dateOccurringRule ? n = 1 : i.ruleType() === o.ConditionalFormatting.RuleType.duplicateRule ? n = 4 : i.ruleType() === o.ConditionalFormatting.RuleType.uniqueRule ? n = 4 : i.ruleType() === o.ConditionalFormatting.RuleType.top10Rule ? n = 2 : i.ruleType() === o.ConditionalFormatting.RuleType.averageRule ? n = 3 : i.ruleType() === o.ConditionalFormatting.RuleType.dataBarRule ? (n = 0,
                                        r = 2) : i.ruleType() === o.ConditionalFormatting.RuleType.twoScaleRule ? (n = 0,
                                        r = 0) : i.ruleType() === o.ConditionalFormatting.RuleType.threeScaleRule ? (n = 0,
                                        r = 1) : i.ruleType() === o.ConditionalFormatting.RuleType.iconSetRule ? (n = 0,
                                        r = 3) : i.ruleType() === o.ConditionalFormatting.RuleType.formulaRule && (n = O.qs(i).ruleType),
                                    a = this,
                                a.Mt || (a.Mt = new Y,
                                    $(a.Mt).on("dialogClose", function(e, t) {
                                        if (t.isCloseByOK) {
                                            var o = a.Ft.getRules().indexOf(i);
                                            a.Ft.getRules()[o] = t.rule
                                        }
                                        a.Mt = null,
                                            a.open(!0)
                                    })),
                                    a.Mt.open(n, !1, r, !0, i))
                            }
                            ,
                            t.prototype.Jt = function() {
                                var e, t;
                                void 0 !== this.Ft && 0 !== this.Ft.count() && -1 !== (e = $(".format-rules-grid-body .ui-state-default").index()) && (t = this.Ft.count() - 1 - e,
                                    this.Ft.removeRule(this.Ft.getRule(t)),
                                    this.Nt())
                            }
                            ,
                            t.prototype.Kt = function(e) {
                                var t, i, o, n = $(".format-rules-grid-body .ui-state-default").index();
                                if (!(0 === n && e || n === this.Ft.count() - 1 && !e)) {
                                    if (t = $.extend(!0, {}, this.Ft),
                                            this.Ft.clearRule(),
                                            i = t.count() - 1 - n,
                                            e)
                                        for (o = 0; o < t.count(); o++)
                                            o === i ? this.Ft.addRule(t.getRule(i + 1)) : o === i + 1 ? this.Ft.addRule(t.getRule(i)) : this.Ft.addRule(t.getRule(o));
                                    else
                                        for (o = 0; o < t.count(); o++)
                                            o === i ? this.Ft.addRule(t.getRule(i - 1)) : o === i - 1 ? this.Ft.addRule(t.getRule(i)) : this.Ft.addRule(t.getRule(o));
                                    this.Nt(),
                                        e ? $(".format-rules-grid-body tr:eq(" + (n - 1) + ")").addClass("ui-state-default") : $(".format-rules-grid-body tr:eq(" + (n + 1) + ")").addClass("ui-state-default")
                                }
                            }
                            ,
                            t.prototype._init = function() {
                                this.Gt()
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, o, r, a, s = e[0];
                                if (n.wrapper.spread.suspendPaint(),
                                        t = n.wrapper.spread.getActiveSheet(),
                                        i = t.conditionalFormats,
                                        !s)
                                    for (this.Ft = new GC.Spread.Sheets.ConditionalFormatting.ConditionalFormats(t),
                                             this.Ft.fromJSON(i.toJSON()),
                                             o = i.getRules(),
                                             r = this.Ft.getRules(),
                                             a = 0; a < o.length; a++)
                                        r[a].Vs = o[a].Vs;
                                this.Nt()
                            }
                            ,
                            t.prototype.Ot = function(e) {
                                var t = n.wrapper.spread.getActiveSheet()
                                    , i = GC.Spread.Sheets.CalcEngine.formulaToExpression(t, e, 0, 0);
                                return i.type === GC.Spread.CalcEngine.ExpressionType.reference ? i.getRange(0, 0) : null
                            }
                            ,
                            t.prototype.Pt = function(e, t) {
                                var i, n, r = this;
                                e.on("click", function(t) {
                                    $(".format-rules-grid-body tr").removeClass("ui-state-default"),
                                        e.addClass("ui-state-default")
                                }),
                                    e.on("dblclick", function(e) {
                                        r.It(),
                                            r.close()
                                    }),
                                    i = function(e) {
                                        var i, n, a = e.currentTarget, s = a.value, l = s.slice(1).split(",");
                                        for (i = 0; i < t.ranges().length; i++)
                                            t.ranges().pop();
                                        for (i = 0; i < l.length; i++)
                                            n = r.Ot(l[i]),
                                                t.ranges().unshift(new o.Range(n.row,n.col,n.rowCount,n.colCount))
                                    }
                                    ,
                                    n = function(e) {
                                        var i = e.currentTarget;
                                        t.stopIfTrue(i.checked)
                                    }
                                    ,
                                    e.find("input[type!=checkbox]").on("change", function(e) {
                                        return i(e)
                                    }),
                                    e.find("input[type=checkbox]").on("change", function(e) {
                                        return n(e)
                                    })
                            }
                            ,
                            t.prototype.Nt = function() {
                                var e, t, i, r, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k;
                                for ($(".format-rules-grid-body").empty(),
                                         e = n.wrapper.spread.getActiveSheet(),
                                         t = e.getActiveRowIndex(),
                                         i = e.getActiveColumnIndex(),
                                         r = this.Ft.getRules(),
                                         s = r.length - 1; s >= 0; s--) {
                                    if (l = $("<tr>"),
                                            c = $("<td>"),
                                            d = $("<td>"),
                                            p = $("<div>"),
                                            u = $("<td>"),
                                            h = $("<input>"),
                                            f = $("<td>"),
                                            g = $("<input>"),
                                            g.prop("type", "checkbox"),
                                            m = n.res.formattingRulesManagerDialog.ruleDescriptions,
                                        r[s].ruleType() === o.ConditionalFormatting.RuleType.cellValueRule) {
                                        switch (b = r[s].value1(t, i),
                                            v = r[s].value2(t, i),
                                            r[s].operator()) {
                                            case 6:
                                                a = n.util.format(m.valueBetween, b, v);
                                                break;
                                            case 0:
                                                a = n.util.format(m.valueEquals, b);
                                                break;
                                            case 2:
                                                a = n.util.format(m.valueGreateThan, b);
                                                break;
                                            case 3:
                                                a = n.util.format(m.valueGreateThanOrEquals, b);
                                                break;
                                            case 4:
                                                a = n.util.format(m.valueLessThan, b);
                                                break;
                                            case 5:
                                                a = n.util.format(m.valueLessThanOrEquals, b);
                                                break;
                                            case 7:
                                                a = n.util.format(m.valueNotBetween, b, v);
                                                break;
                                            case 1:
                                                a = n.util.format(m.valueNotEquals, b)
                                        }
                                        c.text(a),
                                            p.text(n.res.formattingRulesManagerDialog.previewText),
                                            O.os(p, r[s].style())
                                    } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.specificTextRule) {
                                        switch (r[s].operator()) {
                                            case 2:
                                                a = n.util.format(m.valueBeginsWith, r[s].text());
                                                break;
                                            case 0:
                                                a = n.util.format(m.valueContains, r[s].text());
                                                break;
                                            case 1:
                                                a = n.util.format(m.valueNotContains, r[s].text());
                                                break;
                                            case 3:
                                                a = n.util.format(m.valueEndsWith, r[s].text())
                                        }
                                        c.text(a),
                                            p.text(n.res.formattingRulesManagerDialog.previewText),
                                            O.os(p, r[s].style())
                                    } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.dateOccurringRule) {
                                        switch (r[s].type()) {
                                            case 3:
                                                a = m.last7Days;
                                                break;
                                            case 5:
                                                a = m.lastMonth;
                                                break;
                                            case 8:
                                                a = m.lastWeek;
                                                break;
                                            case 6:
                                                a = m.nextMonth;
                                                break;
                                            case 9:
                                                a = m.nextWeek;
                                                break;
                                            case 4:
                                                a = m.thisMonth;
                                                break;
                                            case 7:
                                                a = m.thisWeek;
                                                break;
                                            case 0:
                                                a = m.today;
                                                break;
                                            case 2:
                                                a = m.tomorrow;
                                                break;
                                            case 1:
                                                a = m.yesterday
                                        }
                                        c.text(a),
                                            p.text(n.res.formattingRulesManagerDialog.previewText),
                                            O.os(p, r[s].style())
                                    } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.duplicateRule)
                                        c.text(m.duplicateValues),
                                            p.text(n.res.formattingRulesManagerDialog.previewText),
                                            O.os(p, r[s].style());
                                    else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.uniqueRule)
                                        c.text(m.uniqueValues),
                                            p.text(n.res.formattingRulesManagerDialog.previewText),
                                            O.os(p, r[s].style());
                                    else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.top10Rule) {
                                        switch (r[s].type()) {
                                            case 0:
                                                a = n.util.format(m.top, r[s].rank());
                                                break;
                                            case 1:
                                                a = n.util.format(m.bottom, r[s].rank())
                                        }
                                        c.text(a),
                                            p.text(n.res.formattingRulesManagerDialog.previewText),
                                            O.os(p, r[s].style())
                                    } else if (r[s].ruleType() === o.ConditionalFormatting.RuleType.averageRule) {
                                        switch (r[s].type()) {
                                            case 0:
                                                a = m.above;
                                                break;
                                            case 4:
                                                a = m.above1StdDev;
                                                break;
                                            case 6:
                                                a = m.above2StdDev;
                                                break;
                                            case 8:
                                                a = m.above3StdDev;
                                                break;
                                            case 1:
                                                a = m.below;
                                                break;
                                            case 5:
                                                a = m.below1StdDev;
                                                break;
                                            case 7:
                                                a = m.below2StdDev;
                                                break;
                                            case 9:
                                                a = m.below3StdDev;
                                                break;
                                            case 2:
                                                a = m.equalOrAbove;
                                                break;
                                            case 3:
                                                a = m.equalOrBelow
                                        }
                                        c.text(a),
                                            p.text(n.res.formattingRulesManagerDialog.previewText),
                                            O.os(p, r[s].style())
                                    } else
                                        r[s].ruleType() === o.ConditionalFormatting.RuleType.dataBarRule ? (c.text(m.dataBar),
                                        r[s].showBorder() && p.css("border", "1px solid " + r[s].borderColor()),
                                            r[s].gradient() ? O.ns(p, r[s].color(), "white") : p.css("background-color", r[s].color()),
                                            g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.twoScaleRule ? (c.text(m.twoScale),
                                            O.ns(p, r[s].minColor(), r[s].maxColor()),
                                            g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.threeScaleRule ? (c.text(m.threeScale),
                                            O.ns(p, r[s].minColor(), r[s].midColor(), r[s].maxColor()),
                                            g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.iconSetRule ? (c.text(m.iconSet),
                                            r[s].icons() ? (y = r[s].icons().concat(),
                                            r[s].reverseIconOrder() && y.reverse(),
                                                O.ts(p, y, {
                                                    margin: "2px 0 0 2px"
                                                })) : O.rs(p, r[s].iconSetType(), {
                                                margin: "2px 0 0 2px"
                                            }, r[s].reverseIconOrder()),
                                            g.prop("disabled", "disabled")) : r[s].ruleType() === o.ConditionalFormatting.RuleType.formulaRule && (c.text(n.util.format(m.formula, r[s].formula())),
                                            O.os(p, r[s].style()));
                                    for (x = "",
                                             w = r[s].ranges(),
                                             C = 0; C < w.length; C++)
                                        S = w[C],
                                            k = o.CalcEngine.rangeToFormula(S, 0, 0, o.CalcEngine.RangeReferenceRelative.allAbsolute),
                                            x += k + ",";
                                    h.val("=" + k),
                                        u.append(h),
                                        g.prop("checked", r[s].stopIfTrue()),
                                        f.append(g),
                                        p.css({
                                            width: "100%",
                                            height: "20px"
                                        }).appendTo(d),
                                        c.addClass("rule-column"),
                                        d.addClass("format-column"),
                                        u.addClass("applies-to-column"),
                                        f.addClass("stop-if-true-column"),
                                        l.append([c, d, u, f]),
                                        l.appendTo($(".format-rules-grid-body")),
                                        this.Pt(l, r[s])
                                }
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.FormatRulesManagerDialog = X,
                    J = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".password-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: n.res.passwordDialog.title,
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.xo.find("[name=password]").val();
                                        void 0 === e.Ao[2] && (e.Ao[2] = {}),
                                            e.Ao[2].password = t,
                                            n.actions.openOtherFormat.apply(e, e.Ao),
                                            e.close()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.close(),
                                            n.wrapper.setFocusToSpread()
                                    }
                                }],
                                width: 350
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                this.xo.find("[name=password]").val(""),
                                    this.xo.find("#passwordMessage").text(this.Ao[4])
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.PasswordDialog = J,
                    n.Helper = e,
                    Q = function(e) {
                        n.extends(t, e);
                        function t(t, i) {
                            e.call(this, r, ".range-select-dialog"),
                                this.cq = t,
                                this.Qt = i
                        }
                        return t.prototype.wo = function() {
                            return {
                                resizable: !1,
                                modal: !1,
                                width: 460,
                                height: 80
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this.Qt || {};
                                e.rangeSelectMode = !0,
                                    this.Ap = new GC.Spread.Sheets.FormulaTextBox.FormulaTextBox(this.xo.find("#rangeSelect")[0],e)
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t = n.wrapper.spread;
                                this.$q = t.getActiveSheetIndex(),
                                    this.xo.dialog("option", "title", e[0]),
                                    this.Ap.workbook(n.wrapper.spread),
                                    this.dq = e[1],
                                    this.Ap.startSelectMode(e[2]),
                                    t.bind("RangeSelectEnding", this, this.Rt),
                                    $(document).bind("keydown", this, this.St)
                            }
                            ,
                            t.prototype.Rt = function(e) {
                                var t = e.data;
                                t.close()
                            }
                            ,
                            t.prototype.St = function(e) {
                                var t = e.data;
                                "Enter" === e.key && t.close()
                            }
                            ,
                            t.prototype.Co = function() {
                                var e, t, i = n.wrapper.spread;
                                i.unbind("RangeSelectEnding", this.Rt),
                                    $(document).unbind("keydown", this.St),
                                    i.setActiveSheetIndex(this.$q),
                                this.cq && this.cq.show(),
                                this.dq && (e = this.Ao[3] || [],
                                    t = this.Tt(this.Ap.text()),
                                    e.push(t),
                                    this.dq.apply(this.cq, e)),
                                    this.Ap.endSelectMode(),
                                    this.Ap.workbook(null)
                            }
                            ,
                            t.prototype.Tt = function(e) {
                                var t, i;
                                return e.length > 1 && "=" === (t = e.slice(0, 1)) && (i = e.slice(1, e.length),
                                    isFinite(i)) ? i : e
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.RangeSelectDialog = Q,
                    Z = function(e) {
                        n.extends(t, e);
                        function t() {
                            e.call(this, r, ".save-as-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this
                                , t = {
                                title: n.res.saveAsDialog.title,
                                resizable: !1,
                                width: 280,
                                modal: !0,
                                close: function() {
                                    var t = e.Zh;
                                    t && t({
                                        fileName: e.$saveFileName.val().trim(),
                                        cancelled: e.Ut
                                    })
                                },
                                buttons: [{
                                    text: n.res.ok,
                                    click: function() {
                                        var t = e.$saveFileName.val().trim();
                                        t ? (e.Ut = !1,
                                            e.close()) : e.$saveFileName.focus()
                                    }
                                }, {
                                    text: n.res.cancel,
                                    click: function() {
                                        e.Ut = !0,
                                            e.close()
                                    }
                                }]
                            };
                            return t
                        }
                            ,
                            t.prototype.Bo = function(e) {
                                if (this.$saveFileName || (this.$saveFileName = $("#saveAsFileName")),
                                        this.$saveFileName.val(""),
                                    e && e[0]) {
                                    var t = e[0];
                                    $("#saveAsFileExtension").text(t.fileExtension),
                                        this.Zh = t.done
                                }
                            }
                            ,
                            t
                    }(n.BaseDialog),
                    n.SaveAsDialog = Z
            }()
        }
        , function(e, t) {
            var i = void 0
                , o = GC.Spread
                , n = o.Sheets
                , r = n.Designer;
            !function() {
                "use strict";
                var e, t, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D, F, L, R, B, N, E, V, P, z, j, M, O, G, H = r.util.resolveHtmlPath("../dialogs", "dialogs2.html"), U = function() {
                    function e() {}
                    return e.parseColorExpression = function(e, t, i) {
                        var a, s;
                        if (!e)
                            return null;
                        if (a = r.wrapper.spread.getActiveSheet(),
                            e.type === o.CalcEngine.ExpressionType.string)
                            return e.value;
                        if (e.type === o.CalcEngine.ExpressionType.missingArgument)
                            return null;
                        s = null;
                        try {
                            s = r.util.unParseFormula(e, t, i)
                        } catch (e) {}
                        return n.CalcEngine.evaluateFormula(a, s, t, i)
                    }
                        ,
                        e
                }(), W = function(e) {
                    r.extends(t, e);
                    function t() {
                        e.call(this, H, ".fill-dialog")
                    }
                    return t.prototype.wo = function() {
                        var e = this;
                        return {
                            width: "auto",
                            title: r.res.seriesDialog.series,
                            modal: !0,
                            buttons: [{
                                text: r.res.ok,
                                click: function() {
                                    e.fill(),
                                        e.close(),
                                        r.wrapper.setFocusToSpread()
                                }
                            }, {
                                text: r.res.cancel,
                                click: function() {
                                    e.close(),
                                        r.wrapper.setFocusToSpread()
                                }
                            }]
                        }
                    }
                        ,
                        t.prototype._init = function() {
                            this.Vt = this.xo.find("#series-columns"),
                                this.Wt = this.xo.find("#series-rows"),
                                this.Xt = this.xo.find("#type-linear"),
                                this.Yt = this.xo.find("#type-growth"),
                                this.Zt = this.xo.find("#type-date"),
                                this.$t = this.xo.find("#type-autofill"),
                                this._t = this.xo.find("#date-day"),
                                this.au = this.xo.find("#date-weekday"),
                                this.bu = this.xo.find("#date-month"),
                                this.cu = this.xo.find("#date-year"),
                                this.du = this.xo.find("#series-trend"),
                                this.eu = this.xo.find("#step-value"),
                                this.fu = this.xo.find("#stop-value"),
                                this.gu = 0,
                                this.hu = 1,
                                this.iu = 0,
                                this.Vt.prop("checked", !0),
                                this.Xt.prop("checked", !0),
                                this._t.prop("checked", !0),
                                this.eu.val(1),
                                this.ju();
                            var e = this;
                            this.Vt.on("click", function() {
                                e.gu = 0
                            }),
                                this.Wt.on("click", function() {
                                    e.gu = 1
                                }),
                                this.Xt.on("click", function() {
                                    e.du.prop("checked") || (e.ju(),
                                        e.ku()),
                                        e.hu = 1
                                }),
                                this.Yt.on("click", function() {
                                    e.du.prop("checked") || (e.ju(),
                                        e.ku()),
                                        e.hu = 2
                                }),
                                this.$t.on("click", function() {
                                    e.ju(),
                                        e.lu(),
                                        e.hu = 4
                                }),
                                this.Zt.on("click", function() {
                                    e.mu(),
                                        e.mu(),
                                        e.hu = 3
                                }),
                                this.du.on("change", function() {
                                    $(this).prop("checked") ? e.nu() : e.ou()
                                }),
                                this._t.on("click", function() {
                                    e.iu = 0
                                }),
                                this.au.on("click", function() {
                                    e.iu = 1
                                }),
                                this.bu.on("click", function() {
                                    e.iu = 2
                                }),
                                this.cu.on("click", function() {
                                    e.iu = 3
                                })
                        }
                        ,
                        t.prototype.ju = function() {
                            this._t.attr("disabled", "disabled"),
                                this.au.attr("disabled", "disabled"),
                                this.bu.attr("disabled", "disabled"),
                                this.cu.attr("disabled", "disabled")
                        }
                        ,
                        t.prototype.mu = function() {
                            this._t.removeAttr("disabled"),
                                this.au.removeAttr("disabled"),
                                this.bu.removeAttr("disabled"),
                                this.cu.removeAttr("disabled")
                        }
                        ,
                        t.prototype.lu = function() {
                            this.eu.attr("disabled", "disabled"),
                                this.fu.attr("disabled", "disabled")
                        }
                        ,
                        t.prototype.ku = function() {
                            this.eu.removeAttr("disabled"),
                                this.fu.removeAttr("disabled")
                        }
                        ,
                        t.prototype.ou = function() {
                            this.Zt.removeAttr("disabled"),
                                this.$t.removeAttr("disabled"),
                                this.ku()
                        }
                        ,
                        t.prototype.nu = function() {
                            this.Xt.prop("checked", !0),
                                this.Xt.removeAttr("disabled"),
                                this.Yt.removeAttr("disabled"),
                                this.Zt.attr("disabled", "disabled"),
                                this.$t.attr("disabled", "disabled"),
                                this.ju(),
                                this.lu()
                        }
                        ,
                        t.prototype.fill = function() {
                            var e, t, i, o, a, s, l, c, d, p = r.wrapper.spread, u = p.getActiveSheet();
                            for (u.suspendPaint(),
                                     u.suspendCalcService(),
                                     e = u.getSelections(),
                                     t = [],
                                     i = 0; i < e.length; i++) {
                                if (a = e[i],
                                        o = 0 === this.gu ? new n.Range(a.row,a.col,1,a.colCount) : new n.Range(a.row,a.col,a.rowCount,1),
                                        this.du.prop("checked"))
                                    switch (this.hu) {
                                        case 1:
                                            s = {
                                                fillType: 1,
                                                series: this.gu
                                            };
                                            break;
                                        case 2:
                                            s = {
                                                fillType: 2,
                                                series: this.gu
                                            }
                                    }
                                else
                                    switch (l = +this.eu.val(),
                                        c = this.fu.val(),
                                        this.hu) {
                                        case 1:
                                            c ? (c = +this.fu.val(),
                                                s = {
                                                    fillType: 1,
                                                    series: this.gu,
                                                    step: l,
                                                    stop: c
                                                }) : s = {
                                                fillType: 1,
                                                series: this.gu,
                                                step: l
                                            };
                                            break;
                                        case 2:
                                            c ? (c = +this.fu.val(),
                                                s = {
                                                    fillType: 2,
                                                    series: this.gu,
                                                    step: l,
                                                    stop: c
                                                }) : s = {
                                                fillType: 2,
                                                series: this.gu,
                                                step: l
                                            };
                                            break;
                                        case 4:
                                            s = {
                                                fillType: 4,
                                                series: this.gu
                                            };
                                            break;
                                        case 3:
                                            c ? (c = +this.fu.val(),
                                                s = {
                                                    fillType: 3,
                                                    series: this.gu,
                                                    step: l,
                                                    stop: c,
                                                    unit: this.iu
                                                }) : s = {
                                                fillType: 3,
                                                series: this.gu,
                                                step: l,
                                                unit: this.iu
                                            }
                                    }
                                d = {
                                    startRange: o,
                                    wholeRange: a,
                                    fillAutoOptions: s
                                },
                                    t.push(d)
                            }
                            r.actions.doAction("autoFillByDirection", p, t),
                                u.resumePaint(),
                                u.resumeCalcService()
                        }
                        ,
                        t
                }(r.BaseDialog);
                r.FillDialog = W,
                    e = function(e) {
                        r.extends(t, e);
                        function t(t) {
                            e.call(this, H, ".sort-option-dialog"),
                                this.pu = t
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.customSortDialog.sortOptions,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.pu.qu(e.ru),
                                            e.close()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                this.ru = !0,
                                    this.xo.find("#sort-byrows").prop("checked", !0).click(function() {
                                        e.ru = !0
                                    }),
                                    this.xo.find("#sort-bycols").click(function() {
                                        e.ru = !1
                                    })
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.SortOptionDialog = e,
                    t = function(t) {
                        r.extends(i, t);
                        function i() {
                            t.call(this, H, ".sort-dialog")
                        }
                        return i.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.customSortDialog.sort,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.sort(),
                                            e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            i.prototype.Bo = function() {
                                this.su = this.tu(),
                                    this.xo.find(".sort-infolist").empty(),
                                    this.uu()
                            }
                            ,
                            i.prototype.tu = function() {
                                var e, t, i, o, n, a, s = r.wrapper.spread.getActiveSheet(), l = this.getActiveSelection(s);
                                if (!l)
                                    return null;
                                if (e = r.res.customSortDialog,
                                        t = $("<select><select>"),
                                        t.addClass("sort-row-sortby"),
                                        this.ru)
                                    for (n = l.col,
                                             n = -1 === n ? 0 : n,
                                             i = 0; i < l.colCount; i++)
                                        o = $("<option></option>"),
                                            o.text(e.column + s.getCell(s.getRowCount(1) - 1, n + i, 1).text()),
                                            o.val(n + i),
                                            t.append(o);
                                else
                                    for (a = l.row,
                                             a = -1 === a ? 0 : a,
                                             i = 0; i < l.rowCount; i++)
                                        o = $("<option></option>"),
                                            o.text(e.row + "" + (a + i + 1)),
                                            o.val(a + i),
                                            t.append(o);
                                return t
                            }
                            ,
                            i.prototype._init = function() {
                                var e = this;
                                this.ru = !0,
                                    this.vu = !0,
                                    this.xo.find("#add-level").on("click", function() {
                                        e.uu()
                                    }),
                                    this.xo.find("#delete-level").on("click", function() {
                                        e.wu()
                                    }),
                                    this.xo.find("#copy-level").on("click", function() {
                                        e.xu()
                                    }),
                                    this.xo.find("#move-up").on("click", function() {
                                        e.yu()
                                    }),
                                    this.xo.find("#move-down").on("click", function() {
                                        e.zu()
                                    }),
                                    this.xo.find("#sort-options").on("click", function() {
                                        e.Au()
                                    })
                            }
                            ,
                            i.prototype.uu = function() {
                                var e, t = $("<Div></Div>").addClass("sort-info").appendTo(this.xo.find(".sort-infolist")), i = r.res.customSortDialog;
                                1 === t.parent().children().length ? (this.Bu = t,
                                    this.Bu.addClass("ui-state-default-special ui-state-default"),
                                    t.append($("<label></label>").addClass("sort-row-header").text(i.sortBy2))) : t.append($("<label></label>").addClass("sort-row-header").text(i.thenBy)),
                                this.su && t.append(this.su.clone(!0)),
                                    t.append($("<select></select>").addClass("sort-column").append($("<option>Values</option>"))),
                                    t.append($("<select></select>").addClass("sort-column sort-order").append($("<option>A to Z</option><option>Z to A</option>"))),
                                    t.append($("<div></div>").addClass("clear-float")),
                                    e = this,
                                    t.click(function() {
                                        e.Bu.removeClass("ui-state-default"),
                                            e.Bu = $(this),
                                            e.Bu.addClass("ui-state-default")
                                    })
                            }
                            ,
                            i.prototype.wu = function() {
                                var e = this.Bu;
                                this.Bu = e.prev(),
                                0 === this.Bu.length && (this.Bu = e.next(),
                                    this.Bu.find(".sort-row-header").text(r.res.customSortDialog.sortBy2)),
                                    this.Bu.addClass("ui-state-default"),
                                    e.remove()
                            }
                            ,
                            i.prototype.xu = function() {
                                var e = this.Bu.clone(!0);
                                0 === this.Bu.prev().length && e.find(".sort-row-header").text(r.res.customSortDialog.thenBy),
                                    e.find(".sort-row-sortby").val(this.Bu.find(".sort-row-sortby").val()),
                                    e.find(".sort-order").val(this.Bu.find(".sort-order").val()),
                                    this.Bu.after(e),
                                    this.Bu.removeClass("ui-state-default"),
                                    this.Bu = this.Bu.next()
                            }
                            ,
                            i.prototype.yu = function() {
                                this.Bu.prev().before(this.Bu),
                                    this.Cu()
                            }
                            ,
                            i.prototype.zu = function() {
                                this.Bu.next().after(this.Bu),
                                    this.Cu()
                            }
                            ,
                            i.prototype.Au = function() {
                                var t = this;
                                this.Du || (this.Du = new e(t)),
                                    this.Du.open()
                            }
                            ,
                            i.prototype.qu = function(e) {
                                this.ru !== e && (this.ru = e,
                                    this.su = this.tu(),
                                    this.xo.find(".sort-infolist").empty(),
                                    this.uu())
                            }
                            ,
                            i.prototype.Cu = function() {
                                this.xo.find(".sort-infolist").children().each(function(e, t) {
                                    0 === e ? $(t).find(".sort-row-header").text(r.res.customSortDialog.sortBy2) : $(t).find(".sort-row-header").text(r.res.customSortDialog.thenBy)
                                })
                            }
                            ,
                            i.prototype.sort = function() {
                                var e = r.wrapper.spread.getActiveSheet()
                                    , t = this.getActiveSelection(e)
                                    , i = this.xo.find(".sort-infolist")
                                    , o = [];
                                0 !== i.length && (i.children().each(function(e, t) {
                                    var i, n, r = !0;
                                    "Z to A" === $(t).find(".sort-order").val() && (r = !1),
                                        i = $(t).find(".sort-row-sortby").val(),
                                        n = {
                                            index: i,
                                            ascending: r
                                        },
                                        o.push(n)
                                }),
                                t && r.actions.doAction("sortCustomRange", r.wrapper.spread, {
                                    byRows: this.ru,
                                    sortInfos: o
                                }))
                            }
                            ,
                            i
                    }(r.BaseDialog),
                    r.SortDialog = t,
                    a = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".spread-setting-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                resizable: !1,
                                title: r.res.spreadSettingDialog.spreadSetting,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo(),
                                            r.actions.isFileModified = !0,
                                            e.close(),
                                            r.wrapper.setFocusToSpread(),
                                            r.ribbon.updateShowHide()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.settingTab = this.xo.find(".spread-setting-tab").tabs()
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, o, n = ["noHeaders", "rowHeaders", "columnHeaders", "allHeaders"];
                                switch (e[0]) {
                                    case "general":
                                        t = 0;
                                        break;
                                    case "scrollbar":
                                        t = 1;
                                        break;
                                    case "tabstrip":
                                        t = 2
                                }
                                this.settingTab.tabs("option", "active", t),
                                    this.xo.find("#setting-dragmerge").prop("checked", r.wrapper.spread.options.allowUserDragMerge),
                                    this.xo.find("#setting-dropdrop").prop("checked", r.wrapper.spread.options.allowUserDragDrop),
                                    this.xo.find("#setting-dragfill").prop("checked", r.wrapper.spread.options.allowUserDragFill),
                                    this.xo.find("#setting-undo").prop("checked", r.wrapper.spread.options.allowUndo),
                                    this.xo.find("#setting-formula").prop("checked", r.wrapper.spread.options.allowUserEditFormula),
                                    this.xo.find("#setting-zoom").prop("checked", r.wrapper.spread.options.allowUserZoom),
                                    this.xo.find("#setting-overflow").prop("checked", r.wrapper.spread.getActiveSheet().options.allowCellOverflow),
                                    this.xo.find("#setting-vertical-scrollbar").prop("checked", r.wrapper.spread.options.showVerticalScrollbar),
                                    this.xo.find("#setting-horizontal-scrollbar").prop("checked", r.wrapper.spread.options.showHorizontalScrollbar),
                                    this.xo.find("#setting-scrollbar-showmax").prop("checked", r.wrapper.spread.options.scrollbarShowMax),
                                    this.xo.find("#setting-scrollbar-maxalign").prop("checked", r.wrapper.spread.options.scrollbarMaxAlign),
                                    this.xo.find("#setting-tab-visible").prop("checked", r.wrapper.spread.options.tabStripVisible),
                                    this.xo.find("#setting-new-tab").prop("checked", r.wrapper.spread.options.newTabVisible),
                                    this.xo.find("#setting-tab-edit").prop("checked", r.wrapper.spread.options.tabEditable),
                                    i = this.xo.find("#setting-tab-ratio"),
                                    i.spinner(),
                                    i.val(Math.round(100 * r.wrapper.spread.options.tabStripRatio)),
                                    this.xo.find("#setting-copyExcelStyle").prop("checked", r.wrapper.spread.options.allowCopyPasteExcelStyle),
                                    this.xo.find("#setting-copyExtendRange").prop("checked", r.wrapper.spread.options.allowExtendPasteRange),
                                    o = n[r.wrapper.spread.options.copyPasteHeaderOptions],
                                    this.xo.find('input[type="radio"][name="headerOptions"]').each(function(e, t) {
                                        $(t).val() === o && $(t).attr("checked", "checked")
                                    })
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e, t;
                                for (r.wrapper.spread.options.allowUserDragMerge = this.xo.find("#setting-dragmerge").prop("checked"),
                                         r.wrapper.spread.options.allowUserDragDrop = this.xo.find("#setting-dropdrop").prop("checked"),
                                         r.wrapper.spread.options.allowUserDragFill = this.xo.find("#setting-dragfill").prop("checked"),
                                         r.wrapper.spread.options.allowUndo = this.xo.find("#setting-undo").prop("checked"),
                                         r.wrapper.spread.options.allowUserEditFormula = this.xo.find("#setting-formula").prop("checked"),
                                         r.wrapper.spread.options.allowUserZoom = this.xo.find("#setting-zoom").prop("checked"),
                                         e = 0; e < r.wrapper.spread.sheets.length; e++)
                                    r.wrapper.spread.sheets[e].options.allowCellOverflow = this.xo.find("#setting-overflow").prop("checked");
                                r.wrapper.spread.options.showVerticalScrollbar = this.xo.find("#setting-vertical-scrollbar").prop("checked"),
                                    r.wrapper.spread.options.showHorizontalScrollbar = this.xo.find("#setting-horizontal-scrollbar").prop("checked"),
                                    r.wrapper.spread.options.scrollbarShowMax = this.xo.find("#setting-scrollbar-showmax").prop("checked"),
                                    r.wrapper.spread.options.scrollbarMaxAlign = this.xo.find("#setting-scrollbar-maxalign").prop("checked"),
                                    r.wrapper.spread.options.tabStripVisible = this.xo.find("#setting-tab-visible").prop("checked"),
                                    r.wrapper.spread.options.newTabVisible = this.xo.find("#setting-new-tab").prop("checked"),
                                    r.wrapper.spread.options.tabEditable = this.xo.find("#setting-tab-edit").prop("checked"),
                                    t = this.xo.find("#setting-tab-ratio").val(),
                                $.isNumeric(t) && (r.wrapper.spread.options.tabStripRatio = t / 100),
                                    r.wrapper.spread.options.allowCopyPasteExcelStyle = this.xo.find("#setting-copyExcelStyle").prop("checked"),
                                    r.wrapper.spread.options.allowExtendPasteRange = this.xo.find("#setting-copyExtendRange").prop("checked"),
                                    r.wrapper.spread.options.copyPasteHeaderOptions = GC.Spread.Sheets.CopyPasteHeaderOptions[this.xo.find('input[type="radio"][name="headerOptions"]:checked').val()]
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.SpreadSettingDialog = a,
                    s = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".sheet-setting-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                resizable: !1,
                                title: r.res.sheetSettingDialog.sheetSetting,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.close(),
                                            e.Uo(),
                                            r.actions.isFileModified = !0,
                                            r.wrapper.setFocusToSpread(),
                                            r.ribbon.updateShowHide()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                this.xo.find(".sheet-setting-tab").tabs(),
                                    this.xo.find(".header-setting-tab").tabs(),
                                    this.xo.find("#sheet-column-count").spinner(),
                                    this.xo.find("#sheet-row-count").spinner(),
                                    this.xo.find("#frozen-column-count").spinner(),
                                    this.xo.find("#frozen-row-count").spinner(),
                                    this.xo.find("#trailing-column-count").spinner(),
                                    this.xo.find("#trailing-row-count").spinner(),
                                    this.xo.find("#header-row-count").spinner(),
                                    this.xo.find("#header-row-autoindex").spinner(),
                                    this.xo.find("#header-row-default-width").spinner(),
                                    this.xo.find("#header-column-count").spinner(),
                                    this.xo.find("#header-column-autoindex").spinner(),
                                    this.xo.find("#header-column-default-height").spinner(),
                                    this.xo.find("#gridline-color-picker").colorpicker({
                                        valueChanged: function(t, i) {
                                            void 0 === i.color ? e.xo.find("#gridline-color-span").css("background-color", "") : e.xo.find("#gridline-color-span").css("background-color", i.color)
                                        },
                                        choosedColor: function(t, i) {
                                            e.xo.find("#gridline-color-frame").comboframe("close")
                                        },
                                        openColorDialog: function(t, i) {
                                            e.xo.find("#gridline-color-frame").comboframe("close")
                                        },
                                        showNoFill: !1
                                    }),
                                    this.xo.find("#gridline-color-frame").comboframe(),
                                    this.xo.find("#sheettab-color-picker").colorpicker({
                                        valueChanged: function(t, i) {
                                            void 0 === i.color ? e.xo.find("#sheettab-color-span").css("background-color", "") : e.xo.find("#sheettab-color-span").css("background-color", i.color)
                                        },
                                        choosedColor: function(t, i) {
                                            e.xo.find("#sheettab-color-frame").comboframe("close")
                                        },
                                        openColorDialog: function(t, i) {
                                            e.xo.find("#sheettab-color-frame").comboframe("close")
                                        },
                                        showNoFill: !1
                                    }),
                                    this.xo.find("#sheettab-color-frame").comboframe(),
                                    this.xo.find("#reference-A1").on("click", function() {
                                        e.xo.find("#header-column-autotext-letters").prop("checked", !0)
                                    }),
                                    this.xo.find("#reference-R1C1").on("click", function() {
                                        e.xo.find("#header-column-autotext-numbers").prop("checked", !0)
                                    })
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, o = r.wrapper.spread, n = r.wrapper.spread.getActiveSheet();
                                switch ($("#gridline-color-picker").colorpicker({
                                    themeColors: r.wrapper.getThemeColors()
                                }),
                                    $("#sheettab-color-picker").colorpicker({
                                        themeColors: r.wrapper.getThemeColors()
                                    }),
                                    e[0]) {
                                    case "general":
                                        i = 0;
                                        break;
                                    case "gridline":
                                        i = 1;
                                        break;
                                    case "calculation":
                                        i = 2;
                                        break;
                                    case "headers":
                                        i = 3;
                                        break;
                                    case "sheettab":
                                        i = 4
                                }
                                this.xo.find(".sheet-setting-tab").tabs("option", "active", i),
                                    this.xo.find("#sheet-column-count").val(n.getColumnCount()),
                                    this.xo.find("#sheet-row-count").val(n.getRowCount()),
                                    this.xo.find("#frozen-column-count").val(n.frozenColumnCount()),
                                    this.xo.find("#frozen-row-count").val(n.frozenRowCount()),
                                    this.xo.find("#trailing-column-count").val(n.frozenTrailingColumnCount()),
                                    this.xo.find("#trailing-row-count").val(n.frozenTrailingRowCount()),
                                    this.xo.find("input[name='selection-policy']").each(function(e, t) {
                                        $(t).val() === "" + n.selectionPolicy() && $(t).prop("checked", !0)
                                    }),
                                    this.xo.find("#sheet-protect").prop("checked", n.options.isProtected),
                                    this.xo.find("#gridline-horizontal").prop("checked", n.options.gridline.showHorizontalGridline),
                                    this.xo.find("#gridline-vertical").prop("checked", n.options.gridline.showVerticalGridline),
                                    n.options.gridline.color ? (t = r.ColorHelper.parse(n.options.gridline.color, n.currentTheme().colors()),
                                        $("#gridline-color-picker").colorpicker("option", "selectedItem", t),
                                        this.xo.find("#gridline-color-span").css("background-color", t.color)) : (this.xo.find("#gridline-color-span").css("background-color", "transparent"),
                                        $("#gridline-color-picker").colorpicker("option", "selectedItem", null)),
                                    this.xo.find("input[name='reference-style']").each(function(e, t) {
                                        $(t).val() === "" + o.options.referenceStyle && $(t).prop("checked", !0)
                                    }),
                                    this.xo.find("#header-column-count").val(n.getRowCount(1)),
                                    this.xo.find("input[name='column-autotext']").each(function(e, t) {
                                        $(t).val() === "" + n.options.colHeaderAutoText && $(t).prop("checked", !0)
                                    }),
                                    this.xo.find("#header-column-autoindex").val(n.options.colHeaderAutoTextIndex),
                                    this.xo.find("#header-column-default-height").val(n.defaults.colHeaderRowHeight),
                                    this.xo.find("#header-column-visible").prop("checked", n.options.colHeaderVisible),
                                    this.xo.find("#header-row-count").val(n.getColumnCount(2)),
                                    this.xo.find("input[name='row-autotext']").each(function(e, t) {
                                        $(t).val() === "" + n.options.rowHeaderAutoText && $(t).prop("checked", !0)
                                    }),
                                    this.xo.find("#header-row-autoindex").val(n.options.rowHeaderAutoTextIndex),
                                    this.xo.find("#header-row-default-width").val(n.defaults.rowHeaderColWidth),
                                    this.xo.find("#header-row-visible").prop("checked", n.options.rowHeaderVisible),
                                    n.options.sheetTabColor ? (t = r.ColorHelper.parse(n.options.sheetTabColor, n.currentTheme().colors()),
                                        $("#sheettab-color-picker").colorpicker("option", "selectedItem", t),
                                        this.xo.find("#sheettab-color-span").css("background-color", t.color)) : (this.xo.find("#sheettab-color-span").css("background-color", "transparent"),
                                        $("#sheettab-color-picker").colorpicker("option", "selectedItem", null))
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e, t, i = r.wrapper.spread.getActiveSheet(), o = r.wrapper.spread;
                                i.suspendPaint(),
                                    i.suspendCalcService(),
                                    i.setColumnCount(+this.xo.find("#sheet-column-count").val()),
                                    i.setRowCount(+this.xo.find("#sheet-row-count").val()),
                                    i.frozenRowCount(+this.xo.find("#frozen-row-count").val()),
                                    i.frozenColumnCount(+this.xo.find("#frozen-column-count").val()),
                                    i.frozenTrailingRowCount(+this.xo.find("#trailing-row-count").val()),
                                    i.frozenTrailingColumnCount(+this.xo.find("#trailing-column-count").val()),
                                    i.selectionPolicy(+this.xo.find("input[name='selection-policy']:checked").val()),
                                    i.options.isProtected = this.xo.find("#sheet-protect").prop("checked"),
                                    e = $("#gridline-color-picker").colorpicker("option", "selectedItem"),
                                e && (i.options.gridline = {
                                    showHorizontalGridline: this.xo.find("#gridline-horizontal").prop("checked"),
                                    showVerticalGridline: this.xo.find("#gridline-vertical").prop("checked"),
                                    color: e.color
                                }),
                                    o.options.referenceStyle = +this.xo.find("input[name='reference-style']:checked").val(),
                                    i.setRowCount(+this.xo.find("#header-column-count").val(), 1),
                                    i.options.colHeaderAutoText = +this.xo.find("input[name='column-autotext']:checked").val(),
                                    i.options.colHeaderAutoTextIndex = +this.xo.find("#header-column-autoindex").val(),
                                    i.defaults.colHeaderRowHeight = +this.xo.find("#header-column-default-height").val(),
                                    i.options.colHeaderVisible = this.xo.find("#header-column-visible").prop("checked"),
                                    i.setColumnCount(+this.xo.find("#header-row-count").val(), 2),
                                    i.options.rowHeaderAutoText = +this.xo.find("input[name='row-autotext']:checked").val(),
                                    i.options.rowHeaderAutoTextIndex = +this.xo.find("#header-row-autoindex").val(),
                                    i.defaults.rowHeaderColWidth = +this.xo.find("#header-row-default-width").val(),
                                    i.options.rowHeaderVisible = this.xo.find("#header-row-visible").prop("checked"),
                                    t = $("#sheettab-color-picker").colorpicker("option", "selectedItem"),
                                t && (t.name ? i.options.sheetTabColor = t.name : i.options.sheetTabColor = t.color),
                                    i.resumeCalcService(),
                                    i.resumePaint()
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.SheetSettingDialog = s,
                    l = function(e) {
                        var t, i, o;
                        r.extends(a, e);
                        function a() {
                            e.call(this, H, ".data-validation-dialog")
                        }
                        return a.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.dataValidationDialog.dataValidation,
                                buttons: [{
                                    text: r.res.dataValidationDialog.clearAll,
                                    click: function() {
                                        e.Eu()
                                    }
                                }, {
                                    text: r.res.ok,
                                    click: function() {
                                        e.Fu() && (e.Uo(),
                                            e.close(),
                                            r.wrapper.setFocusToSpread())
                                    },
                                    isDefault: !0
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            a.prototype._init = function() {
                                var e = this;
                                this.xo.find(".data-validation-tab").tabs(),
                                    this.Gu = this.xo.find(".validation-criteria-type"),
                                    this.Hu = this.xo.find(".validation-ignore-blank").prop("disabled", !0).prop("checked", !0),
                                    this.Iu = this.xo.find(".validation-comparison-operator").prop("disabled", !0),
                                    this.Ju = this.xo.find(".validation-incell-dropdown").prop("checked", !0),
                                    this.Ku = this.xo.find(".validation-value1"),
                                    this.Lu = this.xo.find(".validation-value2"),
                                    this.Mu = this.xo.find(".validation-value1-container"),
                                    this.Nu = this.xo.find(".validation-value2-container"),
                                    this.Ou = this.xo.find(".validation-value1-label"),
                                    this.Pu = this.xo.find(".validation-value2-label"),
                                    this.Qu = this.xo.find(".show-input-message").prop("checked", !0),
                                    this.Ru = this.xo.find(".input-title"),
                                    this.Su = this.xo.find(".input-message"),
                                    this.Tu = this.xo.find(".show-error-message").prop("checked", !0),
                                    this.Uu = this.xo.find(".error-title"),
                                    this.Vu = this.xo.find(".error-message"),
                                    this.Wu = this.xo.find(".error-style"),
                                    this.Gu.on("change", function() {
                                        e.Xu()
                                    }),
                                    this.Iu.on("change", function() {
                                        e.Yu()
                                    }),
                                    this.Qu.on("change", function() {
                                        e.Zu()
                                    }),
                                    this.Tu.on("change", function() {
                                        e.$u()
                                    }),
                                    this.Wu.on("change", function() {
                                        e.av()
                                    }),
                                    e.xo.find(".rangeSelectButton").click(function() {
                                        if (e.ys || (e.ys = new r.RangeSelectDialog(e,{
                                                needSheetName: !1
                                            })),
                                            "disabled" !== $(this).attr("disabled")) {
                                            e.hide();
                                            var t = e.xo.dialog("option", "title"), i = e.zs, o;
                                            switch ($(this).data("name")) {
                                                case "validation-value1":
                                                    o = e.Ku.val(),
                                                        e.ys.open(t, i, o, [".validation-value1"]);
                                                    break;
                                                case "validation-value2":
                                                    o = e.Lu.val(),
                                                        e.ys.open(t, i, o, [".validation-value2"]);
                                                    break;
                                                default:
                                                    e.show()
                                            }
                                        }
                                    })
                            }
                            ,
                            a.prototype.zs = function(e, t) {
                                this.xo.find(e).val(t)
                            }
                            ,
                            a.prototype.Bo = function() {
                                var e, t, i;
                                this.xo.find(".data-validation-tab").tabs("option", "active", 0),
                                    e = r.wrapper.spread.getActiveSheet(),
                                (t = this.getActiveSelection(e)) && (i = e.getDataValidator(t.row, t.col),
                                    i ? (this.bv(i),
                                        this.cv(i.type(), i.comparisonOperator()),
                                        this.dv()) : this.Eu())
                            }
                            ,
                            t = {
                                0: "anyValue",
                                1: "wholeNumber",
                                2: "decimalValues",
                                3: "list",
                                4: "date",
                                5: "time",
                                6: "textLength",
                                7: "custom"
                            },
                            i = {
                                0: "equalsTo",
                                1: "notEqualsTo",
                                2: "greaterThan",
                                3: "greaterThanOrEqualsTo",
                                4: "lessThan",
                                5: "lessThanOrEqualsTo",
                                6: "between",
                                7: "notBetween"
                            },
                            o = {
                                0: "stop",
                                1: "warning",
                                2: "information"
                            },
                            a.prototype.bv = function(e) {
                                var n = r.wrapper.spread.getActiveSheet()
                                    , a = n.getActiveRowIndex()
                                    , s = n.getActiveColumnIndex();
                                this.Gu.val(t[e.type()]),
                                    this.Iu.val(i[e.comparisonOperator()]),
                                    this.Ku.val(e.value1(a, s)),
                                    this.Lu.val(e.value2(a, s)),
                                    this.Hu.prop("checked", e.ignoreBlank()),
                                    this.Ju.prop("checked", e.inCellDropdown()),
                                    this.Qu.prop("checked", e.showInputMessage()),
                                    this.Ru.val(e.inputTitle()),
                                    this.Su.val(e.inputMessage()),
                                    this.Tu.prop("checked", e.showErrorMessage()),
                                    this.Wu.val(o[e.errorStyle()]),
                                    this.Uu.val(e.errorTitle()),
                                    this.Vu.val(e.errorMessage())
                            }
                            ,
                            a.prototype.Eu = function() {
                                this.ev(),
                                    this.Gu.find("option:first-child").prop("selected", !0),
                                    this.Iu.find("option:first-child").prop("selected", !0),
                                    this.Ku.val(null),
                                    this.Lu.val(null),
                                    this.Qu.prop("checked", !0),
                                    this.Ru.val(null).prop("disabled", !1),
                                    this.Su.val(null).prop("disabled", !1),
                                    this.Tu.prop("checked", !0),
                                    this.Wu.prop("disabled", !1).find("option:first-child").prop("selected", !0),
                                    this.Uu.val(null).prop("disabled", !1),
                                    this.Vu.val(null).prop("disabled", !1),
                                    this.dv()
                            }
                            ,
                            a.prototype.ev = function() {
                                this.Iu.prop("disabled", !0),
                                    this.Hu.prop("disabled", !0),
                                    this.Ju.parent().css("visibility", "hidden"),
                                    this.Mu.css("visibility", "hidden"),
                                    this.Ou.css("visibility", "hidden"),
                                    this.Nu.css("visibility", "hidden"),
                                    this.Pu.css("visibility", "hidden")
                            }
                            ,
                            a.prototype.fv = function(e) {
                                this.Hu.prop("disabled", e)
                            }
                            ,
                            a.prototype.gv = function(e) {
                                this.Iu.prop("disabled", e)
                            }
                            ,
                            a.prototype.hv = function(e) {
                                this.Ju.parent().css("visibility", e ? "visible" : "hidden")
                            }
                            ,
                            a.prototype.iv = function(e, t) {
                                this.Mu.css("visibility", e ? "visible" : "hidden"),
                                    this.Ou.css("visibility", e ? "visible" : "hidden"),
                                    this.Ou.text(t)
                            }
                            ,
                            a.prototype.jv = function(e, t) {
                                this.Nu.css("visibility", e ? "visible" : "hidden"),
                                    this.Pu.css("visibility", e ? "visible" : "hidden"),
                                    this.Pu.text(t)
                            }
                            ,
                            a.prototype.cv = function(e, t) {
                                var i, o, n;
                                if (this.ev(),
                                    0 !== e)
                                    if (1 === e || 2 === e || 4 === e || 6 === e) {
                                        switch (e) {
                                            case 1:
                                            case 2:
                                                i = r.res.dataValidationDialog.minimum,
                                                    o = r.res.dataValidationDialog.maximum,
                                                    n = r.res.dataValidationDialog.value;
                                                break;
                                            case 4:
                                                i = r.res.dataValidationDialog.startDate,
                                                    o = r.res.dataValidationDialog.endDate,
                                                    n = r.res.dataValidationDialog.dateLabel;
                                                break;
                                            case 6:
                                                i = r.res.dataValidationDialog.minimum,
                                                    o = r.res.dataValidationDialog.maximum,
                                                    n = r.res.dataValidationDialog.length
                                        }
                                        switch (t) {
                                            case 6:
                                            case 7:
                                                this.fv(!1),
                                                    this.gv(!1),
                                                    this.hv(!1),
                                                    this.iv(!0, i),
                                                    this.jv(!0, o);
                                                break;
                                            case 0:
                                            case 1:
                                                this.fv(!1),
                                                    this.gv(!1),
                                                    this.hv(!1),
                                                    this.iv(!0, n),
                                                    this.jv(!1, "");
                                                break;
                                            case 2:
                                            case 3:
                                                this.fv(!1),
                                                    this.gv(!1),
                                                    this.hv(!1),
                                                    this.iv(!0, i),
                                                    this.jv(!1, "");
                                                break;
                                            case 4:
                                            case 5:
                                                this.fv(!1),
                                                    this.gv(!1),
                                                    this.hv(!1),
                                                    this.iv(!0, o),
                                                    this.jv(!1, "")
                                        }
                                    } else
                                        3 === e ? (this.fv(!1),
                                            this.gv(!0),
                                            this.hv(!0),
                                            this.iv(!0, r.res.dataValidationDialog.source),
                                            this.jv(!1, "")) : 7 === e && (this.fv(!1),
                                            this.gv(!0),
                                            this.hv(!1),
                                            this.iv(!0, r.res.dataValidationDialog.formula),
                                            this.jv(!1, ""))
                            }
                            ,
                            a.prototype.Xu = function() {
                                this.cv(n.DataValidation.CriteriaType[this.Gu.val()], n.ConditionalFormatting.ComparisonOperators[this.Iu.val()])
                            }
                            ,
                            a.prototype.Yu = function() {
                                this.cv(n.DataValidation.CriteriaType[this.Gu.val()], n.ConditionalFormatting.ComparisonOperators[this.Iu.val()])
                            }
                            ,
                            a.prototype.Zu = function() {
                                this.Ru.prop("disabled", !this.Qu.prop("checked")),
                                    this.Su.prop("disabled", !this.Qu.prop("checked"))
                            }
                            ,
                            a.prototype.$u = function() {
                                this.Uu.prop("disabled", !this.Tu.prop("checked")),
                                    this.Vu.prop("disabled", !this.Tu.prop("checked")),
                                    this.Wu.prop("disabled", !this.Tu.prop("checked"))
                            }
                            ,
                            a.prototype.dv = function() {
                                var e = this.xo.find(".error-icon");
                                switch (this.Wu.val()) {
                                    case "stop":
                                        e.removeClass("error-icon-warning").removeClass("error-icon-info").addClass("error-icon-stop");
                                        break;
                                    case "warning":
                                        e.removeClass("error-icon-stop").removeClass("error-icon-info").addClass("error-icon-warning");
                                        break;
                                    case "information":
                                        e.removeClass("error-icon-warning").removeClass("error-icon-stop").addClass("error-icon-info")
                                }
                            }
                            ,
                            a.prototype.av = function() {
                                this.dv()
                            }
                            ,
                            a.prototype.Uo = function() {
                                var e, t = n.ConditionalFormatting.ComparisonOperators[this.Iu.val()], i = this.Ku.val(), o = this.Lu.val();
                                switch (i = this.No(i),
                                    o = this.No(o),
                                    this.Gu.val()) {
                                    case "anyValue":
                                        e = new n.DataValidation.DefaultDataValidator,
                                            e.type(0);
                                        break;
                                    case "wholeNumber":
                                        $.isNumeric(i) && (i = +i),
                                        $.isNumeric(o) && (o = +o),
                                            e = n.DataValidation.createNumberValidator(t, i, o, !0);
                                        break;
                                    case "decimalValues":
                                        $.isNumeric(i) && (i = +i),
                                        $.isNumeric(o) && (o = +o),
                                            e = n.DataValidation.createNumberValidator(t, i, o, !1);
                                        break;
                                    case "list":
                                        e = this.Mo(i) ? n.DataValidation.createFormulaListValidator(i) : n.DataValidation.createListValidator(i);
                                        break;
                                    case "date":
                                        e = n.DataValidation.createDateValidator(t, i, o);
                                        break;
                                    case "textLength":
                                        e = n.DataValidation.createTextLengthValidator(t, i, o);
                                        break;
                                    case "custom":
                                        e = n.DataValidation.createFormulaValidator(i)
                                }
                                e && (e.showInputMessage(this.Qu.prop("checked")),
                                    e.inputTitle(this.Ru.val()),
                                    e.inputMessage(this.Su.val()),
                                    e.showErrorMessage(this.Tu.prop("checked")),
                                    e.errorTitle(this.Uu.val()),
                                    e.errorMessage(this.Vu.val()),
                                    e.errorStyle(n.DataValidation.ErrorStyle[this.Wu.val()]),
                                    e.ignoreBlank(this.Hu.prop("checked")),
                                    e.inCellDropdown(this.Ju.prop("checked")),
                                    e.comparisonOperator(n.ConditionalFormatting.ComparisonOperators[this.Iu.val()])),
                                    r.actions.doAction("setDataValidation", r.wrapper.spread, e)
                            }
                            ,
                            a.prototype.Fu = function() {
                                var e = this.Ku.val()
                                    , t = this.Lu.val();
                                if ("visible" === this.Ku.css("visibility") && "hidden" === this.Lu.css("visibility") && !e)
                                    return r.MessageBox.show(r.res.dataValidationDialog.valueEmptyMessage, r.res.title, 1, 0),
                                        !1;
                                if ("visible" === this.Ku.css("visibility") && "visible" === this.Lu.css("visibility")) {
                                    if (!e || !t)
                                        return r.MessageBox.show(r.res.dataValidationDialog.valueEmptyMessage, r.res.title, 1, 0),
                                            !1;
                                    if ($.isNumeric(e) && $.isNumeric(t) && +e > +t)
                                        return r.MessageBox.show(r.res.dataValidationDialog.minimumMaximumMessage, r.res.title, 1, 0),
                                            !1
                                }
                                return !0
                            }
                            ,
                            a
                    }(r.BaseDialog),
                    r.DataValidationDialog = l,
                    c = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".group-direction-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.groupDirectionDialog.settings,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo(),
                                            e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                var e = r.wrapper.spread.getActiveSheet();
                                this.xo.find("#row-group-direction").prop("checked", 1 === e.rowOutlines.direction()),
                                    this.xo.find("#column-group-direction").prop("checked", 1 === e.columnOutlines.direction())
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = r.wrapper.spread.getActiveSheet();
                                e.suspendPaint(),
                                    e.rowOutlines.direction(this.xo.find("#row-group-direction").prop("checked") ? 1 : 0),
                                    e.columnOutlines.direction(this.xo.find("#column-group-direction").prop("checked") ? 1 : 0),
                                    e.resumePaint()
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.GroupDirectionDialog = c,
                    d = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".zoom-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: r.res.zoomDialog.title,
                                width: 230,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        var t, i, o = e.xo.find("input[name='zoom-ratio']:checked").val();
                                        o === r.res.zoomDialog.fitSelection ? r.actions.doAction("zoomSelection", r.wrapper.spread) : (t = e.xo.find("input[name='zoom-custom-ratio']").val(),
                                            i = parseFloat(t),
                                            i /= 100,
                                            i ? r.actions.doAction("zoom", r.wrapper.spread, i) : r.MessageBox.show(r.res.zoomDialog.exception, r.res.title, 2)),
                                            e.close(),
                                            r.wrapper.setFocusToSpread(),
                                            r.ribbon.updateZoomToStatusBar()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                var e = r.wrapper.spread.getActiveSheet()
                                    , t = e.zoom()
                                    , i = this.kv("" + t);
                                this.xo.find("input[type='text']").val(i),
                                    this.lv(t)
                            }
                            ,
                            t.prototype._init = function() {
                                var e = this
                                    , t = r.wrapper.spread.getActiveSheet()
                                    , i = t.zoom()
                                    , o = 4
                                    , n = this.kv("" + i);
                                this.xo.find("input[type='text']").val(n),
                                    this.lv(i),
                                    this.xo.find("input[name='zoom-ratio']").bind("change", function() {
                                        var t, i = e.xo.find("input[name='zoom-ratio']:checked").val();
                                        i === r.res.zoomDialog.custom || (i === r.res.zoomDialog.fitSelection ? (t = r.actions.mv()) && (t.zoom > o && (t.zoom = o),
                                            e.xo.find("input[type='text']").val(e.kv("" + t.zoom))) : e.xo.find("input[type='text']").val(i))
                                    }),
                                    this.xo.find("input[name='zoom-custom-ratio']").bind("focus", function() {
                                        e.xo.find("input[class='custom-ratio']").prop("checked", !0)
                                    })
                            }
                            ,
                            t.prototype.nv = function() {
                                var e = this.xo.find("input[name='zoom-ratio']:checked").val();
                                this.xo.find("input[type='text']").val(e)
                            }
                            ,
                            t.prototype.kv = function(e) {
                                return e.match(/^[0-9\.]*$/) ? 100 * parseFloat(e) : !!e.match(/^[0-9\.]*%$/) && (e.substring(0, e.indexOf("%") - 1),
                                    e)
                            }
                            ,
                            t.prototype.lv = function(e) {
                                switch (e) {
                                    case 2:
                                        this.xo.find("input[id='zoom-ratio1']").prop("checked", !0);
                                        break;
                                    case 1:
                                        this.xo.find("input[id='zoom-ratio2']").prop("checked", !0);
                                        break;
                                    case .75:
                                        this.xo.find("input[id='zoom-ratio3']").prop("checked", !0);
                                        break;
                                    case .5:
                                        this.xo.find("input[id='zoom-ratio4']").prop("checked", !0);
                                        break;
                                    case .25:
                                        this.xo.find("input[id='zoom-ratio5']").prop("checked", !0);
                                        break;
                                    default:
                                        this.xo.find("input[class='custom-ratio']").prop("checked", !0)
                                }
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.ZoomDialog = d,
                    function(e) {
                        e[e.pie = 0] = "pie",
                            e[e.area = 1] = "area",
                            e[e.scatter = 2] = "scatter",
                            e[e.compatible = 3] = "compatible",
                            e[e.bullet = 4] = "bullet",
                            e[e.spread = 5] = "spread",
                            e[e.stacked = 6] = "stacked",
                            e[e.hbar = 7] = "hbar",
                            e[e.vbar = 8] = "vbar",
                            e[e.variance = 9] = "variance",
                            e[e.boxplot = 10] = "boxplot",
                            e[e.cascade = 11] = "cascade",
                            e[e.pareto = 12] = "pareto",
                            r.FormulaSparklineType = e
                    }(r.FormulaSparklineType || {}),
                    function(e) {
                        e[e.cascade = 0] = "cascade",
                            e[e.pareto = 1] = "pareto",
                            r.MultiRangeFormulaType = e
                    }(r.MultiRangeFormulaType || {}),
                    p = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".insert-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.insertSparklineDialog.createSparklines,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                e.xo.find(".rangeSelectButton").click(function() {
                                    if (e.ov || (e.ov = new r.RangeSelectDialog(e,{
                                            absoluteReference: !0,
                                            needSheetName: !1
                                        })),
                                        e.ys || (e.ys = new r.RangeSelectDialog(e,{
                                            absoluteReference: !1,
                                            needSheetName: !1
                                        })),
                                        "disabled" !== $(this).attr("disabled")) {
                                        e.hide();
                                        var t = e.xo.dialog("option", "title"), i = e.zs, o;
                                        switch ($(this).data("name")) {
                                            case "sparkline-data-range":
                                                o = e.xo.find(".sparkline-data-range").val(),
                                                    e.ys.open(t, i, o, [".sparkline-data-range"]);
                                                break;
                                            case "sparkline-location-range":
                                                o = e.xo.find(".sparkline-location-range").val(),
                                                    e.ov.open(t, i, o, [".sparkline-location-range"]);
                                                break;
                                            default:
                                                e.show()
                                        }
                                    }
                                })
                            }
                            ,
                            t.prototype.zs = function(e, t) {
                                var i = t;
                                0 === t.indexOf("=") && (i = t.substr(1)),
                                    this.xo.find(e).val(i)
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, o, n;
                                this.pv = r.wrapper.spread.getActiveSheet(),
                                    this.qv = i,
                                    this.rv = i,
                                    t = this.xo.find("#is-formula-sparkline"),
                                    o = t.parent(),
                                    n = e[0],
                                    void 0 !== e[1] ? (this.qv = n,
                                        t.prop("checked", !0).attr("disabled", "disabled"),
                                        o.addClass("element-disabled")) : (this.rv = n,
                                        t.prop("checked", !0).removeAttr("disabled"),
                                        o.removeClass("element-disabled")),
                                    this.xo.find(".sparkline-data-range").val(r.CEUtility.parseRangeToExpString(this.pv.getSelections()[0])),
                                    this.xo.find(".sparkline-location-range").val("")
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e, t, i = this, o = i.pv, n = i.xo, a = n.find(".sparkline-data-range").val(), s = r.CEUtility.parseExpStringToRanges(n.find(".sparkline-location-range").val(), o);
                                if (!a || !s || s.length < 1)
                                    return void r.MessageBox.show(r.res.insertSparklineDialog.errorDataRangeMessage, r.res.title, 3, 0);
                                if (e = n.find("#is-formula-sparkline").prop("checked")) {
                                    if (t = "",
                                        void 0 !== this.rv)
                                        switch (i.rv) {
                                            case 0:
                                                i.qv = 3,
                                                    t = "line";
                                                break;
                                            case 1:
                                                i.qv = 3,
                                                    t = "column";
                                                break;
                                            case 2:
                                                i.qv = 3,
                                                    t = "winloss"
                                        }
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        type: i.qv,
                                        compatibleType: t,
                                        dataRange: a,
                                        locationRange: s[0]
                                    })
                                } else
                                    r.actions.doAction("setDefaultSparkline", r.wrapper.spread, {
                                        dataRange: a,
                                        locationRange: s[0],
                                        sparklineType: i.rv,
                                        setting: 2 === i.rv ? {
                                            showNegative: !0
                                        } : {}
                                    });
                                r.ribbon.updateSparkline(),
                                    i.close(),
                                    i.sv(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.sv = function() {
                                var e, t = $("#formulaBarText"), i = this.pv;
                                t.length > 0 && (e = i.getFormula(i.getActiveRowIndex(), i.getActiveColumnIndex())) && (e = "=" + e,
                                    t.text(e))
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.InsertSparkLineDialog = p,
                    u = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".sparkline-weight-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "200",
                                modal: !0,
                                title: r.res.sparklineWeightDialog.sparklineWeight,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                var e = r.wrapper.spread.getActiveSheet()
                                    , t = e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex());
                                t && this.xo.find(".sparkline-weight").val(t.setting().options.lineWeight)
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = this.xo.find(".sparkline-weight").val()
                                    , t = this;
                                $.isNumeric(e) ? (r.actions.doAction("setSparklineSetting", r.wrapper.spread, [e, "lineWeight"]),
                                    t.close(),
                                    r.wrapper.setFocusToSpread()) : r.MessageBox.show(r.res.sparklineWeightDialog.errorMessage, r.res.title, 2, 0)
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.SparklineWeightDialog = u,
                    h = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".sparkline-marker-color-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.sparklineMarkerColorDialog.sparklineMarkerColor,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo(),
                                            e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.tv("sparkline-negative-point-color-frame", "sparkline-negative-point-color-span", "sparkline-negative-point-color-picker"),
                                    this.tv("sparkline-marker-point-color-frame", "sparkline-marker-point-color-span", "sparkline-marker-point-color-picker"),
                                    this.tv("sparkline-high-point-color-frame", "sparkline-high-point-color-span", "sparkline-high-point-color-picker"),
                                    this.tv("sparkline-low-point-color-frame", "sparkline-low-point-color-span", "sparkline-low-point-color-picker"),
                                    this.tv("sparkline-first-point-color-frame", "sparkline-first-point-color-span", "sparkline-first-point-color-picker"),
                                    this.tv("sparkline-last-point-color-frame", "sparkline-last-point-color-span", "sparkline-last-point-color-picker")
                            }
                            ,
                            t.prototype.tv = function(e, t, i) {
                                var o = this;
                                this.xo.find("." + i).colorpicker({
                                    valueChanged: function(e, i) {
                                        void 0 === i.color ? o.xo.find("." + t).css("background-color", "") : o.xo.find("." + t).css("background-color", i.color)
                                    },
                                    choosedColor: function(t, i) {
                                        o.xo.find("." + e).comboframe("close")
                                    },
                                    openColorDialog: function(t, i) {
                                        o.xo.find("." + e).comboframe("close")
                                    }
                                }),
                                    this.xo.find("." + e).comboframe()
                            }
                            ,
                            t.prototype.uv = function(e, t, i) {
                                var o, n;
                                $("." + i).colorpicker({
                                    themeColors: r.wrapper.getThemeColors()
                                }),
                                    o = r.wrapper.spread.getActiveSheet(),
                                    e ? (n = r.ColorHelper.parse(e, o.currentTheme().colors()),
                                        $("." + i).colorpicker("option", "selectedItem", n),
                                        this.xo.find("." + t).css("background-color", n.color)) : (this.xo.find("." + t).css("background-color", "transparent"),
                                        $("." + i).colorpicker("option", "selectedItem", null))
                            }
                            ,
                            t.prototype.vv = function(e, t, i) {
                                e && (e.name ? r.actions.doAction(t, r.wrapper.spread, [e.name, i]) : r.actions.doAction(t, r.wrapper.spread, [e.color, i]))
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e = r.wrapper.spread.getActiveSheet()
                                    , t = e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex()).setting();
                                this.uv(t.options.negativeColor, "sparkline-negative-point-color-span", "sparkline-negative-point-color-picker"),
                                    this.uv(t.options.markersColor, "sparkline-marker-point-color-span", "sparkline-marker-point-color-picker"),
                                    this.uv(t.options.highMarkerColor, "sparkline-high-point-color-span", "sparkline-high-point-color-picker"),
                                    this.uv(t.options.lowMarkerColor, "sparkline-low-point-color-span", "sparkline-low-point-color-picker"),
                                    this.uv(t.options.firstMarkerColor, "sparkline-first-point-color-span", "sparkline-first-point-color-picker"),
                                    this.uv(t.options.lastMarkerColor, "sparkline-last-point-color-span", "sparkline-last-point-color-picker")
                            }
                            ,
                            t.prototype.Uo = function() {
                                this.vv($(".sparkline-negative-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "negativeColor"),
                                    this.vv($(".sparkline-marker-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "markersColor"),
                                    this.vv($(".sparkline-high-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "highMarkerColor"),
                                    this.vv($(".sparkline-low-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "lowMarkerColor"),
                                    this.vv($(".sparkline-first-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "firstMarkerColor"),
                                    this.vv($(".sparkline-last-point-color-picker").colorpicker("option", "selectedItem"), "setSparklineSetting", "lastMarkerColor")
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.SparklineMarkerColorDialog = h,
                    f = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".create-table-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.createTableDialog.createTable,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo(),
                                            e.close(),
                                            r.wrapper.setFocusToSpread(),
                                            r.ribbon.updateTable()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                e.xo.find(".rangeSelectButton").click(function() {
                                    var t, i, o;
                                    e.ys || (e.ys = new r.RangeSelectDialog(e,{
                                        absoluteReference: !0,
                                        needSheetName: !1
                                    })),
                                        e.hide(),
                                        t = e.xo.dialog("option", "title"),
                                        i = e.zs,
                                        o = e.xo.find(".table-source-range").val(),
                                        e.ys.open(t, i, o, [".table-source-range"])
                                })
                            }
                            ,
                            t.prototype.zs = function(e, t) {
                                this.xo.find(e).val(t)
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e = r.wrapper.spread.getActiveSheet();
                                this.wv = e,
                                    this.xo.find(".table-source-range").val(r.CEUtility.parseRangeToExpString(e.getSelections()[0], !0))
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = r.CEUtility.parseExpStringToRanges(this.xo.find(".table-source-range").val(), this.wv);
                                e && e.length >= 1 && r.actions.doAction("createDefaultTable", r.wrapper.spread, e[0])
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.CreateTableDialog = f,
                    g = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".format-table-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: 600,
                                modal: !0,
                                title: r.res.formatTableStyle.tableStyle,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.xv() ? r.MessageBox.show(r.res.formatTableStyle.exception, r.res.title, 2) : (t.currentId++,
                                            e.yv(),
                                            r.actions.isFileModified = !0,
                                            e.close(),
                                            r.wrapper.setFocusToSpread())
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.zv = null,
                                    this.Av = null,
                                    this.Bv = null,
                                    this.Cv = null,
                                    this.Dv = null,
                                    this.Ev(),
                                    this.Fv(),
                                    this.Gv(),
                                    this.Hv(),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Fv = function() {
                                var e, t = r.res.tableElement;
                                for (e in t)
                                    $("<option></option>").attr("strip-size", 1).val(e).text(t[e]).appendTo(this.xo.find(".table-element-select"));
                                this.xo.find(".table-element-select").attr("size", 8),
                                    this.xo.find(".table-element-select").get(0).selectedIndex = 0,
                                    this.Jv = this.xo.find(".table-element-select").find("option:selected").val()
                            }
                            ,
                            t.prototype.Ev = function() {
                                var e = r.res.formatTableStyle.tableStyle + " " + t.currentId;
                                this.xo.find(".table-style-input").val(e)
                            }
                            ,
                            t.prototype.Gv = function() {
                                var e, t, i, o, a, s, l, c = this;
                                for (this.Kv = new n.Workbook(this.xo.find(".pre-spread")[0]),
                                         e = this.Kv.getActiveSheet(),
                                         this.Kv.options.showHorizontalScrollbar = !1,
                                         this.Kv.options.showVerticalScrollbar = !1,
                                         this.Kv.options.tabStripVisible = !1,
                                         this.Kv.options.allowUserResize = !1,
                                         this.Kv.options.allowUserDragDrop = !1,
                                         this.Kv.options.allowUserDragFill = !1,
                                         this.Kv.options.allowContextMenu = !1,
                                         e.suspendPaint(),
                                         $(r.util.getCanvas(this.Kv)).unbind("gcmousewheel.gcSheet"),
                                         e.currentTheme(r.wrapper.spread.getActiveSheet().currentTheme()),
                                         e.options.gridline = {
                                             showVerticalGridline: !1,
                                             showHorizontalGridline: !1
                                         },
                                         e.options.colHeaderVisible = !1,
                                         e.options.rowHeaderVisible = !1,
                                         e.options.selectionBackColor = "transparent",
                                         e.options.selectionBorderColor = "transparent",
                                         e.options.isProtected = !0,
                                         e.setColumnCount(8),
                                         e.setRowCount(9),
                                         t = new n.Style,
                                         t.vAlign = 1,
                                         t.hAlign = 1,
                                         i = 1; i < 8; i++)
                                    for (o = 1; o < 7; o++)
                                        e.setValue(i, o, "-"),
                                            e.setStyle(i, o, t);
                                for (e.setRowHeight(0, 1),
                                         e.setRowHeight(8, 10),
                                         e.setColumnWidth(0, 3),
                                         e.setColumnWidth(7, 10),
                                         i = 1; i < 8; i++)
                                    e.setRowHeight(i, 14);
                                for (o = 1; o < 7; o++)
                                    e.setColumnWidth(o, 17);
                                if (0 === e.tables.all().length)
                                    for (s = new n.Tables.TableTheme,
                                             a = e.tables.add("table1", 1, 1, 6, 6, s),
                                             a.filterButtonVisible(!0),
                                             l = 0; l < 7; l++)
                                        a.setColumnName(l, "c" + l);
                                e.resumePaint(),
                                    setTimeout(function() {
                                        c.Kv.refresh()
                                    }, 0)
                            }
                            ,
                            t.prototype.Hv = function() {
                                var e, t = 8;
                                for (e = 1; e <= t; e++)
                                    $("<option></option>").val(e).text(e).appendTo(this.xo.find(".stripe-size-select"));
                                this.xo.find(".stripe-size-select").attr("size", 1),
                                    this.xo.find(".stripe-size-select").get(0).selectedIndex = 0,
                                    this.xo.find(".stripe-size-block").css("display", "none")
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this;
                                this.xo.find(".table-element-select").change(function() {
                                    var t = e.xo.find(".stripe-size-block");
                                    e.Jv = e.xo.find(".table-element-select").find("option:selected").val(),
                                        -1 === e.Jv.indexOf("Strip") ? t.css("display", "none") : t.css("display", "block"),
                                        e.Lv()
                                }),
                                    this.xo.find(".stripe-size-select").change(function() {
                                        var t = e.xo.find(".stripe-size-select").find("option:selected").val();
                                        e.xo.find(".table-element-select").find("option:selected").attr("strip-size", t),
                                            e.Mv()
                                    }),
                                    this.xo.find(".format-table-element").click(function() {
                                        var t, i, o, a, s = e.Kv.getActiveSheet(), l = new n.Style;
                                        0 !== s.tables.all().length && (t = s.tables.find(2, 2),
                                            i = e.xo.find(".table-element-select").find("option:selected").val(),
                                            o = t.style(),
                                        (a = o[i]()) && (l.backColor = a.backColor,
                                            l.foreColor = a.foreColor,
                                            l.font = a.font,
                                            l.borderLeft = a.borderLeft,
                                            l.borderTop = a.borderTop,
                                            l.borderRight = a.borderRight,
                                            l.borderBottom = a.borderBottom,
                                            l.borderVertical = a.borderVertical,
                                            l.borderHorizontal = a.borderHorizontal,
                                            l.textDecoration = a.textDecoration)),
                                        void 0 === this.Nv && (this.Nv = new r.FormatDialog),
                                            this.Nv.open("font", void 0, l, !0, !0),
                                            this.Nv.selectTabOptions = {
                                                font: !0,
                                                border: !0,
                                                fill: !0
                                            },
                                            this.Nv.setFormatDirectly(!1),
                                            $(this.Nv).on("okClicked", function(t, i) {
                                                var o = e.xo.find(".table-element-select").find("option:selected").val();
                                                switch (o) {
                                                    case "firstRowStripStyle":
                                                        e.Cv = i;
                                                        break;
                                                    case "secondRowStripStyle":
                                                        e.Dv = i;
                                                        break;
                                                    case "firstColumnStripStyle":
                                                        e.Av = i;
                                                        break;
                                                    case "secondColumnStripStyle":
                                                        e.Bv = i;
                                                        break;
                                                    default:
                                                        e.zv = i
                                                }
                                                e.Mv()
                                            })
                                    }),
                                    this.xo.find(".clear-table-element").click(function() {
                                        var t, i, o, n = e.Kv.getActiveSheet();
                                        if (0 !== n.tables.all().length) {
                                            switch (n.suspendPaint(),
                                                t = n.tables.find(2, 2),
                                                i = e.xo.find(".table-element-select").find("option:selected").val(),
                                                o = t.style(),
                                                i) {
                                                case "firstRowStripStyle":
                                                    e.Cv = null;
                                                    break;
                                                case "secondRowStripStyle":
                                                    e.Dv = null;
                                                    break;
                                                case "firstColumnStripStyle":
                                                    e.Av = null;
                                                    break;
                                                case "secondColumnStripStyle":
                                                    e.Bv = null;
                                                    break;
                                                default:
                                                    e.zv = null
                                            }
                                            o[i](null),
                                                t.style(o),
                                                n.resumePaint()
                                        }
                                    })
                            }
                            ,
                            t.prototype.Ov = function() {
                                this.xo.find(".format-table-element").unbind("click"),
                                    this.xo.find(".clear-table-element").unbind("click"),
                                    this.xo.find(".table-element-select").unbind("change"),
                                    this.xo.find(".stripe-size-select").unbind("change")
                            }
                            ,
                            t.prototype.Lv = function() {
                                var e, t, i = this.Kv.getActiveSheet(), o = i.tables.find(2, 2), n = parseInt(this.xo.find(".stripe-size-select").find("option:selected").val()), r = this.xo.find(".table-element-select").find("option:selected").val();
                                if (null !== o && "block" === this.xo.find(".stripe-size-block").css("display")) {
                                    switch (t = o.style(),
                                        r) {
                                        case "firstRowStripStyle":
                                            e = t.firstRowStripSize();
                                            break;
                                        case "secondRowStripStyle":
                                            e = t.secondRowStripSize();
                                            break;
                                        case "firstColumnStripStyle":
                                            e = t.firstColumnStripSize();
                                            break;
                                        case "secondColumnStripStyle":
                                            e = t.secondColumnStripSize()
                                    }
                                    e !== n && this.xo.find(".stripe-size-select").val(e)
                                }
                            }
                            ,
                            t.prototype.Mv = function() {
                                var e, t, i, o, r, a = new n.Tables.TableTheme, s = this.xo.find(".stripe-size-block"), l = this.Kv.getActiveSheet();
                                if (l.suspendPaint(),
                                    0 !== l.tables.all().length)
                                    e = l.tables.find(2, 2);
                                else
                                    for (e = l.tables.add("table1", 1, 1, 6, 6, a),
                                             e.filterButtonVisible(!1),
                                             i = 0; i < 7; i++)
                                        e.setColumnName(i, "-");
                                if (e.bandColumns(!0),
                                        e.bandRows(!0),
                                        e.showHeader(!0),
                                        e.showFooter(!0),
                                        e.highlightFirstColumn(!0),
                                        e.highlightLastColumn(!0),
                                        o = this.xo.find(".table-element-select").find("option:selected").val(),
                                    "block" === s.css("display"))
                                    switch (r = parseInt(this.xo.find(".stripe-size-select").find("option:selected").val()),
                                        o) {
                                        case "firstRowStripStyle":
                                            this.Cv && (t = this.ms(e, o, this.Cv),
                                                t.firstRowStripSize(r));
                                            break;
                                        case "secondRowStripStyle":
                                            this.Dv && (t = this.ms(e, o, this.Dv),
                                                t.secondRowStripSize(r));
                                            break;
                                        case "firstColumnStripStyle":
                                            this.Av && (t = this.ms(e, o, this.Av),
                                                t.firstColumnStripSize(r));
                                            break;
                                        case "secondColumnStripStyle":
                                            this.Bv && (t = this.ms(e, o, this.Bv),
                                                t.secondColumnStripSize(r))
                                    }
                                else
                                    this.zv && (t = this.ms(e, o, this.zv));
                                t && e.style(t),
                                    l.resumePaint()
                            }
                            ,
                            t.prototype.ms = function(e, t, i) {
                                var o, r;
                                return i ? (o = e.style(),
                                    r = new n.Tables.TableStyle,
                                    r.backColor = i.backColor,
                                    r.foreColor = i.foreColor,
                                    r.font = i.font,
                                    r.borderLeft = i.borderLeft,
                                    r.borderTop = i.borderTop,
                                    r.borderRight = i.borderRight,
                                    r.borderBottom = i.borderBottom,
                                    r.borderVertical = i.borderVertical,
                                    r.borderHorizontal = i.borderHorizontal,
                                    r.textDecoration = i.textDecoration,
                                    o[t](r),
                                    o) : null
                            }
                            ,
                            t.prototype.yv = function() {
                                var e, i, o, n = this.Kv.getActiveSheet(), r = "custom", a = 1, s = n.tables.find(1, 1);
                                if (s) {
                                    e = this.xo.find(".table-style-input").val(),
                                        i = s.style(),
                                        i.name(e);
                                    for (o in t.customTableStyle)
                                        a++;
                                    e = r + "" + a + "-" + e,
                                        t.customTableStyle[e] = i
                                }
                            }
                            ,
                            t.prototype.xv = function() {
                                var e, i = this.xo.find(".table-style-input").val();
                                for (e in t.customTableStyle)
                                    if ((e = e.substring(e.indexOf("-") + 1)) === i)
                                        return !0;
                                return !1
                            }
                            ,
                            t.prototype.refresh = function() {
                                this.Ov(),
                                0 !== this.xo.find(".table-element-select").children().length && this.xo.find(".table-element-select").empty(),
                                0 !== this.xo.find(".pre-spread").children().length && this.xo.find(".pre-spread").empty(),
                                0 !== this.xo.find(".stripe-size-select").children().length && this.xo.find(".stripe-size-select").empty(),
                                    this._init()
                            }
                            ,
                            t.currentId = 1,
                            t.customTableStyle = {},
                            t
                    }(r.BaseDialog),
                    r.FormatTableDialog = g,
                    m = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".resize-table-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: 300,
                                modal: !0,
                                title: r.res.resizeTableDialog.title,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo(),
                                            e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                e.xo.find(".rangeSelectButton").click(function() {
                                    var t, i, o;
                                    e.ys || (e.ys = new r.RangeSelectDialog(e,{
                                        absoluteReference: !0,
                                        needSheetName: !1
                                    })),
                                        e.hide(),
                                        t = e.xo.dialog("option", "title"),
                                        i = e.zs,
                                        o = e.xo.find(".table-source-range").val(),
                                        e.ys.open(t, i, o, [".table-source-range"])
                                })
                            }
                            ,
                            t.prototype.zs = function(e, t) {
                                this.xo.find(e).val(t)
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e, t = r.wrapper.spread.getActiveSheet();
                                this.wv = t,
                                (e = t.tables.find(t.getActiveRowIndex(), t.getActiveColumnIndex()))instanceof n.Tables.Table && this.xo.find(".table-source-range").val(r.CEUtility.parseRangeToExpString(e.range(), !0))
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = r.CEUtility.parseExpStringToRanges(this.xo.find(".table-source-range").val(), this.wv);
                                e && e.length >= 1 && r.actions.doAction("resizeTable", r.wrapper.spread, e[0])
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.ResizeTableDialog = m,
                    b = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".cell-style-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: "Style",
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.ok()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.xo.find(".cell-style-format-setting").button(),
                                    this.Pv()
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.Qv(),
                                    this.ws = new n.Style
                            }
                            ,
                            t.prototype.Qv = function() {
                                var e = "Style " + t.Rv;
                                this.xo.find(".cell-style-name").val(e)
                            }
                            ,
                            t.prototype.ok = function() {
                                var e = this.xo.find(".cell-style-name").val();
                                this.Sv(e) ? r.MessageBox.show(r.res.newCellStyleDialog.message, r.res.title, 2) : (this.ws.name = e,
                                    t.existedCustomCellStyle[e.toLowerCase()] = this.ws,
                                    t.Rv++,
                                    r.actions.isFileModified = !0,
                                    this.close(),
                                    r.wrapper.setFocusToSpread())
                            }
                            ,
                            t.prototype.Sv = function(e) {
                                return !!(e && (e = e.toLowerCase(),
                                t.existedCustomCellStyle.hasOwnProperty(e) || t.buildInCellStyle.hasOwnProperty(e)))
                            }
                            ,
                            t.prototype.Pv = function() {
                                var e = this;
                                this.xo.find(".cell-style-format-setting").click(function() {
                                    void 0 === e.Nv && (e.Nv = new r.FormatDialog),
                                        e.Nv.open("numbers", void 0, e.ws, !0),
                                        e.Nv.setFormatDirectly(!1),
                                        $(e.Nv).on("okClicked", function(t, i) {
                                            e.ws = i
                                        })
                                })
                            }
                            ,
                            t.buildInCellStyle = {},
                            t.existedCustomCellStyle = {},
                            t.Rv = 1,
                            t
                    }(r.BaseDialog),
                    r.CellStyleDialog = b,
                    v = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".pdf-printer-setting-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "450px",
                                modal: !0,
                                title: r.res.fileMenu.printerSettingDialogTitle,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.ok(),
                                            e.close()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Tv = [],
                                    this.xo.find(".printer-range-setting-button").button(),
                                    this.Uv(),
                                    this.Vv(),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Uv = function() {
                                var e, t = r.res.fileMenu.scalingType, i = this.xo.find(".scaling-type");
                                for (e in t)
                                    $("<option></option>").val(e).text(t[e]).appendTo(i)
                            }
                            ,
                            t.prototype.Vv = function() {
                                var e, t = r.res.fileMenu.duplexMode, i = this.xo.find(".duplex-mode");
                                for (e in t)
                                    $("<option></option>").val(e).text(t[e]).appendTo(i)
                            }
                            ,
                            t.prototype.Wv = function(e) {
                                this.Xv && $(this.Xv).css("background-color", ""),
                                    this.Xv = e,
                                    $(this.Xv).css("background-color", "#98DDFB")
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = this.xo.find(".printer-range-table");
                                $(".add-print-range").on("click", function() {
                                    var i, o = parseInt(e.xo.find(".page-range-index").val(), 10), n = parseInt(e.xo.find(".page-range-count").val(), 10);
                                    if (isNaN(o) || isNaN(n) || o < 0 || n <= 0)
                                        return void r.MessageBox.show(r.res.fileMenu.addRangeException, r.res.title, 3, 0);
                                    i = $("<tr></tr>"),
                                        $("<td></td>").text(o).appendTo(i),
                                        $("<td></td>").text(n).appendTo(i),
                                        i.appendTo(t),
                                        $(i).on("click", function() {
                                            e.Wv(this)
                                        }),
                                        e.Tv.push({
                                            index: o,
                                            count: n
                                        })
                                }),
                                    $(".remove-print-range").on("click", function() {
                                        var t, i, o, n, r, a, s;
                                        if (e.Xv) {
                                            if (t = $(e.Xv).find("td"),
                                                2 !== $(t).length)
                                                return;
                                            for (i = $(t[0]).text(),
                                                     o = $(t[1]).text(),
                                                     n = e.Tv,
                                                     r = n.length,
                                                     a = 0; a < r; a++)
                                                if (s = n[a],
                                                    s.index === parseInt(i, 10) && s.count === parseInt(o, 10)) {
                                                    n.splice(a, 1);
                                                    break
                                                }
                                            $(e.Xv).remove()
                                        }
                                    })
                            }
                            ,
                            t.prototype.ok = function() {
                                var e = $(".copies-number").find("option:selected").text()
                                    , i = $(".scaling-type").get(0).selectedIndex
                                    , o = $(".duplex-mode").get(0).selectedIndex
                                    , n = $(".papersource-by-pagesize").prop("checked");
                                t.printerSettings = {
                                    scalingType: i,
                                    duplexMode: o,
                                    isPageSourceByPageSize: n,
                                    numberOfCopies: parseInt(e, 10),
                                    printRanges: this.Tv
                                }
                            }
                            ,
                            t.printerSettings = {},
                            t
                    }(r.BaseDialog),
                    r.PDFPrinterDialog = v,
                    y = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".format-comment")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.formatComment.title,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.ok(),
                                            e.close()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Yv = ["font", "alignment", "colors", "size", "protection", "properties"],
                                    this.Zv = "Arial",
                                    this.$v = "9pt",
                                    this._v = this.tv(this.xo.find(".fill-color-picker"), {
                                        type: "comment-fill"
                                    }),
                                    this.aw = this.tv(this.xo.find(".line-color-picker"), {
                                        type: "comment-line"
                                    }),
                                    this.xo.find(".color-transparent-slider").slider({
                                        range: "min",
                                        min: 0,
                                        max: 100
                                    }),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, o;
                                this.bw = r.wrapper.spread,
                                (t = this.bw.getActiveSheet()) && (e.length > 0 && (this.cw = t.comments.get(e[0].row, e[0].col)),
                                this.cw && (this.xo.find(".main-comment-tab").tabs(),
                                    this.xo.find(".comment-tab-container li").removeClass("hidden"),
                                e.length > 0 && (o = e[0],
                                o.showTabs && this.dw(o.showTabs),
                                o.activeTab && this.ew(o.activeTab)),
                                    this.fw = {},
                                    this.gw = {},
                                    this.hw = i,
                                    this.iw ? this.jw = {
                                        left: 0,
                                        right: 0,
                                        top: 0,
                                        bottom: 0
                                    } : (this.iw = !1,
                                        this.jw = this.kw()),
                                    this.mw = {},
                                    this.ow = {},
                                    this.iq = {},
                                    this.pw(),
                                    this.qw(),
                                    this.rw(),
                                    this.tw(),
                                    this.uw(),
                                    this.vw()))
                            }
                            ,
                            t.prototype.kw = function() {
                                var e = parseFloat(this.xo.find("#padding-left").val())
                                    , t = parseFloat(this.xo.find("#padding-right").val())
                                    , i = parseFloat(this.xo.find("#padding-top").val())
                                    , o = parseFloat(this.xo.find("#padding-bottom").val());
                                return e = isNaN(e) ? 0 : e,
                                    t = isNaN(t) ? 0 : t,
                                    i = isNaN(i) ? 0 : i,
                                    o = isNaN(o) ? 0 : o,
                                    {
                                        left: e,
                                        right: t,
                                        top: i,
                                        bottom: o
                                    }
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this;
                                this.xo.find(".comment-font-picker").fontpicker({
                                    changed: function(t, i) {
                                        switch (i.name) {
                                            case "family":
                                                e.fw.family = i.value;
                                                break;
                                            case "style":
                                                e.fw.style = i.value;
                                                break;
                                            case "size":
                                                e.fw.size = i.value;
                                                break;
                                            case "weight":
                                                e.fw.weight = i.value;
                                                break;
                                            case "color":
                                                e.fw.foreColor = i.value;
                                                break;
                                            case "underline":
                                                i.value ? e.fw.textDecoration |= 1 : e.fw.textDecoration &= 254;
                                                break;
                                            case "strikethrough":
                                                i.value ? e.fw.textDecoration |= 2 : e.fw.textDecoration &= 253
                                        }
                                    }
                                }),
                                    this.xo.find(".hAlign-select").change(function() {
                                        e.gw.hAlign = $(this).val().toLowerCase()
                                    }),
                                    this.xo.find("#auto-size").change(function() {
                                        e.hw = $(this).prop("checked")
                                    }),
                                    this.xo.find("#automatic-padding").change(function() {
                                        e.iw = $(this).prop("checked"),
                                            e.iw ? e.xo.find(".padding-box").val("") : e.xo.find(".padding-box").val("0"),
                                            e.jw = {
                                                left: 0,
                                                right: 0,
                                                top: 0,
                                                bottom: 0
                                            }
                                    }),
                                    this.xo.find("#padding-left").spinner({
                                        min: 0,
                                        change: function() {
                                            e.jw.left = parseInt($(this).val()),
                                                e.iw = !1,
                                                e.ww(e.xo.find("#automatic-padding"), e.iw)
                                        }
                                    }),
                                    this.xo.find("#padding-right").spinner({
                                        min: 0,
                                        change: function() {
                                            e.jw.right = parseInt($(this).val()),
                                                e.iw = !1,
                                                e.ww(e.xo.find("#automatic-padding"), e.iw)
                                        }
                                    }),
                                    this.xo.find("#padding-top").spinner({
                                        min: 0,
                                        change: function() {
                                            e.jw.top = parseInt($(this).val()),
                                                e.iw = !1,
                                                e.ww(e.xo.find("#automatic-padding"), e.iw)
                                        }
                                    }),
                                    this.xo.find("#padding-bottom").spinner({
                                        min: 0,
                                        change: function() {
                                            e.jw.bottom = parseInt($(this).val()),
                                                e.iw = !1,
                                                e.ww(e.xo.find("#automatic-padding"), e.iw)
                                        }
                                    }),
                                    this.xo.find(".color-transparent-slider").slider({
                                        slide: function(t, i) {
                                            e.xo.find("#colors-transparent-input").val(i.value);
                                            var o = parseFloat((i.value / 100).toFixed(2));
                                            e.ow.transparency = o,
                                                e.xo.find(".comment-fill").css("opacity", 1 - o)
                                        }
                                    }),
                                    this.xo.find("#colors-transparent-input").spinner({
                                        min: 0,
                                        max: 100,
                                        change: function() {
                                            var t, i = parseInt($(this).val());
                                            isNaN(i) || (i < 0 ? (i = 0,
                                                $(this).val(i)) : i > 100 && (i = 100,
                                                $(this).val(i)),
                                                e.xo.find(".color-transparent-slider").slider({
                                                    value: i
                                                }),
                                                t = parseFloat((i / 100).toFixed(2)),
                                                e.ow.transparency = t,
                                                e.xo.find(".comment-fill").css("opacity", 1 - t))
                                        }
                                    }),
                                    this.xo.find(".lines-style-select").change(function() {
                                        e.mw.style = $(this).val()
                                    }),
                                    this.xo.find(".lines-width").spinner({
                                        min: 0,
                                        change: function() {
                                            var t = parseFloat($(this).val());
                                            isNaN(t) || (e.mw.width = t)
                                        }
                                    }),
                                    this.xo.find("#comment-size-height").spinner({
                                        min: 0,
                                        change: function() {
                                            var t = parseFloat($(this).val());
                                            isNaN(t) || (e.iq.height = t),
                                                e.hw = !1
                                        }
                                    }),
                                    this.xo.find("#comment-size-width").spinner({
                                        min: 0,
                                        change: function() {
                                            var t = parseFloat($(this).val());
                                            isNaN(t) || (e.iq.width = t),
                                                e.hw = !1
                                        }
                                    }),
                                    this.xo.find("#comment-locked").change(function() {
                                        e.xw = $(this).prop("checked")
                                    }),
                                    this.xo.find("#comment-lock-text").change(function() {
                                        e.yw = $(this).prop("checked")
                                    }),
                                    this.xo.find("input[type='radio'][name='dynamic-ratio']").change(function() {
                                        var t = e.xo.find("input[type='radio'][name='dynamic-ratio']:checked");
                                        switch (t.attr("id")) {
                                            case "move-size":
                                                e.zw = !0,
                                                    e.Aw = !0;
                                                break;
                                            case "move-no-size":
                                                e.zw = !0,
                                                    e.Aw = !1;
                                                break;
                                            case "no-move-size":
                                                e.zw = !1,
                                                    e.Aw = !1
                                        }
                                    })
                            }
                            ,
                            t.prototype.ok = function() {
                                this.Bw(),
                                    this.Cw(),
                                    this.Dw(),
                                    this.Ew(),
                                    this.Fw(),
                                    this.Gw()
                            }
                            ,
                            t.prototype.Bw = function() {
                                var e, t, i;
                                this.cw && ($.isEmptyObject(this.fw) || (this.fw.family && (e = this.cw.fontFamily()) !== this.fw.family && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "fontFamily",
                                    oldValue: e,
                                    newValue: this.fw.family
                                }),
                                this.fw.size && (e = parseFloat(this.cw.fontSize()),
                                    t = parseFloat(this.fw.size),
                                e !== t && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "fontSize",
                                    oldValue: e + "pt",
                                    newValue: this.fw.size + "pt"
                                })),
                                this.fw.weight && (e = this.cw.fontWeight(),
                                this.fw.weight !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "fontWeight",
                                    oldValue: e,
                                    newValue: this.fw.weight
                                })),
                                this.fw.style && (e = this.cw.fontStyle(),
                                this.fw.style !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "fontStyle",
                                    oldValue: e,
                                    newValue: this.fw.style
                                })),
                                this.fw.foreColor && (e = this.cw.foreColor(),
                                    i = this.fw.foreColor,
                                    "string" == typeof i ? i !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                        propertyName: "foreColor",
                                        oldValue: e,
                                        newValue: i
                                    }) : i.color !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                        propertyName: "foreColor",
                                        oldValue: e,
                                        newValue: i.color
                                    })),
                                void 0 !== this.fw.textDecoration && (e = this.cw.textDecoration(),
                                (t = this.fw.textDecoration) !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "textDecoration",
                                    oldValue: e,
                                    newValue: this.fw.textDecoration
                                }))))
                            }
                            ,
                            t.prototype.pw = function() {
                                var e, t, i, o, n, a, s, l;
                                this.cw && (e = this.cw.fontFamily(),
                                    t = this.cw.fontSize(),
                                    i = this.cw.fontWeight(),
                                    o = this.cw.fontStyle(),
                                    n = this.cw.foreColor(),
                                    a = this.cw.textDecoration(),
                                    this.fw.family = e || this.Zv,
                                    this.fw.size = t || this.$v,
                                    this.fw.weight = i || void 0,
                                    this.fw.style = o || void 0,
                                    this.fw.foreColor = n || void 0,
                                    this.fw.textDecoration = a || 0,
                                    s = this.xo.find(".comment-font-picker"),
                                    s.fontpicker("family", this.fw.family),
                                    s.fontpicker("style", this.fw.style ? this.fw.style : "normal"),
                                    l = this.fw.size,
                                -1 !== l.indexOf("px") && (l = r.util.px2pt(parseInt(l))),
                                    s.fontpicker("size", parseInt(l)),
                                    s.fontpicker("weight", this.fw.weight ? this.fw.weight : "normal"),
                                    this.fw.foreColor ? s.fontpicker("color", r.ColorHelper.parse(this.fw.foreColor, r.wrapper.spread.getActiveSheet().currentTheme().colors())) : s.fontpicker("color", null),
                                    1 & this.fw.textDecoration ? s.fontpicker("underline", !0) : s.fontpicker("underline", !1),
                                    2 & this.fw.textDecoration ? s.fontpicker("strikethrough", !0) : s.fontpicker("strikethrough", !1))
                            }
                            ,
                            t.prototype.Cw = function() {
                                var e, t, i;
                                this.cw && (void 0 !== this.gw.hAlign && (e = this.cw.horizontalAlign(),
                                (t = n.HorizontalAlign[this.gw.hAlign]) !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "horizontalAlign",
                                    oldValue: e,
                                    newValue: t
                                })),
                                void 0 !== this.hw && (e = this.cw.autoSize(),
                                this.hw !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "autoSize",
                                    oldValue: e,
                                    newValue: this.hw
                                })),
                                void 0 !== this.iw && (e = this.cw.padding(),
                                    i = this.iw ? null : $.isEmptyObject(this.jw) ? null : new n.Comments.Padding(this.jw.top,this.jw.right,this.jw.bottom,this.jw.left),
                                this.Hw(e, i) || r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "padding",
                                    oldValue: e,
                                    newValue: i
                                })))
                            }
                            ,
                            t.prototype.Hw = function(e, t) {
                                return !e && !t || !(!e || !t || e.left !== t.left || e.right !== t.right || e.top !== t.top || e.bottom !== t.bottom)
                            }
                            ,
                            t.prototype.qw = function() {
                                var e, t, i;
                                this.cw && (e = this.cw.autoSize(),
                                    t = this.cw.horizontalAlign(),
                                void 0 !== t && this.Iw(this.xo.find(".hAlign-select"), n.HorizontalAlign[t]),
                                void 0 !== e && this.ww(this.xo.find("#auto-size"), e),
                                    i = this.cw.padding(),
                                    i ? (void 0 !== i.left && (this.Jw(this.xo.find("#padding-left"), i.left),
                                        this.iw = !1),
                                    void 0 !== i.right && (this.Jw(this.xo.find("#padding-right"), i.right),
                                        this.iw = !1),
                                    void 0 !== i.top && (this.Jw(this.xo.find("#padding-top"), i.top),
                                        this.iw = !1),
                                    void 0 !== i.bottom && (this.Jw(this.xo.find("#padding-bottom"), i.bottom),
                                        this.iw = !1)) : (this.iw = !0,
                                        this.xo.find(".padding-box").val("")),
                                    this.ww(this.xo.find("#automatic-padding"), this.iw))
                            }
                            ,
                            t.prototype.Dw = function() {
                                var e, t, i, o, n, a = this, s = this.cw;
                                s && (e = a.ow,
                                e.color !== s.backColor() && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "backColor",
                                    oldValue: s.backColor(),
                                    newValue: e.color
                                }),
                                e.transparency !== 1 - s.opacity() && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "opacity",
                                    oldValue: s.opacity(),
                                    newValue: 1 - e.transparency
                                }),
                                $.isEmptyObject(this.mw) || (t = this.cw.borderColor(),
                                this.mw.colorItem && (i = this.mw.colorItem.color) !== t && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "borderColor",
                                    oldValue: t,
                                    newValue: this.mw.colorItem.color
                                }),
                                    o = this.cw.borderStyle(),
                                this.mw.style && this.mw.style !== o && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "borderStyle",
                                    oldValue: o,
                                    newValue: this.mw.style
                                }),
                                    n = this.cw.borderWidth(),
                                this.mw.width && this.mw.width !== n && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "borderWidth",
                                    oldValue: n,
                                    newValue: this.mw.width
                                })))
                            }
                            ,
                            t.prototype.rw = function() {
                                var e, t, i, o, n, r;
                                this.cw && (e = this.cw.backColor(),
                                    t = parseFloat((1 - this.cw.opacity()).toFixed(2)),
                                    this.ow.color = e,
                                    this.ow.transparency = t,
                                    this._v.colorpicker("option", "value", e),
                                    this.xo.find(".comment-fill").css("background-color", e),
                                    i = 100 * t,
                                    this.xo.find(".color-transparent-slider").slider("option", "value", i),
                                    this.xo.find("#colors-transparent-input").val(i),
                                    o = this.cw.borderColor(),
                                o && (this.aw.colorpicker("option", "value", o),
                                    this.xo.find(".comment-line").css("background-color", o)),
                                    n = parseFloat(this.cw.borderWidth().toFixed(2)),
                                isNaN(n) || this.xo.find(".lines-width").val(n),
                                (r = this.cw.borderStyle()) && this.xo.find(".lines-style-select").val(r))
                            }
                            ,
                            t.prototype.Ew = function() {
                                var e, t;
                                this.cw && (void 0 === this.iq.height || this.hw || (e = this.cw.height(),
                                this.iq.height !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "height",
                                    oldValue: e,
                                    newValue: this.iq.height
                                })),
                                void 0 === this.iq.width || this.hw || (t = this.cw.width(),
                                this.iq.width !== t && r.actions.doAction("setCommentProperty", this.bw, {
                                    propertyName: "width",
                                    oldValue: t,
                                    newValue: this.iq.width
                                })))
                            }
                            ,
                            t.prototype.tw = function() {
                                var e, t;
                                this.cw && (e = this.cw.height(),
                                    t = this.cw.width(),
                                void 0 !== e && this.xo.find("#comment-size-height").val(e),
                                void 0 !== t && this.xo.find("#comment-size-width").val(t))
                            }
                            ,
                            t.prototype.Fw = function() {
                                if (this.cw) {
                                    var e;
                                    void 0 !== this.xw && (e = this.cw.locked(),
                                    this.xw !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                        propertyName: "locked",
                                        oldValue: e,
                                        newValue: this.xw
                                    })),
                                    void 0 !== this.yw && (e = this.cw.lockText(),
                                    this.yw !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                        propertyName: "lockText",
                                        oldValue: e,
                                        newValue: this.yw
                                    }))
                                }
                            }
                            ,
                            t.prototype.uw = function() {
                                var e, t;
                                this.cw && (e = this.cw.locked(),
                                    t = this.cw.lockText(),
                                void 0 !== e && this.xo.find("#comment-locked").prop("checked", e),
                                void 0 !== t && this.xo.find("#comment-lock-text").prop("checked", t))
                            }
                            ,
                            t.prototype.Gw = function() {
                                if (this.cw) {
                                    var e;
                                    void 0 !== this.zw && (e = this.cw.dynamicMove(),
                                    this.zw !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                        propertyName: "dynamicMove",
                                        oldValue: e,
                                        newValue: this.zw
                                    })),
                                    void 0 !== this.Aw && (e = this.cw.dynamicSize(),
                                    this.Aw !== e && r.actions.doAction("setCommentProperty", this.bw, {
                                        propertyName: "dynamicSize",
                                        oldValue: e,
                                        newValue: this.Aw
                                    }))
                                }
                            }
                            ,
                            t.prototype.vw = function() {
                                var e, t;
                                this.cw && (e = this.cw.dynamicMove(),
                                    t = this.cw.dynamicSize(),
                                    e && t ? this.xo.find("#move-size").prop("checked", !0) : e && !t ? this.xo.find("#move-no-size").prop("checked", !0) : this.xo.find("#no-move-size").prop("checked", !0))
                            }
                            ,
                            t.prototype.dw = function(e) {
                                var t, i, o = this.xo.find(".comment-tab-container li");
                                o.addClass("hidden");
                                for (t in e)
                                    e.hasOwnProperty(t) && -1 !== (i = $.inArray(t, this.Yv)) && e[t] && $(o[i]).removeClass("hidden")
                            }
                            ,
                            t.prototype.tv = function(e, t) {
                                var i, o, n, r, a;
                                if (t.type)
                                    return i = this,
                                        o = $("<div></div>").addClass("colorpicker-container"),
                                        n = $("<span></span>").appendTo(o),
                                        $("<span></span>").addClass("colorpicker-preview " + t.type).appendTo(n),
                                        r = $("<div></div>").addClass("colorpicker-popup").appendTo(o),
                                        a = $("<div></div>").colorpicker({
                                            valueChanged: function(e, o) {
                                                var n = void 0 === o.color ? "transparent" : o.color;
                                                switch (i.xo.find("." + t.type).css("background-color", n),
                                                    t.type) {
                                                    case "comment-fill":
                                                        i.ow.color = o.color;
                                                        break;
                                                    case "comment-line":
                                                        i.mw.colorItem = o
                                                }
                                            },
                                            choosedColor: function(e, t) {
                                                o.comboframe("close")
                                            },
                                            openColorDialog: function(e, t) {
                                                o.comboframe("close")
                                            }
                                        }).appendTo(r),
                                        o.comboframe().click(function() {
                                            o.comboframe("open")
                                        }),
                                        e.append(o),
                                        a
                            }
                            ,
                            t.prototype.ew = function(e) {
                                switch (e) {
                                    case "font":
                                        return 0;
                                    case "alignment":
                                        return 1;
                                    case "colors":
                                        return 2;
                                    case "size":
                                        return 3;
                                    case "protection":
                                        return 4;
                                    case "properties":
                                        return 5
                                }
                                return 0
                            }
                            ,
                            t.prototype.ww = function(e, t) {
                                var i = this.xo.find(e);
                                !0 === t ? (i.prop("indeterminate", !1),
                                    i.prop("checked", !0)) : !1 === t ? (i.prop("indeterminate", !1),
                                    i.prop("checked", !1)) : (i.prop("indeterminate", !0),
                                    i.prop("checked", !1))
                            }
                            ,
                            t.prototype.Iw = function(e, t) {
                                var i = this.xo.find(e);
                                t !== r.BaseMetaObject.indeterminateValue ? i.val(t) : i.val(null)
                            }
                            ,
                            t.prototype.Jw = function(e, t) {
                                var i = this.xo.find(e);
                                void 0 !== t && null !== t ? i.val(t) : i.val(null)
                            }
                            ,
                            t.prototype.Kw = function(e) {
                                var t, i, o, n, r, a = e.toLowerCase();
                                return -1 === a.indexOf("rgb") && -1 === a.indexOf("rgba") ? null : (t = e.split(","),
                                    4 === t.length ? (o = t[0].substr(t[0].indexOf("(") + 1),
                                        n = t[1],
                                        r = t[2],
                                        i = t[3].substr(0, t[3].indexOf(")")),
                                        [parseFloat(o), parseFloat(n), parseFloat(r), parseFloat(i)]) : 3 === t.length ? (o = t[0].substr(t[0].indexOf("(") + 1),
                                        n = t[1],
                                        r = t[2].substr(0, t[2].indexOf(")")),
                                        [parseFloat(o), parseFloat(n), parseFloat(r)]) : null)
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.FormatCommentDialog = y,
                    x = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".pie-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.pieSparklineDialog.pieSparklineSetting,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Lw = "pie-color-picker-widget",
                                    this.Mw(!0),
                                    this.Nw = {
                                        color: "#A9A9A9"
                                    }
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, o, n, a, s, l, c, d, p, u, h;
                                if (this.wv = r.wrapper.spread.getActiveSheet(),
                                    this.wv && e[0] && (t = e[0].row,
                                        i = e[0].col,
                                        o = r.util.parseFormulaSparkline(t, i),
                                        o.arguments)) {
                                    if (n = o.arguments[0],
                                            a = r.util.unParseFormula(n, t, i),
                                            this.xo.find(".pie-percentage").val(a),
                                            s = this.xo.find(".pie-colors-list").children().length,
                                        (l = o.arguments.length - 1) > s)
                                        for (c = 0; c < l - s; c++)
                                            this.xo.find(".add-pie-color").trigger("click");
                                    else if (l < s)
                                        for (c = 0; c < s - l; c++)
                                            d = this.xo.find(".remove-pie-color"),
                                            d.length > 0 && $(d[0]).trigger("click");
                                    if (0 === l)
                                        p = r.ColorHelper.parse(this.Nw.color, this.wv.currentTheme().colors()),
                                            $(".pie-color-picker1-widget").colorpicker("option", "selectedItem", p),
                                            this.xo.find(".pie-color-picker1").css("background-color", p.color);
                                    else
                                        for (c = 1; c <= l; c++) {
                                            u = null,
                                                h = U.parseColorExpression(o.arguments[c], t, i);
                                            try {
                                                u = r.ColorHelper.parse(h, this.wv.currentTheme().colors())
                                            } catch (e) {}
                                            $(".pie-color-picker" + c + "-widget").colorpicker("option", "selectedItem", u),
                                                this.xo.find(".pie-color-picker" + c).css("background-color", u && u.color ? u.color : "transparent")
                                        }
                                }
                            }
                            ,
                            t.prototype.sv = function() {
                                var e, t = $("#formulaBarText");
                                t.length > 0 && (e = this.wv.getFormula(this.wv.getActiveRowIndex(), this.wv.getActiveColumnIndex())) && (e = "=" + e,
                                    t.text(e))
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e, t, i, o, n = this.xo.find(".pie-percentage").val(), a = this.xo.find(".pie-colors-list").children().length, s = [];
                                for (s.push(n),
                                         e = 0; e < a; e++)
                                    t = e + 1,
                                        i = $(".pie-color-picker" + t + "-widget").colorpicker("option").selectedItem,
                                    1 === a && i.baseColor === this.Nw.color || i && i.color && s.push(i.color);
                                for (o = "=PIESPARKLINE(" + s[0],
                                         e = 1; e < s.length; e++)
                                    o += ',"' + s[e] + '"';
                                o += ")",
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: o,
                                        dataRange: n,
                                        type: 0
                                    }),
                                    this.sv(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this;
                                this.xo.find(".add-pie-color").bind("click", function() {
                                    e.Mw()
                                })
                            }
                            ,
                            t.prototype.Mw = function(e) {
                                var t, i, o, n, a, s, l, c = this.xo.find(".add-pie-color");
                                e ? c.addClass("add-pie-color") : c.addClass("remove-pie-color").removeClass("add-pie-color"),
                                    t = this.xo.find(".pie-colors-list"),
                                    i = this.Ow(),
                                    o = $("<div>").addClass("pie-color").data("value", i).appendTo(t),
                                    $("<label>").text(r.res.pieSparklineDialog.color + " " + i).addClass("pie-color-column").appendTo(o),
                                    n = "pie-color-picker" + i,
                                    a = $("<div>").addClass("pie-color-picker").appendTo(o),
                                    this.tv(a, n),
                                    s = $("<div>").addClass("add-pie-color").appendTo(o),
                                    $("<span>").addClass("ui-icon ui-icon-plus").appendTo(s),
                                    l = this,
                                    $(s).bind("click", function() {
                                        l.Mw()
                                    }),
                                    this.xo.find(".remove-pie-color").unbind(),
                                    this.xo.find(".remove-pie-color").bind("click", function(e) {
                                        l.Pw(e)
                                    })
                            }
                            ,
                            t.prototype.Pw = function(e) {
                                var t = this
                                    , i = $(e.target).parents("div.pie-color")
                                    , o = i.data("value")
                                    , n = $(".pie-color-picker" + o + "-widget");
                                n.length > 0 && (n.colorpicker("destroy"),
                                    n.parents("div.color-picker-popup").remove()),
                                i && 0 !== i.length && $(e.target).parents("div.pie-color").remove(),
                                    t.Qw()
                            }
                            ,
                            t.prototype.Qw = function() {
                                var e, t, i, o, n, a, s = r.res.pieSparklineDialog.color, l = this.xo.find(".pie-colors-list label"), c = l.length;
                                for (e = 1; e <= c; e++)
                                    $(l[e - 1]).text(s + " " + e),
                                        t = $(l[e - 1]).parents("div.pie-color"),
                                        i = "pie-color-picker" + e,
                                        o = t.find("span.color-picker-preview"),
                                    o.length > 0 && o.removeClass(o.attr("class")).addClass("color-picker-preview " + i),
                                        n = "pie-color-picker" + e + "-widget",
                                        a = $("." + this.Lw),
                                    a.length > 0 && a[e - 1] && $(a[e - 1]).removeClass($(a[e - 1]).attr("class")).addClass(this.Lw + " " + n),
                                        t.data("value", e)
                            }
                            ,
                            t.prototype.tv = function(e, t) {
                                var i, o, n = this, a = t + "-widget", s = $("<div></div>").addClass("color-picker-container"), l = $("<span></span>").appendTo(s);
                                return $("<span></span>").addClass("color-picker-preview " + t).appendTo(l),
                                    i = $("<div></div>").addClass("color-picker-popup").appendTo(s),
                                    o = $("<div></div>").colorpicker({
                                        valueChanged: function(e, t) {
                                            var i = void 0 === t.color ? "transparent" : t.color;
                                            n.xo.find(".pie-color-picker" + n.Rw).css("background-color", i)
                                        },
                                        choosedColor: function(e, t) {
                                            s.comboframe("close")
                                        },
                                        openColorDialog: function(e, t) {
                                            s.comboframe("close")
                                        }
                                    }).addClass(this.Lw + " " + a).appendTo(i),
                                    o.colorpicker("option", "themeColors", r.wrapper.getThemeColors()),
                                    s.comboframe().click(function(e) {
                                        s.comboframe("open");
                                        var t = $(e.target).parents("div.pie-color");
                                        n.Rw = t.data("value")
                                    }),
                                    e.append(s),
                                    o
                            }
                            ,
                            t.prototype.Ow = function() {
                                var e, t, i = r.res.pieSparklineDialog.color, o = this.xo.find(".pie-colors-list label");
                                for (e = o.length; e > 0; e--)
                                    if ((t = $(o[e - 1]).text()) === i + " " + e)
                                        return e + 1;
                                return 1
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.PieSparklineDialog = x,
                    w = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".area-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.areaSparklineDialog.areaSparklineSetting,
                                width: "500px",
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Uo = function() {
                                var e, t, i, o, n = this.xo.find(".area-data-range").val(), a = this.xo.find(".area-min-value").val(), s = this.xo.find(".area-max-value").val(), l = this.xo.find(".area-line1-value").val(), c = this.xo.find(".area-line2-value").val(), d = $(".positive-color-picker").colorpicker("option").selectedItem, p = "";
                                d && d.color && d.baseColor !== this.Nw.colorPositive && (p = '"' + d.color + '"'),
                                    e = $(".negative-color-picker").colorpicker("option").selectedItem,
                                    t = "",
                                e && e.color && e.baseColor !== this.Nw.colorNegative && (t = '"' + e.color + '"'),
                                    i = [n, a, s, l, c, p, t],
                                    o = this.Sw(i),
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: o,
                                        dataRange: n,
                                        type: 1
                                    }),
                                    this.sv(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.Sw = function(e) {
                                for (var t, i, o = e.length; o > 0 && "" === e[o - 1]; )
                                    o--;
                                for (t = "",
                                         i = 0; i < o; i++)
                                    t += e[i],
                                    i !== o - 1 && (t += ",");
                                return "=AREASPARKLINE(" + t + ")"
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, o, n, a, s, l, c, d, p;
                                if (this.wv = r.wrapper.spread.getActiveSheet(),
                                    this.wv && e[0] && (t = this.Tw,
                                        i = e[0].row,
                                        o = e[0].col,
                                        n = r.util.parseFormulaSparkline(i, o),
                                        n.arguments)) {
                                    for (a = n.arguments,
                                             s = t.length,
                                             l = 0; l < s; l++)
                                        a[l] ? this.xo.find(t[l]).val(r.util.unParseFormula(a[l], i, o)) : this.xo.find(t[l]).val("");
                                    c = null,
                                        d = U.parseColorExpression(a[5], i, o),
                                    d || (d = this.Nw.colorPositive);
                                    try {
                                        c = r.ColorHelper.parse(d, this.wv.currentTheme().colors())
                                    } catch (e) {}
                                    $(".positive-color-picker").colorpicker("option", "selectedItem", c),
                                        this.xo.find(".positive-color-span").css("background-color", c.color),
                                        p = U.parseColorExpression(a[6], i, o),
                                    p || (p = this.Nw.colorNegative);
                                    try {
                                        c = r.ColorHelper.parse(p, this.wv.currentTheme().colors())
                                    } catch (e) {}
                                    $(".negative-color-picker").colorpicker("option", "selectedItem", c),
                                        this.xo.find(".negative-color-span").css("background-color", c.color)
                                }
                            }
                            ,
                            t.prototype._init = function() {
                                this.Tw = [".area-data-range", ".area-min-value", ".area-max-value", ".area-line1-value", ".area-line2-value"],
                                    this.tv(this.xo.find(".positive-color"), "positive-color"),
                                    this.tv(this.xo.find(".negative-color"), "negative-color"),
                                    this.Nw = {
                                        colorPositive: "#787878",
                                        colorNegative: "#CB0000"
                                    }
                            }
                            ,
                            t.prototype.sv = function() {
                                var e, t = $("#formulaBarText");
                                t.length > 0 && (e = this.wv.getFormula(this.wv.getActiveRowIndex(), this.wv.getActiveColumnIndex())) && (e = "=" + e,
                                    t.text(e))
                            }
                            ,
                            t.prototype.tv = function(e, t) {
                                var i, o, n, a = this, s = t + "-span", l = $("<div></div>").addClass("area-color-picker-container"), c = $("<span></span>").appendTo(l);
                                $("<span></span>").addClass("area-color-picker-preview " + s).appendTo(c),
                                    i = $("<div></div>").addClass("area-color-picker-popup").appendTo(l),
                                    o = t + "-picker",
                                    n = $("<div></div>").colorpicker({
                                        valueChanged: function(e, t) {
                                            var i = void 0 === t.color ? "transparent" : t.color;
                                            a.xo.find("." + s).css("background-color", i)
                                        },
                                        choosedColor: function(e, t) {
                                            l.comboframe("close")
                                        },
                                        openColorDialog: function(e, t) {
                                            l.comboframe("close")
                                        }
                                    }).addClass(o).appendTo(i),
                                    n.colorpicker("option", "themeColors", r.wrapper.getThemeColors()),
                                    l.comboframe().click(function(e) {
                                        l.comboframe("open")
                                    }),
                                    e.append(l)
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.AreaSparklineDialog = w,
                    C = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".scatter-sparkline-dialog"),
                                this.Uw = "ColorValueChanged"
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.scatterSparklineDialog.scatterSparklineSetting,
                                width: "600px",
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Tw = [".scatter-points1", ".scatter-points2", ".scatter-minx", ".scatter-maxx", ".scatter-miny", ".scatter-maxy", ".scatter-hline", ".scatter-vline", ".scatter-xmin-zone", ".scatter-xmax-zone", ".scatter-ymin-zone", ".scatter-ymax-zone"],
                                    this.tv(this.xo.find(".scatter-color1"), "scatter-color1"),
                                    this.tv(this.xo.find(".scatter-color2"), "scatter-color2"),
                                    this.Nw = {
                                        tags: !1,
                                        drawSymbol: !0,
                                        drawLines: !1,
                                        dash: !1,
                                        color1: "#969696",
                                        color2: "#CB0000"
                                    },
                                    this.Iv()
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e, t, i, o = this.Vw, n = "";
                                for (e = 0; e < o.length; e++)
                                    t = o[e],
                                        n += void 0 !== t && null !== t ? t + "," : ",";
                                n = this.Ww(n),
                                    i = "=SCATTERSPARKLINE(" + n + ")",
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: i,
                                        dataRange: this.Vw[0],
                                        type: 2
                                    }),
                                    this.sv(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.Ww = function(e) {
                                for (var t = e.length; t > 0 && "," === e[t - 1]; )
                                    t--;
                                return e.substr(0, t)
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = e.xo;
                                t.find(".scatter-points1").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".scatter-points2").keyup(function() {
                                        e.Vw[1] = $(this).val()
                                    }),
                                    t.find(".scatter-minx").keyup(function() {
                                        e.Vw[2] = $(this).val()
                                    }),
                                    t.find(".scatter-maxx").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    t.find(".scatter-miny").keyup(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    t.find(".scatter-maxy").keyup(function() {
                                        e.Vw[5] = $(this).val()
                                    }),
                                    t.find(".scatter-hline").keyup(function() {
                                        e.Vw[6] = $(this).val()
                                    }),
                                    t.find(".scatter-vline").keyup(function() {
                                        e.Vw[7] = $(this).val()
                                    }),
                                    t.find(".scatter-xmin-zone").keyup(function() {
                                        e.Vw[8] = $(this).val()
                                    }),
                                    t.find(".scatter-xmax-zone").keyup(function() {
                                        e.Vw[9] = $(this).val()
                                    }),
                                    t.find(".scatter-ymin-zone").keyup(function() {
                                        e.Vw[10] = $(this).val()
                                    }),
                                    t.find(".scatter-ymax-zone").keyup(function() {
                                        e.Vw[11] = $(this).val()
                                    }),
                                    t.find(".scatter-tags").change(function() {
                                        e.Vw[12] = $(this).prop("checked")
                                    }),
                                    t.find(".scatter-drawsymbol").change(function() {
                                        e.Vw[13] = $(this).prop("checked")
                                    }),
                                    t.find(".scatter-drawlines").change(function() {
                                        e.Vw[14] = $(this).prop("checked")
                                    }),
                                    $(".scatter-point1").bind(this.Uw, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[15] = '"' + o + '"'
                                    }),
                                    $(".scatter-point2").bind(this.Uw, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "tranparent";
                                        e.Vw[16] = '"' + o + '"'
                                    }),
                                    t.find(".scatter-dash").change(function() {
                                        e.Vw[17] = $(this).prop("checked")
                                    })
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, n, a, s, l, c, d, p, u, h, f, g, m, b, v;
                                if (this.Vw = [],
                                        this.wv = r.wrapper.spread.getActiveSheet(),
                                    this.wv && e[0] && (t = e[0].row,
                                        i = e[0].col,
                                        n = r.util.parseFormulaSparkline(t, i),
                                        n.arguments)) {
                                    for (a = n.arguments,
                                             s = this.Tw,
                                             l = s.length,
                                             c = 0; c < l; c++)
                                        d = "",
                                        a[c] && (d = r.util.unParseFormula(a[c], t, i)),
                                            this.xo.find(s[c]).val(d),
                                            this.Vw.push(d);
                                    p = null,
                                        u = null,
                                        h = null,
                                        f = null,
                                    a[12] && (p = a[12].type === o.CalcEngine.ExpressionType.boolean ? a[12].value : null),
                                    a[13] && (u = a[13].type === o.CalcEngine.ExpressionType.boolean ? a[13].value : null),
                                    a[14] && (h = a[14].type === o.CalcEngine.ExpressionType.boolean ? a[14].value : null),
                                        g = U.parseColorExpression(a[15], t, i),
                                        m = U.parseColorExpression(a[16], t, i),
                                    a[17] && (f = a[17].type === o.CalcEngine.ExpressionType.boolean ? a[17].value : null),
                                        b = g ? '"' + g + '"' : null,
                                        v = m ? '"' + m + '"' : null,
                                        this.Xw("scatter-tags", null !== p ? p : this.Nw.tags),
                                        this.Xw("scatter-drawsymbol", null !== u ? u : this.Nw.drawSymbol),
                                        this.Xw("scatter-drawlines", null !== h ? h : this.Nw.drawLines),
                                        this.Xw("scatter-dash", null !== f ? f : this.Nw.dash),
                                        this.Yw("scatter-color1", null !== g ? g : this.Nw.color1),
                                        this.Yw("scatter-color2", null !== m ? m : this.Nw.color2),
                                        this.Vw.push(p, u, h, b, v, f)
                                }
                            }
                            ,
                            t.prototype.Yw = function(e, t) {
                                var i, o = $("." + e + "-picker");
                                if (0 !== o.length)
                                    if (t) {
                                        i = null;
                                        try {
                                            i = r.ColorHelper.parse(t, this.wv.currentTheme().colors())
                                        } catch (e) {}
                                        i && i.color && (o.colorpicker("option", "selectedItem", i),
                                            this.xo.find("." + e + "-span").css("background-color", i.color))
                                    } else
                                        o.colorpicker("option", "selectedItem", null),
                                            this.xo.find("." + e + "-span").css("background-color", "transparent")
                            }
                            ,
                            t.prototype.tv = function(e, t) {
                                var i, o, n, a = this, s = t + "-span", l = $("<div></div>").addClass("scatter-color-picker-container"), c = $("<span></span>").appendTo(l);
                                $("<span></span>").addClass("scatter-color-picker-preview " + s).appendTo(c),
                                    i = $("<div></div>").addClass("scatter-color-picker-popup").appendTo(l),
                                    o = t + "-picker",
                                    n = $("<div></div>").colorpicker({
                                        valueChanged: function(e, t) {
                                            var i = void 0 === t.color ? "transparent" : t.color;
                                            "scatter-color1-picker" === e.target.className ? a.Vw[15] = '"' + i + '"' : a.Vw[16] = '"' + i + '"',
                                                a.xo.find("." + s).css("background-color", i),
                                                $(this).trigger(a.Uw, {
                                                    value: t
                                                })
                                        },
                                        choosedColor: function(e, t) {
                                            l.comboframe("close")
                                        },
                                        openColorDialog: function(e, t) {
                                            l.comboframe("close")
                                        }
                                    }).addClass(o).appendTo(i),
                                    n.colorpicker("option", "themeColors", r.wrapper.getThemeColors()),
                                    l.comboframe().click(function(e) {
                                        l.comboframe("open")
                                    }),
                                    e.append(l)
                            }
                            ,
                            t.prototype.sv = function() {
                                var e, t = $("#formulaBarText");
                                t.length > 0 && (e = this.wv.getFormula(this.wv.getActiveRowIndex(), this.wv.getActiveColumnIndex())) && (e = "=" + e,
                                    t.text(e))
                            }
                            ,
                            t.prototype.Zw = function(e, t) {
                                var i = this.xo.find("." + e);
                                void 0 !== t ? i.val(t) : i.val("")
                            }
                            ,
                            t.prototype.Xw = function(e, t, i) {
                                void 0 !== t ? this.xo.find("." + e).prop("checked", t) : this.xo.find("." + e).prop("checked", i)
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.ScatterSparklineDialog = C,
                    S = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".compatible-style-setting")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.compatibleSparklineDialog.styleSetting,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function(e) {
                                if (this.$w = {},
                                        this.wv = r.wrapper.spread.getActiveSheet(),
                                    void 0 !== e[0]) {
                                    var t = e[0];
                                    this._w = e[0],
                                        this.Yw("axis", (t.axisColor ? t.axisColor : t.ac) || this.Nw.axis),
                                        this.Yw("series", (t.seriesColor ? t.seriesColor : t.sc) || this.Nw.series),
                                        this.Yw("markers", (t.markersColor ? t.markersColor : t.mc) || this.Nw.markers),
                                        this.Yw("negative", (t.negativeColor ? t.negativeColor : t.nc) || this.Nw.negativePoints),
                                        this.Yw("first-marker", (t.firstMarkerColor ? t.firstMarkerColor : t.fmc) || this.Nw.firstPoint),
                                        this.Yw("high-marker", (t.highMarkerColor ? t.highMarkerColor : t.hmc) || this.Nw.highPoint),
                                        this.Yw("last-marker", (t.lastMarkerColor ? t.lastMarkerColor : t.lastmc) || this.Nw.lastPoint),
                                        this.Yw("low-marker", (t.lowMarkerColor ? t.lowMarkerColor : t.lowmc) || this.Nw.lowPoint),
                                        this.Zw("compatible-line-weight", t.lineWeight || t.lw)
                                }
                            }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    negativePoints: "#A52A2A",
                                    markers: "#244062",
                                    highPoint: "#0000FF",
                                    lowPoint: "#0000FF",
                                    firstPoint: "#95B3D7",
                                    lastPoint: "#95B3D7",
                                    series: "#244062",
                                    axis: "#000000"
                                },
                                    this.ax = {
                                        axiscolor: "ac",
                                        firstmarkercolor: "fmc",
                                        highmarkercolor: "hmc",
                                        lastmarkercolor: "lastmc",
                                        lowmarkercolor: "lowmc",
                                        markerscolor: "mc",
                                        negativecolor: "nc",
                                        seriescolor: "sc",
                                        lineweight: "lw"
                                    },
                                    this.tv(this.xo.find(".compatible-axis"), "axis", "axisColor"),
                                    this.tv(this.xo.find(".compatible-series"), "series", "seriesColor"),
                                    this.tv(this.xo.find(".compatible-markers"), "markers", "markersColor"),
                                    this.tv(this.xo.find(".compatible-negative"), "negative", "negativeColor"),
                                    this.tv(this.xo.find(".compatible-first-marker"), "first-marker", "firstMarkerColor"),
                                    this.tv(this.xo.find(".compatible-high-marker"), "high-marker", "highMarkerColor"),
                                    this.tv(this.xo.find(".compatible-last-marker"), "last-marker", "lastMarkerColor"),
                                    this.tv(this.xo.find(".compatible-low-marker"), "low-marker", "lowMarkerColor"),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Yw = function(e, t) {
                                var i, o = $("." + e + "-picker");
                                if (0 !== o.length)
                                    if (t) {
                                        i = null;
                                        try {
                                            i = r.ColorHelper.parse(t, this.wv.currentTheme().colors())
                                        } catch (e) {}
                                        i && i.color && (o.colorpicker("option", "selectedItem", i),
                                            this.xo.find("." + e + "-span").css("background-color", i.color))
                                    } else
                                        o.colorpicker("option", "selectedItem", null),
                                            this.xo.find("." + e + "-span").css("background-color", "transparent")
                            }
                            ,
                            t.prototype.Zw = function(e, t) {
                                void 0 !== t ? this.xo.find("." + e).val(t) : this.xo.find("." + e).val("")
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this;
                                this.xo.find(".compatible-line-weight").keyup(function() {
                                    var t = e.xo.find(".compatible-line-weight").val();
                                    e.$w.lineWeight = t
                                })
                            }
                            ,
                            t.prototype.bx = function() {
                                this.Yw("axis", this.Nw.axis),
                                    this.Yw("series", this.Nw.series),
                                    this.Yw("markers", this.Nw.markers),
                                    this.Yw("negative", this.Nw.negativePoints),
                                    this.Yw("first-marker", this.Nw.firstPoint),
                                    this.Yw("high-marker", this.Nw.highPoint),
                                    this.Yw("last-marker", this.Nw.lastPoint),
                                    this.Yw("low-marker", this.Nw.lowPoint),
                                    this.Zw("compatible-line-weight")
                            }
                            ,
                            t.prototype.Uo = function() {
                                $(this).trigger("compatibleStyleOkClick", this.$w),
                                    this.bx(),
                                    this.close()
                            }
                            ,
                            t.prototype.tv = function(e, t, i) {
                                var o, n, a, s = this, l = t + "-span", c = $("<div></div>").addClass("compatible-color-picker-container"), d = $("<span></span>").appendTo(c);
                                $("<span></span>").addClass("compatible-color-picker-preview " + l).appendTo(d),
                                    o = $("<div></div>").addClass("compatible-color-picker-popup").appendTo(c),
                                    n = t + "-picker",
                                    a = $("<div></div>").colorpicker({
                                        valueChanged: function(e, t) {
                                            var o, n = void 0 === t.color ? "transparent" : t.color;
                                            s.xo.find("." + l).css("background-color", n),
                                                o = s.ax[i.toLowerCase()],
                                                void 0 !== s._w[o] ? s.$w[o] = n : s.$w[i] = n
                                        },
                                        choosedColor: function(e, t) {
                                            c.comboframe("close")
                                        },
                                        openColorDialog: function(e, t) {
                                            c.comboframe("close")
                                        }
                                    }).addClass(n).appendTo(o),
                                    a.colorpicker("option", "themeColors", r.wrapper.getThemeColors()),
                                    c.comboframe().click(function(e) {
                                        c.comboframe("open")
                                    }),
                                    e.append(c)
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.CompatibleStyleSettingDialog = S,
                    k = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".compatible-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.compatibleSparklineDialog.compatibleSparklineSetting,
                                width: "580px",
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, o, n, a;
                                this.ex = "",
                                    this.gx = {},
                                    this.wv = r.wrapper.spread.getActiveSheet(),
                                this.wv && e[0] && (t = e[0].row,
                                    i = e[0].col,
                                (o = r.util.parseFormulaSparkline(t, i)) && (o.function.name && (this.ex = o.function.name),
                                o.arguments && o.arguments.length > 0 && (n = o.arguments,
                                    this.Zw("com-data", r.util.unParseFormula(n[0], t, i)),
                                    this.hx("com-data-orientation", n[1].value),
                                    n[2] ? this.Zw("com-date-axis-data", r.util.unParseFormula(n[2], t, i)) : this.Zw("com-date-axis-data"),
                                    n[3] ? this.hx("com-date-axis-orientation", n[3].value) : this.hx("com-date-axis-orientation"),
                                    a = U.parseColorExpression(n[4], t, i),
                                a && (this.gx = this.ix(a)),
                                    this.jx(this.gx))))
                            }
                            ,
                            t.prototype.ix = function(e) {
                                var t, i, o, n, r, a = {}, s = !1, l = !0, c = "", d = "";
                                if (e) {
                                    for (e = e.substr(1, e.length - 2),
                                             t = 0,
                                             i = e.length; t < i; t++)
                                        o = e.charAt(t),
                                            ":" === o ? l = !1 : "," !== o || s ? "'" === o || '"' === o || ("(" === o ? s = !0 : ")" === o && (s = !1),
                                                l ? c += o : d += o) : (a[c] = d,
                                                c = "",
                                                d = "",
                                                l = !0);
                                    c && (a[c] = d);
                                    for (n in a)
                                        null !== (r = a[n]) && void 0 !== r && ("TRUE" === r.toUpperCase() ? a[n] = !0 : "FALSE" === r.toUpperCase() ? a[n] = !1 : !isNaN(r) && isFinite(r) && (a[n] = parseFloat(r)))
                                }
                                return a
                            }
                            ,
                            t.prototype.bx = function() {
                                this.hx("com-display-emptycell-as", -1),
                                    this.Xw("com-display-hidden", this.kx.displayHidden),
                                    this.Xw("com-show-first", this.kx.showFirst),
                                    this.Xw("com-show-last", this.kx.showLast),
                                    this.Xw("com-show-high", this.kx.showHigh),
                                    this.Xw("com-show-low", this.kx.showLow),
                                    this.Xw("com-show-negative", this.kx.showNegative),
                                    this.Xw("com-show-markers", this.kx.showMarkers),
                                    this.Xw("com-show-markers", this.kx.showMarkers),
                                    this.Xw("com-right-to-left", this.kx.rightToLeft),
                                    this.Xw("com-display-xaxis", this.kx.displayXAxis),
                                    this.hx("com-min-axis-type", -1),
                                    this.hx("com-max-axis-type", -1),
                                    this.Zw("com-manual-max", ""),
                                    this.Zw("com-manual-min", "")
                            }
                            ,
                            t.prototype.jx = function(e) {
                                if (e) {
                                    this.hx("com-display-emptycell-as", void 0 !== e.displayEmptyCellsAs ? e.displayEmptyCellsAs : e.deca),
                                        this.Xw("com-display-hidden", void 0 !== e.displayHidden ? e.displayHidden : e.dh, this.kx.displayHidden),
                                        this.Xw("com-show-first", void 0 !== e.showFirst ? e.showFirst : e.sf, this.kx.showFirst),
                                        this.Xw("com-show-last", void 0 !== e.showLast ? e.showLast : e.slast, this.kx.showLast),
                                        this.Xw("com-show-high", void 0 !== e.showHigh ? e.showHigh : e.sh, this.kx.showHigh),
                                        this.Xw("com-show-low", void 0 !== e.showLow ? e.showLow : e.slow, this.kx.showLow),
                                        this.Xw("com-show-negative", void 0 !== e.showNegative ? e.showNegative : e.sn, this.kx.showNegative),
                                        this.Xw("com-show-markers", void 0 !== e.showMarkers ? e.showMarkers : e.sm, this.kx.showMarkers),
                                        this.Xw("com-right-to-left", void 0 !== e.rightToLeft ? e.rightToLeft : e.rtl, this.kx.rightToLeft),
                                        this.Xw("com-display-xaxis", void 0 !== e.displayXAxis ? e.displayXAxis : e.dxa, this.kx.displayXAxis),
                                        this.hx("com-min-axis-type", void 0 !== e.minAxisType ? e.minAxisType : e.minat),
                                        this.hx("com-max-axis-type", void 0 !== e.maxAxisType ? e.maxAxisType : e.maxat),
                                        this.Zw("com-manual-max", void 0 !== e.manualMax ? e.manualMax : e.mmax),
                                        this.Zw("com-manual-min", void 0 !== e.manualMin ? e.manualMin : e.mmin);
                                    var t = this.xo.find(".com-min-axis-type").val();
                                    this.lx(t, "com-manual-min-label", "com-manual-min"),
                                        t = this.xo.find(".com-max-axis-type").val(),
                                        this.lx(t, "com-manual-max-label", "com-manual-max")
                                }
                            }
                            ,
                            t.prototype.hx = function(e, t) {
                                var i = this.xo.find("." + e).get(0);
                                void 0 !== t ? (t >= i.length && (t = i.length - 1),
                                    i.selectedIndex = t) : i.selectedIndex = -1
                            }
                            ,
                            t.prototype.Zw = function(e, t) {
                                var i = this.xo.find("." + e);
                                void 0 !== t ? i.val(t) : i.val("")
                            }
                            ,
                            t.prototype.Xw = function(e, t, i) {
                                void 0 !== t ? (t = !!t,
                                    this.xo.find("." + e).prop("checked", t)) : this.xo.find("." + e).prop("checked", i)
                            }
                            ,
                            t.prototype.lx = function(e, t, i) {
                                var o = this.xo.find("." + i)
                                    , n = this.xo.find("." + t);
                                "custom" !== e ? (o.addClass("manual-disable").attr("disabled", "disabled"),
                                    n.addClass("manual-disable")) : (o.removeClass("manual-disable").removeAttr("disabled"),
                                    n.removeClass("manual-disable"))
                            }
                            ,
                            t.prototype._init = function() {
                                this.xo.find(".com-color-setting").button(),
                                    this.kx = {
                                        displayEmptyCellsAs: 0,
                                        rightToLeft: !1,
                                        displayHidden: !1,
                                        displayXAxis: !1,
                                        showFirst: !1,
                                        showHigh: !1,
                                        showLast: !1,
                                        showLow: !1,
                                        showNegative: !1,
                                        showMarkers: !1,
                                        manualMax: 0,
                                        manualMin: 0,
                                        maxAxisType: 0,
                                        minAxisType: 0
                                    },
                                    this.ax = {
                                        axiscolor: "ac",
                                        firstmarkercolor: "fmc",
                                        highmarkercolor: "hmc",
                                        lastmarkercolor: "lastmc",
                                        lowmarkercolor: "lowmc",
                                        markerscolor: "mc",
                                        negativecolor: "nc",
                                        seriescolor: "sc",
                                        displayemptycellsas: "deca",
                                        righttoleft: "rtl",
                                        displayhidden: "dh",
                                        displayxaxis: "dxa",
                                        showfirst: "sf",
                                        showhigh: "sh",
                                        showlast: "slast",
                                        showlow: "slow",
                                        shownegative: "sn",
                                        showmarkers: "sm",
                                        manualmax: "mmax",
                                        manualmin: "mmin",
                                        maxaxistype: "maxat",
                                        minaxistype: "minat",
                                        lineweight: "lw"
                                    },
                                this.mx || (this.mx = new S),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = e.xo;
                                t.find(".com-color-setting").bind("click", function() {
                                    e.mx.open(e.gx)
                                }),
                                    $(this.mx).bind("compatibleStyleOkClick", function(t, i) {
                                        e.gx = $.extend({}, e.gx, i)
                                    }),
                                    t.find(".com-display-emptycell-as").change(function() {
                                        var t = e.gx
                                            , i = n.Sparklines.EmptyValueStyle[e.xo.find(".com-display-emptycell-as").val()];
                                        void 0 !== t.deca ? t.deca = i : t.displayEmptyCellsAs = i
                                    }),
                                    t.find(".com-display-hidden").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-display-hidden").prop("checked");
                                        void 0 !== t.dh ? t.dh = i : t.displayHidden = i
                                    }),
                                    t.find(".com-show-first").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-show-first").prop("checked");
                                        void 0 !== t.sf ? t.sf = i : t.showFirst = i
                                    }),
                                    t.find(".com-show-last").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-show-last").prop("checked");
                                        void 0 !== t.slast ? t.slast = i : t.showLast = i
                                    }),
                                    t.find(".com-show-high").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-show-high").prop("checked");
                                        void 0 !== t.sh ? t.sh = i : t.showHigh = i
                                    }),
                                    t.find(".com-show-low").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-show-low").prop("checked");
                                        t.slow ? t.slow = i : t.showLow = i
                                    }),
                                    t.find(".com-show-negative").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-show-negative").prop("checked");
                                        void 0 !== t.sn ? t.sn = i : t.showNegative = i
                                    }),
                                    t.find(".com-show-markers").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-show-markers").prop("checked");
                                        void 0 !== t.sm ? t.sm = i : t.showMarkers = i
                                    }),
                                    t.find(".com-min-axis-type").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-min-axis-type").val();
                                        void 0 !== t.minat ? t.minat = n.Sparklines.SparklineAxisMinMax[i] : t.minAxisType = n.Sparklines.SparklineAxisMinMax[i],
                                            e.lx(i, "com-manual-min-label", "com-manual-min")
                                    }),
                                    t.find(".com-max-axis-type").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-max-axis-type").val();
                                        void 0 !== t.maxat ? t.maxat = n.Sparklines.SparklineAxisMinMax[i] : t.maxAxisType = n.Sparklines.SparklineAxisMinMax[i],
                                            e.lx(i, "com-manual-max-label", "com-manual-max")
                                    }),
                                    t.find(".com-manual-max").keyup(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-manual-max").val();
                                        void 0 !== t.mmax ? t.mmax = i : t.manualMax = i
                                    }),
                                    t.find(".com-manual-min").keyup(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-manual-min").val();
                                        void 0 !== t.mmin ? t.mmin = i : t.manualMin = i
                                    }),
                                    t.find(".com-right-to-left").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-right-to-left").prop("checked");
                                        void 0 !== t.rtl ? t.rtl = i : t.rightToLeft = i
                                    }),
                                    t.find(".com-display-xaxis").change(function() {
                                        var t = e.gx
                                            , i = e.xo.find(".com-display-xaxis").prop("checked");
                                        void 0 !== t.dxa ? t.dxa = i : t.displayXAxis = i
                                    })
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e, t, i, o, a = this.xo.find(".com-data").val(), s = n.Sparklines.DataOrientation[this.xo.find(".com-data-orientation").val()], l = this.xo.find(".com-date-axis-data").val(), c = n.Sparklines.DataOrientation[this.xo.find(".com-date-axis-orientation").val()];
                                void 0 === c && (c = ""),
                                    e = [];
                                for (t in this.gx)
                                    void 0 !== this.gx[t] && "" !== this.gx[t] && e.push(t + ":" + this.gx[t]);
                                if (i = "",
                                    e.length > 0 && (i = '"{' + e.join(",") + '}"'),
                                        o = "",
                                        o = "" !== i ? "=" + this.ex + "(" + a + "," + s + "," + l + "," + c + "," + i + ")" : "" !== c ? "=" + this.ex + "(" + a + "," + s + "," + l + "," + c + ")" : "" !== l ? "=" + this.ex + "(" + a + "," + s + "," + l + ")" : "=" + this.ex + "(" + a + "," + s + ")",
                                    o.length >= 250) {
                                    e = [];
                                    for (t in this.gx)
                                        void 0 !== this.gx[t] && "" !== this.gx[t] && e.push(this.nx(t, !0) + ":" + this.nx(this.gx[t])),
                                            i = '"{' + e.join(",") + '}"',
                                            o = "=" + this.ex + "(" + a + "," + s + "," + l + "," + c + "," + i + ")"
                                }
                                r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                    formula: o,
                                    type: 3,
                                    dataRange: a
                                }),
                                    this.sv(),
                                    this.bx(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.nx = function(e, t) {
                                var i, o, n, a, s;
                                if (t)
                                    return (i = this.ax[e.toLowerCase()]) || e;
                                if (e.length > 9 && (e = e.toLowerCase(),
                                    -1 !== e.indexOf("rgb"))) {
                                    if ((o = r.util.parseColorString(e)) && o.length > 0)
                                        for (n = "#",
                                                 a = 0; a < o.length; a++)
                                            s = o[a].toString(16),
                                            1 === s.length && (s = "0" + s),
                                                n += s;
                                    if ("#" !== n)
                                        return n
                                }
                                return e
                            }
                            ,
                            t.prototype.sv = function() {
                                var e, t = $("#formulaBarText");
                                t.length > 0 && (e = this.wv.getFormula(this.wv.getActiveRowIndex(), this.wv.getActiveColumnIndex())) && (e = "=" + e,
                                    t.text(e))
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.CompatibleSparklineDialog = k,
                    T = function(e) {
                        r.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i),
                                this.sheet = r.wrapper.spread.getActiveSheet(),
                                this.colorValueChanged = "ColorValueChanged"
                        }
                        return t.prototype.updateTextBox = function(e, t) {
                            var i = this.xo.find("." + e);
                            void 0 !== t ? i.val(t) : i.val("")
                        }
                            ,
                            t.prototype.updateColorPicker = function(e, t, i) {
                                var o, n = $("." + e);
                                if (0 !== n.length)
                                    if (i) {
                                        o = null;
                                        try {
                                            o = r.ColorHelper.parse(i, this.sheet.currentTheme().colors())
                                        } catch (e) {}
                                        o && o.color && (n.colorpicker("option", "selectedItem", o),
                                            this.xo.find("." + t).css("background-color", o.color))
                                    } else
                                        n.colorpicker("option", "selectedItem", null),
                                            this.xo.find("." + t).css("background-color", "transparent")
                            }
                            ,
                            t.prototype.updateCheckBox = function(e, t, i) {
                                void 0 !== t && null !== t ? this.xo.find("." + e).prop("checked", t) : this.xo.find("." + e).prop("checked", i)
                            }
                            ,
                            t.prototype.updateSelect = function(e, t) {
                                var i = this.xo.find("." + e);
                                void 0 !== t && i.val(t)
                            }
                            ,
                            t.prototype.removeContinuousComma = function(e) {
                                for (var t = e.length; t > 0 && "," === e[t - 1]; )
                                    t--;
                                return e.substr(0, t)
                            }
                            ,
                            t.prototype.updateFormulaBar = function() {
                                var e, t = $("#formulaBarText");
                                t.length > 0 && (e = this.sheet.getFormula(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())) && (e = "=" + e,
                                    t.text(e))
                            }
                            ,
                            t.prototype.createColorPicker = function(e, t, i) {
                                var o = this;
                                this.xo.find("." + i).colorpicker({
                                    valueChanged: function(e, i) {
                                        void 0 === i.color ? o.xo.find("." + t).css("background-color", "transparent") : o.xo.find("." + t).css("background-color", i.color),
                                            $(this).trigger(o.colorValueChanged, {
                                                value: i
                                            })
                                    },
                                    choosedColor: function(t, i) {
                                        o.xo.find("." + e).comboframe("close")
                                    },
                                    openColorDialog: function(t, i) {
                                        o.xo.find("." + e).comboframe("close")
                                    }
                                }),
                                    this.xo.find("." + i).colorpicker("option", "themeColors", r.wrapper.getThemeColors()),
                                    this.xo.find("." + e).comboframe()
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.SparklineExBaseDialog = T,
                    A = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".bullet-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.bulletSparklineDialog.bulletSparklineSetting,
                                minWidth: 500,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.ox(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())
                            }
                            ,
                            t.prototype.ox = function(e, t) {
                                var i, n, a, s, l, c, d, p, u, h, f, g = r.util.parseFormulaSparkline(e, t);
                                g && g.arguments ? (i = g.arguments) && i.length > 0 && (n = r.util.unParseFormula(i[0], e, t),
                                    a = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0,
                                    s = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0,
                                    l = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0,
                                    c = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0,
                                    d = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0,
                                    p = i[6] ? r.util.unParseFormula(i[6], e, t) : void 0,
                                    u = i[7] ? U.parseColorExpression(i[7], e, t) : void 0,
                                i[8] && (h = i[8].type === o.CalcEngine.ExpressionType.boolean ? i[8].value : null),
                                    this.updateTextBox("bullet-measure", n),
                                    this.updateTextBox("bullet-target", a),
                                    this.updateTextBox("bullet-maxi", s),
                                    this.updateTextBox("bullet-good", l),
                                    this.updateTextBox("bullet-bad", c),
                                    this.updateTextBox("bullet-forecast", d),
                                    this.updateTextBox("bullet-tickunit", p),
                                    this.updateColorPicker("bullet-color-picker", "bullet-color-span", u || this.Nw.colorScheme),
                                    this.updateCheckBox("bullet-vertical", h, this.Nw.vertical),
                                    f = u ? '"' + u + '"' : null,
                                    this.Vw = [n, a, s, l, c, d, p, f, h]) : this.bx()
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("bullet-measure", ""),
                                    this.updateTextBox("bullet-target", ""),
                                    this.updateTextBox("bullet-maxi", ""),
                                    this.updateTextBox("bullet-good", ""),
                                    this.updateTextBox("bullet-bad", ""),
                                    this.updateTextBox("bullet-forecast", ""),
                                    this.updateTextBox("bullet-tickunit", ""),
                                    this.updateColorPicker("bullet-color-picker", "bullet-color-span", this.Nw.colorScheme),
                                    this.updateCheckBox("bullet-vertical", this.Nw.vertical)
                            }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    vertical: !1,
                                    colorScheme: "#A0A0A0"
                                },
                                    this.createColorPicker("bullet-color-frame", "bullet-color-span", "bullet-color-picker"),
                                    this.Pv()
                            }
                            ,
                            t.prototype.Pv = function() {
                                var e = this
                                    , t = this.xo;
                                t.find(".bullet-measure").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".bullet-target").keyup(function() {
                                        e.Vw[1] = $(this).val()
                                    }),
                                    t.find(".bullet-maxi").keyup(function() {
                                        e.Vw[2] = $(this).val()
                                    }),
                                    t.find(".bullet-forecast").keyup(function() {
                                        e.Vw[5] = $(this).val()
                                    }),
                                    t.find(".bullet-good").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    t.find(".bullet-bad").keyup(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    t.find(".bullet-tickunit").keyup(function() {
                                        e.Vw[6] = $(this).val()
                                    }),
                                    $(".bullet-color-picker").bind(this.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[7] = '"' + o + '"'
                                    }),
                                    t.find(".bullet-vertical").change(function() {
                                        e.Vw[8] = $(this).prop("checked")
                                    })
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t, i, o, a = this.Vw, s = "";
                                for (e = 0; e < a.length; e++)
                                    t = a[e],
                                        s += void 0 !== t && null !== t ? t + "," : ",";
                                s = this.removeContinuousComma(s),
                                    i = "=BULLETSPARKLINE(" + s + ")",
                                    o = this.sheet.getSelections(),
                                    r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, {
                                        formula: i,
                                        type: 4,
                                        locationRange: o.length > 0 ? o[0] : new n.Range(0,0,1,1)
                                    }),
                                    r.ribbon.updateSparkline(),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t
                    }(T),
                    r.BulletSparklineDialog = A,
                    I = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".spread-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.spreadSparklineDialog.spreadSparklineSetting,
                                minWidth: 500,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    showAverage: !1,
                                    style: 4,
                                    colorScheme: "#646464",
                                    vertical: !1
                                },
                                    this.createColorPicker("spread-color-frame", "spread-color-span", "spread-color-picker"),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.px(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = e.xo;
                                t.find(".spread-points").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".spread-style").change(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    t.find(".spread-scale-start").keyup(function() {
                                        e.Vw[2] = $(this).val()
                                    }),
                                    t.find(".spread-scale-end").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    $(".spread-color-picker").bind(this.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[5] = '"' + o + '"'
                                    }),
                                    t.find(".spread-show-average").change(function() {
                                        e.Vw[1] = $(this).prop("checked")
                                    }),
                                    t.find(".spread-vertical").change(function() {
                                        e.Vw[6] = $(this).prop("checked")
                                    })
                            }
                            ,
                            t.prototype.px = function(e, t) {
                                var i, n, a, s, l, c, d, p, u, h = r.util.parseFormulaSparkline(e, t);
                                h && h.arguments && (i = h.arguments,
                                    i && i.length > 0 ? (n = r.util.unParseFormula(i[0], e, t),
                                    i[1] && (a = i[1].type === o.CalcEngine.ExpressionType.boolean ? i[1].value : null),
                                    i[2] && (s = r.util.unParseFormula(i[2], e, t)),
                                    i[3] && (l = r.util.unParseFormula(i[3], e, t)),
                                        c = i[4] ? r.util.unParseFormula(i[4], e, t) : null,
                                    i[5] && (d = U.parseColorExpression(i[5], e, t)),
                                    i[6] && (p = i[6].type === o.CalcEngine.ExpressionType.boolean ? i[6].value : null),
                                        this.updateTextBox("spread-points", n),
                                        this.updateTextBox("spread-scale-start", s),
                                        this.updateTextBox("spread-scale-end", l),
                                        this.updateColorPicker("spread-color-picker", "spread-color-span", d || this.Nw.colorScheme),
                                        this.updateCheckBox("spread-show-average", a, this.Nw.showAverage),
                                        this.updateCheckBox("spread-vertical", p, this.Nw.vertical),
                                        this.updateSelect("spread-style", c || this.Nw.style),
                                        u = d ? '"' + d + '"' : null,
                                        this.Vw = [n, a, s, l, c, u, p]) : this.bx())
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t, i, o = this.Vw, n = "";
                                for (e = 0; e < o.length; e++)
                                    t = o[e],
                                        n += void 0 !== t && null !== t ? t + "," : ",";
                                n = this.removeContinuousComma(n),
                                    i = "=SPREADSPARKLINE(" + n + ")",
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: i,
                                        type: 5,
                                        dataRange: this.Vw[0]
                                    }),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("spread-points", ""),
                                    this.updateTextBox("spread-scale-start", ""),
                                    this.updateTextBox("spread-scale-end", ""),
                                    this.updateColorPicker("spread-color-picker", "spread-color-span", this.Nw.colorScheme),
                                    this.updateCheckBox("spread-show-average", this.Nw.showAverage),
                                    this.updateCheckBox("spread-vertical", this.Nw.vertical),
                                    this.updateSelect("spread-style", this.Nw.style)
                            }
                            ,
                            t
                    }(T),
                    r.SpreadSparklineDialog = I,
                    D = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".stacked-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.stackedSparklineDialog.stackedSparklineSetting,
                                minWidth: 500,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    color: "#646464",
                                    vertical: !1,
                                    textOrientation: 0
                                },
                                    this.createColorPicker("stacked-color-frame", "stacked-color-span", "stacked-color-picker"),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = this.xo;
                                t.find(".stacked-points").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".stacked-color-range").keyup(function() {
                                        e.Vw[1] = $(this).val()
                                    }),
                                    t.find(".stacked-label-range").keyup(function() {
                                        e.Vw[2] = $(this).val()
                                    }),
                                    t.find(".stacked-maximum").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    t.find(".stacked-target-red").keyup(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    t.find(".stacked-target-green").keyup(function() {
                                        e.Vw[5] = $(this).val()
                                    }),
                                    t.find(".stacked-target-blue").keyup(function() {
                                        e.Vw[6] = $(this).val()
                                    }),
                                    t.find(".stacked-target-yellow").keyup(function() {
                                        e.Vw[7] = $(this).val()
                                    }),
                                    t.find(".stacked-highlight-position").keyup(function() {
                                        e.Vw[9] = $(this).val()
                                    }),
                                    t.find(".stacked-vertical").change(function() {
                                        e.Vw[10] = $(this).prop("checked")
                                    }),
                                    t.find(".stacked-text-orientation").change(function() {
                                        e.Vw[11] = $(this).val()
                                    }),
                                    t.find(".stacked-text-size").keyup(function() {
                                        e.Vw[12] = $(this).val()
                                    }),
                                    $(".stacked-color-picker").bind(e.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[8] = '"' + o + '"'
                                    })
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.sheet = r.wrapper.spread.getActiveSheet(),
                                    this.qx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t, i, o = this.Vw, n = "";
                                for (e = 0; e < o.length; e++)
                                    t = o[e],
                                        n += void 0 !== t && null !== t ? t + "," : ",";
                                n = this.removeContinuousComma(n),
                                    i = "=STACKEDSPARKLINE(" + n + ")",
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: i,
                                        type: 6,
                                        dataRange: this.Vw[0]
                                    }),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.qx = function(e, t) {
                                var i, n, a, s, l, c, d, p, u, h, f, g, m, b, v, y = r.util.parseFormulaSparkline(e, t);
                                y && y.arguments ? (i = y.arguments) && i.length > 0 && (n = r.util.unParseFormula(i[0], e, t),
                                    a = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0,
                                    s = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0,
                                    l = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0,
                                    c = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0,
                                    d = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0,
                                    p = i[6] ? r.util.unParseFormula(i[6], e, t) : void 0,
                                    u = i[7] ? r.util.unParseFormula(i[7], e, t) : void 0,
                                    h = i[8] ? U.parseColorExpression(i[8], e, t) : void 0,
                                    f = i[9] ? r.util.unParseFormula(i[9], e, t) : void 0,
                                i[10] && (g = i[10].type === o.CalcEngine.ExpressionType.boolean ? i[10].value : null),
                                    m = i[11] ? r.util.unParseFormula(i[11], e, t) : void 0,
                                    b = i[12] ? r.util.unParseFormula(i[12], e, t) : void 0,
                                    this.updateTextBox("stacked-points", n),
                                    this.updateTextBox("stacked-color-range", a),
                                    this.updateTextBox("stacked-label-range", s),
                                    this.updateTextBox("stacked-maximum", l),
                                    this.updateTextBox("stacked-target-red", c),
                                    this.updateTextBox("stacked-target-green", d),
                                    this.updateTextBox("stacked-target-blue", p),
                                    this.updateTextBox("stacked-target-yellow", u),
                                    this.updateColorPicker("stacked-color-picker", "stacked-color-span", h || this.Nw.color),
                                    this.updateTextBox("stacked-highlight-position", f),
                                    this.updateCheckBox("stacked-vertical", g, this.Nw.vertical),
                                    this.updateSelect("stacked-text-orientation", m || this.Nw.textOrientation),
                                    this.updateTextBox("stacked-text-size", b),
                                    v = h ? '"' + h + '"' : null,
                                    this.Vw = [n, a, s, l, c, d, p, u, v, f, g, m, b]) : this.bx()
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("stacked-points", ""),
                                    this.updateTextBox("stacked-color-range", ""),
                                    this.updateTextBox("stacked-label-range", ""),
                                    this.updateTextBox("stacked-maximum", ""),
                                    this.updateTextBox("stacked-target-red", ""),
                                    this.updateTextBox("stacked-target-green", ""),
                                    this.updateTextBox("stacked-target-blue", ""),
                                    this.updateTextBox("stacked-target-yellow", ""),
                                    this.updateColorPicker("stacked-color-picker", "stacked-color-span", this.Nw.color),
                                    this.updateTextBox("stacked-highlight-position", ""),
                                    this.updateCheckBox("stacked-vertical", this.Nw.vertical),
                                    this.updateTextBox("stacked-text-orientation", this.Nw.textOrientation),
                                    this.updateTextBox("stacked-text-size", "")
                            }
                            ,
                            t
                    }(T),
                    r.StackedSparklineDialog = D,
                    F = function(e) {
                        r.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype._init = function() {
                            this.sx = "gray",
                                this.createColorPicker("barbase-color-frame", "barbase-color-span", "barbase-color-picker"),
                                this.Iv()
                        }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.sheet = r.wrapper.spread.getActiveSheet(),
                                    this.tx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())
                            }
                            ,
                            t.prototype.tx = function(e, t) {
                                var i, o, n, a, s = r.util.parseFormulaSparkline(e, t);
                                s && s.arguments ? (i = s.arguments) && i.length > 0 && (o = r.util.unParseFormula(i[0], e, t),
                                    n = i[1] ? U.parseColorExpression(i[1], e, t) : void 0,
                                    this.updateTextBox("barbase-value", o),
                                    this.updateColorPicker("barbase-color-picker", "barbase-color-span", null === n ? this.sx : n),
                                    a = n ? '"' + n + '"' : null,
                                    this.Vw = [o, a]) : this.bx()
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = this.xo;
                                t.find(".barbase-value").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    $(".barbase-color-picker").bind(e.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[1] = '"' + o + '"'
                                    })
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("barbase-value", ""),
                                    this.updateColorPicker("barbase-color-picker", "barbase-color-span", this.sx)
                            }
                            ,
                            t.prototype.applySetting = function(e) {
                                var t, i, o, a, s = this.Vw, l = "";
                                for (t = 0; t < s.length; t++)
                                    i = s[t],
                                        l += void 0 !== i && null !== i ? i + "," : ",";
                                l = this.removeContinuousComma(l),
                                    7 === e ? o = "=HBARSPARKLINE(" + l + ")" : 8 === e && (o = "=VBARSPARKLINE(" + l + ")"),
                                    a = this.sheet.getSelections(),
                                    r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, {
                                        formula: o,
                                        type: e,
                                        locationRange: a.length > 0 ? a[0] : new n.Range(0,0,1,1)
                                    }),
                                    r.ribbon.updateSparkline(),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t
                    }(T),
                    r.BarBaseSparklineDialog = F,
                    L = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".barbase-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.barbaseSparklineDialog.hbarSparklineSetting,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting(7)
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t
                    }(F),
                    r.HbarSparklineDialog = L,
                    R = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".barbase-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.barbaseSparklineDialog.vbarSparklineSetting,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting(8)
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t
                    }(F),
                    r.VbarSparklineDialog = R,
                    B = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".vari-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.variSparklineDialog.variSparklineSetting,
                                minWidth: 500,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    legend: !1,
                                    colorPositive: "green",
                                    colorNegative: "red",
                                    vertical: !1
                                },
                                    this.createColorPicker("vari-negative-color-frame", "vari-negative-color-span", "vari-negative-color-picker"),
                                    this.createColorPicker("vari-positive-color-frame", "vari-positive-color-span", "vari-positive-color-picker"),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.sheet = r.wrapper.spread.getActiveSheet(),
                                    this.ux(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())
                            }
                            ,
                            t.prototype.ux = function(e, t) {
                                var i, n, a, s, l, c, d, p, u, h, f, g, m, b = r.util.parseFormulaSparkline(e, t);
                                b && b.arguments ? (i = b.arguments) && i.length > 0 && (n = r.util.unParseFormula(i[0], e, t),
                                    a = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0,
                                    s = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0,
                                    l = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0,
                                    c = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0,
                                    d = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0,
                                i[6] && (p = i[6].type === o.CalcEngine.ExpressionType.boolean ? i[6].value : null),
                                    u = i[7] ? U.parseColorExpression(i[7], e, t) : void 0,
                                    h = i[8] ? U.parseColorExpression(i[8], e, t) : void 0,
                                i[9] && (f = i[9].type === o.CalcEngine.ExpressionType.boolean ? i[9].value : null),
                                    this.updateTextBox("vari-variance", n),
                                    this.updateTextBox("vari-reference", a),
                                    this.updateTextBox("vari-mini", s),
                                    this.updateTextBox("vari-maxi", l),
                                    this.updateTextBox("vari-mark", c),
                                    this.updateTextBox("vari-tickunit", d),
                                    this.updateColorPicker("vari-positive-color-picker", "vari-positive-color-span", u || this.Nw.colorPositive),
                                    this.updateColorPicker("vari-negative-color-picker", "vari-negative-color-span", h || this.Nw.colorNegative),
                                    this.updateCheckBox("vari-legend", p),
                                    this.updateCheckBox("vari-vertical", f),
                                    g = u ? '"' + u + '"' : null,
                                    m = h ? '"' + h + '"' : null,
                                    this.Vw = [n, a, s, l, c, d, p, g, m, f]) : this.bx()
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("vari-variance", ""),
                                    this.updateTextBox("vari-reference", ""),
                                    this.updateTextBox("vari-mini", ""),
                                    this.updateTextBox("vari-maxi", ""),
                                    this.updateTextBox("vari-mark", ""),
                                    this.updateTextBox("vari-tickunit", ""),
                                    this.updateColorPicker("vari-positive-color-picker", "vari-positive-color-span", this.Nw.colorPositive),
                                    this.updateColorPicker("vari-negative-color-picker", "vari-negative-color-span", this.Nw.colorNegative),
                                    this.updateCheckBox("vari-legend", this.Nw.legend),
                                    this.updateCheckBox("vari-vertical", this.Nw.vertical)
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t, i, o, a = this.Vw, s = "";
                                for (e = 0; e < a.length; e++)
                                    t = a[e],
                                        s += void 0 !== t && null !== t ? t + "," : ",";
                                s = this.removeContinuousComma(s),
                                    i = "=VARISPARKLINE(" + s + ")",
                                    o = this.sheet.getSelections(),
                                    r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, {
                                        formula: i,
                                        type: 4,
                                        locationRange: o.length > 0 ? o[0] : new n.Range(0,0,1,1)
                                    }),
                                    r.ribbon.updateSparkline(),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = e.xo;
                                t.find(".vari-variance").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".vari-reference").keyup(function() {
                                        e.Vw[1] = $(this).val()
                                    }),
                                    t.find(".vari-mini").keyup(function() {
                                        e.Vw[2] = $(this).val()
                                    }),
                                    t.find(".vari-maxi").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    t.find(".vari-mark").keyup(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    t.find(".vari-tickunit").keyup(function() {
                                        e.Vw[5] = $(this).val()
                                    }),
                                    $(".vari-positive-color-picker").bind(this.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[7] = '"' + o + '"'
                                    }),
                                    $(".vari-negative-color-picker").bind(this.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[8] = '"' + o + '"'
                                    }),
                                    t.find(".vari-legend").change(function() {
                                        e.Vw[6] = $(this).prop("checked")
                                    }),
                                    t.find(".vari-vertical").change(function() {
                                        e.Vw[9] = $(this).prop("checked")
                                    })
                            }
                            ,
                            t
                    }(T),
                    r.VariSparklineDialog = B,
                    N = function(e) {
                        r.extends(t, e);
                        function t(t) {
                            e.call(this, H, ".calendar-sparkline-dialog"),
                                this.vx = t
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.calendarSparklineDialog.calendarSparklineDialog,
                                width: 530,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e, t;
                                if (this.createColorPicker("calendar-emptyColor-frame", "calendar-emptyColor-span", "calendar-emptyColor-picker"),
                                        this.createColorPicker("calendar-startColor-frame", "calendar-startColor-span", "calendar-startColor-picker"),
                                        this.createColorPicker("calendar-middleColor-frame", "calendar-middleColor-span", "calendar-middleColor-picker"),
                                        this.createColorPicker("calendar-endColor-frame", "calendar-endColor-span", "calendar-endColor-picker"),
                                        e = this.xo.find(".calendar-sparkline-month"),
                                    0 === this.vx)
                                    for (t = 1; t < 13; t++)
                                        e.append($("<option></option>").val(t).text(t));
                                else
                                    e.attr("disabled", "disabled"),
                                        e.addClass("disabled");
                                this.Iv(),
                                    this.wx(!0),
                                    0 === this.vx ? this.xo.dialog("option", "title", r.res.calendarSparklineDialog.monthSparklineDialog) : 1 === this.vx && this.xo.dialog("option", "title", r.res.calendarSparklineDialog.yearSparklineDialog),
                                    this.xx = "lightgray",
                                    this.yx = "lightgreen",
                                    this.zx = "green",
                                    this.Ax = "darkgreen"
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this;
                                e.Bx(),
                                    e.xo.find(".calendar-sparkline-checkbox").change(function() {
                                        e.wx(!$(this).prop("checked"))
                                    }),
                                    $(".calendar-emptyColor-picker").bind(e.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Cx = o
                                    }),
                                    $(".calendar-startColor-picker").bind(e.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Dx = o
                                    }),
                                    $(".calendar-middleColor-picker").bind(e.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Ex = o
                                    }),
                                    $(".calendar-endColor-picker").bind(e.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Fx = o
                                    }),
                                    e.xo.find(".calendar-sparkline-year").keyup(function() {
                                        this.value = this.value.replace(/\D+/g, "")
                                    }),
                                    e.xo.find(".color-picker-container").comboframe().click(function(e) {
                                        $(this).comboframe("open")
                                    })
                            }
                            ,
                            t.prototype.Bx = function() {
                                var e = this;
                                e.xo.find(".rangeSelectButton").click(function() {
                                    if (e.ov || (e.ov = new r.RangeSelectDialog(e,{
                                            absoluteReference: !0,
                                            needSheetName: !1
                                        })),
                                        e.ys || (e.ys = new r.RangeSelectDialog(e,{
                                            absoluteReference: !1,
                                            needSheetName: !1
                                        })),
                                        "disabled" !== $(this).attr("disabled")) {
                                        e.hide();
                                        var t = e.xo.dialog("option", "title"), i = e.zs, o;
                                        switch ($(this).data("name")) {
                                            case "data-range":
                                                o = e.xo.find(".calendar-sparkline-data").val(),
                                                    e.ys.open(t, i, o, [".calendar-sparkline-data"]);
                                                break;
                                            case "location-range":
                                                o = e.xo.find(".calendar-sparkline-location").val(),
                                                    e.ov.open(t, i, o, [".calendar-sparkline-location"]);
                                                break;
                                            case "color-range":
                                                o = e.xo.find(".calendar-sparkline-color").val(),
                                                    e.ys.open(t, i, o, [".calendar-sparkline-color"]);
                                                break;
                                            default:
                                                e.show()
                                        }
                                    }
                                })
                            }
                            ,
                            t.prototype.zs = function(e, t) {
                                var i = t;
                                0 === t.indexOf("=") && (i = t.substr(1)),
                                    this.xo.find(e).val(i)
                            }
                            ,
                            t.prototype.Bo = function(e) {
                                var t, i, o, n, a, s, l, c, d, p, u, h, f, g, m, b = this, v = r.wrapper.spread.getActiveSheet();
                                function y() {
                                    t = "",
                                        i = 1,
                                        n = b.xx,
                                        a = b.yx,
                                        s = b.zx,
                                        l = b.Ax,
                                        d = !1,
                                        o = r.CEUtility.parseRangeToExpString(v.getSelections()[0]),
                                        p = "",
                                        c = ""
                                }
                                u = e[0],
                                    u ? (h = v.getActiveRowIndex(),
                                        f = v.getActiveColumnIndex(),
                                        g = r.util.parseFormulaSparkline(h, f),
                                        g && g.arguments ? (m = g.arguments,
                                            m.length > 0 ? (t = r.util.unParseFormula(m[0], h, f),
                                                0 === this.vx ? (d = 4 === m.length,
                                                    i = r.util.unParseFormula(m[1], h, f),
                                                    o = r.util.unParseFormula(m[2], h, f),
                                                    d ? c = r.util.unParseFormula(m[3], h, f) : (this.Cx = n = m[3] && r.util.unParseFormula(m[3], h, f).replace(/"/g, ""),
                                                        this.Dx = a = m[4] && r.util.unParseFormula(m[4], h, f).replace(/"/g, ""),
                                                        this.Ex = s = m[5] && r.util.unParseFormula(m[5], h, f).replace(/"/g, ""),
                                                        this.Fx = l = m[6] && r.util.unParseFormula(m[6], h, f).replace(/"/g, ""))) : 1 === this.vx && (d = 3 === m.length,
                                                    o = r.util.unParseFormula(m[1], h, f),
                                                    d ? c = r.util.unParseFormula(m[2], h, f) : (this.Cx = n = m[2] && r.util.unParseFormula(m[2], h, f).replace(/"/g, ""),
                                                        this.Dx = a = m[3] && r.util.unParseFormula(m[3], h, f).replace(/"/g, ""),
                                                        this.Ex = s = m[4] && r.util.unParseFormula(m[4], h, f).replace(/"/g, ""),
                                                        this.Fx = l = m[5] && r.util.unParseFormula(m[5], h, f).replace(/"/g, ""))),
                                                p = r.CEUtility.parseRangeToExpString(v.getSelections()[0], !0)) : y()) : y()) : y(),
                                    this.Gx({
                                        dataRange: o,
                                        locationRange: p,
                                        year: t,
                                        month: i,
                                        emptyColor: n,
                                        startColor: a,
                                        middleColor: s,
                                        endColor: l,
                                        isRangeColor: d,
                                        colorRange: c
                                    })
                            }
                            ,
                            t.prototype.Gx = function(e) {
                                this.updateTextBox("calendar-sparkline-data", e.dataRange),
                                    this.updateTextBox("calendar-sparkline-location", e.locationRange),
                                    this.updateTextBox("calendar-sparkline-year", e.year),
                                    this.updateTextBox("calendar-sparkline-color", e.colorRange),
                                0 === this.vx && this.updateSelect("calendar-sparkline-month", e.month),
                                    this.updateColorPicker("calendar-emptyColor-picker", "calendar-emptyColor-span", e.emptyColor),
                                    this.updateColorPicker("calendar-startColor-picker", "calendar-startColor-span", e.startColor),
                                    this.updateColorPicker("calendar-middleColor-picker", "calendar-middleColor-span", e.middleColor),
                                    this.updateColorPicker("calendar-endColor-picker", "calendar-endColor-span", e.endColor),
                                    this.wx(!e.isRangeColor)
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t = r.wrapper.spread.getActiveSheet(), i = this.xo.find(".calendar-sparkline-location").val(), o = r.CEUtility.parseExpStringToRanges(i, t);
                                if (!o || o.length < 1)
                                    return void r.MessageBox.show(r.res.insertSparklineDialog.errorDataRangeMessage, r.res.title, 3, 0);
                                e = this.Hx(),
                                    r.actions.doAction("setFormulaSparklineWithoutDatarange", r.wrapper.spread, {
                                        formula: e,
                                        locationRange: o[0]
                                    }),
                                    this.close()
                            }
                            ,
                            t.prototype.Hx = function() {
                                var e, t = "", i = this.xo.find(".calendar-sparkline-data").val(), o = this.xo.find(".calendar-sparkline-year").val(), n = this.xo.find(".calendar-sparkline-month").val(), a = this.Cx || this.xx, s = this.Dx || this.yx, l = this.Ex || this.zx, c = this.Fx || this.Ax, d = this.xo.find(".calendar-sparkline-checkbox").prop("checked"), p = this.xo.find(".calendar-sparkline-color").val(), u = [];
                                return u.push(o),
                                0 === this.vx && u.push(n),
                                    !i || i.length < 1 ? void r.MessageBox.show(r.res.insertSparklineDialog.errorDataRangeMessage, r.res.title, 3, 0) : (u.push(i),
                                        d ? u.push(p) : (u.push('"' + a + '"'),
                                            u.push('"' + s + '"'),
                                            u.push('"' + l + '"'),
                                            u.push('"' + c + '"')),
                                        e = u.join(","),
                                        0 === this.vx ? t += "=MONTHSPARKLINE" : 1 === this.vx && (t += "=YEARSPARKLINE"),
                                        t += "(",
                                        t += e,
                                        t += ")")
                            }
                            ,
                            t.prototype.wx = function(e) {
                                e ? (this.xo.find(".calendar-sparkline-checkbox").prop("checked", !1),
                                    this.xo.find(".calendar-sparkline-color").attr("disabled", "disabled"),
                                    this.xo.find(".color-range-button").attr("disabled", "disabled")) : (this.xo.find(".calendar-sparkline-checkbox").prop("checked", !0),
                                    this.xo.find(".calendar-sparkline-color").removeAttr("disabled", "disabled"),
                                    this.xo.find(".color-range-button").removeAttr("disabled", "disabled"))
                            }
                            ,
                            t
                    }(T),
                    r.CalendarSparklineDialog = N,
                    E = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".boxplot-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.boxplotSparklineDialog.boxplotSparklineSetting,
                                minWidth: 500,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    boxplotClass: "5ns",
                                    style: 0,
                                    colorScheme: "#D2D2D2",
                                    vertical: !1,
                                    showAverage: !1
                                },
                                    this.createColorPicker("boxplot-color-frame", "boxplot-color-span", "boxplot-color-picker"),
                                    this.Iv()
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.sheet = r.wrapper.spread.getActiveSheet(),
                                    this.Ix(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex())
                            }
                            ,
                            t.prototype.Ix = function(e, t) {
                                var i, n, a, s, l, c, d, p, u, h, f, g, m, b, v = r.util.parseFormulaSparkline(e, t);
                                v && v.arguments && (i = v.arguments,
                                    i && i.length > 0 ? (n = this.Nw,
                                        a = r.util.unParseFormula(i[0], e, t),
                                    i[1] && (s = i[1].type === o.CalcEngine.ExpressionType.string ? i[1].value : null),
                                    i[2] && (l = i[2].type === o.CalcEngine.ExpressionType.boolean ? i[2].value : null),
                                        c = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0,
                                        d = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0,
                                        p = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0,
                                        u = i[6] ? r.util.unParseFormula(i[6], e, t) : void 0,
                                        h = i[7] ? U.parseColorExpression(i[7], e, t) : void 0,
                                        f = i[8] ? r.util.unParseFormula(i[8], e, t) : void 0,
                                    i[9] && (g = i[9].type === o.CalcEngine.ExpressionType.boolean ? i[9].value : null),
                                        this.updateTextBox("boxplot-points", a),
                                        this.updateSelect("boxplot-class", null === s ? n.boxplotClass : s),
                                        this.updateTextBox("boxplot-scale-start", c),
                                        this.updateTextBox("boxplot-scale-end", d),
                                        this.updateTextBox("boxplot-acceptable-start", p),
                                        this.updateTextBox("boxplot-acceptable-end", u),
                                        this.updateColorPicker("boxplot-color-picker", "boxplot-color-span", null === h ? n.colorScheme : h),
                                        this.updateSelect("boxplot-style", null === f ? n.style : f),
                                        this.updateCheckBox("boxplot-vertical", null === g ? n.vertical : g),
                                        this.updateCheckBox("boxplot-show-average", null === l ? n.showAverage : l),
                                        m = s ? '"' + s + '"' : null,
                                        b = h ? '"' + h + '"' : null,
                                        this.Vw = [a, m, l, c, d, p, u, b, f, g]) : this.bx())
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("boxplot-points", ""),
                                    this.updateSelect("boxplot-class", this.Nw.boxplotClass),
                                    this.updateTextBox("boxplot-scale-start", ""),
                                    this.updateTextBox("boxplot-scale-end", ""),
                                    this.updateTextBox("boxplot-acceptable-start", ""),
                                    this.updateTextBox("boxplot-acceptable-end", ""),
                                    this.updateColorPicker("boxplot-color-picker", "boxplot-color-span", this.Nw.colorScheme),
                                    this.updateSelect("boxplot-style", this.Nw.style),
                                    this.updateCheckBox("boxplot-vertical", this.Nw.vertical),
                                    this.updateCheckBox("boxplot-show-average", this.Nw.showAverage)
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = e.xo;
                                t.find(".boxplot-points").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".boxplot-class").change(function() {
                                        e.Vw[1] = '"' + $(this).val() + '"'
                                    }),
                                    t.find(".boxplot-scale-start").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    t.find(".boxplot-scale-end").keyup(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    t.find(".boxplot-acceptable-start").keyup(function() {
                                        e.Vw[5] = $(this).val()
                                    }),
                                    t.find(".boxplot-acceptable-end").keyup(function() {
                                        e.Vw[6] = $(this).val()
                                    }),
                                    $(".boxplot-color-picker").bind(this.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[7] = '"' + o + '"'
                                    }),
                                    t.find(".boxplot-style").change(function() {
                                        e.Vw[8] = $(this).val()
                                    }),
                                    t.find(".boxplot-show-average").change(function() {
                                        e.Vw[2] = $(this).prop("checked")
                                    }),
                                    t.find(".boxplot-vertical").change(function() {
                                        e.Vw[9] = $(this).prop("checked")
                                    })
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t, i, o = this.Vw, n = "";
                                for (e = 0; e < o.length; e++)
                                    t = o[e],
                                        n += void 0 !== t && null !== t ? t + "," : ",";
                                n = this.removeContinuousComma(n),
                                    i = "=BOXPLOTSPARKLINE(" + n + ")",
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: i,
                                        type: 10,
                                        dataRange: this.Vw[0]
                                    }),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t
                    }(T),
                    r.BoxPlotSparklineDialog = E,
                    V = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".cascade-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.cascadeSparklineDialog.cascadeSparklineSetting,
                                minWidth: 500,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    colorPositive: "#8CBF64",
                                    colorNegative: "#D6604D",
                                    vertical: !1
                                },
                                    this.createColorPicker("cascade-positive-color-frame", "cascade-positive-color-span", "cascade-positive-color-picker"),
                                    this.createColorPicker("cascade-negative-color-frame", "cascade-negative-color-span", "cascade-negative-color-picker"),
                                    this.Iv()
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t, i, o = this.Vw, n = "";
                                for (e = 0; e < o.length; e++)
                                    t = o[e],
                                        n += void 0 !== t && null !== t ? t + "," : ",";
                                n = this.removeContinuousComma(n),
                                    i = "=CASCADESPARKLINE(" + n + ")",
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: i,
                                        type: 11,
                                        dataRange: this.Vw[0],
                                        parameterSets: this.Vw
                                    }),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = e.xo;
                                t.find(".cascade-points-range").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".cascade-point-index").keyup(function() {
                                        e.Vw[1] = $(this).val()
                                    }),
                                    t.find(".cascade-mini").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    t.find(".cascade-maxi").keyup(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    $(".cascade-positive-color-picker").bind(this.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[5] = '"' + o + '"'
                                    }),
                                    $(".cascade-negative-color-picker").bind(this.colorValueChanged, function(t, i) {
                                        var o = i.value && i.value.color ? i.value.color : "transparent";
                                        e.Vw[6] = '"' + o + '"'
                                    }),
                                    t.find(".cascade-labels-range").keyup(function() {
                                        e.Vw[2] = $(this).val()
                                    }),
                                    t.find(".cascade-vertical").change(function() {
                                        e.Vw[7] = $(this).prop("checked")
                                    })
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.sheet = r.wrapper.spread.getActiveSheet(),
                                    this.Jx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()),
                                    this.Kx()
                            }
                            ,
                            t.prototype.Kx = function() {
                                var e, t = this.sheet.getSelections();
                                t && t.length > 0 && (e = t[0],
                                    t.length > 1 || e.rowCount > 1 || e.colCount > 1 ? this.xo.find(".cascade-point-index").attr("disabled", "disabled") : this.xo.find(".cascade-point-index").removeAttr("disabled"))
                            }
                            ,
                            t.prototype.Jx = function(e, t) {
                                var i, n, a, s, l, c, d, p, u, h, f, g, m = r.util.parseFormulaSparkline(e, t);
                                m && m.arguments && (i = m.arguments,
                                    i && i.length > 0 ? (n = this.Nw,
                                        a = r.util.unParseFormula(i[0], e, t),
                                        s = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0,
                                        l = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0,
                                        c = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0,
                                        d = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0,
                                        p = i[5] ? U.parseColorExpression(i[5], e, t) : void 0,
                                        u = i[6] ? U.parseColorExpression(i[6], e, t) : void 0,
                                    i[7] && (h = i[7].type === o.CalcEngine.ExpressionType.boolean ? i[7].value : null),
                                        this.updateTextBox("cascade-points-range", a),
                                        this.updateTextBox("cascade-point-index", s),
                                        this.updateTextBox("cascade-maxi", d),
                                        this.updateTextBox("cascade-mini", c),
                                        this.updateTextBox("cascade-labels-range", l),
                                        this.updateColorPicker("cascade-positive-color-picker", "cascade-positive-color-span", null === p ? n.colorPositive : p),
                                        this.updateColorPicker("cascade-negative-color-picker", "cascade-negative-color-span", null === u ? n.colorNegative : u),
                                        this.updateCheckBox("cascade-vertical", null === h ? n.vertical : h),
                                        f = u ? '"' + u + '"' : null,
                                        g = p ? '"' + p + '"' : null,
                                        this.Vw = [a, s, l, c, d, g, f, h]) : this.bx())
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("cascade-points-range", ""),
                                    this.updateTextBox("cascade-point-index", ""),
                                    this.updateTextBox("cascade-maxi", ""),
                                    this.updateTextBox("cascade-mini", ""),
                                    this.updateTextBox("cascade-labels-range", ""),
                                    this.updateColorPicker("cascade-positive-color-picker", "cascade-positive-color-span", this.Nw.colorPositive),
                                    this.updateColorPicker("cascade-negative-color-picker", "cascade-negative-color-span", this.Nw.colorNegative),
                                    this.updateCheckBox("cascade-vertical", this.Nw.vertical)
                            }
                            ,
                            t
                    }(T),
                    r.CascadeSparklineDialog = V,
                    P = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".pareto-sparkline-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                modal: !0,
                                title: r.res.paretoSparklineDialog.paretoSparklineSetting,
                                minWidth: 500,
                                resizable: !1,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.applySetting()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                this.Nw = {
                                    label: 0,
                                    vertical: !1
                                },
                                    this.Iv()
                            }
                            ,
                            t.prototype.applySetting = function() {
                                var e, t, i, o = this.Vw, n = "";
                                for (e = 0; e < o.length; e++)
                                    t = o[e],
                                        n += void 0 !== t && null !== t ? t + "," : ",";
                                n = this.removeContinuousComma(n),
                                    i = "=PARETOSPARKLINE(" + n + ")",
                                    r.actions.doAction("setFormulaSparkline", r.wrapper.spread, {
                                        formula: i,
                                        type: 12,
                                        dataRange: this.Vw[0],
                                        parameterSets: this.Vw
                                    }),
                                    this.updateFormulaBar(),
                                    this.close(),
                                    r.wrapper.setFocusToSpread()
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this
                                    , t = e.xo;
                                t.find(".pareto-points").keyup(function() {
                                    e.Vw[0] = $(this).val()
                                }),
                                    t.find(".pareto-point-index").keyup(function() {
                                        e.Vw[1] = $(this).val()
                                    }),
                                    t.find(".pareto-color-range").keyup(function() {
                                        e.Vw[2] = $(this).val()
                                    }),
                                    t.find(".pareto-target").keyup(function() {
                                        e.Vw[3] = $(this).val()
                                    }),
                                    t.find(".pareto-target2").keyup(function() {
                                        e.Vw[4] = $(this).val()
                                    }),
                                    t.find(".pareto-highlightPosition").keyup(function() {
                                        e.Vw[5] = $(this).val()
                                    }),
                                    t.find(".pareto-label").change(function() {
                                        e.Vw[6] = $(this).val()
                                    }),
                                    t.find(".pareto-vertical").change(function() {
                                        e.Vw[7] = $(this).prop("checked")
                                    })
                            }
                            ,
                            t.prototype.Bo = function() {
                                this.Vw = [],
                                    this.sheet = r.wrapper.spread.getActiveSheet(),
                                    this.Lx(this.sheet.getActiveRowIndex(), this.sheet.getActiveColumnIndex()),
                                    this.Kx()
                            }
                            ,
                            t.prototype.Kx = function() {
                                var e, t = this.sheet.getSelections();
                                t && t.length > 0 && (e = t[0],
                                    t.length > 1 || e.rowCount > 1 || e.colCount > 1 ? this.xo.find(".pareto-point-index").attr("disabled", "disabled") : this.xo.find(".pareto-point-index").removeAttr("disabled"))
                            }
                            ,
                            t.prototype.Lx = function(e, t) {
                                var i, n, a, s, l, c, d, p, u, h, f = r.util.parseFormulaSparkline(e, t);
                                f && f.arguments && (i = f.arguments,
                                    i && i.length > 0 ? (n = this.Nw,
                                        a = r.util.unParseFormula(i[0], e, t),
                                        s = i[1] ? r.util.unParseFormula(i[1], e, t) : void 0,
                                        l = i[2] ? r.util.unParseFormula(i[2], e, t) : void 0,
                                        c = i[3] ? r.util.unParseFormula(i[3], e, t) : void 0,
                                        d = i[4] ? r.util.unParseFormula(i[4], e, t) : void 0,
                                        p = i[5] ? r.util.unParseFormula(i[5], e, t) : void 0,
                                    i[6] && (u = i[6].type === o.CalcEngine.ExpressionType.number ? i[6].value : null),
                                    i[7] && (h = i[7].type === o.CalcEngine.ExpressionType.boolean ? i[7].value : null),
                                        this.updateTextBox("pareto-points", a),
                                        this.updateTextBox("pareto-point-index", s),
                                        this.updateTextBox("pareto-color-range", l),
                                        this.updateTextBox("pareto-highlightPosition", p),
                                        this.updateTextBox("pareto-target", c),
                                        this.updateTextBox("pareto-target2", d),
                                        this.updateSelect("pareto-label", null === u ? n.label : u),
                                        this.updateCheckBox("cascade-vertical", null === h ? n.vertical : h),
                                        this.Vw = [a, s, l, c, d, p, u, h]) : this.bx())
                            }
                            ,
                            t.prototype.bx = function() {
                                this.updateTextBox("pareto-points", ""),
                                    this.updateTextBox("pareto-point-index", ""),
                                    this.updateTextBox("pareto-color-range", ""),
                                    this.updateTextBox("pareto-highlightPosition", ""),
                                    this.updateTextBox("pareto-target", ""),
                                    this.updateTextBox("pareto-target2", ""),
                                    this.updateSelect("pareto-label", this.Nw.label),
                                    this.updateCheckBox("cascade-vertical", this.Nw.vertical)
                            }
                            ,
                            t
                    }(T),
                    r.ParetoSparklineDialog = P,
                    z = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".protection-option")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                resizable: !1,
                                modal: !0,
                                title: e.Mx("title"),
                                width: 250,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        var i, o, n = {}, a = e.xo.find("div[class='protection-option-container']").children(), s = t.itemIDPre.length;
                                        for (i = 0; i < a.length; i++)
                                            o = a[i].id.substring(s),
                                                e.Nx(n, o, a[i].checked);
                                        r.actions.doAction("confirmProtectSheet", r.wrapper.spread, n),
                                            e.close(),
                                            e.Uo(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function() {
                                var e, i, o = r.wrapper.spread.getActiveSheet(), n = o.options.protectionOptions, a = this.xo.find("div[class='protection-option-container']").children(), s = t.itemIDPre.length;
                                for (e = 0; e < a.length; e++)
                                    i = a[e].id.substring(s),
                                        a[e].checked = this.Ox(n, i)
                            }
                            ,
                            t.prototype.Ox = function(e, t) {
                                var i = e[t];
                                return void 0 === i ? "allowSelectLockedCells" === t || "allowSelectUnlockedCells" === t : i
                            }
                            ,
                            t.prototype.Nx = function(e, t, i) {
                                "allowSelectLockedCells" === t || "allowSelectUnlockedCells" === t ? i || (e[t] = !1) : i && (e[t] = !0)
                            }
                            ,
                            t.prototype.Px = function() {
                                return ["allowSelectLockedCells", "allowSelectUnlockedCells", "allowSort", "allowFilter", "allowResizeRows", "allowResizeColumns", "allowEditObjects", "allowDragInsertRows", "allowDragInsertColumns", "allowInsertRows", "allowInsertColumns", "allowDeleteRows", "allowDeleteColumns"]
                            }
                            ,
                            t.prototype.Mx = function(e) {
                                return r.res.protectionOptionDialog ? r.res.protectionOptionDialog[e] : e
                            }
                            ,
                            t.prototype._init = function() {
                                var e, i, o, n = this, r = n.xo.find("div[class='protection-option-container']"), a = n.Px();
                                for (e = 0; e < a.length; e++)
                                    i = n.Mx(a[e]),
                                        o = t.itemIDPre + a[e],
                                        r.append($('<input id="' + o + '" type="checkbox"/><label for="' + o + '">' + i + "</label></br>"))
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = r.wrapper.spread.getActiveSheet();
                                this.Qx() && !e.options.protectionOptions.allowEditObjects && r.ribbon.clearSlicerTab()
                            }
                            ,
                            t.prototype.Qx = function() {
                                var e, t, i = r.wrapper.spread.getActiveSheet(), o = r.util.getSelectedSlicers(i);
                                if (o && 0 !== o.length) {
                                    e = !0;
                                    for (t in o)
                                        if (!(e = o[t].isLocked()))
                                            break;
                                    return e
                                }
                            }
                            ,
                            t.itemIDPre = "protectionOption-",
                            t
                    }(r.BaseDialog),
                    r.ProtectionOptionDialog = z,
                    j = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".insert-slicer-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.insertSlicerDialog.insertSlicer,
                                buttons: [{
                                    text: r.res.ok,
                                    id: "slicerDialogOK",
                                    click: function() {
                                        e.Uo(),
                                            e.close(),
                                            r.actions.doAction("baseDialogCommand", r.wrapper.spread, {
                                                value: {
                                                    tableName: e.Vg.name(),
                                                    columnsChecked: e.Rx
                                                },
                                                execute: r.spreadActions.dialogAction.insertSlicerForDialog
                                            }),
                                            r.ribbon.insertTableSlicer(e.Vg, e.Rx),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype.Bo = function(e) {
                                this.Rx = [],
                                    this.Sx(),
                                    $(".insert-slicer-container").empty(),
                                    this.Vg = e[0],
                                    this.Tx(this.Vg)
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = this;
                                this.Ux.each(function(t) {
                                    $(this).prop("checked") && e.Rx.push(t)
                                }),
                                    this.Vx.unbind(),
                                    this.Ux.unbind()
                            }
                            ,
                            t.prototype.Tx = function(e) {
                                var t, i, o, n, r, a = this, s = $(".insert-slicer-container");
                                for (t = 0; t < this.Vg.range().colCount; t++)
                                    i = this.Vg.getColumnName(t),
                                        o = $("<div class='insert-slicer-block'></div>"),
                                        o.appendTo(s),
                                        n = $("<input type='checkbox' />"),
                                        n.appendTo(o),
                                        r = $("<label>" + i + "</label>"),
                                        r.appendTo(o);
                                this.Vx = $(".insert-slicer-block"),
                                    this.Ux = $(this.Vx).find("input"),
                                    this.Vx.bind("mousedown", function() {
                                        var e = $(this).find("input");
                                        e.prop("checked") ? e.prop("checked", !1) : e.prop("checked", !0),
                                            a.Sx()
                                    }),
                                    this.Ux.bind("mousedown", function(e) {
                                        e.stopPropagation()
                                    }),
                                    this.Ux.change(function() {
                                        a.Sx()
                                    })
                            }
                            ,
                            t.prototype.Sx = function() {
                                var e = $("#slicerDialogOK");
                                $(this.Vx).find($("input:checked")).length > 0 ? (e.hasClass("insert-slicer-ok") && (e.removeClass("insert-slicer-ok"),
                                    e.addClass("ui-state-default")),
                                    e.attr("disabled", !1)) : (e.removeClass("ui-state-default"),
                                    e.addClass("insert-slicer-ok"),
                                    e.attr("disabled", !0))
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.InsertSlicerDialog = j,
                    M = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".slicer-setting-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                title: r.res.slicerSettingDialog.slicerSetting,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.Uo()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = this;
                                $("#hide-item").change(function() {
                                    e.Wx()
                                }),
                                    $("#visually-item").change(function() {
                                        e.Xx()
                                    })
                            }
                            ,
                            t.prototype.Wx = function() {
                                $("#hide-item").prop("checked") ? ($("#visually-item").attr("disabled", !0),
                                    $("#show-item").attr("disabled", !0)) : ($("#visually-item").attr("disabled", !1),
                                $("#visually-item").prop("checked") && $("#show-item").attr("disabled", !1))
                            }
                            ,
                            t.prototype.Xx = function() {
                                $("#hide-item").prop("checked") || ($("#visually-item").prop("checked") ? $("#show-item").attr("disabled", !1) : $("#show-item").attr("disabled", !0))
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e, t;
                                this.Yx(),
                                    e = r.wrapper.spread.getActiveSheet(),
                                (t = r.util.getSelectedSlicers(e)) && 0 !== t.length && (t.length > 1 ? ($("#slicer-setting-name").css("color", "#9b6d84"),
                                    $("#slicer-name").attr("disabled", !0).css("background-color", "#f0f0f0"),
                                    this.Zx(t)) : 1 === t.length && ($("#slicer-setting-name").css("color", "#000000"),
                                    $("#slicer-name").attr("disabled", !1).css("background-color", "#ffffff"),
                                    this.$x(t[0])),
                                    this.Wx(),
                                    this.Xx())
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e = []
                                    , t = $("#slicer-name").val();
                                e.push(t),
                                    e.push($("#display-header").prop("checked")),
                                    e.push($("#slicer-caption").val()),
                                    e.push($("input[name='item-sort']:checked").val()),
                                    e.push($("#hide-item").prop("checked")),
                                    e.push($("#visually-item").prop("checked")),
                                    e.push($("#show-item").prop("checked")),
                                    this._x(e)
                            }
                            ,
                            t.prototype._x = function(e) {
                                var t = r.wrapper.spread
                                    , i = t.getActiveSheet()
                                    , o = r.util.getSelectedSlicers(i)
                                    , n = o[0]
                                    , a = e[0];
                                if (o && 1 === o.length) {
                                    if (this.ay(t, n.name(), a))
                                        return r.MessageBox.show(r.res.sameSlicerName, r.res.title, 2),
                                            !1;
                                    if (!a || 0 === a.length)
                                        return r.MessageBox.show(r.res.nullSlicerName, r.res.title, 2),
                                            !1
                                }
                                r.actions.doAction("baseDialogCommand", r.wrapper.spread, {
                                    value: {
                                        slicerSettings: e,
                                        selectedSlicers: o
                                    },
                                    execute: r.spreadActions.dialogAction.SlicerSettingForDialog
                                }),
                                    this.close()
                            }
                            ,
                            t.prototype.ay = function(e, t, i) {
                                var o, n, r, a, s, l, c = e.getSheetCount();
                                for (t = t.toLowerCase(),
                                         i = i.toLowerCase(),
                                         n = 0; n < c; n++) {
                                    o = e.getSheet(n),
                                        r = o.slicers.all();
                                    for (a in r)
                                        if (s = r[a],
                                                l = s.name(),
                                            (l = l.toLowerCase()) === i && l !== t)
                                            return !0
                                }
                                return !1
                            }
                            ,
                            t.prototype.Yx = function() {
                                $("#source-name").text(""),
                                    $("#slicer-name").val(""),
                                    $("#slicer-caption").val(""),
                                    $("#display-header").prop("checked", !0),
                                    $("#ascending").prop("checked", !0),
                                    $("#hide-item").prop("checked", !1),
                                    $("#visually-item").prop("checked", !0),
                                    $("#show-item").prop("checked", !0)
                            }
                            ,
                            t.prototype.$x = function(e) {
                                var t = e;
                                $("#source-name").text(t.sourceName()),
                                    $("#slicer-name").val(t.name()),
                                    $("#slicer-caption").val(t.captionName()),
                                    t.showHeader() ? $("#display-header").prop("checked", !0) : $("#display-header").prop("checked", !1),
                                    1 === t.sortState() ? $("#ascending").prop("checked", !0) : $("#descending").prop("checked", !0),
                                    t.showNoDataItems() ? $("#hide-item").prop("checked", !1) : $("#hide-item").prop("checked", !0),
                                    t.visuallyNoDataItems() ? $("#visually-item").prop("checked", !0) : $("#visually-item").prop("checked", !1),
                                    t.showNoDataItemsInLast() ? $("#show-item").prop("checked", !0) : $("#show-item").prop("checked", !1)
                            }
                            ,
                            t.prototype.Zx = function(e) {
                                var t, i, o, n, r, a, s, l, c, d;
                                if (e && 0 !== e.length) {
                                    t = !1,
                                        i = !1,
                                        o = !1,
                                        n = !1,
                                        r = !0,
                                        a = !0,
                                        s = e[0].sortState(),
                                        l = e[0].captionName();
                                    for (c in e)
                                        d = e[c],
                                            t = t || d.showHeader(),
                                            i = i || !d.showNoDataItems(),
                                            o = o || d.visuallyNoDataItems(),
                                            n = n || d.showNoDataItemsInLast(),
                                        d.sortState() !== s && (r = !1),
                                        d.captionName() !== l && (a = !1);
                                    a ? $("#slicer-caption").val(l) : $("#slicer-caption").val(""),
                                        t ? $("#display-header").prop("checked", !0) : $("#display-header").prop("checked", !1),
                                        i ? $("#hide-item").prop("checked", !0) : $("#hide-item").prop("checked", !1),
                                        o ? $("#visually-item").prop("checked", !0) : $("#visually-item").prop("checked", !1),
                                        n ? $("#show-item").prop("checked", !0) : $("#show-item").prop("checked", !1),
                                        r ? 1 === s ? $("#ascending").prop("checked", !0) : $("#descending").prop("checked", !0) : ($("#ascending").prop("checked", !1),
                                            $("#descending").prop("checked", !1))
                                }
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.SlicerSettingDialog = M,
                    O = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".slicer-style-dialog")
                        }
                        t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: 600,
                                modal: !0,
                                title: r.res.formatSlicerStyle.slicerStyle,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.by() ? r.MessageBox.show(r.res.formatSlicerStyle.exception, r.res.title, 2) : (t.currentId++,
                                            e.yv(),
                                            r.actions.isFileModified = !0,
                                            e.close(),
                                            r.wrapper.setFocusToSpread())
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                var e = "- - - -";
                                $(".slicer-pre-style").find("span").text(e),
                                    $(".slicer-pre-style").attr("style", ""),
                                    $("#slicer-pre-header").attr("style", ""),
                                    $("#selected-item-data").attr("style", ""),
                                    $("#selected-item-no-data").attr("style", ""),
                                    $("#unselected-item-data").attr("style", ""),
                                    $("#unselected-item-no-data").attr("style", ""),
                                    $("#hovered-selected-item-data").attr("style", ""),
                                    $("#hovered-selected-item-no-data").attr("style", ""),
                                    $("#hovered-unselected-item-data").attr("style", ""),
                                    $("#hovered-unselected-item-no-data").attr("style", ""),
                                    $(".slicer-pre-style").find("span").css("text-decoration", "none"),
                                    this.ey = this.xo.find(".slicer-element-select"),
                                    this.gy = this.xo.find(".format-slicer-element"),
                                    this.hy = this.xo.find(".clear-slicer-element"),
                                    this.iy = new GC.Spread.Sheets.Slicers.SlicerStyle,
                                    this.jy = new GC.Spread.Sheets.Style,
                                    this.ky = new GC.Spread.Sheets.Style,
                                    this.ly = new GC.Spread.Sheets.Style,
                                    this.ny = new GC.Spread.Sheets.Style,
                                    this.oy = new GC.Spread.Sheets.Style,
                                    this.py = new GC.Spread.Sheets.Style,
                                    this.qy = new GC.Spread.Sheets.Style,
                                    this.sy = new GC.Spread.Sheets.Style,
                                    this.ty = new GC.Spread.Sheets.Style,
                                    this.uy = new GC.Spread.Sheets.Style,
                                    this.vy(),
                                    this.wy(),
                                    this.Iv()
                            }
                            ,
                            t.prototype.vy = function() {
                                var e = r.res.formatSlicerStyle.slicerStyle + " " + t.currentId;
                                this.xo.find(".slicer-style-input").val(e)
                            }
                            ,
                            t.prototype.wy = function() {
                                var e, t = r.res.slicerElement;
                                for (e in t)
                                    $("<option></option>").attr("strip-size", 1).val(e).text(t[e]).appendTo(this.ey);
                                this.ey.attr("size", 8),
                                    this.ey.get(0).selectedIndex = 0
                            }
                        ;
                        var i = {
                            9: 1,
                            1: 1,
                            3: 1,
                            4: 1,
                            7: 1,
                            11: 1,
                            2: 2,
                            10: 2,
                            12: 2,
                            8: 2,
                            13: 2,
                            5: 3,
                            6: 3
                        };
                        return t.prototype.xy = function(e) {
                            var t = new GC.Spread.Sheets.Slicers.SlicerBorder;
                            return e ? (t.borderColor(e.color),
                                t.borderStyle(this.yy(e.style)),
                                t.borderWidth(i[e.style]),
                                t) : null
                        }
                            ,
                            t.prototype.yy = function(e) {
                                if (e)
                                    switch (e) {
                                        case 6:
                                            return "double";
                                        case 9:
                                        case 11:
                                        case 4:
                                        case 13:
                                        case 10:
                                        case 12:
                                            return "dotted";
                                        case 2:
                                        case 3:
                                        case 8:
                                            return "dashed";
                                        default:
                                            return "solid"
                                    }
                                return "solid"
                            }
                            ,
                            t.prototype.Iv = function() {
                                var e = this;
                                this.gy.click(function() {
                                    var t = new n.Style;
                                    t = e.zy(t),
                                    void 0 === e.Nv && (e.Nv = new r.FormatDialog),
                                        e.Nv.open("font", void 0, t, !0),
                                        e.Nv.selectTabOptions = {
                                            font: !0,
                                            border: !0,
                                            fill: !0
                                        },
                                        e.Nv.setFormatDirectly(!1),
                                        $(e.Nv).on("okClicked", function(t, i) {
                                            e.Mv(i)
                                        })
                                }),
                                    this.hy.click(function() {
                                        e.Ay()
                                    })
                            }
                            ,
                            t.prototype.Ov = function() {
                                this.gy.unbind("click"),
                                    this.hy.unbind("click")
                            }
                            ,
                            t.prototype.Ay = function() {
                                var e = new GC.Spread.Sheets.Slicers.SlicerStyleInfo
                                    , t = this.ey.find("option:selected").val();
                                switch (t) {
                                    case "wholeSlicer":
                                        this.jy = new GC.Spread.Sheets.Style,
                                            this.By(),
                                            this.iy.wholeSlicerStyle(e);
                                        break;
                                    case "header":
                                        this.ky = new GC.Spread.Sheets.Style,
                                            this.Cy($("#slicer-pre-header")),
                                            this.iy.headerStyle(e);
                                        break;
                                    case "selectedItemWithData":
                                        this.ly = new GC.Spread.Sheets.Style,
                                            this.Cy($("#selected-item-data")),
                                            this.iy.selectedItemWithDataStyle(e);
                                        break;
                                    case "selectedItemWithNoData":
                                        this.ny = new GC.Spread.Sheets.Style,
                                            this.Cy($("#selected-item-no-data")),
                                            this.iy.selectedItemWithNoDataStyle(e);
                                        break;
                                    case "unselectedItemWithData":
                                        this.oy = new GC.Spread.Sheets.Style,
                                            this.Cy($("#unselected-item-data")),
                                            this.iy.unSelectedItemWithDataStyle(e);
                                        break;
                                    case "unselectedItemWithNoData":
                                        this.py = new GC.Spread.Sheets.Style,
                                            this.Cy($("#unselected-item-no-data")),
                                            this.iy.unSelectedItemWithNoDataStyle(e);
                                        break;
                                    case "hoveredSelectedItemWithData":
                                        this.qy = new GC.Spread.Sheets.Style,
                                            this.Cy($("#hovered-selected-item-data")),
                                            this.iy.hoveredSelectedItemWithDataStyle(e);
                                        break;
                                    case "hoveredSelectedItemWithNoData":
                                        this.sy = new GC.Spread.Sheets.Style,
                                            this.Cy($("#hovered-selected-item-no-data")),
                                            this.iy.hoveredSelectedItemWithNoDataStyle(e);
                                        break;
                                    case "hoveredUnselectedItemWithData":
                                        this.ty = new GC.Spread.Sheets.Style,
                                            this.Cy($("#hovered-unselected-item-data")),
                                            this.iy.hoveredUnSelectedItemWithDataStyle(e);
                                        break;
                                    case "hoveredUnselectedItemWithNoData":
                                        this.uy = new GC.Spread.Sheets.Style,
                                            this.Cy($("#hovered-unselected-item-no-data")),
                                            this.iy.hoveredUnSelectedItemWithNoDataStyle(e)
                                }
                            }
                            ,
                            t.prototype.By = function() {
                                var e, t = $(".slicer-pre-style");
                                t.removeAttr("style"),
                                    t.find("span").css("text-decoration", "none"),
                                    e = this.iy.headerStyle(),
                                e && this.Dy($("#slicer-pre-header"), e.textDecoration()),
                                    e = this.iy.selectedItemWithDataStyle(),
                                e && this.Dy($("#selected-item-data"), e.textDecoration()),
                                    e = this.iy.selectedItemWithNoDataStyle(),
                                e && this.Dy($("#selected-item-no-data"), e.textDecoration()),
                                    e = this.iy.unSelectedItemWithDataStyle(),
                                e && this.Dy($("#unselected-item-data"), e.textDecoration()),
                                    e = this.iy.unSelectedItemWithNoDataStyle(),
                                e && this.Dy($("#unselected-item-no-data"), e.textDecoration()),
                                    e = this.iy.hoveredSelectedItemWithDataStyle(),
                                e && this.Dy($("#hovered-selected-item-data"), e.textDecoration()),
                                    e = this.iy.hoveredSelectedItemWithNoDataStyle(),
                                e && this.Dy($("#hovered-selected-item-no-data"), e.textDecoration()),
                                    e = this.iy.hoveredUnSelectedItemWithDataStyle(),
                                e && this.Dy($("#hovered-unselected-item-data"), e.textDecoration()),
                                (e = this.iy.hoveredUnSelectedItemWithNoDataStyle()) && this.Dy($("#hovered-unselected-item-no-data"), e.textDecoration())
                            }
                            ,
                            t.prototype.Cy = function(e) {
                                e.removeAttr("style");
                                var t = this.iy.wholeSlicerStyle();
                                t && this.Dy(e, t.textDecoration())
                            }
                            ,
                            t.prototype.zy = function(e) {
                                var t = this.ey.find("option:selected").val();
                                switch (t) {
                                    case "wholeSlicer":
                                        e = this.jy;
                                        break;
                                    case "header":
                                        e = this.ky;
                                        break;
                                    case "selectedItemWithData":
                                        e = this.ly;
                                        break;
                                    case "selectedItemWithNoData":
                                        e = this.ny;
                                        break;
                                    case "unselectedItemWithData":
                                        e = this.oy;
                                        break;
                                    case "unselectedItemWithNoData":
                                        e = this.py;
                                        break;
                                    case "hoveredSelectedItemWithData":
                                        e = this.qy;
                                        break;
                                    case "hoveredSelectedItemWithNoData":
                                        e = this.sy;
                                        break;
                                    case "hoveredUnselectedItemWithData":
                                        e = this.ty;
                                        break;
                                    case "hoveredUnselectedItemWithNoData":
                                        e = this.uy
                                }
                                return e
                            }
                            ,
                            t.prototype.Mv = function(e) {
                                var t, i, o, n, r = new GC.Spread.Sheets.Slicers.SlicerStyleInfo, a = this.ey.find("option:selected").val();
                                if (e)
                                    switch (r.backColor(e.backColor),
                                        r.foreColor(e.foreColor),
                                        r.font(e.font),
                                        r.textDecoration(e.textDecoration),
                                        t = this.xy(e.borderLeft),
                                        i = this.xy(e.borderTop),
                                        o = this.xy(e.borderRight),
                                        n = this.xy(e.borderBottom),
                                    t && r.borderLeft(t),
                                    i && r.borderTop(i),
                                    o && r.borderRight(o),
                                    n && r.borderBottom(n),
                                        a) {
                                        case "wholeSlicer":
                                            this.jy = e,
                                                this.Ey($(".slicer-pre-style"), e),
                                                this.iy.wholeSlicerStyle(r);
                                            break;
                                        case "header":
                                            this.ky = e,
                                                this.Ey($("#slicer-pre-header"), e),
                                                this.iy.headerStyle(r);
                                            break;
                                        case "selectedItemWithData":
                                            this.ly = e,
                                                this.Ey($("#selected-item-data"), e),
                                                this.iy.selectedItemWithDataStyle(r);
                                            break;
                                        case "selectedItemWithNoData":
                                            this.ny = e,
                                                this.Ey($("#selected-item-no-data"), e),
                                                this.iy.selectedItemWithNoDataStyle(r);
                                            break;
                                        case "unselectedItemWithData":
                                            this.oy = e,
                                                this.Ey($("#unselected-item-data"), e),
                                                this.iy.unSelectedItemWithDataStyle(r);
                                            break;
                                        case "unselectedItemWithNoData":
                                            this.py = e,
                                                this.Ey($("#unselected-item-no-data"), e),
                                                this.iy.unSelectedItemWithNoDataStyle(r);
                                            break;
                                        case "hoveredSelectedItemWithData":
                                            this.qy = e,
                                                this.Ey($("#hovered-selected-item-data"), e),
                                                this.iy.hoveredSelectedItemWithDataStyle(r);
                                            break;
                                        case "hoveredSelectedItemWithNoData":
                                            this.sy = e,
                                                this.Ey($("#hovered-selected-item-no-data"), e),
                                                this.iy.hoveredSelectedItemWithNoDataStyle(r);
                                            break;
                                        case "hoveredUnselectedItemWithData":
                                            this.ty = e,
                                                this.Ey($("#hovered-unselected-item-data"), e),
                                                this.iy.hoveredUnSelectedItemWithDataStyle(r);
                                            break;
                                        case "hoveredUnselectedItemWithNoData":
                                            this.uy = e,
                                                this.Ey($("#hovered-unselected-item-no-data"), e),
                                                this.iy.hoveredUnSelectedItemWithNoDataStyle(r)
                                    }
                            }
                            ,
                            t.prototype.Ey = function(e, t) {
                                var i, o, n, r, a = this.Fy(t.backColor), s = this.Fy(t.foreColor), l = t.borderLeft, c = t.borderTop, d = t.borderRight, p = t.borderBottom, u = t.textDecoration;
                                a && e.css("background-color", a),
                                s && e.css("color", s),
                                l && (i = this.Fy(t.borderLeft.color)) && e.css("border-left", "1px solid" + i),
                                c && (o = this.Fy(t.borderTop.color)) && e.css("border-top", "1px solid" + o),
                                d && (n = this.Fy(t.borderRight.color)) && e.css("border-right", "1px solid" + n),
                                p && (r = this.Fy(t.borderBottom.color)) && e.css("border-bottom", "1px solid" + r),
                                    this.Dy(e, u)
                            }
                            ,
                            t.prototype.Dy = function(e, t) {
                                e.find("span").length > 0 && (e = e.find("span")),
                                    2 === t ? e.css("text-decoration", "line-through") : 1 === t ? e.css("text-decoration", "underline") : 3 === t && e.css("text-decoration", "line-through underline")
                            }
                            ,
                            t.prototype.Fy = function(e) {
                                var t, i, o;
                                return e && 0 !== e.length ? (t = r.wrapper.spread,
                                    i = t.getActiveSheet(),
                                    o = i.currentTheme(),
                                    o ? o.getColor(e) : null) : null
                            }
                            ,
                            t.prototype.by = function() {
                                var e, i = this.xo.find(".slicer-style-input").val();
                                for (e in t.customSlicerStyle)
                                    if ((e = e.substring(e.indexOf("-") + 1)) === i)
                                        return !0;
                                return !1
                            }
                            ,
                            t.prototype.yv = function() {
                                var e, i = "custom", o = 1, n = this.xo.find(".slicer-style-input").val();
                                this.iy.name(n);
                                for (e in t.customSlicerStyle)
                                    o++;
                                n = i + "" + o + "-" + n,
                                    t.customSlicerStyle[n] = this.iy
                            }
                            ,
                            t.prototype.refresh = function() {
                                this.Ov(),
                                0 !== this.ey.children().length && this.ey.empty(),
                                    this._init()
                            }
                            ,
                            t.currentId = 1,
                            t.customSlicerStyle = {},
                            t
                    }(r.BaseDialog),
                    r.SlicerStyleDialog = O,
                    G = function(e) {
                        r.extends(t, e);
                        function t() {
                            e.call(this, H, ".format-slicer-dialog")
                        }
                        return t.prototype.wo = function() {
                            var e = this;
                            return {
                                width: "auto",
                                modal: !0,
                                resizable: !1,
                                title: r.res.slicerPropertyDialog.formatSlicer,
                                buttons: [{
                                    text: r.res.ok,
                                    click: function() {
                                        e.close(),
                                            e.Uo(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }, {
                                    text: r.res.cancel,
                                    click: function() {
                                        e.close(),
                                            r.wrapper.setFocusToSpread()
                                    }
                                }]
                            }
                        }
                            ,
                            t.prototype._init = function() {
                                $(".slicer-property-tab > ul").css("margin-top", "0px"),
                                    this.Gy = this.xo.find("#slicer-layout-item-width"),
                                    this.Hy = this.xo.find("#slicer-size-width"),
                                    this.Iy = this.xo.find("#slicer-size-scale-width"),
                                    this.Jy = this.xo.find("#slicer-size-height"),
                                    this.Ky = this.xo.find("#slicer-size-scale-height"),
                                    this.Ly = this.xo.find("#slicer-disable-resize"),
                                    this.My = this.xo.find("#slicer-layout-column-count")
                            }
                            ,
                            t.prototype.Bo = function() {
                                var e = r.wrapper.spread.getActiveSheet();
                                this.Ny = !0,
                                    this.Oy = !0,
                                    this.Py = !0,
                                    this.Qy = r.util.getSelectedSlicers(e),
                                this.Qy && 0 !== this.Qy.length && (this.Ry(),
                                    this.Qy.length > 1 ? this.Sy(this.Qy) : 1 === this.Qy.length && this.Ty(this.Qy[0]),
                                    $("#slicer-size-scale-height").val("100"),
                                    $("#slicer-size-scale-width").val("100"))
                            }
                            ,
                            t.prototype.Uo = function() {
                                var e, t, i, o, n, a, s, l, c, d, p, u;
                                if (this.Qy && 0 !== this.Qy.length) {
                                    if (this.Qy.length >= 1) {
                                        if (!this.Qy || 0 === this.Qy.length)
                                            return;
                                        e = $("#slicer-position-horizontal").val(),
                                            t = $("#slicer-position-vertial").val(),
                                            i = $("#slicer-layout-column-count").val(),
                                            o = $("#slicer-layout-item-height").val(),
                                            n = $("#slicer-size-height").val(),
                                            a = $("#slicer-size-width").val(),
                                            s = $("#slicer-disable-resize").prop("checked"),
                                            l = $("#slicer-locked").prop("checked"),
                                            c = $("#no-move-size").prop("checked"),
                                            d = $("#move-no-size").prop("checked"),
                                            p = $("#move-size").prop("checked"),
                                            u = {
                                                horizontal: e,
                                                vertical: t,
                                                columnCount: i,
                                                itemHeight: o,
                                                slicerHeight: n,
                                                slicerWidth: a,
                                                disableResizingAndMoving: s,
                                                locked: l,
                                                noMoveSize: c,
                                                moveNoSize: d,
                                                moveSize: p
                                            },
                                            r.actions.doAction("baseDialogCommand", r.wrapper.spread, {
                                                value: {
                                                    formatOption: u,
                                                    selectedSlicers: this.Qy
                                                },
                                                execute: r.spreadActions.dialogAction.FormatSlicerForDialog
                                            })
                                    }
                                    this.Uy()
                                }
                            }
                            ,
                            t.prototype.Ry = function() {
                                var e = this;
                                this.xo.find(".slicer-property-tab").tabs(),
                                    $("#position-layout").width(120),
                                    $("#size").width(60),
                                    $("#properties").width(80),
                                    this.xo.find("#slicer-position-horizontal").spinner({
                                        min: 0
                                    }),
                                    this.xo.find("#slicer-position-vertial").spinner({
                                        min: 0
                                    }),
                                    this.xo.find("#slicer-layout-item-height").spinner({
                                        min: 0
                                    }),
                                    this.My.spinner({
                                        min: 1,
                                        spin: function(t, i) {
                                            e.Vy(i.value)
                                        }
                                    }),
                                    this.Jy.spinner({
                                        min: 0,
                                        spin: function(t, i) {
                                            e.Wy(i.value)
                                        }
                                    }),
                                    this.Ky.spinner({
                                        min: 0,
                                        spin: function(t, i) {
                                            e.Xy(i.value)
                                        }
                                    }),
                                    this.Gy.spinner({
                                        min: 0,
                                        spin: function(t, i) {
                                            e.Yy(i.value)
                                        }
                                    }),
                                    this.Hy.spinner({
                                        min: 0,
                                        spin: function(t, i) {
                                            e.Zy(i.value)
                                        }
                                    }),
                                    this.Iy.spinner({
                                        min: 0,
                                        spin: function(t, i) {
                                            e.$y(i.value)
                                        }
                                    }),
                                    this.My.bind("input", function() {
                                        var t = e._y($(this).val());
                                        e.Vy(t)
                                    }),
                                    this.Gy.bind("input", function() {
                                        var t = e._y($(this).val());
                                        e.Yy(t)
                                    }),
                                    this.Hy.bind("input", function() {
                                        var t = e._y($(this).val());
                                        e.Zy(t)
                                    }),
                                    this.Iy.bind("input", function() {
                                        var t = e._y($(this).val());
                                        e.$y(t)
                                    }),
                                    this.Jy.bind("input", function() {
                                        var t = e._y($(this).val());
                                        e.Wy(t)
                                    }),
                                    this.Ky.bind("input", function() {
                                        var t = e._y($(this).val());
                                        e.Xy(t)
                                    }),
                                    this.Ly.bind("change", function() {
                                        $(this).prop("checked") ? e.az() : e.bz()
                                    })
                            }
                            ,
                            t.prototype.Uy = function() {
                                this.My.unbind(),
                                    this.Gy.unbind(),
                                    this.Hy.unbind(),
                                    this.Iy.unbind(),
                                    this.Jy.unbind(),
                                    this.Ky.unbind(),
                                    this.Ly.unbind()
                            }
                            ,
                            t.prototype._y = function(e) {
                                return r.util.formatNumber(e)
                            }
                            ,
                            t.prototype.az = function() {
                                $("#slicer-position-horizontal").spinner("disable"),
                                    $("#slicer-position-vertial").spinner("disable"),
                                    $("#slicer-layout-column-count").spinner("disable"),
                                    $("#slicer-layout-item-height").spinner("disable"),
                                    $("#slicer-layout-item-width").spinner("disable"),
                                    $("#slicer-size-height").spinner("disable"),
                                    $("#slicer-size-width").spinner("disable"),
                                    $("#slicer-size-scale-height").spinner("disable"),
                                    $("#slicer-size-scale-width").spinner("disable")
                            }
                            ,
                            t.prototype.bz = function() {
                                $("#slicer-position-horizontal").spinner("enable"),
                                    $("#slicer-position-vertial").spinner("enable"),
                                    $("#slicer-layout-column-count").spinner("enable"),
                                    $("#slicer-layout-item-height").spinner("enable"),
                                    $("#slicer-layout-item-width").spinner("enable"),
                                    $("#slicer-size-height").spinner("enable"),
                                    $("#slicer-size-width").spinner("enable"),
                                    $("#slicer-size-scale-height").spinner("enable"),
                                    $("#slicer-size-scale-width").spinner("enable")
                            }
                            ,
                            t.prototype.Ty = function(e) {
                                e && ($("#slicer-position-horizontal").val(e.position().x),
                                    $("#slicer-position-vertial").val(e.position().y),
                                    $("#slicer-layout-column-count").val(e.columnCount()),
                                    $("#slicer-layout-item-height").val(Math.round(e.itemHeight())),
                                    $("#slicer-layout-item-width").val(r.util.getSlicerItemWidth(e.columnCount(), e.width())),
                                    $("#slicer-size-height").val(Math.round(e.height())),
                                    $("#slicer-size-width").val(Math.round(e.width())),
                                    e.disableResizingAndMoving() ? ($("#slicer-disable-resize").prop("checked", !0),
                                        this.az()) : ($("#slicer-disable-resize").prop("checked", !1),
                                        this.bz()),
                                    e.isLocked() ? $("#slicer-locked").prop("checked", !0) : $("#slicer-locked").prop("checked", !1),
                                    e.dynamicMove() ? e.dynamicSize() ? $("#move-size").prop("checked", !0) : $("#move-no-size").prop("checked", !0) : $("#no-move-size").prop("checked", !0))
                            }
                            ,
                            t.prototype.Sy = function(e) {
                                var t, i, o, n, a, s, l, c, d, p, u, h, f, g, m;
                                if (e && 0 !== e.length) {
                                    t = e[0],
                                        i = !0,
                                        o = !0,
                                        n = !0,
                                        a = !0,
                                        s = !0,
                                        l = !0,
                                        c = e[0].columnCount(),
                                        d = e[0].itemHeight(),
                                        p = r.util.getSlicerItemWidth(t.columnCount(), t.width()),
                                        u = e[0].height(),
                                        h = e[0].width(),
                                        f = e[0].dynamicMove(),
                                        g = e[0].dynamicSize();
                                    for (m in e)
                                        t = e[m],
                                            i = i && t.disableResizingAndMoving(),
                                            o = o && t.isLocked(),
                                            s = s && t.dynamicMove(),
                                            l = l && t.dynamicSize(),
                                        t.columnCount() !== c && (n = !1),
                                        t.itemHeight() !== d && (a = !1),
                                            t = e[m],
                                        r.util.getSlicerItemWidth(t.columnCount(), t.width()) !== p && (this.Oy = !1),
                                        t.height() !== u && (this.Ny = !1),
                                        t.width() !== h && (this.Py = !1),
                                        t.dynamicMove() !== f && (s = !1),
                                        t.dynamicSize() !== g && (l = !1);
                                    $("#slicer-position-horizontal").val(""),
                                        $("#slicer-position-vertial").val(""),
                                        s && l && f ? g ? $("#move-size").prop("checked", !0) : $("#move-no-size").prop("checked", !0) : $("#no-move-size").prop("checked", !0),
                                        n ? $("#slicer-layout-column-count").val(c) : $("#slicer-layout-column-count").val(""),
                                        a ? $("#slicer-layout-item-height").val(Math.round(d)) : $("#slicer-layout-item-height").val(""),
                                        this.Oy ? $("#slicer-layout-item-width").val(p) : $("#slicer-layout-item-width").val(""),
                                        this.Ny ? $("#slicer-size-height").val(Math.round(u)) : $("#slicer-size-height").val(""),
                                        this.Py ? $("#slicer-size-width").val(Math.round(h)) : $("#slicer-size-width").val(""),
                                        i ? ($("#slicer-disable-resize").prop("checked", !0),
                                            this.az()) : ($("#slicer-disable-resize").prop("checked", !1),
                                            this.bz()),
                                        o ? $("#slicer-locked").prop("checked", !0) : $("#slicer-locked").prop("checked", !1)
                                }
                            }
                            ,
                            t.prototype.cz = function() {
                                var e = r.wrapper.spread.getActiveSheet()
                                    , t = r.util.getSelectedSlicers(e);
                                return t && 0 !== t.length ? Math.round(t[0].height()) : void 0
                            }
                            ,
                            t.prototype.dz = function() {
                                var e = r.wrapper.spread.getActiveSheet()
                                    , t = r.util.getSelectedSlicers(e);
                                return t && 0 !== t.length ? Math.round(t[0].width()) : void 0
                            }
                            ,
                            t.prototype.ez = function() {
                                var e = r.wrapper.spread.getActiveSheet()
                                    , t = r.util.getSelectedSlicers(e);
                                return t && 0 !== t.length ? t[0].columnCount() : void 0
                            }
                            ,
                            t.prototype.Vy = function(e) {
                                var t, i;
                                e <= 0 || ($("#slicer-layout-column-count").val(e),
                                    t = this.dz(),
                                    i = r.util.getSlicerItemWidth(e, t),
                                    $("#slicer-layout-item-width").val(i))
                            }
                            ,
                            t.prototype.Wy = function(e) {
                                var t, i;
                                if (!this.Ny)
                                    return $("#slicer-size-scale-height").val(""),
                                        void $("#slicer-size-scale-width").val("");
                                t = this.cz(),
                                    i = Math.round(e / t * 100),
                                    $("#slicer-size-scale-height").val(i)
                            }
                            ,
                            t.prototype.Zy = function(e) {
                                var t = this.dz()
                                    , i = Math.round(e / t * 100)
                                    , o = this.ez()
                                    , n = r.util.getSlicerItemWidth(o, e);
                                this.Oy ? $("#slicer-layout-item-width").val(n) : $("#slicer-layout-item-width").val(""),
                                    this.Py ? $("#slicer-size-scale-width").val(i) : $("#slicer-size-scale-width").val("")
                            }
                            ,
                            t.prototype.Xy = function(e) {
                                var t, i;
                                this.Ny && (t = this.cz(),
                                    i = Math.round(e * t / 100),
                                    $("#slicer-size-height").val(i))
                            }
                            ,
                            t.prototype.$y = function(e) {
                                var t, i, o, n;
                                this.Py && (t = this.dz(),
                                    i = Math.round(e * t / 100),
                                    o = this.ez(),
                                    n = r.util.getSlicerItemWidth(o, i),
                                    $("#slicer-size-width").val(i),
                                    $("#slicer-layout-item-width").val(n))
                            }
                            ,
                            t.prototype.Yy = function(e) {
                                var t, i, o, n;
                                if (!this.Oy)
                                    return $("#slicer-size-width").val(""),
                                        void $("#slicer-size-scale-width").val("100");
                                t = this.dz(),
                                    i = this.ez(),
                                    o = r.util.getSlicerWidthFromItem(i, e),
                                    n = Math.round(o / t * 100),
                                    $("#slicer-size-width").val(o),
                                    $("#slicer-size-scale-width").val(n)
                            }
                            ,
                            t
                    }(r.BaseDialog),
                    r.FormatSlicerDialog = G
            }()
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e, t = function() {
                    function e(e) {
                        this.rootElem = e,
                            this.selectedTab = null,
                            this.onSelectItem = null,
                            this.fz(),
                            this.selectedTab = e.find("a:first").closest("li"),
                            this.showTab(this.selectedTab.children("a").attr("href"))
                    }
                    return e.prototype.showTab = function(e) {
                        if (this.selectedTab) {
                            var t = $(this.selectedTab.children(":first").attr("href"));
                            t.hide(),
                                this.selectedTab.removeClass("menu-item-selected")
                        }
                        this.selectedTab = $("li > a[href=" + e + "]").parent(),
                            this.selectedTab.addClass("menu-item-selected"),
                            this.hideUnselectedViews(),
                            $(e).show("fast")
                    }
                        ,
                        e.prototype.hideUnselectedViews = function() {
                            var e = this.rootElem.children("li:not(.selected)");
                            e.each(function(e, t) {
                                var i = $(t).children("a").attr("href");
                                $(i).hide()
                            })
                        }
                        ,
                        e.prototype.fz = function() {
                            var e = this;
                            this.rootElem.find("a").on("click", function(t) {
                                return e.gz(t),
                                    !1
                            })
                        }
                        ,
                        e.prototype.gz = function(e) {
                            var t = $(e.target).attr("href");
                            0 !== $(t).length && this.showTab(t),
                            this.onSelectItem && this.onSelectItem.call(null, e)
                        }
                        ,
                        e
                }();
                i.Menu = t,
                    e = function() {
                        function e() {
                            this.mainMenu = new t($(".menu-panel ul")),
                                this.importMenu = new t($("#import-page .left-view ul")),
                                this.exportMenu = new t($("#export-page .left-view ul"))
                        }
                        return e.isNotSupportFileApi = function() {
                            var e = window;
                            return !e.File && !e.FileReader
                        }
                            ,
                            e.showNotSupportFileApiDialog = function() {
                                i.MessageBox.show(i.res.fileAPINotSupported, i.res.title, i.MessageBoxIcon.warning)
                            }
                            ,
                            e.checkFileApiSupport = function() {
                                return !e.isNotSupportFileApi() || (e.showNotSupportFileApiDialog(),
                                    !1)
                            }
                            ,
                            e.checkBolbSupport = function() {
                                return !!window.Blob || (i.MessageBox.show(i.res.blobNotSupported, i.res.title, i.MessageBoxIcon.warning),
                                    !1)
                            }
                            ,
                            e.prototype.hz = function() {
                                var e, t, o = i.wrapper.spread.sheets, n = o.length;
                                if (n <= 0)
                                    return null;
                                if (e = $(".export-sheet-select"))
                                    for (e.children().length > 0 && e.empty(),
                                             $("<option>").text(i.res.fileMenu.allSheet).appendTo(e),
                                             t = 0; t < n; t++)
                                        $("<option>").text(o[t].name()).appendTo(e)
                            }
                            ,
                            e.prototype.showFileScreen = function() {
                                $(".file-menu").hasClass("hidden") && $(".file-menu").removeClass("hidden")
                            }
                            ,
                            e.prototype.closeFileScreen = function() {
                                $(".file-menu").hasClass("hidden") || $(".file-menu").addClass("hidden")
                            }
                            ,
                            e.prototype.clickOnMainMenuTab = function(e) {
                                "#" !== e.target.getAttribute("href") && $(".menu-title span").text(e.target.textContent)
                            }
                            ,
                            e.prototype.bindNavigatorHandlers = function() {
                                var e = this;
                                $("#file-menu-goback").on("click", function() {
                                    return e.closeFileScreen()
                                }),
                                    this.mainMenu.onSelectItem = this.clickOnMainMenuTab
                            }
                            ,
                            e.prototype.initPage = function() {
                                this.iz(),
                                    $(".menu-title span").text(i.res.fileMenu.new),
                                    this.mainMenu.showTab("#new-page"),
                                    this.bindNavigatorHandlers()
                            }
                            ,
                            e.prototype.iz = function() {
                                this.jz(),
                                    this.kz(),
                                    this.lz()
                            }
                            ,
                            e.prototype.jz = function() {
                                var e = this;
                                $.ajax({
                                    url: "../resources/templates/templatesconfig.txt"/*tpa=https://www.grapecity.com/en/demos/spread/JS/WebDesigner/resources/templates/templatesconfig.js*/
                                    ,
                                    type: "GET",
                                    dataType: "json",
                                    success: function(t) {
                                        return e.mz(t)
                                    },
                                    error: function() {
                                        return i.MessageBox.show(i.res.requestTemplateConfigFail, i.res.title, 3)
                                    }
                                })
                            }
                            ,
                            e.prototype.nz = function(e) {
                                var t, i, o = this, n = $("<div>");
                                return n.addClass("template-item"),
                                    t = $("<div>"),
                                    t.addClass("template-item-thumb").addClass(e.thumbClass),
                                    t.appendTo(n),
                                    i = $("<span>"),
                                    i.text(e.name),
                                    i.appendTo(n),
                                    n.on("click", function() {
                                        return o.oz(e.name)
                                    }),
                                    n
                            }
                            ,
                            e.prototype.oz = function(e) {
                                i.actions.openTemplate(i.wrapper.spread, e)
                            }
                            ,
                            e.prototype.mz = function(e) {
                                var t, i, o = $("#new-page");
                                for (t = 0; t < e.length; t++)
                                    i = this.nz(e[t]),
                                        i.appendTo(o)
                            }
                            ,
                            e.prototype.kz = function() {
                                this.pz()
                            }
                            ,
                            e.prototype.pz = function() {
                                $("#import-json").on("click", function(t) {
                                    if (!e.checkFileApiSupport())
                                        return !1;
                                    var o = $(t.currentTarget)
                                        , n = o.data("action")
                                        , r = o.data("actionArgs");
                                    i.actions.doAction(n, i.wrapper.spread, r)
                                }),
                                    $("#import_excel_rowAndColumnHeaders").on("click", function(e) {
                                        var t = $(e.currentTarget).prop("checked");
                                        $("#import_excel_rowHeaders").prop("checked", t),
                                            $("#import_excel_columnHeaders").prop("checked", t)
                                    }),
                                    $("#import_excel_rowHeaders").on("click", function() {
                                        var e = $("#import_excel_rowHeaders").prop("checked") && $("#import_excel_columnHeaders").prop("checked");
                                        $("#import_excel_rowAndColumnHeaders").prop("checked", e)
                                    }),
                                    $("#import_excel_columnHeaders").on("click", function() {
                                        var e = $("#import_excel_rowHeaders").prop("checked") && $("#import_excel_columnHeaders").prop("checked");
                                        $("#import_excel_rowAndColumnHeaders").prop("checked", e)
                                    }),
                                    $("#import-excel").on("click", function(t) {
                                        var o, n, r, a, s, l, c, d;
                                        if (!e.checkFileApiSupport())
                                            return !1;
                                        o = $(t.currentTarget),
                                            n = o.data("action"),
                                            r = !!$("#import_excel_ignoreStyle").prop("checked"),
                                            a = !!$("#import_excel_ignoreFormula").prop("checked"),
                                            s = !!$("#import_excel_rowHeaders").prop("checked"),
                                            l = !!$("#import_excel_columnHeaders").prop("checked"),
                                            c = !!$("#import_excel_doNotRecalculateAfterLoad").prop("checked"),
                                            d = {
                                                excelOpenFlags: {
                                                    ignoreStyle: r,
                                                    ignoreFormula: a,
                                                    frozenColumnsAsRowHeaders: s,
                                                    frozenRowsAsColumnHeaders: l,
                                                    doNotRecalculateAfterLoad: c
                                                },
                                                password: $("#import_excel_password").val()
                                            },
                                            i.actions.doAction(n, i.wrapper.spread, d)
                                    }),
                                    $("#import-csv").on("click", function(t) {
                                        var o = $(t.currentTarget)
                                            , n = o.data("action")
                                            , r = $("#import_csv_includeRowHeader").prop("checked") ? 1 : 0
                                            , a = $("#import_csv_includeColumnHeader").prop("checked") ? 2 : 0
                                            , s = $("#import_csv_unformatted").prop("checked") ? 8 : 0
                                            , l = $("#import_csv_importFormula").prop("checked") ? 16 : 0
                                            , c = {
                                            textFileOpenFlags: "" + (r | a | s | l),
                                            rowDelimiter: e.qz($("#import_csv_rowDelimiter").val()),
                                            columnDelimiter: e.qz($("#import_csv_columnDelimiter").val()),
                                            cellDelimiter: e.qz($("#import_csv_cellDelimiter").val()),
                                            encoding: $("#import_csv_encoding").val()
                                        };
                                        i.actions.doAction(n, i.wrapper.spread, c)
                                    })
                            }
                            ,
                            e.prototype.lz = function() {
                                this.rz()
                            }
                            ,
                            e.prototype.sz = function() {
                                var e = $(".export-setting-input").get(0).selectedIndex;
                                return 0 === e ? void 0 : e - 1
                            }
                            ,
                            e.prototype.rz = function() {
                                $("#export-json, #export-js").on("click", function(t) {
                                    if (!e.checkBolbSupport())
                                        return !1;
                                    var o = $(t.currentTarget)
                                        , n = o.data("action")
                                        , r = o.data("actionArgs");
                                    i.actions.doAction(n, i.wrapper.spread, r)
                                }),
                                    $("#export_excel_saveBothCustomRowAndColumnHeaders").on("click", function(e) {
                                        var t = $(e.currentTarget).prop("checked");
                                        $("#export_excel_saveCustomRowHeaders").prop("checked", t),
                                            $("#export_excel_saveCustomColumnHeaders").prop("checked", t)
                                    }),
                                    $("#export_excel_saveCustomRowHeaders").on("click", function() {
                                        var e = $("#export_excel_saveCustomRowHeaders").prop("checked") && $("#export_excel_saveCustomColumnHeaders").prop("checked");
                                        $("#export_excel_saveBothCustomRowAndColumnHeaders").prop("checked", e)
                                    }),
                                    $("#export_excel_saveCustomColumnHeaders").on("click", function() {
                                        var e = $("#export_excel_saveCustomRowHeaders").prop("checked") && $("#export_excel_saveCustomColumnHeaders").prop("checked");
                                        $("#export_excel_saveBothCustomRowAndColumnHeaders").prop("checked", e)
                                    }),
                                    $("#export-excel").on("click", function(e) {
                                        var t = $(e.currentTarget)
                                            , o = t.data("action")
                                            , n = !!$("#export_excel_ignoreStyle").prop("checked")
                                            , r = !!$("#export_excel_ignoreFormulas").prop("checked")
                                            , a = !!$("#export_excel_saveCustomRowHeaders").prop("checked")
                                            , s = !!$("#export_excel_saveCustomColumnHeaders").prop("checked")
                                            , l = {
                                            excelSaveFlags: {
                                                ignoreStyle: n,
                                                ignoreFormula: r,
                                                rowHeadersAsFrozenColumns: a,
                                                columnHeadersAsFrozenRows: s
                                            },
                                            password: $("#export_excel_password").val()
                                        };
                                        i.actions.doAction(o, i.wrapper.spread, l)
                                    }),
                                    $("#export-csv").on("click", function(t) {
                                        var o = $(t.currentTarget)
                                            , n = o.data("action")
                                            , r = $("#export_csv_includeRowHeader").prop("checked") ? 1 : 0
                                            , a = $("#export_csv_includeColumnHeader").prop("checked") ? 2 : 0
                                            , s = $("#export_csv_unFormatted").prop("checked") ? 8 : 0
                                            , l = $("#export_csv_exportFormula").prop("checked") ? 16 : 0
                                            , c = $("#export_csv_asViewed").prop("checked") ? 32 : 0
                                            , d = {
                                            saveFlags: r | a | s | l | c,
                                            sheetIndex: e.tz($("#export_csv_sheetIndex").val()),
                                            encoding: $("#export_csv_encoding").val(),
                                            row: e.tz($("#export_csv_row").val() || "0"),
                                            column: e.tz($("#export_csv_column").val() || "0"),
                                            rowCount: e.tz($("#export_csv_rowCount").val() || "-1"),
                                            columnCount: e.tz($("#export_csv_columnCount").val() || "-1"),
                                            rowDelimiter: e.qz($("#export_csv_rowDelimiter").val()),
                                            columnDelimiter: e.qz($("#export_csv_columnDelimiter").val()),
                                            cellDelimiter: e.qz($("#export_csv_cellDelimiter").val())
                                        };
                                        if (!i.wrapper.spread.sheets[d.sheetIndex])
                                            return void i.MessageBox.show(i.res.exportCsvSheetIndexError, i.res.title, 2, 0);
                                        i.actions.doAction(n, i.wrapper.spread, d)
                                    });
                                var t = this;
                                $("#export-pdf").on("click", function(e) {
                                    var o = $(e.currentTarget)
                                        , n = o.data("action")
                                        , r = {
                                        title: $(".pdf-title").val(),
                                        author: $(".pdf-author").val(),
                                        subject: $(".pdf-subject").val(),
                                        creator: $(".pdf-application").val(),
                                        keywords: $(".pdf-keywords").val()
                                    }
                                        , a = {
                                        sheetIndex: t.sz(),
                                        setting: r
                                    };
                                    i.actions.doAction(n, i.wrapper.spread, a)
                                })
                            }
                            ,
                            e.tz = function(e) {
                                return e = parseInt(e),
                                    isNaN(e) ? null : e
                            }
                            ,
                            e.qz = function(e) {
                                return e.replace(/\\r/g, "\r").replace(/\\n/g, "\n")
                            }
                            ,
                            e
                    }(),
                    i.FileMenu = e,
                    i.fileMenu,
                    i.loader.ready(function() {
                        i.fileMenu = new e,
                            $("#file-menu-tab").on("click", function() {
                                i.fileMenu.showFileScreen(),
                                    i.fileMenu.hz()
                            }),
                            i.fileMenu.initPage()
                    })
            }()
        }
        , function(e, t) {
            var i = void 0
                , o = null
                , n = GC.Spread.Sheets
                , r = n.Designer;
            !function() {
                "use strict";
                var e = function(e) {
                    r.extends(t, e);
                    function t() {
                        e.call(this, r.util.resolveHtmlPath("../formatDialog", "formatDialog.html"), ".format-dialog"),
                            t.Rv++
                    }
                    var a = {
                        "zh-cn": "804",
                        "ja-jp": "411"
                    };
                    return t.prototype.wo = function() {
                        var e = this;
                        return {
                            width: "auto",
                            modal: !0,
                            title: r.res.formatDialog.title,
                            buttons: [{
                                text: r.res.ok,
                                click: function() {
                                    if (e.uz || void 0 === e.uz)
                                        e.vz();
                                    else {
                                        var t;
                                        t = e.wz ? e.xz.result() : e.yz(),
                                            $(e).trigger("okClicked", t),
                                            e.zz()
                                    }
                                    e.close()
                                }
                            }, {
                                text: r.res.cancel,
                                click: function() {
                                    e.cancel(),
                                        e.close()
                                }
                            }]
                        }
                    }
                        ,
                        t.prototype.zz = function() {
                            var e, t = r.wrapper.spread.getActiveSheet(), i = t.getActiveRowIndex(), o = t.getActiveColumnIndex(), n = t.tables.find(i, o);
                            n && (e = n.getSlicerData()) && e.refresh()
                        }
                        ,
                        t.prototype.vz = function() {
                            var e, t, i = this, o = i.xz.result(), n = {
                                fontFamily: i.Aq,
                                fontSize: i.Cq,
                                fontStyle: i.Bq,
                                fontWeight: i.Dq
                            };
                            void 0 === i.Az && void 0 === i.mw || (e = {
                                orignalBorder: i.Bz,
                                borderType: i.Cz()
                            }),
                                t = {
                                    merged: i.Dz
                                },
                                r.actions.doAction("baseDialogCommand", r.wrapper.spread, {
                                    value: {
                                        styleInfo: o,
                                        fontInfo: n,
                                        borderInfo: e,
                                        mergeInfo: t
                                    },
                                    execute: r.spreadActions.dialogAction.formatDialogApplySetting
                                }),
                                i.Ez()
                        }
                        ,
                        t.prototype.Bo = function(e) {
                            var o, n, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C = 0;
                            e = e || [],
                            void 0 !== e && e.length > 0 && (r.util.assert("string" == typeof e[0]),
                                C = t.getTabIndexById(e[0])),
                            void 0 !== e[1] && this.xo.find(".font-picker").fontpicker("option", "customFontStyle", e[1]),
                                void 0 !== e[2] ? this.xz = new r.StyleShadowObject(e[2]) : this.xz = new r.SpreadStyleShadowObject(r.wrapper.spread),
                                e[3] ? (this.Fz(!0, e[4]),
                                    o = {
                                        borderTop: this.xz.borderTop(),
                                        borderBottom: this.xz.borderBottom(),
                                        borderRight: this.xz.borderRight(),
                                        borderLeft: this.xz.borderLeft(),
                                        borderVertical: this.xz.borderVertical(),
                                        borderHorizontal: this.xz.borderHorizontal(),
                                        diagonalUp: this.xz.diagonalUp(),
                                        diagonalDown: this.xz.diagonalDown()
                                    },
                                    this.Gz(o),
                                    this.wz = !0) : (this.Fz(!1),
                                    n = this.Hz(),
                                n && this.Gz(n),
                                    this.wz = !1),
                                this.xo.find(".main-tab").tabs("option", "active", C),
                                this.Iw(".input-horizontal-align", this.xz.hAlign()),
                                this.Iw(".input-vertical-align", this.xz.vAlign()),
                                this.xz.textIndent() !== r.BaseMetaObject.indeterminateValue ? this.xo.find(".input-indent").spinner("value", this.xz.textIndent()) : this.xo.find(".input-indent").spinner("value", ""),
                                this.ww(".input-wrap", this.xz.wordWrap()),
                                this.ww(".input-shrink", this.xz.shrinkToFit()),
                                this.ww(".input-vertical-text", this.xz.isVerticalText()),
                                this.Dz = this.Iz(),
                                this.ww(".input-merge", this.Dz),
                                this.Jz(this.xz.font(), this.xz.foreColor(), this.xz.textDecoration()),
                                this.ww(".cell-protection", this.xz.locked()),
                                this.Kz(".show-color-span", this.xz.backColor()),
                                void 0 !== e[2] ? this.Lz(this.xz.formatter()) : this.Mz(this.xz.formatter(), r.wrapper.spread),
                            void 0 !== this.selectTabOptions && this.selectTab(this.selectTabOptions),
                            this.selectTabOptions && !this.selectTabOptions.padding || (a = this.xz.font(),
                            a && "string" == typeof a && (s = r.util.parseFont(a),
                                this.Aq = s.fontFamily,
                                this.Cq = s.fontSize.replace(/(pt|px)$/, ""),
                                this.Bq = s.fontStyle,
                                this.Dq = s.fontWeight),
                                this.Nz.getActiveSheet().setStyle(0, 0, null),
                                this.Oz = i,
                                this.Pz = i,
                                this.Qz = i,
                                this.Rz = i,
                                l = this.xz.cellPadding(),
                                c = r.util.parsePadding(l),
                                this.xo.find(".label-top-padding").spinner("value", parseInt(c[0]) || 0),
                                this.xo.find(".label-right-padding").spinner("value", parseInt(c[1]) || 0),
                                this.xo.find(".label-bottom-padding").spinner("value", parseInt(c[2]) || 0),
                                this.xo.find(".label-left-padding").spinner("value", parseInt(c[3]) || 0),
                                this.Sz("top-padding", parseInt(c[0]) || 0),
                                this.Sz("right-padding", parseInt(c[1]) || 0),
                                this.Sz("bottom-padding", parseInt(c[2]) || 0),
                                this.Sz("left-padding", parseInt(c[3]) || 0),
                                d = this.xz.watermark(),
                            d !== r.BaseMetaObject.undefinedValue && d !== r.BaseMetaObject.indeterminateValue || (d = ""),
                                this.Tz(".label-text-input", d),
                                this.Uz(d),
                                p = this.xz.labelOptions() || {},
                                u = p.alignment,
                                this.Vz(u || 0),
                                this.Wz(p.foreColor || "grey"),
                                this.Xz(p.font || a || r.res.defaultFont),
                                h = p.font,
                            h && "string" == typeof h && (s = r.util.parseFont(h),
                                this.Oz = s.fontFamily,
                                this.Pz = s.fontSize.replace(/(pt|px)$/, ""),
                                this.Qz = s.fontStyle,
                                this.Rz = s.fontWeight),
                                f = r.util.getFromCache("defaultFont", function() {
                                    return r.util.parseFont(r.res.defaultFont)
                                }),
                                g = this.Oz || this.Aq || f.fontFamily,
                            g.match(/^["'].*["']$/) && (g = g.substring(1, g.length - 1)),
                                this.Iw(".label-font-family", g),
                                this.Iw(".label-font-size", this.Pz || this.Cq || f.fontSize.replace(/(pt|px)$/, "")),
                                m = this.Rz || this.Dq || "normal",
                                "normal" === m ? this.xo.find(".label-font-weight").val(!1).removeClass("button-active") : "bold" === m && this.xo.find(".label-font-weight").val(!0).addClass("button-active"),
                                b = this.Qz || this.Bq || "normal",
                                "normal" === b ? this.xo.find(".label-font-style").val(!1).removeClass("button-active") : "italic" === b && this.xo.find(".label-font-style").val(!0).addClass("button-active"),
                                v = p.visibility,
                                this.Yz(void 0 !== v ? v : 2),
                                y = ["visible", "hidden", "auto"],
                                this.Iw(".label-visibility", y[v] || "auto"),
                                x = p.margin,
                                w = r.util.parsePadding(x),
                                this.xo.find(".label-top-margin").spinner("value", parseInt(w[0]) || 0),
                                this.xo.find(".label-right-margin").spinner("value", parseInt(w[1]) || 0),
                                this.xo.find(".label-bottom-margin").spinner("value", parseInt(w[2]) || 0),
                                this.xo.find(".label-left-margin").spinner("value", parseInt(w[3]) || 0),
                                this.Sz("top-margin", parseInt(w[0]) || 0),
                                this.Sz("right-margin", parseInt(w[1]) || 0),
                                this.Sz("bottom-margin", parseInt(w[2]) || 0),
                                this.Sz("left-margin", parseInt(w[3]) || 0))
                        }
                        ,
                        t.prototype._init = function() {
                            var e = this;
                            this.Zz = new GC.Spread.Sheets.Workbook(this.xo.find(".sample-spread")[0]),
                                this.wz = !1,
                                this.$z = [],
                                this._z = "3/14/2001 13:30:00",
                                this.Az = "Text 1",
                                this.mw = 1,
                                this.aA = new r.ColorDailog,
                                this.aA._create(),
                                this.bA(),
                                this.xo.find("button").button(),
                                this.xo.find(".tabs").tabs(),
                                this.xo.find(".small-border-icon").button(),
                                this.xo.find(".big-border-icon").button(),
                                this.xo.find(".input-indent").spinner({
                                    min: 0,
                                    max: 1e4,
                                    change: function() {
                                        e.xz.textIndent($(this).spinner("value"))
                                    },
                                    spin: function() {}
                                }),
                                this.xo.find(".font-picker").fontpicker({
                                    changed: function(t, i) {
                                        var o, n, r, a, s, l, c;
                                        switch (i.name) {
                                            case "family":
                                                e.Aq = i.value;
                                                break;
                                            case "style":
                                                e.Bq = i.value;
                                                break;
                                            case "size":
                                                e.Cq = i.value;
                                                break;
                                            case "weight":
                                                e.Dq = i.value;
                                                break;
                                            case "color":
                                                o = i.value,
                                                    o ? o.name ? e.xz.foreColor(o.name) : e.xz.foreColor(o.color) : e.xz.foreColor(o);
                                                break;
                                            case "underline":
                                                e.cA = i.value;
                                                break;
                                            case "doubleUnderline":
                                                e.dA = i.value;
                                                break;
                                            case "strikethrough":
                                                e.eA = i.value
                                        }
                                        n = 0,
                                            e.cA ? n |= 1 : e.dA && (n |= 8),
                                        e.eA && (n |= 2),
                                            e.xz.textDecoration(n),
                                            e.Aq || e.Bq || e.Cq || e.Dq ? (r = e.Aq ? e.Aq : "Arial",
                                                a = e.Bq ? e.Bq : "normal",
                                                s = e.Cq ? e.Cq + "pt" : "10pt",
                                                l = e.Dq ? e.Dq : "normal",
                                                c = a + " " + l + " " + s + " " + r,
                                                e.xz.font(c)) : e.xz.font("")
                                    }
                                }),
                                this.xo.find(".format-tab-li").click(function() {
                                    $("button[dialogtobefocused='true']").focus()
                                }),
                                this.xo.find(".input-horizontal-align").change(function() {
                                    var t = e.xo.find(".input-horizontal-align").val();
                                    e.xz.hAlign(t)
                                }),
                                this.xo.find(".input-vertical-align").change(function() {
                                    var t = e.xo.find(".input-vertical-align").val();
                                    e.xz.vAlign(t)
                                }),
                                this.xo.find(".input-indent").change(function() {
                                    var t = e.xo.find(".input-indent").val();
                                    e.xz.textIndent(t)
                                }),
                                this.xo.find(".input-wrap").change(function() {
                                    var t = e.xo.find(".input-wrap").prop("checked");
                                    e.xz.wordWrap(t)
                                }),
                                this.xo.find(".input-shrink").change(function() {
                                    var t = e.xo.find(".input-shrink").prop("checked");
                                    e.xz.shrinkToFit(t)
                                }),
                                this.xo.find(".input-merge").click(function() {
                                    !0 === e.Dz ? e.Dz = !1 : !1 === e.Dz ? e.Dz = r.BaseMetaObject.indeterminateValue : e.Dz = !0,
                                        e.ww(".input-merge", e.Dz)
                                }),
                                this.xo.find(".input-vertical-text").change(function() {
                                    var t = e.xo.find(".input-vertical-text").prop("checked");
                                    e.xz.isVerticalText(t)
                                }),
                                this.xo.find(".cell-protection").change(function() {
                                    var t = e.xo.find(".cell-protection").prop("checked");
                                    e.xz.locked(t)
                                }),
                                this.xo.find(".colorPicker").colorpicker({
                                    valueChanged: function(t, i) {
                                        if (i.name) {
                                            var o = r.ColorHelper.parse(i.name, r.wrapper.spread.getActiveSheet().currentTheme().colors());
                                            e.xo.find(".show-color-span").css("background-color", o.color),
                                                e.xz.backColor(i.name)
                                        } else
                                            e.xo.find(".show-color-span").css("background-color", i.color),
                                                e.xz.backColor(i.color)
                                    }
                                }),
                                this.xo.find(".border-picker").borderpicker({
                                    colorChanged: function(t, i) {
                                        i.name ? e.Az = i.name : e.Az = i.color
                                    },
                                    lineStyleChanged: function(t, i) {
                                        e.mw = i
                                    }
                                }),
                                this.xo.find(".border-picker").borderpicker("option", "colorOptions", {
                                    showNoFill: !1
                                }),
                                this.xo.find(".more-color-button").click(function() {
                                    void 0 === e.aA && (e.aA = new r.ColorDailog,
                                        e.aA._create()),
                                        e.aA.value = e.fA,
                                        "" === e.fA || void 0 === e.fA ? e.aA.gA(!0, "rgb(0,0,0)") : e.aA.gA(!0, e.fA),
                                        e.aA.open()
                                }),
                                $(this.aA).on("dialogClose", function(t, i) {
                                    i && (e.xo.find(".colorPicker").colorpicker("option", "selectedItem", this.value),
                                        e.xo.find(".show-color-span").css("background-color", this.value),
                                        e.xz.backColor(this.value))
                                }),
                                this.xo.find(".no-color-button").click(function() {
                                    e.xo.find(".colorPicker").colorpicker("option", "selectedItem", null),
                                        e.xo.find(".show-color-span").css("background-color", "transparent"),
                                        e.xz.backColor(null)
                                }),
                                this.xo.find(".no-border-button").click(function() {
                                    e.xo.find(".small-border-icon").prop("checked", !1).button("refresh"),
                                        e.hA(1, 1),
                                        e.hA(1, 2),
                                        e.hA(2, 1),
                                        e.hA(2, 2)
                                }),
                                this.xo.find(".outside-border-button").click(function() {
                                    e.xo.find(".top-line-input").prop("checked", !0).button("refresh"),
                                        e.xo.find(".top-line-input").trigger("change"),
                                        e.xo.find(".bottom-line-input").prop("checked", !0).button("refresh"),
                                        e.xo.find(".bottom-line-input").trigger("change"),
                                        e.xo.find(".left-line-input").prop("checked", !0).button("refresh"),
                                        e.xo.find(".left-line-input").trigger("change"),
                                        e.xo.find(".right-line-input").prop("checked", !0).button("refresh"),
                                        e.xo.find(".right-line-input").trigger("change")
                                }),
                                this.xo.find(".inside-border-button").click(function() {
                                    e.xo.find(".horizontal-inner-line-input").prop("checked", !0).button("refresh"),
                                        e.xo.find(".horizontal-inner-line-input").trigger("change"),
                                        e.xo.find(".vertical-inner-line-input").prop("checked", !0).button("refresh"),
                                        e.xo.find(".vertical-inner-line-input").trigger("change")
                                }),
                                this.xo.find(".top-line-input").change(function() {
                                    var t, i = e.xo.find(".top-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(1, 1);
                                    i ? (o.getCell(1, 1).borderTop(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(1, 2).borderTop(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.borderTop(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.borderTop.color || a.borderTop.style !== e.mw ? (o.getCell(1, 1).borderTop(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(1, 2).borderTop(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".top-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.borderTop(new n.LineBorder(e.Az,e.mw))) : (o.getCell(1, 1).borderTop(new n.LineBorder(e.Az,0)),
                                            o.getCell(1, 2).borderTop(new n.LineBorder(e.Az,0)),
                                            e.xz.borderTop(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".bottom-line-input").change(function() {
                                    var t, i = e.xo.find(".bottom-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(2, 1);
                                    i ? (o.getCell(2, 1).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 2).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.borderBottom(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.borderBottom.color || a.borderBottom.style !== e.mw ? (o.getCell(2, 1).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 2).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".bottom-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.borderBottom(new n.LineBorder(e.Az,e.mw))) : (o.getCell(2, 1).borderBottom(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 2).borderBottom(new n.LineBorder(e.Az,0)),
                                            e.xz.borderBottom(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".left-line-input").change(function() {
                                    var t, i = e.xo.find(".left-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(1, 1);
                                    i ? (o.getCell(1, 1).borderLeft(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 1).borderLeft(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.borderLeft(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.borderLeft.color || a.borderLeft.style !== e.mw ? (o.getCell(1, 1).borderLeft(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 1).borderLeft(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".left-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.borderLeft(new n.LineBorder(e.Az,e.mw))) : (o.getCell(1, 1).borderLeft(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 1).borderLeft(new n.LineBorder(e.Az,0)),
                                            e.xz.borderLeft(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".right-line-input").change(function() {
                                    var t, i = e.xo.find(".right-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(1, 2);
                                    i ? (o.getCell(1, 2).borderRight(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 2).borderRight(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.borderRight(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.borderRight.color || a.borderRight.style !== e.mw ? (o.getCell(1, 2).borderRight(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 2).borderRight(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".right-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.borderRight(new n.LineBorder(e.Az,e.mw))) : (o.getCell(1, 2).borderRight(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 2).borderRight(new n.LineBorder(e.Az,0)),
                                            e.xz.borderRight(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".horizontal-inner-line-input").change(function() {
                                    var t, i = e.xo.find(".horizontal-inner-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(1, 1);
                                    i ? (o.getCell(1, 1).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(1, 2).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.borderHorizontal(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.borderBottom.color || a.borderBottom.style !== e.mw ? (o.getCell(1, 1).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(1, 2).borderBottom(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".horizontal-inner-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.borderHorizontal(new n.LineBorder(e.Az,e.mw))) : (o.getCell(1, 1).borderBottom(new n.LineBorder(e.Az,0)),
                                            o.getCell(1, 2).borderBottom(new n.LineBorder(e.Az,0)),
                                            e.xz.borderHorizontal(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".vertical-inner-line-input").change(function() {
                                    var t, i = e.xo.find(".vertical-inner-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(1, 1);
                                    i ? (o.getCell(1, 1).borderRight(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 1).borderRight(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.borderVertical(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.borderRight.color || a.borderRight.style !== e.mw ? (o.getCell(1, 1).borderRight(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 1).borderRight(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".vertical-inner-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.borderVertical(new n.LineBorder(e.Az,e.mw))) : (o.getCell(1, 1).borderRight(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 1).borderRight(new n.LineBorder(e.Az,0)),
                                            e.xz.borderVertical(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".diagonal-up-line-input").change(function() {
                                    var t, i = e.xo.find(".diagonal-up-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(1, 1);
                                    i ? (o.getCell(1, 1).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 1).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(1, 2).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 2).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.diagonalUp(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.diagonalUp.color || a.diagonalUp.style !== e.mw ? (o.getCell(1, 1).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 1).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(1, 2).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 2).diagonalUp(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".diagonal-up-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.diagonalUp(new n.LineBorder(e.Az,e.mw))) : (o.getCell(1, 1).diagonalUp(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 1).diagonalUp(new n.LineBorder(e.Az,0)),
                                            o.getCell(1, 2).diagonalUp(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 2).diagonalUp(new n.LineBorder(e.Az,0)),
                                            e.xz.diagonalUp(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".diagonal-down-line-input").change(function() {
                                    var t, i = e.xo.find(".diagonal-down-line-input").prop("checked"), o = e.iA.getActiveSheet(), a = o.getActualStyle(1, 1);
                                    i ? (o.getCell(1, 1).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 1).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(1, 2).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                        o.getCell(2, 2).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                        e.xz.diagonalDown(new n.LineBorder(e.Az,e.mw))) : (t = r.ColorHelper.parse(e.Az, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        t.color !== a.diagonalDown.color || a.diagonalDown.style !== e.mw ? (o.getCell(1, 1).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 1).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(1, 2).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                            o.getCell(2, 2).diagonalDown(new n.LineBorder(e.Az,e.mw)),
                                            e.xo.find(".diagonal-down-line-input").prop("checked", !0).button("refresh"),
                                            e.xz.diagonalDown(new n.LineBorder(e.Az,e.mw))) : (o.getCell(1, 1).diagonalDown(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 1).diagonalDown(new n.LineBorder(e.Az,0)),
                                            o.getCell(1, 2).diagonalDown(new n.LineBorder(e.Az,0)),
                                            o.getCell(2, 2).diagonalDown(new n.LineBorder(e.Az,0)),
                                            e.xz.diagonalDown(new n.LineBorder(e.Az,0))))
                                }),
                                this.xo.find(".border-line-panel").click(function(t) {
                                    var i, o, n, r, a, s, l, c, d, p, u, h, f, g, m, b;
                                    t = t || window.event,
                                        i = t.target || t.srcElement,
                                        o = e.xo.find(".corner").width(),
                                        n = e.xo.find(".corner").height(),
                                        r = $(i).height(),
                                        a = $(i).width(),
                                        s = o,
                                        l = n,
                                        c = e.iA,
                                        d = c.getActiveSheet(),
                                        p = d.getSpans(),
                                        u = t.offsetX || t.clientX - $(i).offset().left,
                                        h = t.offsetY || t.clientY - $(i).offset().top,
                                        f = a,
                                        g = r,
                                        m = !1,
                                        0 === p.length ? (Math.abs(a / 2 - u) < s && h > s && r - h > l ? (e.jA(".vertical-inner-line-input"),
                                            m = !0) : Math.abs(r / 2 - h) < l && u > s && a - u > s && (e.jA(".horizontal-inner-line-input"),
                                            m = !0),
                                            f = a / 2,
                                            g = r / 2) : 2 === p.length && (p[0].rowCount > 1 ? (Math.abs(a / 2 - u) < s && (e.jA(".vertical-inner-line-input"),
                                            m = !0),
                                            f = a / 2) : (Math.abs(r / 2 - h) < l && (e.jA(".horizontal-inner-line-input"),
                                            m = !0),
                                            g = r / 2)),
                                    m || (b = e.kA(f, g, u, h),
                                        u >= 0 && u <= s && h >= n && h <= r - n ? e.jA(".left-line-input") : a - u >= 0 && a - u <= s && h >= n && h <= r - n ? e.jA(".right-line-input") : h >= 0 && h <= l && u >= o && u <= a - o ? e.jA(".top-line-input") : r - h >= 0 && r - h <= l && u >= o && u <= a - o ? e.jA(".bottom-line-input") : b ? e.jA(".diagonal-down-line-input") : e.jA(".diagonal-up-line-input"))
                                }),
                                this.xo.find(".colorPicker").colorpicker("option", "showThemeColorTitle", !1),
                                this.xo.find(".colorPicker").colorpicker("option", "showStandardColorTitle", !1),
                                this.xo.find(".colorPicker").colorpicker("option", "showOutline", !1),
                                this.xo.find(".colorPicker").colorpicker("option", "showNoFill", !1),
                                this.xo.find(".colorPicker").colorpicker("option", "showMoreColors", !1),
                                this.xo.find(".colorPicker").colorpicker("option", "themeColors", r.wrapper.getThemeColors()),
                                this.xo.find(".border-picker").borderpicker("option", "colorOptions", {
                                    themeColors: r.wrapper.getThemeColors()
                                }),
                                this.lA(),
                                this.xo.find(".tab-border-li").click(function() {
                                    setTimeout(function() {
                                        e.iA.refresh()
                                    }, 0)
                                }),
                                this.mA()
                        }
                        ,
                        t.prototype.kA = function(e, t, i, o) {
                            var n = e / 2
                                , r = t / 2;
                            return i > e && (i -= e),
                            o > t && (o -= t),
                            i < n && o < r || i > n && o > r
                        }
                        ,
                        t.prototype.zz = function() {
                            var e, t = r.wrapper.spread, i = t.getActiveSheet(), o = i.getActiveRowIndex(), n = i.getActiveColumnIndex(), a = i.tables.find(o, n);
                            a && (e = a.getSlicerData()) && e.refresh()
                        }
                        ,
                        t.prototype.bA = function() {
                            this.xo.find(".top-line-input").attr("id", "top-line-border-" + t.Rv),
                                this.xo.find(".top-line").attr("for", "top-line-border-" + t.Rv),
                                this.xo.find(".horizontal-inner-line-input").attr("id", "horizontal-inner-line-border-" + t.Rv),
                                this.xo.find(".horizontal-inner-line").attr("for", "horizontal-inner-line-border-" + t.Rv),
                                this.xo.find(".bottom-line-input").attr("id", "bottom-line-border-" + t.Rv),
                                this.xo.find(".bottom-line").attr("for", "bottom-line-border-" + t.Rv),
                                this.xo.find(".diagonal-up-line-input").attr("id", "diagonal-up-line-border-" + t.Rv),
                                this.xo.find(".diagonal-up-line").attr("for", "diagonal-up-line-border-" + t.Rv),
                                this.xo.find(".left-line-input").attr("id", "left-line-border-" + t.Rv),
                                this.xo.find(".left-line").attr("for", "left-line-border-" + t.Rv),
                                this.xo.find(".vertical-inner-line-input").attr("id", "vertical-inner-line-border-" + t.Rv),
                                this.xo.find(".vertical-inner-line").attr("for", "vertical-inner-line-border-" + t.Rv),
                                this.xo.find(".right-line-input").attr("id", "right-line-border-" + t.Rv),
                                this.xo.find(".right-line").attr("for", "right-line-border-" + t.Rv),
                                this.xo.find(".diagonal-down-line-input").attr("id", "diagonal-down-line-border-" + t.Rv),
                                this.xo.find(".diagonal-down-line").attr("for", "diagonal-down-line-border-" + t.Rv)
                        }
                        ,
                        t.getTabIndexById = function(e) {
                            switch (e) {
                                case "number":
                                    return 0;
                                case "alignment":
                                    return 1;
                                case "font":
                                    return 2;
                                case "border":
                                    return 3;
                                case "fill":
                                    return 4;
                                case "protected":
                                    return 5
                            }
                            return 0
                        }
                        ,
                        t.prototype.cancel = function() {}
                        ,
                        t.prototype.yz = function() {
                            var e = this.xz.result()
                                , t = this.Cz();
                            return {
                                formatter: e.formatter,
                                backColor: e.backColor,
                                foreColor: e.foreColor,
                                hAlign: e.hAlign,
                                vAlign: e.vAlign,
                                textIndent: e.textIndent,
                                wordWrap: e.wordWrap,
                                shrinkToFit: e.shrinkToFit,
                                isVerticalText: e.isVerticalText,
                                font: e.font,
                                locked: e.locked,
                                borderTop: t.topLineBorder,
                                borderBottom: t.bottomLineBorder,
                                borderLeft: t.leftLineBorder,
                                borderRight: t.rightLineBorder,
                                borderInnerVertical: t.innerVerticalLineBorder,
                                borderInnerHorizontal: t.innerHorizontalLineBorder,
                                textDecoration: e.textDecoration
                            }
                        }
                        ,
                        t.prototype.ww = function(e, t) {
                            var i = this.xo.find(e);
                            !0 === t ? (i.prop("indeterminate", !1),
                                i.prop("checked", !0)) : !1 === t ? (i.prop("indeterminate", !1),
                                i.prop("checked", !1)) : (i.prop("indeterminate", !0),
                                i.prop("checked", !1))
                        }
                        ,
                        t.prototype.Iw = function(e, t) {
                            var i = this.xo.find(e);
                            t !== r.BaseMetaObject.indeterminateValue ? i.val(t) : i.val(null)
                        }
                        ,
                        t.prototype.Jz = function(e, t, o) {
                            var n, a, s, l, c = this.xo.find(".font-picker");
                            e && e !== r.BaseMetaObject.indeterminateValue && e !== r.BaseMetaObject.undefinedValue ? (n = r.util.parseFont(e),
                                a = n.fontFamily.split(","),
                                a.length > 1 ? c.fontpicker("family", a[0]) : c.fontpicker("family", n.fontFamily),
                                c.fontpicker("style", n.fontStyle),
                                -1 !== n.fontSize.indexOf("pt") ? c.fontpicker("size", n.fontSize.substring(0, n.fontSize.length - 2)) : -1 !== n.fontSize.indexOf("px") ? (s = this.xo.find(".gcui-fontpicker-preview").get(0).style.fontSize,
                                    c.fontpicker("size", s.substring(0, s.length - 2))) : c.fontpicker("size", n.fontSize),
                                c.fontpicker("weight", n.fontWeight)) : (l = r.util.getFromCache("defaultFont", function() {
                                return r.util.parseFont(r.res.defaultFont)
                            }),
                                c.fontpicker("family", l.fontFamily),
                                c.fontpicker("style", l.fontStyle),
                                c.fontpicker("size", l.fontSize.replace(/(pt|px)$/, "")),
                                c.fontpicker("weight", l.fontWeight)),
                                this.Aq = i,
                                this.Bq = i,
                                this.Cq = i,
                                this.Dq = i,
                                t !== r.BaseMetaObject.indeterminateValue && t !== r.BaseMetaObject.undefinedValue ? c.fontpicker("color", r.ColorHelper.parse(t, r.wrapper.spread.getActiveSheet().currentTheme().colors())) : c.fontpicker("color", null),
                                c.fontpicker("colorOption", "themeColors", r.wrapper.getThemeColors()),
                                1 & o ? (c.fontpicker("underline", !0),
                                    this.cA = !0,
                                    c.fontpicker("doubleUnderline", !1),
                                    this.dA = !1) : 8 & o ? (c.fontpicker("underline", !1),
                                    this.cA = !1,
                                    c.fontpicker("doubleUnderline", !0),
                                    this.dA = !0) : (c.fontpicker("underline", !1),
                                    this.cA = !1,
                                    c.fontpicker("doubleUnderline", !1),
                                    this.dA = !1),
                                2 & o ? (c.fontpicker("strikethrough", !0),
                                    this.eA = !0) : (c.fontpicker("strikethrough", !1),
                                    this.eA = !1)
                        }
                        ,
                        t.prototype.Kz = function(e, t) {
                            var i, o = this.xo.find(e);
                            t === r.BaseMetaObject.indeterminateValue || t === r.BaseMetaObject.undefinedValue || void 0 === t || null === t ? (o.css("background-color", ""),
                                this.xo.find(".colorPicker").colorpicker("option", "selectedItem", null),
                                this.fA = "rgb(0,0,0)") : (i = r.ColorHelper.parse(t, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                this.xo.find(".colorPicker").colorpicker("option", "selectedItem", i),
                                o.css("background-color", i.color),
                                this.fA = i.color)
                        }
                        ,
                        t.prototype.Tz = function(e, t) {
                            var i = this.xo.find(e);
                            i.val(t || "")
                        }
                        ,
                        t.prototype.nA = function(e, t) {
                            var i, o, n, a, s, l = this, c = !1, d = !1;
                            for (this.iA = new GC.Spread.Sheets.Workbook(this.xo.find(".border-sheet")[0]),
                                     this.iA.options.showHorizontalScrollbar = !1,
                                     this.iA.options.showVerticalScrollbar = !1,
                                     this.iA.options.tabStripVisible = !1,
                                     this.iA.options.allowUserResize = !1,
                                     i = this.iA.getActiveSheet(),
                                     $(r.util.getCanvas(this.iA)).unbind("gcmousewheel.gcSheet"),
                                     i.currentTheme(r.wrapper.spread.getActiveSheet().currentTheme()),
                                     i.options.gridline = {
                                         showVerticalGridline: !1,
                                         showHorizontalGridline: !1
                                     },
                                     i.options.colHeaderVisible = !1,
                                     i.options.rowHeaderVisible = !1,
                                     i.options.allowUserDragDrop = !1,
                                     i.options.allowUserDragFill = !1,
                                     i.options.selectionBackColor = "transparent",
                                     i.options.selectionBorderColor = "transparent",
                                     i.options.isProtected = !0,
                                     i.setColumnCount(4),
                                     i.setRowCount(4),
                                     i.setValue(1, 1, r.res.formatDialog.sampleText),
                                     i.setValue(1, 2, r.res.formatDialog.sampleText),
                                     i.setValue(2, 1, r.res.formatDialog.sampleText),
                                     i.setValue(2, 2, r.res.formatDialog.sampleText),
                                     o = 1; o < 3; o++)
                                for (n = 1; n < 3; n++)
                                    i.getCell(o, n).vAlign(1),
                                        i.getCell(o, n).hAlign(1);
                            if (i.setRowHeight(0, 2),
                                    i.setRowHeight(1, 33),
                                    i.setRowHeight(2, 34),
                                    i.setRowHeight(3, 1),
                                    i.setColumnWidth(0, 2),
                                    i.setColumnWidth(1, 77),
                                    i.setColumnWidth(2, 78),
                                    i.setColumnWidth(3, 1),
                                    this.xo.find(".diagonal-up-line-input").button("enable"),
                                    this.xo.find(".diagonal-down-line-input").button("enable"),
                                    e)
                                t ? (this.xo.find(".horizontal-middle").show(),
                                    this.xo.find(".vertical-middle").show(),
                                    this.xo.find(".vertical-inner-line-input").button("enable"),
                                    this.xo.find(".horizontal-inner-line-input").button("enable"),
                                    this.xo.find(".inside-border-button").button("enable")) : (i.addSpan(1, 1, 2, 2),
                                    this.xo.find(".horizontal-middle").hide(),
                                    this.xo.find(".vertical-middle").hide(),
                                    this.xo.find(".vertical-inner-line-input").button("disable"),
                                    this.xo.find(".horizontal-inner-line-input").button("disable"),
                                    this.xo.find(".inside-border-button").button("disable"));
                            else {
                                for (a = r.wrapper.spread.getActiveSheet().getSelections(),
                                         s = this.Iz(),
                                         o = 0; o < a.length; o++)
                                    a[o].rowCount > 1 && (d = !0),
                                    a[o].colCount > 1 && (c = !0);
                                !0 === s && (d = !1,
                                    c = !1),
                                    !c && d ? (i.addSpan(1, 1, 1, 2),
                                        i.addSpan(2, 1, 1, 2),
                                        this.xo.find(".vertical-middle").hide(),
                                        this.xo.find(".horizontal-middle").show(),
                                        this.xo.find(".vertical-inner-line-input").button("disable"),
                                        this.xo.find(".horizontal-inner-line-input").button("enable"),
                                        this.xo.find(".inside-border-button").button("enable")) : c && !d ? (i.addSpan(1, 1, 2, 1),
                                        i.addSpan(1, 2, 2, 1),
                                        this.xo.find(".vertical-middle").show(),
                                        this.xo.find(".horizontal-middle").hide(),
                                        this.xo.find(".horizontal-inner-line-input").button("disable"),
                                        this.xo.find(".vertical-inner-line-input").button("enable"),
                                        this.xo.find(".inside-border-button").button("enable")) : c || d ? (this.xo.find(".horizontal-middle").show(),
                                        this.xo.find(".vertical-middle").show(),
                                        this.xo.find(".vertical-inner-line-input").button("enable"),
                                        this.xo.find(".horizontal-inner-line-input").button("enable"),
                                        this.xo.find(".inside-border-button").button("enable")) : (i.addSpan(1, 1, 2, 2),
                                        this.xo.find(".horizontal-middle").hide(),
                                        this.xo.find(".vertical-middle").hide(),
                                        this.xo.find(".vertical-inner-line-input").button("disable"),
                                        this.xo.find(".horizontal-inner-line-input").button("disable"),
                                        this.xo.find(".inside-border-button").button("disable"))
                            }
                            setTimeout(function() {
                                l.iA.refresh()
                            }, 0)
                        }
                        ,
                        t.prototype.oA = function() {
                            var e = this.xo.find(".border-sheet");
                            "gcSpread" === e.attr("gcuielement") && (this.iA.destroy(),
                                this.xo.find(".border-sheet").html(""))
                        }
                        ,
                        t.prototype.Fz = function(e, t) {
                            void 0 !== this.iA && this.oA(),
                                this.nA(e, t)
                        }
                        ,
                        t.prototype.Cz = function() {
                            var e, t, i, o, r, a, s, l, c = this.xo.find(".top-line-input").prop("checked"), d = this.xo.find(".right-line-input").prop("checked"), p = this.xo.find(".bottom-line-input").prop("checked"), u = this.xo.find(".left-line-input").prop("checked"), h = this.xo.find(".horizontal-inner-line-input").prop("checked"), f = this.xo.find(".vertical-inner-line-input").prop("checked"), g = this.xo.find(".diagonal-up-line-input").prop("checked"), m = this.xo.find(".diagonal-down-line-input").prop("checked"), b = this.iA.getActiveSheet().getStyle(1, 1), v = this.iA.getActiveSheet().getStyle(2, 2);
                            return c && (e = new n.LineBorder(b.borderTop.color,b.borderTop.style)),
                            p && (t = new n.LineBorder(v.borderBottom.color,v.borderBottom.style)),
                            d && (i = new n.LineBorder(v.borderRight.color,v.borderRight.style)),
                            u && (o = new n.LineBorder(b.borderLeft.color,b.borderLeft.style)),
                            h && (r = new n.LineBorder(b.borderBottom.color,b.borderBottom.style)),
                            f && (a = new n.LineBorder(b.borderRight.color,b.borderRight.style)),
                            g && (s = new n.LineBorder(b.diagonalUp.color,b.diagonalUp.style)),
                            m && (l = new n.LineBorder(b.diagonalDown.color,b.diagonalDown.style)),
                                {
                                    topLineBorder: e,
                                    bottomLineBorder: t,
                                    rightLineBorder: i,
                                    leftLineBorder: o,
                                    innerHorizontalLineBorder: r,
                                    innerVerticalLineBorder: a,
                                    diagonalUpBorder: s,
                                    diagonalDownBorder: l
                                }
                        }
                        ,
                        t.prototype.jA = function(e) {
                            var t = this.xo.find(e)
                                , i = t.prop("checked");
                            i = !i,
                                t.prop("checked", i).button("refresh"),
                                t.trigger("change")
                        }
                        ,
                        t.prototype.hA = function(e, t) {
                            var i = this.iA.getActiveSheet();
                            i.getCell(e, t).borderTop(new n.LineBorder(this.Az,0)),
                                i.getCell(e, t).borderBottom(new n.LineBorder(this.Az,0)),
                                i.getCell(e, t).borderLeft(new n.LineBorder(this.Az,0)),
                                i.getCell(e, t).borderRight(new n.LineBorder(this.Az,0)),
                                i.getCell(e, t).diagonalUp(new n.LineBorder(this.Az,0)),
                                i.getCell(e, t).diagonalDown(new n.LineBorder(this.Az,0)),
                                this.xz.borderTop(void 0),
                                this.xz.borderLeft(void 0),
                                this.xz.borderRight(void 0),
                                this.xz.borderBottom(void 0),
                                this.xz.diagonalUp(void 0),
                                this.xz.diagonalDown(void 0)
                        }
                        ,
                        t.prototype.Hz = function() {
                            var e, t, n, a, s, l, c, d, p, u, h, f, g, m, b, v, y, x, w, C, S = r.wrapper.spread, k = S.getActiveSheet(), T = k.getSelections(), A = T.length;
                            if (0 === A)
                                return null;
                            for (e = -1 === T[0].row ? 0 : T[0].row,
                                     t = -1 === T[0].col ? 0 : T[0].col,
                                     n = k.getStyle(e, t),
                                     a = e + T[0].rowCount - 1,
                                     s = t + T[0].colCount - 1,
                                     l = k.getStyle(a, s),
                                     b = !1,
                                     v = !1,
                                 n && (c = n.borderTop,
                                     p = n.borderLeft,
                                     g = n.diagonalUp,
                                     m = n.diagonalDown),
                                 l && (d = l.borderBottom,
                                     u = l.borderRight),
                                     C = 0; C < A; C++) {
                                for (e = -1 === T[C].row ? 0 : T[C].row,
                                         t = -1 === T[C].col ? 0 : T[C].col,
                                     T[C].rowCount > 1 && !b && (y = k.getStyle(e, t),
                                     y && (h = y.borderBottom),
                                         b = !0),
                                     T[C].colCount > 1 && !v && (y = k.getStyle(e, t),
                                     y && (f = y.borderRight),
                                         v = !0),
                                         w = 0; w < T[C].colCount; w++) {
                                    if (!(y = k.getStyle(e, t + w)) || !c) {
                                        c = i;
                                        break
                                    }
                                    if (void 0 === y.borderTop || y.borderTop === o || y.borderTop.color !== c.color || y.borderTop.style !== c.style) {
                                        c = i;
                                        break
                                    }
                                }
                                for (x = 0; x < T[C].rowCount; x++) {
                                    if (!(y = k.getStyle(e + x, t)) || !p) {
                                        p = i;
                                        break
                                    }
                                    if (void 0 === y.borderLeft || y.borderLeft === o || y.borderLeft.color !== p.color || y.borderLeft.style !== p.style) {
                                        p = i;
                                        break
                                    }
                                }
                                for (w = 0; w < T[C].colCount; w++) {
                                    if (!(y = k.getStyle(e + T[C].rowCount - 1, t + w)) || !d) {
                                        d = i;
                                        break
                                    }
                                    if (void 0 === y.borderBottom || y.borderBottom === o || y.borderBottom.color !== d.color || y.borderBottom.style !== d.style) {
                                        d = i;
                                        break
                                    }
                                }
                                for (x = 0; x < T[C].rowCount; x++) {
                                    if (!(y = k.getStyle(e + x, t + T[C].colCount - 1)) || !u) {
                                        u = i;
                                        break
                                    }
                                    if (void 0 === y.borderRight || y.borderRight === o || y.borderRight.color !== u.color || y.borderRight.style !== u.style) {
                                        u = i;
                                        break
                                    }
                                }
                                for (x = 0; x < T[C].rowCount; x++)
                                    for (w = 0; w < T[C].colCount; w++) {
                                        if (!(y = k.getStyle(e + x, t + w)) || !g) {
                                            g = i;
                                            break
                                        }
                                        if (void 0 === y.diagonalUp || y.diagonalUp === o || y.diagonalUp.color !== g.color || y.diagonalUp.style !== g.style) {
                                            g = i;
                                            break
                                        }
                                    }
                                for (x = 0; x < T[C].rowCount; x++)
                                    for (w = 0; w < T[C].colCount; w++) {
                                        if (!(y = k.getStyle(e + x, t + w)) || !m) {
                                            m = i;
                                            break
                                        }
                                        if (void 0 === y.diagonalDown || y.diagonalDown === o || y.diagonalDown.color !== m.color || y.diagonalDown.style !== m.style) {
                                            m = i;
                                            break
                                        }
                                    }
                                if (b)
                                    for (x = 0; x < T[C].rowCount - 1; x++)
                                        for (w = 0; w < T[C].colCount; w++) {
                                            if (!(y = k.getStyle(e + x, t + w)) || !h) {
                                                h = i;
                                                break
                                            }
                                            if (void 0 === y.borderBottom || y.borderBottom === o || y.borderBottom.color !== h.color || y.borderBottom.style !== h.style) {
                                                h = i;
                                                break
                                            }
                                        }
                                if (v)
                                    for (x = 0; x < T[C].rowCount; x++)
                                        for (w = 0; w < T[C].colCount - 1; w++) {
                                            if (!(y = k.getStyle(e + x, t + w)) || !f) {
                                                f = i;
                                                break
                                            }
                                            if (void 0 === y.borderRight || y.borderRight === o || y.borderRight.color !== f.color || y.borderRight.style !== f.style) {
                                                f = i;
                                                break
                                            }
                                        }
                            }
                            return {
                                borderTop: c,
                                borderBottom: d,
                                borderLeft: p,
                                borderRight: u,
                                borderVertical: f,
                                borderHorizontal: h,
                                diagonalUpBorder: g,
                                diagonalDownBorder: m
                            }
                        }
                        ,
                        t.prototype.Gz = function(e) {
                            var t, i, o, n, a, s = this;
                            s.Bz = e,
                                t = !1,
                                i = !1,
                                e.borderTop ? (this.Az = e.borderTop.color,
                                    this.mw = e.borderTop.style,
                                    this.xo.find(".top-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".top-line-input").trigger("change")) : this.xo.find(".top-line-input").prop("checked", !1).button("refresh"),
                                e.borderBottom ? (this.Az = e.borderBottom.color,
                                    this.mw = e.borderBottom.style,
                                    this.xo.find(".bottom-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".bottom-line-input").trigger("change")) : this.xo.find(".bottom-line-input").prop("checked", !1).button("refresh"),
                                e.borderLeft ? (this.Az = e.borderLeft.color,
                                    this.mw = e.borderLeft.style,
                                    this.xo.find(".left-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".left-line-input").trigger("change")) : this.xo.find(".left-line-input").prop("checked", !1).button("refresh"),
                                e.borderRight ? (this.Az = e.borderRight.color,
                                    this.mw = e.borderRight.style,
                                    this.xo.find(".right-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".right-line-input").trigger("change")) : this.xo.find(".right-line-input").prop("checked", !1).button("refresh"),
                                e.borderHorizontal ? (t = !0,
                                    this.Az = e.borderHorizontal.color,
                                    this.mw = e.borderHorizontal.style,
                                    this.xo.find(".horizontal-inner-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".horizontal-inner-line-input").trigger("change")) : this.xo.find(".horizontal-inner-line-input").prop("checked", !1).button("refresh"),
                                e.borderVertical ? (i = !0,
                                    this.Az = e.borderVertical.color,
                                    this.mw = e.borderVertical.style,
                                    this.xo.find(".vertical-inner-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".vertical-inner-line-input").trigger("change")) : this.xo.find(".vertical-inner-line-input").prop("checked", !1).button("refresh"),
                                e.diagonalUpBorder ? (this.Az = e.diagonalUpBorder.color,
                                    this.mw = e.diagonalUpBorder.style,
                                    this.xo.find(".diagonal-up-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".diagonal-up-line-input").trigger("change")) : this.xo.find(".diagonal-up-line-input").prop("checked", !1).button("refresh"),
                                e.diagonalDownBorder ? (this.Az = e.diagonalDownBorder.color,
                                    this.mw = e.diagonalDownBorder.style,
                                    this.xo.find(".diagonal-down-line-input").prop("checked", !0).button("refresh"),
                                    this.xo.find(".diagonal-down-line-input").trigger("change")) : this.xo.find(".diagonal-down-line-input").prop("checked", !1).button("refresh"),
                                !e.borderTop || !e.borderBottom || !e.borderLeft || !e.borderRight || t && !e.borderHorizontal || i && !e.borderVertical ? (this.mw = 1,
                                    this.Az = "Text 1",
                                    o = r.ColorHelper.parse("Text 1", r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                    this.xo.find(".border-picker").borderpicker("option", "borderColor", o),
                                    this.xo.find(".border-picker").borderpicker("option", "lineStyle", 1)) : (n = e.borderTop.color,
                                    a = e.borderTop.style,
                                    n !== e.borderBottom.color || i && n !== e.borderVertical.color || t && n !== e.borderHorizontal.color || n !== e.borderLeft.color || n !== e.borderRight.color ? (this.Az = "Text 1",
                                        o = r.ColorHelper.parse("Text 1", r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        this.xo.find(".border-picker").borderpicker("option", "borderColor", o)) : (o = r.ColorHelper.parse(n, r.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                        this.xo.find(".border-picker").borderpicker("option", "borderColor", o),
                                        this.Az = n),
                                    a !== e.borderBottom.style || i && a !== e.borderVertical.style || t && a !== e.borderHorizontal.style || a !== e.borderLeft.style || a !== e.borderRight.style ? (this.mw = 1,
                                        this.xo.find(".border-picker").borderpicker("option", "lineStyle", 1)) : (this.xo.find(".border-picker").borderpicker("option", "lineStyle", a),
                                        this.mw = a)),
                                setTimeout(function() {
                                    s.iA.refresh()
                                }, 0)
                        }
                        ,
                        t.prototype.Iz = function() {
                            var e, t, i = r.wrapper.spread.getActiveSheet(), o = i.getSelections();
                            if (1 === o.length)
                                return e = i.getSpans(o[0]),
                                1 === e.length && e[0].row === o[0].row && e[0].rowCount === o[0].rowCount && e[0].col === o[0].col && e[0].colCount === o[0].colCount || e.length > 0 && r.BaseMetaObject.indeterminateValue;
                            for (t = 0; t < o.length; t++)
                                if (e = i.getSpans(o[t]),
                                    e.length > 0)
                                    return r.BaseMetaObject.indeterminateValue;
                            return !1
                        }
                        ,
                        t.prototype.setFormatDirectly = function(e) {
                            this.uz = e
                        }
                        ,
                        t.prototype.pA = function(e, t, i) {
                            var o = $("<div></div>").addClass("gcui-numberpicker hidden " + i);
                            return $("<label></label>").attr("for", t).css({
                                "vertical-align": "middle",
                                "margin-right": "5px"
                            }).text(r.res.formatNumberPickerSetting.decimalPlaces).appendTo(o),
                                $("<input>").attr({
                                    id: t,
                                    value: "2"
                                }).addClass(e + " format-decimal-input").appendTo(o),
                                o
                        }
                        ,
                        t.prototype.qA = function(e, t, i) {
                            var o = $("<div></div>").addClass("gcui-numberpicker hidden " + i);
                            return $("<input>").attr({
                                id: t,
                                type: "checkbox"
                            }).addClass(e).appendTo(o),
                                $("<label></label>").attr("for", t).text(r.res.formatNumberPickerSetting.separator).appendTo(o),
                                o
                        }
                        ,
                        t.prototype.rA = function(e, t, i) {
                            var o, n, a = $("<div></div>").addClass("gcui-numberpicker hidden " + i);
                            for ($("<label><label>").css({
                                "margin-right": "5px"
                            }).text(r.res.formatNumberPickerSetting.symbol).appendTo(a),
                                     o = $("<select></select>").attr("size", 1).addClass(t),
                                     n = 0; n < e.length; n++)
                                o.append($("<option></option>").text(e[n][0]));
                            return a.append(o),
                                a
                        }
                        ,
                        t.prototype.sA = function(e, t, i, o) {
                            var n, r, a, s, l = i + "-container", c = $("<div></div>").addClass("gcui-numberpicker hidden " + o + " " + l), d = "format-number-label", p = $("<div></div>").addClass(d);
                            if ($("<label></label>").text(t).appendTo(p),
                                    n = $("<select></select>").attr({
                                        name: i + "-list",
                                        size: 6
                                    }).addClass(i + "-select"),
                                    Array.isArray(e))
                                for (r = 0; r < e.length; r++)
                                    n.append($("<option></option>").val(e[r]).text(e[r]));
                            else
                                for (a in e)
                                    -1 !== a.indexOf("red") ? n.append($("<option></option>").css("color", "red").val(a).text(e[a])) : n.append($("<option></option>").val(a).text(e[a]));
                            return n.get(0).selectedIndex = 0,
                                "custom-type" === i ? (s = $("<input></input>").addClass("custom-type-input"),
                                    c.append(p).append(s).append(n)) : c.append(p).append(n),
                                c
                        }
                        ,
                        t.prototype.tA = function(e, t) {
                            var i = "spread-format-" + t;
                            return $("<p></p>").text(e).addClass("gcui-numberpicker hidden " + i)
                        }
                        ,
                        t.prototype.uA = function(e, t, i, o, n) {
                            var r, a, s = i + "-container", l = $("<div></div>").addClass("gcui-numberpicker hidden " + o + " " + s), c = "format-number-label", d = $("<div></div>").addClass(c);
                            $("<label></label>").text(t).appendTo(d),
                                r = $("<select></select>").addClass(i + "-select " + n);
                            for (a in e)
                                r.append($("<option></option>").val(a).text(e[a]));
                            return r.get(0).selectedIndex = 0,
                                l.append(d).append(r),
                                l
                        }
                        ,
                        t.prototype.lA = function() {
                            var e, t;
                            this.vA(),
                                this.wA(),
                                this.xA(),
                                this.yA(),
                                this.zA(),
                                this.AA(),
                                this.BA(),
                                this.CA(),
                                this.DA(),
                                this.EA(),
                                this.FA(),
                                this.GA(),
                                e = this;
                            function i(t) {
                                var i, o;
                                e.xo.find(".gcui-numberpicker").addClass("hidden"),
                                    i = e.xo.find(".category-select option:selected").val(),
                                    o = "spread-format-" + i,
                                    e.xo.find(".gcui-numberpicker").each(function(e, t) {
                                        $(t).hasClass(o) && $(t).removeClass("hidden")
                                    }),
                                    e.HA(t, i)
                            }
                            t = this.xo.find(".category-select"),
                                t.bind("click", i),
                                t.bind("mousemove", function(e) {
                                    return !1
                                }),
                                t.bind("change", i)
                        }
                        ,
                        t.prototype.HA = function(e, t) {
                            if ("general" === t)
                                this.IA();
                            else if ("numbers" === t) {
                                var i = this.xo.find(".negative-number-select").get(0).selectedIndex;
                                this.JA(i),
                                    this.KA()
                            } else
                                "accounting" === t ? this.LA() : "currency" === t ? (this.MA(),
                                    this.NA()) : "date" === t ? this.OA() : "time" === t ? this.PA() : "percentage" === t ? this.QA() : "fraction" === t ? this.RA() : "scientific" === t ? this.SA() : "text" === t ? this.TA() : "special" === t ? this.UA() : "custom" === t && (this.VA(),
                                    this.WA());
                            this.Ez(),
                                this.XA()
                        }
                        ,
                        t.prototype.yA = function() {
                            var e = this
                                , t = this.pA("currency-decimal-places-input", "currency-decimal-places", "spread-format-currency")
                                , i = this.rA(r.res.accountingSymbol, "currency-symbol-dropdown", "spread-format-currency")
                                , o = this.tA(r.res.formatNumberComments.currencyComments, "currency")
                                , n = this.sA(r.res.currencyNegativeNumbers, r.res.formatNumberPickerSetting.negativeNumber, "currency-type", "spread-format-currency");
                            this.xo.find(".tab-number-setting").append(t).append(i),
                                this.xo.find(".tab-number-comments").append(o),
                                this.xo.find(".tab-number-setting").append(n),
                                this.xo.find(".currency-symbol-dropdown").get(0).selectedIndex = 1,
                                this.xo.find(".currency-type-select").change(function() {
                                    e.MA()
                                }),
                                this.xo.find(".currency-symbol-dropdown").change(function() {
                                    e.MA(),
                                        e.NA()
                                }),
                                this.xo.find(".currency-decimal-places-input").spinner({
                                    min: 0,
                                    max: 16,
                                    change: function() {
                                        var t = e.xo.find(".currency-decimal-places-input").val();
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.MA(),
                                            e.NA()
                                    },
                                    spin: function() {
                                        var t = arguments[1].value;
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.MA(),
                                            e.NA()
                                    }
                                })
                        }
                        ,
                        t.prototype.zA = function() {
                            var e, t, i, o, n, a = this, s = [], l = r.res.dateFormats;
                            for (e = 0; e < l.length; e++)
                                s.push(this.YA(this._z, l[e]));
                            t = this.sA(s, r.res.formatNumberPickerSetting.type, "date-type", "spread-format-date"),
                                i = this.tA(r.res.formatNumberComments.dateComments, "date"),
                                o = this.uA(r.res.localeType, r.res.formatNumberPickerSetting.locale, "date-type-locale", "spread-format-date", "type-locale-select"),
                                n = this.uA(r.res.calendarType, r.res.formatNumberPickerSetting.calendar, "date-type-calendar", "spread-format-date-calendar"),
                                this.xo.find(".tab-number-setting").append(t).append(o).append(n),
                                this.xo.find(".tab-number-comments").append(i),
                                this.xo.find(".date-type-select").change(function() {
                                    a.OA()
                                }),
                                this.xo.find(".date-type-locale-select").change(function() {
                                    var e = a.xo.find(".date-type-locale-select").find("option:selected").val();
                                    a.xo.find(".type-locale-select").val(e),
                                        a.ZA(),
                                        a.OA(),
                                        a.xo.find(".date-type-select").change(function() {
                                            a.OA()
                                        })
                                }),
                                this.xo.find(".date-type-calendar-select").change(function() {
                                    a.ZA(),
                                        a.OA(),
                                        a.xo.find(".date-type-select").change(function() {
                                            a.OA()
                                        })
                                })
                        }
                        ,
                        t.prototype.ZA = function() {
                            var e, t, i, o, n, a, s = [], l = this.xo.find(".date-type-locale-select").find("option:selected").val();
                            switch (l) {
                                case "ja_jp":
                                    if (this.xo.find(".spread-format-date-calendar").removeClass("hidden"),
                                        "western" === (t = this.xo.find(".date-type-calendar-select").find("option:selected").val()))
                                        for (i = r.res.japanWesternDateFormat,
                                                 e = 0; e < i.length; e++)
                                            s.push(this.YA(this._z, i[e]));
                                    else if ("JER" === t)
                                        for (o = r.res.japanEmperorReignDateFormat,
                                                 e = 0; e < o.length; e++)
                                            s.push(this.YA(this._z, o[e]));
                                    break;
                                case "en_us":
                                    for (this.xo.find(".spread-format-date-calendar").addClass("hidden"),
                                             n = r.res.dateFormats,
                                             e = 0; e < n.length; e++)
                                        s.push(this.YA(this._z, n[e]))
                            }
                            0 !== s.length && (this.xo.find(".date-type-container").remove(),
                                a = this.sA(s, r.res.formatNumberPickerSetting.type, "date-type", "spread-format-date"),
                                a.insertBefore(this.xo.find(".date-type-locale-container")),
                                a.removeClass("hidden"))
                        }
                        ,
                        t.prototype.GA = function() {
                            var e = this
                                , t = this.sA(r.res.customFormats, r.res.formatNumberPickerSetting.type, "custom-type", "spread-format-custom")
                                , o = this.tA(r.res.formatNumberComments.customComments, "custom")
                                , n = $("<div></div>").addClass("custom-type-div custom-class gcui-numberpicker hidden spread-format-custom")
                                , a = $("<button></button>").addClass("custom-type-button custom-class");
                            $("<span></span>").text(r.res.formatNumberPickerSetting.deleted).appendTo(a),
                                n.append(a),
                                this.xo.find(".tab-number-setting").append(t).append(n),
                                this.xo.find(".tab-number-comments").append(o),
                                this.xo.find(".custom-type-select").change(function() {
                                    var t = e.xo.find(".custom-type-select").find("option:selected").text();
                                    e.xo.find(".custom-type-input").val(t),
                                        e.WA(),
                                        e.XA()
                                }),
                                this.xo.find(".custom-type-input").bind("input propertychange", function() {
                                    e.WA(),
                                        e.XA()
                                }),
                                this.xo.find(".custom-type-button").click(function() {
                                    e.Ez(!1),
                                        e.$A = i,
                                        e.xo.find(".custom-type-input").val(""),
                                        e.xo.find(".sample-display").text(e.YA(e._A, ""))
                                })
                        }
                        ,
                        t.prototype.XA = function() {
                            var e = r.res.customFormats
                                , t = this.xo.find(".custom-type-input").val();
                            if ($.inArray(t, this.$z) >= 0 || $.inArray(t, e) < 0)
                                return void this.xo.find(".custom-type-button").attr("disabled", !1);
                            this.xo.find(".custom-type-button").attr("disabled", !0)
                        }
                        ,
                        t.prototype.Ez = function(e) {
                            var t, i, o, n, a, s = this.xo.find(".custom-type-input").val();
                            if (void 0 === e && (e = !0),
                                    s) {
                                if (t = r.res.customFormats,
                                        e) {
                                    if ($.inArray(s, t) >= 0)
                                        return;
                                    $.inArray(s, this.$z) < 0 && (this.$z.push(s),
                                        $.merge(r.res.customFormats, [s]))
                                } else {
                                    if ($.inArray(s, t) < 0)
                                        return;
                                    i = $.inArray(s, t),
                                        o = $.inArray(s, this.$z),
                                    i >= 0 && o >= 0 && (this.$z.splice(o, 1),
                                        t.splice(i, 1))
                                }
                                for (n = this.xo.find(".custom-type-select"),
                                         n.empty(),
                                         a = 0; a < t.length; a++)
                                    n.append($("<option></option>").val(t[a]).text(t[a]))
                            }
                        }
                        ,
                        t.prototype.AA = function() {
                            var e, t, i, o, n = this, a = [], s = r.res.timeFormats;
                            for (e = 0; e < s.length; e++)
                                a.push(this.YA(this._z, s[e]));
                            t = this.sA(a, r.res.formatNumberPickerSetting.type, "time-type", "spread-format-time"),
                                i = this.tA(r.res.formatNumberComments.timeComments, "time"),
                                o = this.uA(r.res.localeType, r.res.formatNumberPickerSetting.locale, "time-type-locale", "spread-format-time", "type-locale-select"),
                                this.xo.find(".tab-number-setting").append(t).append(o),
                                this.xo.find(".tab-number-comments").append(i),
                                this.xo.find(".time-type-select").change(function() {
                                    n.PA()
                                }),
                                this.xo.find(".time-type-locale-select").change(function() {
                                    var e = n.xo.find(".time-type-locale-select").find("option:selected").val();
                                    n.xo.find(".type-locale-select").val(e),
                                        n.aB(),
                                        n.PA(),
                                        n.xo.find(".time-type-select").change(function() {
                                            n.PA()
                                        })
                                })
                        }
                        ,
                        t.prototype.aB = function() {
                            var e, t, i, o, n = [], a = this.xo.find(".time-type-locale-select").find("option:selected").val();
                            switch (a) {
                                case "ja_jp":
                                    for (t = r.res.japanTimeFormats,
                                             e = 0; e < t.length; e++)
                                        n.push(this.YA(this._z, t[e]));
                                    break;
                                case "en_us":
                                    for (i = r.res.timeFormats,
                                             e = 0; e < i.length; e++)
                                        n.push(this.YA(this._z, i[e]))
                            }
                            0 !== n.length && (this.xo.find(".time-type-container").remove(),
                                o = this.sA(n, r.res.formatNumberPickerSetting.type, "time-type", "spread-format-time"),
                                o.insertBefore(this.xo.find(".time-type-locale-container")),
                                o.removeClass("hidden"))
                        }
                        ,
                        t.prototype.BA = function() {
                            var e = this
                                , t = this.pA("percentage-decimal-places-input", "percentage-decimal-places", "spread-format-percentage")
                                , i = this.tA(r.res.formatNumberComments.percentageComments, "percentage");
                            this.xo.find(".tab-number-comments").append(i),
                                this.xo.find(".tab-number-setting").append(t),
                                this.xo.find(".percentage-decimal-places-input").spinner({
                                    min: 0,
                                    max: 16,
                                    change: function() {
                                        var t = e.xo.find(".percentage-decimal-places-input").val();
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.QA()
                                    },
                                    spin: function() {
                                        var t = arguments[1].value;
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.QA()
                                    }
                                })
                        }
                        ,
                        t.prototype.DA = function() {
                            var e = this
                                , t = this.pA("scientific-decimal-places-input", "scientific-decimal-places", "spread-format-scientific");
                            this.xo.find(".tab-number-setting").append(t),
                                this.xo.find(".scientific-decimal-places-input").spinner({
                                    min: 0,
                                    max: 16,
                                    change: function() {
                                        var t = e.xo.find(".scientific-decimal-places-input").val();
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.SA()
                                    },
                                    spin: function() {
                                        var t = arguments[1].value;
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.SA()
                                    }
                                })
                        }
                        ,
                        t.prototype.CA = function() {
                            var e = this
                                , t = this.sA(r.res.fractionType, r.res.formatNumberPickerSetting.type, "fraction-type", "spread-format-fraction");
                            this.xo.find(".tab-number-setting").append(t),
                                this.xo.find(".fraction-type-select").change(function() {
                                    e.RA()
                                })
                        }
                        ,
                        t.prototype.FA = function() {
                            var e = this
                                , t = this.sA(r.res.specialType, r.res.formatNumberPickerSetting.type, "special-type", "spread-format-special")
                                , i = this.tA(r.res.formatNumberComments.specialComments, "special")
                                , o = this.uA(r.res.localeType, r.res.formatNumberPickerSetting.locale, "special-type-locale", "spread-format-special", "special-locale-select");
                            this.xo.find(".tab-number-setting").append(t).append(o),
                                this.xo.find(".tab-number-comments").append(i),
                                this.xo.find(".special-type-select").change(function() {
                                    e.UA()
                                }),
                                this.xo.find(".special-type-locale-select").change(function() {
                                    var t = e.xo.find(".special-type-locale-select").find("option:selected").val();
                                    e.xo.find(".type-locale-select").val(t),
                                        e.bB(),
                                        e.UA(),
                                        e.xo.find(".special-type-select").change(function() {
                                            e.UA()
                                        })
                                })
                        }
                        ,
                        t.prototype.bB = function() {
                            var e, t = r.res.specialType, i = this.xo.find(".special-type-locale-select").find("option:selected").val();
                            switch (i) {
                                case "ja_jp":
                                    t = r.res.specialJapanType;
                                    break;
                                case "en_us":
                                    t = r.res.specialType
                            }
                            0 !== t.length && (this.xo.find(".special-type-container").remove(),
                                e = this.sA(t, r.res.formatNumberPickerSetting.type, "special-type", "spread-format-special"),
                                e.insertBefore(this.xo.find(".special-type-locale-container")),
                                e.removeClass("hidden"))
                        }
                        ,
                        t.prototype.xA = function() {
                            var e = this
                                , t = this.pA("accounting-decimal-places-input", "accounting-decimal-places", "spread-format-accounting")
                                , i = this.rA(r.res.accountingSymbol, "accounting-symbol-dropdown", "spread-format-accounting")
                                , o = this.tA(r.res.formatNumberComments.accountingComments, "accounting");
                            this.xo.find(".tab-number-setting").append(t).append(i),
                                this.xo.find(".tab-number-comments").append(o),
                                this.xo.find(".accounting-symbol-dropdown").get(0).selectedIndex = 1,
                                this.xo.find(".accounting-symbol-dropdown").change(function() {
                                    e.LA()
                                }),
                                this.xo.find(".accounting-decimal-places-input").spinner({
                                    min: 0,
                                    max: 16,
                                    change: function() {
                                        var t = e.xo.find(".accounting-decimal-places-input").val();
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.LA()
                                    },
                                    spin: function() {
                                        var t = arguments[1].value;
                                        e.xo.find(".format-decimal-input").val(t),
                                            e.LA()
                                    }
                                })
                        }
                        ,
                        t.prototype.cB = function() {
                            this.xo.find(".category-select").val("general").trigger("change"),
                                this.xo.find(".category-select").get(0).selectedIndex = -1,
                                this.xo.find(".format-decimal-input").val(2),
                                this.xo.find(".currency-symbol-dropdown").get(0).selectedIndex = 1,
                                this.xo.find(".accounting-symbol-dropdown").get(0).selectedIndex = 1,
                                this.xo.find(".currency-type-select").get(0).selectedIndex = 0,
                                this.$A = i,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.vA = function() {
                            var e = this.tA(r.res.formatNumberComments.generalComments, "general");
                            this.xo.find(".tab-number-setting").append(e)
                        }
                        ,
                        t.prototype.EA = function() {
                            var e = this.tA(r.res.formatNumberComments.textComments, "text");
                            this.xo.find(".tab-number-setting").append(e)
                        }
                        ,
                        t.prototype.wA = function() {
                            var e = this
                                , t = this.pA("decimal-places-input", "decimal-places", "spread-format-numbers")
                                , i = this.qA("separator-input", "thousand-separator", "spread-format-numbers")
                                , o = this.sA(r.res.negativeNumbers, r.res.formatNumberPickerSetting.negativeNumber, "negative-number", "spread-format-numbers")
                                , n = this.tA(r.res.formatNumberComments.numberComments, "numbers");
                            this.xo.find(".tab-number-setting").append(t).append(i),
                                this.xo.find(".tab-number-setting").append(o),
                                this.xo.find(".tab-number-comments").append(n),
                                this.xo.find(".negative-number-select").change(function() {
                                    var t = this.selectedIndex;
                                    e.JA(t)
                                }),
                                this.xo.find(".separator-input").change(function() {
                                    e.KA();
                                    var t = e.xo.find(".negative-number-select").get(0).selectedIndex;
                                    e.JA(t)
                                }),
                                this.xo.find(".decimal-places-input").spinner({
                                    min: 0,
                                    max: 16,
                                    change: function() {
                                        var t, i = e.xo.find(".decimal-places-input").val();
                                        e.xo.find(".format-decimal-input").val(i),
                                            e.KA(),
                                            t = e.xo.find(".negative-number-select").get(0).selectedIndex,
                                            e.JA(t)
                                    },
                                    spin: function() {
                                        var t, i = arguments[1].value;
                                        e.xo.find(".format-decimal-input").val(i),
                                            e.KA(),
                                            t = e.xo.find(".negative-number-select").get(0).selectedIndex,
                                            e.JA(t)
                                    }
                                })
                        }
                        ,
                        t.prototype.IA = function() {
                            this.xo.find(".sample-display").text(this.YA(this._A, r.res.generalFormat)),
                                this.$A = "General",
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.TA = function() {
                            this.xo.find(".sample-display").text(this.YA(this._A, r.res.textFormats[0])),
                                this.$A = "@",
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.LA = function() {
                            var e = this.xo.find(".accounting-symbol-dropdown").get(0).selectedIndex
                                , t = this.xo.find(".accounting-decimal-places-input").val()
                                , i = this.dB(t, e);
                            this.xo.find(".sample-display").text(this.YA(this._A, i)),
                                this.$A = i,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.KA = function() {
                            var e, t, i, o, n, a, s = this.xo.find(".separator-input").prop("checked"), l = r.res.negativeNumbers, c = "1234.10", d = parseInt(this.xo.find(".decimal-places-input").val());
                            if (d > 0) {
                                for (e = "",
                                         t = 0; t < d; t++)
                                    e = "" + t % 10 + e.substring(0);
                                c = c.substring(0, c.indexOf(".") + 1) + e
                            } else
                                c = c.substring(0, c.indexOf("."));
                            s && (i = c.indexOf("1"),
                                c = c.substring(0, i + 1) + "," + c.substring(i + 1));
                            for (o in l)
                                n = c,
                                    a = l[o],
                                -1 !== a.indexOf("-") && (n = "-" + n),
                                -1 !== a.indexOf(")") && (n = "(" + n + ")"),
                                    this.xo.find(".negative-number-select").find("option[value='" + o + "']").text(n)
                        }
                        ,
                        t.prototype.NA = function() {
                            var e, t, i, o, n, a, s, l = parseInt(this.xo.find(".currency-decimal-places-input").val()), c = r.res.currencyNegativeNumbers, d = "1,234.10", p = this.xo.find(".currency-symbol-dropdown").get(0).selectedIndex;
                            if (l > 0) {
                                for (e = "",
                                         t = 0; t < l; t++)
                                    e = "" + t % 10 + e.substring(0);
                                d = d.substring(0, d.indexOf(".") + 1) + e
                            } else
                                d = d.substring(0, d.indexOf("."));
                            i = r.res.accountingSymbol[p][1],
                            i === r.res.accountingSymbol[0][0] && (i = ""),
                                o = !0;
                            for (n in c)
                                a = d,
                                    s = c[n],
                                    -1 !== s.indexOf("-") && o ? (a = "-" + i + a,
                                        o = !1) : a = -1 !== s.indexOf("-") ? i + "-" + a : i + a,
                                    this.xo.find(".currency-type-select").find("option[value='" + n + "']").text(a)
                        }
                        ,
                        t.prototype.JA = function(e) {
                            var t = this.xo.find(".separator-input").prop("checked")
                                , i = parseInt(this.xo.find(".decimal-places-input").val())
                                , o = this.eB(e, i, t);
                            this.xo.find(".sample-display").text(this.YA(this._A, o)),
                                this.$A = o,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.WA = function() {
                            var e = this.xo.find(".custom-type-input").val();
                            this.fB(e) && (this.xo.find(".sample-display").text(this.YA(this._A, e)),
                                this.$A = e,
                                this.xz.formatter(this.$A))
                        }
                        ,
                        t.prototype.fB = function(e) {
                            var t, i = [];
                            for (t = 0; t < e.length; t++)
                                if ("[" === e[t] && i.push(t),
                                    "]" === e[t]) {
                                    if (0 === i.length)
                                        return !1;
                                    i.pop()
                                }
                            return 0 === i.length
                        }
                        ,
                        t.prototype.VA = function() {
                            if (this.$A)
                                this.xo.find(".custom-type-input").val(this.$A);
                            else {
                                var e = this.xo.find(".custom-type-select").find("option:selected").text();
                                this.xo.find(".custom-type-input").val(e)
                            }
                        }
                        ,
                        t.prototype.RA = function() {
                            var e = r.res.fractionFormats
                                , t = this.xo.find(".fraction-type-select").get(0).selectedIndex
                                , i = e[t];
                            this.xo.find(".sample-display").text(this.YA(this._A, i)),
                                this.$A = i,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.UA = function() {
                            var e, t = r.res.specialFormats, i = this.xo.find(".special-type-select").get(0).selectedIndex, o = this.xo.find(".special-type-locale-select").find("option:selected").val();
                            switch (o) {
                                case "ja_jp":
                                    t = r.res.specialJapanFormats;
                                    break;
                                case "en_us":
                                    t = r.res.specialFormats
                            }
                            e = t[i],
                                this.xo.find(".sample-display").text(this.YA(this._A, e)),
                                this.$A = e,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.SA = function() {
                            var e, t, i = this.xo.find(".scientific-decimal-places-input").val(), o = "";
                            if (i > 0) {
                                for (t = 0; t < i; t++)
                                    o += "0";
                                e = "0." + o + "E+00"
                            } else
                                e = "0E+00";
                            this.xo.find(".sample-display").text(this.YA(this._A, e)),
                                this.$A = e,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.QA = function() {
                            var e, t, i = this.xo.find(".percentage-decimal-places-input").val(), o = "";
                            if (i > 0) {
                                for (t = 0; t < i; t++)
                                    o += "0";
                                e = "0." + o + "%"
                            } else
                                e = "0%";
                            this.xo.find(".sample-display").text(this.YA(this._A, e)),
                                this.$A = e,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.PA = function() {
                            var e, t = this.xo.find(".time-type-select").get(0).selectedIndex, i = r.res.timeFormats, o = this.xo.find(".time-type-locale-select").find("option:selected").val();
                            switch (o) {
                                case "ja_jp":
                                    i = r.res.japanTimeFormats;
                                    break;
                                case "en_us":
                                    i = r.res.timeFormats
                            }
                            e = i[t],
                                this.xo.find(".sample-display").text(this.YA(this._A, e)),
                                this.$A = e,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.OA = function() {
                            var e, t, i = this.xo.find(".date-type-select").get(0).selectedIndex, o = r.res.dateFormats, n = this.xo.find(".date-type-locale-select").find("option:selected").val();
                            switch (n) {
                                case "ja_jp":
                                    this.xo.find(".spread-format-date-calendar").removeClass("hidden"),
                                        e = this.xo.find(".date-type-calendar-select").find("option:selected").val(),
                                        "western" === e ? o = r.res.japanWesternDateFormat : "JER" === e && (o = r.res.japanEmperorReignDateFormat);
                                    break;
                                case "en_us":
                                    this.xo.find(".spread-format-date-calendar").addClass("hidden"),
                                        o = r.res.dateFormats
                            }
                            t = o[i],
                                this.xo.find(".sample-display").text(this.YA(this._A, t)),
                                this.$A = t,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.MA = function() {
                            var e = this.xo.find(".currency-decimal-places-input").val()
                                , t = this.xo.find(".currency-type-select").get(0).selectedIndex
                                , i = this.gB(t, e);
                            this.xo.find(".sample-display").text(this.YA(this._A, i)),
                                this.$A = i,
                                this.xz.formatter(this.$A)
                        }
                        ,
                        t.prototype.YA = function(e, t) {
                            var i = this.Zz.getActiveSheet();
                            return i.setFormatter(0, 0, t),
                                i.setValue(0, 0, e),
                                i.getText(0, 0)
                        }
                        ,
                        t.prototype.gB = function(e, t) {
                            var i, o, n, s, l, c, d, p, u, h, f, g, m, b;
                            if (-1 === e && (e = 0),
                                    n = r.res.currencyFormats[e],
                                t > 0) {
                                for (l = "",
                                         s = 0; s < t; s++)
                                    l += "0";
                                n = n.replace(/#0/g, "#0." + l)
                            }
                            if (c = n.split(";"),
                                    d = r.res.accountingSymbol,
                                    p = this.xo.find(".currency-symbol-dropdown").get(0).selectedIndex,
                                    i = d[p][1],
                                    u = d[p][2],
                                    h = a[u && u.toLowerCase()] || u,
                                null === i)
                                return n;
                            if ("$" === i)
                                for (n = "",
                                         o = "$",
                                         s = 0; s < c.length; s++)
                                    f = c[s],
                                        g = f.indexOf("[Red]"),
                                        m = 5,
                                        -1 !== g ? (b = f.substring(0, g + m) + o + f.substring(g + m),
                                            n = n + b + ";") : n = n + o + f + ";";
                            else
                                for (n = "",
                                         s = 0; s < c.length; s++)
                                    f = c[s],
                                        g = f.indexOf("[Red]"),
                                        m = 5,
                                        -1 !== g ? (b = f.substring(0, g + m) + "[$" + i + "-" + h + "]" + f.substring(g + m),
                                            n = n + b + ";") : n = n + "[$" + i + "-" + h + "]" + f + ";";
                            return "" !== n && ";" === n.charAt(n.length - 1) && (n = n.substring(0, n.length - 1)),
                                n
                        }
                        ,
                        t.prototype.dB = function(e, t) {
                            var i, o, n, s, l, c, d, p, u = r.res.accountingSymbol, h = r.res.accountingFormats[0], f = u[t][1], g = u[t][2], m = a[g && g.toLowerCase()] || g;
                            if (e > 0) {
                                for (o = "",
                                         n = 0; n < e; n++)
                                    o += "0";
                                h = h.replace(/#0/g, "#0." + o)
                            }
                            return s = h.split(";"),
                                null === f ? h : ("$" === f ? (i = " $",
                                    l = s[0].replace(/_\(\*/g, i + "*"),
                                    l = l.replace(/_\)/g, "_"),
                                    c = s[1].replace(/_\(\*/g, i + "*"),
                                    c = c.replace(/\(/g, ""),
                                    c = c.replace(/\)/g, "_"),
                                    d = s[2].replace(/_\(\*/, i + "*"),
                                    d = d.replace(/_\)/g, "_"),
                                    p = s[3].replace(/_\(/g, "_"),
                                    p = p.replace(/_\)/g, "_"),
                                    h = l + ";" + c + ";" + d + ";" + p) : (l = s[0].replace(/_\(\*/g, "_-[$" + f + "-" + m + "]*"),
                                    l = l.replace(/_\)/, "_-"),
                                    c = s[1].replace(/_\(\*/g, "-[$" + f + "-" + m + "]*"),
                                    c = c.replace(/\(/g, ""),
                                    c = c.replace(/\)/g, "_-"),
                                    d = s[2].replace(/_\(\*/g, "_-[$" + f + "-" + m + "]*"),
                                    d = d.replace(/_\)/g, "_-"),
                                    p = s[3].replace(/_\(/g, "_-"),
                                    p = p.replace(/_\)/g, "_-"),
                                    h = l + ";" + c + ";" + d + ";" + p),
                                    h)
                        }
                        ,
                        t.prototype.eB = function(e, t, i) {
                            var o, n, a = r.res.numberFormats, s = a.length / 2, l = a[e];
                            if (i && (l = a[e + s]),
                                t > 0) {
                                for (o = "",
                                         n = 0; n < t; n++)
                                    o += "0";
                                l = l.replace(/0/g, "0." + o)
                            }
                            return l
                        }
                        ,
                        t.prototype.Mz = function(e, t) {
                            var o, n, r, a, s, l = t.getActiveSheet(), c = l.getSelections(), d = c.length;
                            if (0 !== d) {
                                for (o = -1 === c[0].row ? 0 : c[0].row,
                                         n = -1 === c[0].col ? 0 : c[0].col,
                                         r = l.getValue(o, n),
                                     null !== r && void 0 !== r || (r = ""),
                                         a = 0; a < d; a++)
                                    if (o = -1 === c[a].row ? 0 : c[a].row,
                                            n = -1 === c[a].col ? 0 : c[a].col,
                                        void 0 === e) {
                                        if ("" === r)
                                            break
                                    } else
                                        e !== l.getFormatter(o, n) && (e = i);
                                s = this.hB(),
                                s && !this.iB(e) && (e = s),
                                    this._A = r,
                                    this.$A = e,
                                    void 0 !== e ? (this.xo.find(".sample-display").text(this.YA(r, e)),
                                        this.jB(e)) : this.cB()
                            }
                        }
                        ,
                        t.prototype.Lz = function(e) {
                            this.$A = e,
                                void 0 !== e ? this.jB(e) : this.cB()
                        }
                        ,
                        t.prototype.jB = function(e) {
                            var t, i, o, n, a, s, l, c, d, p, u, h, f, g = 0, m = !1, b = r.res.dateFormats, v = r.res.japanWesternDateFormat, y = r.res.japanEmperorReignDateFormat, x = r.res.timeFormats, w = r.res.japanTimeFormats, C = r.res.specialFormats, S = r.res.specialJapanFormats, k = r.res.numberFormats, T = r.res.currencyFormats, A = r.res.accountingFormats, I = r.res.percentageFormats, D = r.res.scientificFormats, F = r.res.fractionFormats, L = r.res.customFormats;
                            if (this.xo.find(".custom-type-input").val(e),
                                    i = this.iB(e)) {
                                if (this.xo.find(".category-select").val("date").trigger("change"),
                                    (o = $.inArray(i, b)) >= 0)
                                    return this.xo.find(".date-type-locale-select").val("en_us").trigger("change"),
                                        this.xo.find(".date-type-select").get(0).selectedIndex = o,
                                        void this.xo.find(".date-type-select").trigger("change");
                                if ((o = $.inArray(i, v)) >= 0)
                                    return this.xo.find(".date-type-locale-select").val("ja_jp").trigger("change"),
                                        this.xo.find(".date-type-calendar-select").val("western").trigger("change"),
                                        this.xo.find(".date-type-select").get(0).selectedIndex = o,
                                        void this.xo.find(".date-type-select").trigger("change");
                                if ((o = $.inArray(i, y)) >= 0)
                                    return this.xo.find(".date-type-locale-select").val("ja_jp").trigger("change"),
                                        this.xo.find(".date-type-calendar-select").val("JER").trigger("change"),
                                        this.xo.find(".date-type-select").get(0).selectedIndex = o,
                                        void this.xo.find(".date-type-select").trigger("change")
                            }
                            if ((n = $.inArray(e, x)) >= 0)
                                return this.xo.find(".category-select").val("time").trigger("change"),
                                    this.xo.find(".time-type-locale-select").val("en_us").trigger("change"),
                                    this.xo.find(".time-type-select").get(0).selectedIndex = n,
                                    void this.xo.find(".time-type-select").trigger("change");
                            if ((n = $.inArray(e, w)) >= 0)
                                return this.xo.find(".category-select").val("time").trigger("change"),
                                    this.xo.find(".time-type-locale-select").val("ja_jp").trigger("change"),
                                    this.xo.find(".time-type-select").get(0).selectedIndex = n,
                                    void this.xo.find(".time-type-select").trigger("change");
                            if ((a = $.inArray(e, C)) >= 0)
                                return this.xo.find(".category-select").val("special").trigger("change"),
                                    this.xo.find(".special-type-locale-select").val("en_us").trigger("change"),
                                    this.xo.find(".special-type-select").get(0).selectedIndex = a,
                                    void this.xo.find(".special-type-select").trigger("change");
                            if ((a = $.inArray(e, S)) >= 0)
                                return this.xo.find(".category-select").val("special").trigger("change"),
                                    this.xo.find(".special-type-locale-select").val("ja_jp").trigger("change"),
                                    this.xo.find(".special-type-select").get(0).selectedIndex = a,
                                    void this.xo.find(".special-type-select").trigger("change");
                            for (t = 0; t < F.length; t++)
                                if (e === F[t])
                                    return this.xo.find(".category-select").val("fraction").trigger("change"),
                                        this.xo.find(".fraction-type-select").get(0).selectedIndex = t,
                                        void this.xo.find(".fraction-type-select").trigger("change");
                            if ("General" === e)
                                return void this.xo.find(".category-select").val("general").trigger("change");
                            if ("@" === e)
                                return void this.xo.find(".category-select").val("text").trigger("change");
                            if (-1 !== e.indexOf(".")) {
                                for (s = e.indexOf("."),
                                         t = s + 1; t < e.length && "0" === e.substring(t, t + 1); t++)
                                    g++;
                                this.xo.find(".format-decimal-input").val(g)
                            }
                            for (l = e.substring(e.indexOf("."), e.indexOf(".") + g + 1),
                                     c = e.replace(RegExp(l, "g"), ""),
                                     t = 0; t < k.length; t++)
                                if (c === k[t])
                                    return this.xo.find(".category-select").val("numbers").trigger("change"),
                                        this.xo.find(".negative-number-select").get(0).selectedIndex = t % 4,
                                        this.xo.find(".negative-number-select").trigger("change"),
                                        void (-1 !== e.indexOf("#,") && (m = !0,
                                            this.xo.find(".separator-input").prop("checked", m)));
                            for (-1 !== e.indexOf("$") && (c = c.replace(/\$/g, "")),
                                     d = c.replace(/\[\xa5-804]|\[\xa5-411]/g, ""),
                                     t = 0; t < T.length; t++)
                                if (d === T[t])
                                    return this.xo.find(".category-select").val("currency").trigger("change"),
                                        this.xo.find(".currency-type-select").get(0).selectedIndex = t % 4,
                                        this.xo.find(".currency-type-select").trigger("change"),
                                        p = c.indexOf("\xa5-804") >= 0 ? 2 : c.indexOf("\xa5-411") >= 0 ? 3 : 1,
                                        void (this.xo.find(".currency-symbol-dropdown").get(0).selectedIndex = p);
                            for (u = A.length,
                                     h = 0; h < u; h++)
                                if (e === A[h])
                                    return this.xo.find(".category-select").val("accounting").trigger("change"),
                                        void (this.xo.find(".accounting-symbol-dropdown").get(0).selectedIndex = h % u - 1);
                            return c === D[0] ? void this.xo.find(".category-select").val("scientific").trigger("change") : c === I[0] ? void this.xo.find(".category-select").val("percentage").trigger("change") : (f = $.inArray(e, L)) >= 0 ? (this.xo.find(".category-select").val("custom").trigger("change"),
                                this.xo.find(".custom-type-select").get(0).selectedIndex = f,
                                void this.xo.find(".custom-type-select").trigger("change")) : void this.xo.find(".category-select").val("custom").trigger("change")
                        }
                        ,
                        t.prototype.selectTab = function(e) {
                            e.numbers ? this.xo.find(".tab-number-li").css("display", "block") : this.xo.find(".tab-number-li").css("display", "none"),
                                e.alignment ? this.xo.find(".tab-alignment-li").css("display", "block") : this.xo.find(".tab-alignment-li").css("display", "none"),
                                e.font ? this.xo.find(".tab-font-li").css("display", "block") : this.xo.find(".tab-font-li").css("display", "none"),
                                e.border ? this.xo.find(".tab-border-li").css("display", "block") : this.xo.find(".tab-border-li").css("display", "none"),
                                e.fill ? this.xo.find(".tab-fill-li").css("display", "block") : this.xo.find(".tab-fill-li").css("display", "none"),
                                e.protection ? this.xo.find(".tab-protection-li").css("display", "block") : this.xo.find(".tab-protection-li").css("display", "none"),
                                e.padding ? this.xo.find(".tab-cellLabel-li").css("display", "block") : this.xo.find(".tab-cellLabel-li").css("display", "none")
                        }
                        ,
                        t.prototype.kB = function() {
                            r.ribbon.updateCellStyle(),
                                r.ribbon.updateMerge(),
                                r.ribbon.updateFormat()
                        }
                        ,
                        t.prototype.hB = function() {
                            var e, t, i, o, n, a, s, l, c, d, p = r.wrapper.spread.getActiveSheet(), u = p.getSelections();
                            if (!u || 0 === u.length)
                                return null;
                            if (t = -1 === u[0].row ? 0 : u[0].row,
                                    i = -1 === u[0].col ? 0 : u[0].col,
                                    !(p.getValue(t, i)instanceof Date))
                                return null;
                            for (e = this.lB(p.getValue(t, i), t, i),
                                     o = 0; o < u.length; o++)
                                for (n = u[o],
                                         t = -1 === n.row ? 0 : n.row,
                                         i = -1 === n.col ? 0 : n.col,
                                         a = n.rowCount,
                                         s = n.colCount,
                                         l = t; l < t + a; l++)
                                    for (c = i; c < i + s; c++)
                                        if (!((d = p.getValue(l, c))instanceof Date && this.lB(p.getValue(l, c), l, c) === e))
                                            return null;
                            return e
                        }
                        ,
                        t.prototype.lB = function(e, t, i) {
                            var o, n = r.res.dateFormats, a = r.res.japanWesternDateFormat, s = r.res.japanEmperorReignDateFormat, l = r.wrapper.spread.getActiveSheet(), c = l.getText(t, i);
                            for (o = 0; o < n.length; o++)
                                if (this.YA(e, n[o]) === c)
                                    return n[o];
                            for (o = 0; o < a.length; o++)
                                if (this.YA(e, a[o]) === c)
                                    return a[o];
                            for (o = 0; o < s.length; o++)
                                if (this.YA(e, s[o]) === c)
                                    return s[o]
                        }
                        ,
                        t.prototype.iB = function(e) {
                            var t, i, o, n, a, s, l;
                            if (null === e || void 0 === e)
                                return !1;
                            if (t = r.res.dateFormats,
                                    i = r.res.japanWesternDateFormat,
                                    o = r.res.japanEmperorReignDateFormat,
                                    n = "1992",
                                -1 !== e.indexOf("G") || -1 !== e.indexOf("g") || -1 !== e.indexOf("e"))
                                return e;
                            for (a = 0; a < t.length; a++)
                                if (s = this.YA(n, t[a]),
                                        l = this.YA(n, e),
                                    s === l && -1 !== t[a].indexOf(e))
                                    return t[a];
                            for (a = 0; a < i.length; a++)
                                if (s = this.YA(n, i[a]),
                                        l = this.YA(n, e),
                                    s === l && -1 !== i[a].indexOf(e))
                                    return i[a];
                            for (a = 0; a < o.length; a++)
                                if (s = this.YA(n, o[a]),
                                        l = this.YA(n, e),
                                    s === l && -1 !== o[a].indexOf(e))
                                    return o[a];
                            return !1
                        }
                        ,
                        t.prototype.Sz = function(e, t) {
                            var i, o, n, a, s, l, c;
                            e && (-1 !== e.indexOf("top") ? i = 0 : -1 !== e.indexOf("right") ? i = 1 : -1 !== e.indexOf("bottom") ? i = 2 : -1 !== e.indexOf("left") && (i = 3),
                                o = this.Nz.getActiveSheet(),
                                n = o.getStyle(0, 0),
                            n || (n = new GC.Spread.Sheets.Style),
                                -1 !== e.indexOf("padding") ? (a = r.util.parsePadding(n.cellPadding),
                                    a[i] = t,
                                    n.cellPadding = a.join(" "),
                                    o.setStyle(0, 0, n),
                                    this.xz.cellPadding(a.join(" "))) : -1 !== e.indexOf("margin") && (s = n.labelOptions || {},
                                    l = r.util.parsePadding(s.margin),
                                    l[i] = t,
                                    c = l.join(" "),
                                    this.mB("margin", c)))
                        }
                        ,
                        t.prototype.mA = function() {
                            var e, t, i, o, n, a, s, l, c, d = this;
                            d.xo.find(".numeric").spinner({
                                min: 0,
                                max: 99,
                                stop: function() {
                                    d.Sz($(this).data("name"), $(this).spinner("value"))
                                },
                                change: function() {
                                    d.Sz($(this).data("name"), $(this).spinner("value"))
                                }
                            }),
                                e = d.xo.find(".label-font-family"),
                                t = r.res.fontPicker.fontFamilies;
                            for (i in t)
                                t.hasOwnProperty(i) && (o = t[i],
                                    $("<option></option>").text(o).val(o).appendTo(e));
                            n = d.xo.find(".label-font-size"),
                                a = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72],
                                a.forEach(function(e) {
                                    $("<option></option>").text(e).val(e).appendTo(n)
                                }),
                                s = d.xo.find(".label-visibility"),
                                l = r.res.formatDialog.labelVisibility;
                            for (c in l)
                                l.hasOwnProperty(c) && $("<option></option>").text(l[c]).val(c).appendTo(s);
                            d.nB(),
                                d.oB(),
                                d.xo.find(".label-font-color").click(function() {
                                    d.pB.gcuipopup("show")
                                }),
                                d.xo.find(".label-text-input").keyup(function() {
                                    d.Uz($(this).val())
                                }),
                                d.xo.find(".label-alignment-button").click(function() {
                                    d.Vz(GC.Spread.Sheets.LabelAlignment[$(this).data("name")])
                                }),
                                d.xo.find(".label-font-family").change(function() {
                                    d.Oz = $(this).val(),
                                        d.Xz()
                                }),
                                d.xo.find(".label-font-size").change(function() {
                                    d.Pz = $(this).val() + "pt",
                                        d.Xz()
                                }),
                                d.xo.find(".label-font-weight").click(function() {
                                    $(this).val(!$(this).val()),
                                        d.Rz = $(this).val() ? "bold" : "normal",
                                        $(this).val() ? $(this).addClass("button-active") : $(this).removeClass("button-active"),
                                        d.Xz()
                                }),
                                d.xo.find(".label-font-style").click(function() {
                                    $(this).val(!$(this).val()),
                                        d.Qz = $(this).val() ? "italic" : "normal",
                                        $(this).val() ? $(this).addClass("button-active") : $(this).removeClass("button-active"),
                                        d.Xz()
                                }),
                                d.xo.find(".label-visibility").change(function() {
                                    d.Yz(GC.Spread.Sheets.LabelVisibility[$(this).val()])
                                })
                        }
                        ,
                        t.prototype.Uz = function(e) {
                            var t = this.Nz.getActiveSheet()
                                , i = t.getStyle(0, 0);
                            i || (i = new GC.Spread.Sheets.Style),
                                i.watermark = e,
                                t.setStyle(0, 0, i),
                                this.xz.watermark(e)
                        }
                        ,
                        t.prototype.Vz = function(e) {
                            this.mB("alignment", e),
                                this.qB(e)
                        }
                        ,
                        t.prototype.qB = function(e) {
                            this.xo.find(".label-alignment-button").removeClass("button-active");
                            var t = this.xo.find(".label-alignment-button");
                            t.each(function(t, i) {
                                GC.Spread.Sheets.LabelAlignment[$(i).data("name")] === e && $(i).addClass("button-active")
                            })
                        }
                        ,
                        t.prototype.Xz = function(e) {
                            if (e)
                                return void this.mB("font", e);
                            var t = $("<span></span>");
                            t.css("font", "normal normal 11pt Calibri"),
                                t.css("font-weight", this.Rz || "normal"),
                                t.css("font-style", this.Qz || "normal"),
                                t.css("font-size", this.Pz || "11pt"),
                                t.css("font-family", this.Oz || "Calibri"),
                                this.mB("font", t.css("font"))
                        }
                        ,
                        t.prototype.Wz = function(e) {
                            this.mB("foreColor", e || "grey")
                        }
                        ,
                        t.prototype.Yz = function(e) {
                            this.mB("visibility", e)
                        }
                        ,
                        t.prototype.mB = function(e, t) {
                            var i = this.Nz.getActiveSheet()
                                , o = i.getStyle(0, 0);
                            o || (o = new GC.Spread.Sheets.Style),
                            o.labelOptions || (o.labelOptions = {}),
                                o.labelOptions[e] = t,
                                i.setStyle(0, 0, o),
                                this.xz.labelOptions(o.labelOptions)
                        }
                        ,
                        t.prototype.oB = function() {
                            var e = this;
                            $("#label-color-picker").colorpicker({
                                valueChanged: function(t, i) {
                                    e.Wz(i.color)
                                },
                                choosedColor: function(t, i) {
                                    e.pB.gcuipopup("hide")
                                },
                                openColorDialog: function() {
                                    e.pB.gcuipopup("hide")
                                }
                            }),
                                e.pB = $("#label-color-popup").gcuipopup({
                                    autoHide: !0,
                                    position: {
                                        of: e.xo.find(".label-font-color"),
                                        my: "right top",
                                        at: "right bottom"
                                    },
                                    showing: function(e, t) {
                                        $("#label-color-picker").colorpicker("option", "themeColors", r.wrapper.getThemeColors())
                                    }
                                })
                        }
                        ,
                        t.prototype.nB = function() {
                            var e, t, i = this.xo.find(".preview-spread-container"), o = new GC.Spread.Sheets.Workbook(i[0]), n = o.getActiveSheet();
                            n.suspendPaint(),
                                o.options.showHorizontalScrollbar = !1,
                                o.options.showVerticalScrollbar = !1,
                                o.options.tabStripVisible = !1,
                                o.options.allowUserResize = !1,
                                o.options.allowUserDragDrop = !1,
                                o.options.allowUserDragFill = !1,
                                o.options.allowUserZoom = !1,
                                $(r.util.getCanvas(o)).unbind("gcmousewheel.gcSheet"),
                                n.options.colHeaderVisible = !1,
                                n.options.rowHeaderVisible = !1,
                                n.options.selectionBackColor = "transparent",
                                n.options.selectionBorderColor = "transparent",
                                n.options.gridline = {
                                    showVerticalGridline: !1,
                                    showHorizontalGridline: !1
                                },
                                n.options.isProtected = !0,
                                n.setColumnCount(1),
                                n.setRowCount(1),
                                e = i.width(),
                                t = i.height(),
                                n.setColumnWidth(0, e),
                                n.setRowHeight(0, t),
                                n.setValue(0, 0, r.res.formatDialog.paddingPreviewText),
                                n.resumePaint(),
                                this.Nz = o
                        }
                        ,
                        t.myRes = r.res.formatDialog,
                        t.Rv = 0,
                        t
                }(r.BaseDialog);
                r.FormatDialog = e
            }()
        }
        , function(e, t) {
            var i = GC.Spread.Sheets
                , o = GC.Spread.Sheets.Designer;
            !function(e) {
                "use strict";
                var t, n, r, a, s, l = !1, c = !1, d = GC.Spread.CalcEngine.ExpressionType;
                function p(e) {
                    return void 0 === e || null === e
                }
                function u(e) {
                    var t, n, r;
                    e && (s = new i.FormulaTextBox.FormulaTextBox($("#formulaBarText").get(0))),
                        s.workbook(o.wrapper.spread),
                        w(void 0, $(".ok-btn"), !1),
                        w(void 0, $(".cancel-btn"), !1),
                        f(e),
                        t = o.wrapper.spread.getActiveSheet(),
                        n = t.getActiveColumnIndex(),
                        r = t.getActiveRowIndex(),
                        o.util.triggerSheetEvent(t, i.Events.EnterCell, {
                            sheet: t,
                            sheetName: t.name(),
                            row: r,
                            col: n
                        }),
                        o.util.triggerSheetEvent(t, i.Events.SelectionChanged, null)
                }
                e.initFormulaBar = u;
                function h() {
                    s && (s.destroy(),
                        s = null)
                }
                e.resetFormulaBar = h;
                function f(e) {
                    var d, p, u = o.wrapper.spread, h = o.wrapper.spreadElement;
                    u.bind(i.Events.InvalidOperation, function(e, t) {
                        0 !== t.invalidType && 4 !== t.invalidType || (o.MessageBox.show(t.message, o.res.title, 2, 0, function() {
                            $(".fill-content").focus()
                        }),
                            c = !0)
                    });
                    function f(e, i) {
                        var a = o.wrapper.spread.getActiveSheet()
                            , s = a.getActiveColumnIndex()
                            , l = a.getActiveRowIndex()
                            , c = a.getCell(l, s);
                        w(!0, $(".functions-btn")),
                            t = c.value(),
                            n = c.formula(),
                            r = !0
                    }
                    u.bind(i.Events.EnterCell, f),
                        h.bind(i.Events.EnterCell, f);
                    function x(e, t) {
                        var i, n, r = o.wrapper.spread.getActiveSheet(), a = r.getSelections()[r.getSelections().length - 1];
                        null !== a && void 0 !== a && (i = m(a),
                            n = $("[name=namedRangeSelector]"),
                            n.val(i))
                    }
                    u.bind(i.Events.SelectionChanging, x),
                        h.bind(i.Events.SelectionChanging, x);
                    function S(e, t) {
                        var i, n = $("[name=namedRangeSelector]"), r = o.wrapper.spread.getActiveSheet(), a = r.getSelections()[r.getSelections().length - 1];
                        null !== a && void 0 !== a && (i = l ? m(a) : b(o.wrapper.spread, o.wrapper.spread.getActiveSheet().getActiveRowIndex() + 1, o.wrapper.spread.getActiveSheet().getActiveColumnIndex() + 1, a),
                            n.val(i))
                    }
                    u.bind(i.Events.SelectionChanged, S),
                        h.bind(i.Events.SelectionChanged, S),
                        o.wrapper.spread.bind(i.Events.ActiveSheetChanged, function(e, t) {
                            var n = o.wrapper.spread.getActiveSheet();
                            o.util.triggerSheetEvent(n, i.Events.SelectionChanging, void 0),
                                o.util.triggerSheetEvent(n, i.Events.SelectionChanged, void 0),
                                o.util.triggerSheetEvent(n, i.Events.EnterCell, void 0)
                        }),
                    e && (o.wrapper.spreadElement.bind("FileOpened", function(e, t) {
                        var n = o.wrapper.spread.getActiveSheet();
                        o.util.triggerSheetEvent(n, i.Events.SelectionChanging, void 0),
                            o.util.triggerSheetEvent(n, i.Events.SelectionChanged, void 0),
                            o.util.triggerSheetEvent(n, i.Events.EnterCell, void 0),
                            s.text(C(n, n.getActiveRowIndex(), n.getActiveColumnIndex()))
                    }),
                        $(document).bind("keydown", function(e) {
                            e.shiftKey && (l = !0)
                        }),
                        $(document).bind("keyup", function(e) {
                            var t, i, n, r;
                            e.shiftKey || (l = !1,
                                t = $("[name=namedRangeSelector]"),
                            (i = o.wrapper.spread.getActiveSheet()) && (r = i.getSelections()[i.getSelections().length - 1],
                                n = b(o.wrapper.spread, o.wrapper.spread.getActiveSheet().getActiveRowIndex() + 1, o.wrapper.spread.getActiveSheet().getActiveColumnIndex() + 1, r),
                                t.val(n)))
                        }),
                        $(".fill-content").bind("keyup", function(e) {
                            var t = $(".fill-content")
                                , i = t.text();
                            "" !== i && "=" !== i.substring(0, 1) ? w(!1, $(".functions-btn")) : w(!0, $(".functions-btn"))
                        }),
                        $(".fill-content").focus(function(e) {
                            r = !1,
                                w(void 0, $(".ok-btn"), !0),
                                w(void 0, $(".cancel-btn"), !0)
                        }),
                        $(".functions-btn").click(function() {
                            a || (a = new o.InsertFunctionDialog),
                                a.open()
                        }),
                        $(".cancel-btn").click(function() {
                            y(),
                                o.wrapper.setFocusToSpread()
                        }),
                        $(".ok-btn").click(function() {
                            o.wrapper.setFocusToSpread(),
                                v(null)
                        }),
                        p = !1,
                        $(".splitter").mousedown(function(e) {
                            d = e.pageX,
                                p = !0
                        }),
                        $(document).mousemove(function(e) {
                            var t, i, o, n;
                            p && (t = e.pageX - d,
                                i = $(".named-range-selector"),
                                o = $(".union-container"),
                                n = $("#formulaBarText"),
                            i.width() + t < 0 && (t = i.width()),
                            n.width() - t < 0 && (t = n.width()),
                                i.width(i.width() + t),
                                n.css("left", parseFloat(n.css("left")) + t),
                                o.width(o.width() + t),
                                d = e.pageX,
                                g())
                        }),
                        $(document).mouseup(function(e) {
                            p = !1
                        }),
                        $(o).bind("layoutChanged", g))
                }
                e.addEvents = f;
                function g() {
                    var e, t = $(".formulaBar"), i = $("#formulaBarText"), o = t.find("td"), n = t.width(), r = 0, a = [];
                    o.each(function(e, t) {
                        var i = $(t).outerWidth();
                        r += i,
                            a.push(i)
                    }),
                        e = n - r - 10,
                        i.css({
                            width: e + a[a.length - 1] - 10
                        })
                }
                function m(e) {
                    var t = ""
                        , i = e.rowCount
                        , n = e.colCount
                        , r = e.row + 1
                        , a = e.col + 1;
                    return t = 1 === i && 1 === n ? b(o.wrapper.spread, r, a) : i < 0 && n > 0 ? n + "C" : n < 0 && i > 0 ? i + "R" : i < 0 && n < 0 ? o.wrapper.spread.getActiveSheet().getRowCount() + "R x " + o.wrapper.spread.getActiveSheet().getColumnCount() + "C" : i + "R x " + n + "C"
                }
                e.GetSelectedRangeString = m;
                function b(e, t, i, o) {
                    var n, r, a, s, l, c, p, u, h, f;
                    if (t < 1 || i < 1)
                        return null;
                    if (n = "",
                            r = e.getActiveSheet().name(),
                            o) {
                        if (null !== (s = e.getActiveSheet().getSpans()))
                            for (l = 0; l < s.length; l++)
                                s[l].row === o.row && s[l].col === o.col && s[l].rowCount === o.rowCount && s[l].colCount === o.colCount && (a = !0);
                        if (void 0 !== (c = e.getCustomNames()))
                            for (h = 0; h < c.length; h++)
                                if ((u = c[h].getExpression()) && u.type === d.reference && u.source && u.source.getName && r === u.source.getName() && null !== (p = u.getRange(0, 0)) && void 0 !== p && (p.row === o.row && p.column === o.col && p.row + p.rowCount === o.row + o.rowCount && p.column + p.columnCount === o.col + o.colCount || p.row === o.row && p.column === o.col && a)) {
                                    n = c[h].getName();
                                    break
                                }
                        if ("" === n && void 0 !== (c = e.getActiveSheet().getCustomNames()))
                            for (h = 0; h < c.length; h++)
                                (u = c[h].getExpression()) && u.type === d.reference && (p = u.getRange(0, 0),
                                (p.row === o.row && p.column === o.col && p.row + p.rowCount === o.row + o.rowCount && p.column + p.columnCount === o.col + o.colCount || p.row === o.row && p.column === o.col && a) && (n = c[h].getName()))
                    }
                    if ("" === n)
                        switch (e.options.referenceStyle) {
                            case 0:
                                for (; i > 0; )
                                    f = i % 26,
                                        0 == f ? (n = "Z" + n,
                                            i--) : n = String.fromCharCode("A".charCodeAt(0) + f - 1) + n,
                                        i = parseInt("" + i / 26);
                                n += "" + t;
                                break;
                            case 1:
                                n = "R" + t + "C" + i
                        }
                    return n
                }
                e.GetCellPositionString = b;
                function v(e) {
                    var i, a, s, l, d = o.wrapper.spread.getActiveSheet(), u = d.getActiveColumnIndex(), h = d.getActiveRowIndex(), f = d.getCell(h, u), g = o.wrapper.spread;
                    if (p(e))
                        i = g.sheets[e.sheetIndex].getCell(e.row, e.col);
                    else {
                        if (!p(f))
                            return !1;
                        i = f
                    }
                    if (!r)
                        if (a = $(".fill-content"),
                            "" !== (s = "" + a.text())) {
                            if ("=" === s.substring(0, 1) && (l = {
                                    cmd: "editCell",
                                    sheetName: i.sheet.name(),
                                    row: i.row,
                                    col: i.col,
                                    newValue: s,
                                    autoFormat: !0
                                },
                                    g.commandManager().execute(l),
                                !0 === c))
                                return c = !1,
                                    !1
                        } else
                            i.value(""),
                                l = {
                                    cmd: "editCell",
                                    sheetName: i.sheet.name(),
                                    row: i.row,
                                    col: i.col,
                                    newValue: "",
                                    autoFormat: !0
                                },
                                g.commandManager().execute(l);
                    return w(!0, $(".functions-btn")),
                        w(void 0, $(".ok-btn"), !1),
                        w(void 0, $(".cancel-btn"), !1),
                        t = i.value(),
                        n = i.formula(),
                        r = !0,
                        !0
                }
                e.CommitFormula = v;
                function y() {
                    var e = $(".fill-content")
                        , i = o.wrapper.spread.getActiveSheet()
                        , a = i.getActiveColumnIndex()
                        , s = i.getActiveRowIndex()
                        , l = i.getCell(s, a);
                    null != l && (r || (w(!0, $(".functions-btn")),
                        w(void 0, $(".ok-btn"), !1),
                        w(void 0, $(".cancel-btn"), !1),
                        l.value(t),
                        l.formula(n),
                        r = !0,
                        o.wrapper.spread.focus(!0),
                        e.text(x(l, n))))
                }
                e.CancelFormula = y;
                function x(e, t) {
                    var i, o = "";
                    return "" === t || null === t ? (i = e.value(),
                        o = null != i ? i instanceof Date ? i.toLocaleString() : "" + i : e.text()) : o = "=" !== t.substring(0, 1) ? "=" + t : t,
                        null == o ? "" : o
                }
                e.GetTextOfFormulaTextBox = x;
                function w(e, t, i) {
                    void 0 !== e ? e ? (t.prop("disabled", !1),
                        t.fadeTo("faster", 1)) : (t.prop("disabled", !0),
                        t.fadeTo("faster", .2)) : i ? t.fadeTo("faster", 1) : t.fadeTo("faster", 0)
                }
                e.setButtonStatus = w;
                function C(e, t, i) {
                    var o, n = "";
                    return e && (n = e.getFormula(t, i),
                        n ? n = "=" + n : (n = e.getText(t, i),
                            o = !e.parent || e.parent.options.allowUserEditFormula,
                        "=" === n[0] && o && (n = "'" + n))),
                        n
                }
                o.formulaBar = e
            }(o.formulaBar || {})
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function(e) {
                "use strict";
                var t, o, n = 600;
                function r() {
                    $(".content").css("height", ($(".content").children(".fill-spread-content").height() + 155)),
                        $(".header").css("width", $(window).width() + "px"),
                    $(".ribbon-bar").data("gcui-gcuiribbon") && $(".ribbon-bar").data("gcui-gcuiribbon").updateRibbonSize();
                    var e = i.wrapper.spread;
                    e && e.isPaintSuspended() && (e.resumePaint(),
                        e.refresh(),
                        t = !0)
                }
                o = null;
                function a() {
                    o && window.clearTimeout(o),
                        o = window.setTimeout(function() {
                            r(),
                                o = null,
                            t && (t = !1,
                                window.setTimeout(function() {
                                    i.wrapper.spread.suspendPaint()
                                }, 300))
                        }, 100)
                }
                $(document).ready(function() {
                    i.loader.loadContent(),
                        $(window).resize(a),
                        $(window).resize(),
                        $("#verticalSplitter").draggable({
                            axis: "y",
                            containment: ".container",
                            scroll: !1,
                            zIndex: 100,
                            stop: function(e, t) {
                                var o = $(this)
                                    , n = o.offset().top
                                    , r = n - $(".header").height()
                                    , a = $(".content .fill-spread-content")
                                    , s = $("#formulaBarText").height()
                                    , l = s + r
                                    , c = 20;
                                l < c ? ($("#formulaBarText").css({
                                    height: c
                                }),
                                    n = n + c - l) : $("#formulaBarText").css({
                                    height: l
                                }),
                                    a.css({
                                        top: n + 10
                                    }),
                                    a.parent().css({
                                        height: a.height()
                                    }),
                                    $(".header").css({
                                        height: n
                                    }),
                                    o.css({
                                        top: 0
                                    }),
                                    i.wrapper.spread.refresh()
                            }
                        });
                    function e(e) {
                        e && (e.effectAllowed = "none",
                            e.dropEffect = "none")
                    }
                    window.addEventListener("dragenter", function(t) {
                        t = t || event,
                            t.preventDefault(),
                            e(t.dataTransfer)
                    }, !1),
                        window.addEventListener("dragover", function(t) {
                            t = t || event,
                                t.preventDefault(),
                                e(t.dataTransfer)
                        }, !1),
                        window.addEventListener("drop", function(t) {
                            t = t || event,
                                t.preventDefault(),
                                e(t.dataTransfer)
                        }, !1)
                }),
                    i.loader.ready(function() {
                        $(window).unbind("resize.gcuiribbon"),
                            $("#verticalSplitter").show(),
                            r()
                    }),
                    i.index = e
            }(i.index || {})
        }
        , function(e, t) {
            !function() {

                var url = window.location.href;
                if(url.indexOf("http://42.") == 0 || url.indexOf("https://42.") == 0) {
                    GC.Spread.Sheets.LicenseKey = "42.*,595987746818664#A0cI9ZJJCL3V6csFmZ0IiczRmI1pjIs9WQisnOiQkIsISP3ElYUZUdLZXeMVHdnZ5ThFVa5R6KkJkMpV4cxAnerdVOyAjcShXRlJGa6djbWd7SrkTavpUQl34NJJUWBp5N4QjdDBTWZNGazk5VyJ6czx6LOtUYxQlaiojITJCLxkDMwQjMxQTN0IicfJye#4Xfd5nIzImNnJiOiMkIsISMx8idgMlSgQWYlJHcTJiOi8kI1tlOiQmcQJCLiMTNwUTOwASOyATM8EDMyIiOiQncDJCLioiLyQjI0IyctRkIsICuPWOrFWOkZmeicaOgKaekneek0SOk0aujYaeixauptauI0ISYONkIsICN6YDOxgjN4czN8kTNJU8I";
                } else if(url.indexOf("http://10.") == 0 || url.indexOf("https://10.") == 0) {
                    GC.Spread.Sheets.LicenseKey = "10.*,595987746818664#A0wQISiwSflNHbhZmOiI7ckJye0ICbuFkI1pjIEJCLi4TP7R5KENHMW5kYldFR4MFcmNWOp3SS4REWIxGMKBnekdTNHJHe5EmY8R4KZ9WRxI5dUVkRwQ4RwA5RLJFSMhVaFdES0tSUWVjRrkHMahkVLZDeIF6UD5mI0IyUiwCOxgDMwYTM8YTM0IicfJye35XX3JyMiZzZiojIDJCLiETMuYHITpEIkFWZyB7UiojIOJyebpjIkJHUiwiIxIjN4MDMgEzMwEDOxAjMiojI4J7QiwiIq8CMxIiOiMXbEJCLig1jlzahlDZmpnInmDoimH9pnHpukDpum1ImmnYsmbarmLiOiEmTDJCLiQjN6gTM8YDN7cDO9UTOII4O";
                } else if(url.indexOf("http://139.") == 0 || url.indexOf("https://139.") == 0) {
                    GC.Spread.Sheets.LicenseKey = "139.*,595987746818664#A0cI9ZJJCL3V6csFmZ0IiczRmI1pjIs9WQisnOiQkIsISP3EkdYBTYKVWRrRUM9oVTzp6KplFepFmNB9Ears6Yw8kerUlSmpVa996b7xUYYhTUyMmTntmUQBzSzRkYD5WatNDbUV4K0VVQ7gVV8QlZjFneLlDWDd6YiojITJCL6gTO9UzMyITN0IicfJye35XX3JyMiZzZiojIDJCLiETMuYHITpEIkFWZyB7UiojIOJyebpjIkJHUiwiI5ADOzYDMgYTMxEDOxAjMiojI4J7QiwiIq8SOzEjI0IyctRkIsICuPWOrFWOkZmeicaOgKaekneek0SOk0aujYaeixauptauI0ISYONkIsICN6YDOxgjN4czN8kTNJU8I";
                } else {
                    GC.Spread.Sheets.LicenseKey = "GrapeCity-Internal-Use-Only,*.grapecity.com|*.componentone.com,E636932262711579#A0CxmjM6IjMzkjNzYjI0ICZJJCL3V6csFmZ0IiczRmI1pjIs9WQisnOiQkIsISP3EkUaR7Y9NDN5p6Rkl7aaVlVWpkMlpFMqF7b4YFU93mSF3mZqZlbKhnRzYnUYRncHRDSCdDOGRDSCFzLM5mUKN4cxAjezVENxdlbMhzUw9URC9mZYVzYiojITJCL9gTM4EzNwcTO0IicfJye&Qf35VfiMjY6cmI0IyQiwiIxEjL6ByUKBCZhVmcwNlI0IiTis7W0ICZyBlIsISOygTN5ADIzITNwgTMwIjI0ICdyNkIsISbvNmLl96b49WZu3Gct36YuoCLt36YukHdpNWZwFmcn9iKiojIz5GRiwiIsFmbyVGdulEI9RXaDVGchJ7RiojIh94QiwSZ5JHd0ICb6VkIsISu5oT"
                }


            }()
        }
        , function(e, t, i) {
            var o = GC.Spread.Sheets
                , n = GC.Spread.Sheets.Designer
                , r = GC.Spread.Sheets.Charts
                , a = r.Chart
                , s = n.util.chartHelper
                , l = n.ColorHelper
                , c = void 0
                , d = i(13)
                , p = i(0).app;
            !function(e) {
                "use strict";
                var t, a, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A = "schema-type-button", I = "ztree-container", D = "ztree-container", F = "other", L = !1, R = !1, B = i(12), N = i(1), E = i(11), V = i(2);
                e.slicerSettingDialog;
                function P() {
                    var i, r, a, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D, F, R, V, P, M, W, _, X, Q, Z, ee, te, ie, oe, ne, ae, se, le, ce, de, pe, ue, me, be, ve, ye, xe, we, Ce, Se, ke, Te, Ae, Ie, De, $e, Fe, Le, Re, Be, Ne, Ee, Ve, Pe, ze, Oe, Ge, He, Ue, We, _e, qe, Ke, Xe = 200, Qe = 4, et = "50", tt = new n.CellValueRuleFormatDialog, it = new n.TextRuleFormatDialog, ot = new n.DateOccurringFormatDialog, nt = new n.DuplicateValuesFormatDialog, rt = new n.Top10RuleFormatDialog, st = new n.AverageRuleFormatDialog, lt = new n.FormatRulesManagerDialog, ct = [], dt = [], pt = function() {
                        var e;
                        for (e = 0; e < dt.length; e++)
                            clearTimeout(dt[e]);
                        for (dt = [],
                                 e = 0; e < ct.length; e++)
                            clearTimeout(ct[e]);
                        ct = [],
                        Ge && (Ge.children("ul").addClass("hidden"),
                            Ge = c),
                            $("#condition-format-popup").children("ul").addClass("hidden")
                    };
                    $(".ribbon-bar").gcuiribbon({
                        click: function(l, c) {
                            var f, g, m, b, v, y, H, U, q, K, Y, De, Ge, He, Ue, We, _e, qe, Ke, Xe, Qe, et, tt, it, ot, nt, rt, st, lt = n.wrapper.spread, ct = lt.getActiveSheet(), dt = s.getSelectedChart(ct);
                            switch (c.name) {
                                case "font-family":
                                    n.actions.doAction("setFontFamily", lt, $("#" + c.commandName).data("font"));
                                    break;
                                case "font-size":
                                    n.actions.doAction("setFontSize", lt, $("#" + c.commandName).text() + "pt")
                            }
                            switch (c.commandName) {
                                case "copy":
                                    n.util.isSlicerSelected(ct) ? n.actions.doAction("floatingObjectCopy", lt) : n.actions.doAction("copy", lt);
                                    break;
                                case "cut":
                                    n.util.isSlicerSelected(ct) ? n.actions.doAction("floatingObjectCut", lt) : n.actions.doAction("cut", lt);
                                    break;
                                case "paste-all":
                                    n.actions.doAction("paste", lt, 0);
                                    break;
                                case "paste-formulas":
                                    n.actions.doAction("paste", n.wrapper.spread, 3);
                                    break;
                                case "paste-values":
                                    n.actions.doAction("paste", n.wrapper.spread, 1);
                                    break;
                                case "paste-formatting":
                                    n.actions.doAction("paste", n.wrapper.spread, 2);
                                    break;
                                case "font-weight":
                                    n.actions.doAction("setFontWeight", lt, $("#" + c.commandName).prop("checked") ? "bold" : "normal");
                                    break;
                                case "font-italic":
                                    n.actions.doAction("setFontStyle", lt, $("#" + c.commandName).prop("checked") ? "italic" : "normal");
                                    break;
                                case "font-underline":
                                    n.actions.doAction("setUnderline", lt, $("#" + c.commandName).prop("checked")),
                                    $("#" + c.commandName).prop("checked") && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-double-underline", !1);
                                    break;
                                case "font-double-underline":
                                    n.actions.doAction("setDoubleUnderline", lt, $("#" + c.commandName).prop("checked")),
                                    $("#" + c.commandName).prop("checked") && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-underline", !1);
                                    break;
                                case "increase-fontsize":
                                    b = O(),
                                    b && n.actions.doAction("setFontSize", lt, b + "pt");
                                    break;
                                case "decrease-fontsize":
                                    v = G(),
                                    v && n.actions.doAction("setFontSize", lt, v + "pt");
                                    break;
                                case "bottom-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            bottom: !0
                                        }
                                    });
                                    break;
                                case "top-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            top: !0
                                        }
                                    });
                                    break;
                                case "left-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            left: !0
                                        }
                                    });
                                    break;
                                case "right-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            right: !0
                                        }
                                    });
                                    break;
                                case "no-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: null,
                                        options: {
                                            all: !0
                                        }
                                    });
                                    break;
                                case "all-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            all: !0
                                        }
                                    });
                                    break;
                                case "outside-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            outline: !0
                                        }
                                    });
                                    break;
                                case "thickbox-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",5),
                                        options: {
                                            outline: !0
                                        }
                                    });
                                    break;
                                case "bottom-double-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",6),
                                        options: {
                                            bottom: !0
                                        }
                                    });
                                    break;
                                case "thick-bottom-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",5),
                                        options: {
                                            bottom: !0
                                        }
                                    });
                                    break;
                                case "top-bottom-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            bottom: !0,
                                            top: !0
                                        }
                                    });
                                    break;
                                case "top-thick-bottom-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            top: !0
                                        }
                                    }),
                                        n.actions.doAction("setBorder", lt, {
                                            lineborder: new o.LineBorder("black",5),
                                            options: {
                                                bottom: !0
                                            }
                                        });
                                    break;
                                case "top-double-bottom-border":
                                    n.actions.doAction("setBorder", lt, {
                                        lineborder: new o.LineBorder("black",1),
                                        options: {
                                            top: !0
                                        }
                                    }),
                                        n.actions.doAction("setBorder", lt, {
                                            lineborder: new o.LineBorder("black",6),
                                            options: {
                                                bottom: !0
                                            }
                                        });
                                    break;
                                case "more-border":
                                    m = n.formatCellDialog,
                                    void 0 === m && (m = new n.FormatDialog,
                                        n.formatCellDialog = m),
                                        m.open("border");
                                    break;
                                case "backcolor":
                                    i || ($("#backcolor-picker").colorpicker({
                                        valueChanged: function(e, t) {
                                            t.name ? n.actions.doAction("setBackColor", n.wrapper.spread, t.name) : n.actions.doAction("setBackColor", n.wrapper.spread, t.color)
                                        },
                                        choosedColor: function(e, t) {
                                            i.gcuipopup("hide")
                                        },
                                        openColorDialog: function() {
                                            i.gcuipopup("hide")
                                        }
                                    }),
                                        i = $("#backcolor-popup").gcuipopup({
                                            autoHide: !0,
                                            position: {
                                                of: $("#backcolor-button"),
                                                my: "left top",
                                                at: "left bottom"
                                            },
                                            showing: function(e, t) {
                                                $("#backcolor-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors())
                                            }
                                        })),
                                        i.gcuipopup("show");
                                    break;
                                case "forecolor":
                                    r || ($("#forecolor-picker").colorpicker({
                                        valueChanged: function(e, t) {
                                            t.name ? n.actions.doAction("setForeColor", n.wrapper.spread, t.name) : n.actions.doAction("setForeColor", n.wrapper.spread, t.color)
                                        },
                                        choosedColor: function(e, t) {
                                            r.gcuipopup("hide")
                                        },
                                        openColorDialog: function() {
                                            r.gcuipopup("hide")
                                        }
                                    }),
                                        r = $("#forecolor-popup").gcuipopup({
                                            autoHide: !0,
                                            position: {
                                                of: $("#forecolor-button"),
                                                my: "left top",
                                                at: "left bottom"
                                            },
                                            showing: function(e, t) {
                                                $("#forecolor-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors())
                                            }
                                        })),
                                        r.gcuipopup("show");
                                    break;
                                case "top-align":
                                    n.actions.doAction("setVAlign", lt, 0);
                                    break;
                                case "middle-align":
                                    n.actions.doAction("setVAlign", lt, 1);
                                    break;
                                case "bottom-align":
                                    n.actions.doAction("setVAlign", lt, 2);
                                    break;
                                case "left-align":
                                    n.actions.doAction("setHAlign", lt, 0);
                                    break;
                                case "center-align":
                                    n.actions.doAction("setHAlign", lt, 1);
                                    break;
                                case "right-align":
                                    n.actions.doAction("setHAlign", lt, 2);
                                    break;
                                case "increase-indent":
                                    n.actions.doAction("setIndent", lt, 1);
                                    break;
                                case "vertical-text":
                                    n.actions.doAction("setTextVertical", lt, $("#vertical-text").prop("checked"));
                                    break;
                                case "decrease-indent":
                                    n.actions.doAction("setIndent", lt, -1);
                                    break;
                                case "wrap-text":
                                    n.actions.doAction("setWordWrap", lt, $("#wrap-text").prop("checked"));
                                    break;
                                case "merge-center":
                                    $("#merge-center").prop("checked") ? n.actions.doAction("mergeCenter", lt) : n.actions.doAction("unmergeCells", lt),
                                        setTimeout(function() {
                                            re()
                                        }, 0);
                                    break;
                                case "merge-center-button":
                                    n.actions.doAction("mergeCenter", lt);
                                    break;
                                case "merge-across":
                                    n.actions.doAction("mergeAcross", lt);
                                    break;
                                case "merge-cells":
                                    n.actions.doAction("mergeCells", lt);
                                    break;
                                case "unmerge-cells":
                                    n.actions.doAction("unmergeCells", lt);
                                    break;
                                case "format-general":
                                    n.actions.doAction("setFormatter", lt, null);
                                    break;
                                case "format-number":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Number.format);
                                    break;
                                case "format-currency":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Currency.format);
                                    break;
                                case "format-accouting":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Accounting.format);
                                    break;
                                case "format-shortdate":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.ShortDate.format);
                                    break;
                                case "format-longdate":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.LongDate.format);
                                    break;
                                case "format-time":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Time.format);
                                    break;
                                case "format-percentage":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Percentage.format);
                                    break;
                                case "format-fraction":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Fraction.format);
                                    break;
                                case "format-scientific":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Scientific.format);
                                    break;
                                case "format-text":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Text.format);
                                    break;
                                case "format-comma":
                                    n.actions.doAction("setFormatter", lt, n.res.commonFormats.Comma.format);
                                    break;
                                case "increase-decimal":
                                    n.actions.doAction("increaseDecimal", lt);
                                    break;
                                case "decrease-decimal":
                                    n.actions.doAction("decreaseDecimal", lt);
                                    break;
                                case "button-celltype":
                                    void 0 === Q && (Q = new n.ButtonCellTypeDialog),
                                        Q.open();
                                    break;
                                case "checkbox-celltype":
                                    void 0 === Z && (Z = new n.CheckBoxCellTypeDialog),
                                        Z.open();
                                    break;
                                case "combobox-celltype":
                                    void 0 === ee && (ee = new n.ComboBoxCellTypeDialog),
                                        ee.open();
                                    break;
                                case "hyperlink-celltype":
                                    void 0 === te && (te = new n.HyperLinkCellTypeDialog),
                                        te.open();
                                    break;
                                case "clear-celltype":
                                    n.actions.doAction("clearCellType", lt);
                                    break;
                                case "conditional-format":
                                    h || (h = $("#condition-format-popup").gcuipopup({
                                        autoHide: !0,
                                        position: {
                                            of: $("#condition-format"),
                                            my: "left top",
                                            at: "left bottom"
                                        },
                                        collision: "fit fit",
                                        showing: function(e, t) {
                                            $("#condition-format-popup-menu").removeClass("hidden")
                                        },
                                        hiding: function() {
                                            return pt()
                                        }
                                    })),
                                        h.gcuipopup("show");
                                    break;
                                case "insert-cells":
                                    switch (g = n.spreadActions.getSelectionType(lt)) {
                                        case 0:
                                            n.MessageBox.show(n.res.insertCellInSheet, n.res.title, 2);
                                            break;
                                        case 2:
                                            n.actions.doAction("insertColumns", lt);
                                            break;
                                        case 1:
                                            n.actions.doAction("insertRows", lt);
                                            break;
                                        case 4:
                                            n.MessageBox.show(n.res.insertCellInMixtureRange, n.res.title, 2);
                                            break;
                                        case 3:
                                            void 0 === T && (T = new n.InsertCellsDialog),
                                                T.open()
                                    }
                                    break;
                                case "insert-rows":
                                    n.actions.doAction("insertRows", lt);
                                    break;
                                case "insert-columns":
                                    n.actions.doAction("insertColumns", lt);
                                    break;
                                case "insert-sheet":
                                    n.actions.doAction("insertSheet", lt);
                                    break;
                                case "delete-cells":
                                    switch (g = n.spreadActions.getSelectionType(lt)) {
                                        case 0:
                                            n.actions.doAction("clearSheetAllCell", lt);
                                            break;
                                        case 2:
                                            n.actions.doAction("deleteColumns", lt);
                                            break;
                                        case 1:
                                            n.actions.doAction("deleteRows", lt);
                                            break;
                                        case 4:
                                            n.MessageBox.show(n.res.insertCellInMixtureRange, n.res.title, 2);
                                            break;
                                        case 3:
                                            void 0 === A && (A = new n.DeleteCellsDialog),
                                                A.open()
                                    }
                                    break;
                                case "delete-rows":
                                    n.actions.doAction("deleteRows", lt);
                                    break;
                                case "delete-columns":
                                    n.actions.doAction("deleteColumns", lt);
                                    break;
                                case "delete-sheet":
                                    n.actions.doAction("deleteSheet", lt);
                                    break;
                                case "set-rowheight":
                                    void 0 === x && (x = new n.RowHeightDialog),
                                        x.open();
                                    break;
                                case "set-columnwidth":
                                    void 0 === w && (w = new n.ColumnWidthDialog),
                                        w.open();
                                    break;
                                case "autofit-rowheight":
                                    n.actions.doAction("autofitRows", lt);
                                    break;
                                case "default-rowheight":
                                    void 0 === C && (C = new n.StandardRowHeightDialog),
                                        C.open();
                                    break;
                                case "hide-rows":
                                    n.actions.doAction("hideRows", lt);
                                    break;
                                case "unhide-rows":
                                    n.actions.doAction("unHideRows", lt);
                                    break;
                                case "autofit-columnwidth":
                                    n.actions.doAction("autofitColumns", lt);
                                    break;
                                case "default-columnwidth":
                                    void 0 === S && (S = new n.StandardColumnWidthDialog),
                                        S.open();
                                    break;
                                case "hide-columns":
                                    n.actions.doAction("hideColumns", lt);
                                    break;
                                case "unhide-columns":
                                    n.actions.doAction("unHideColumns", lt);
                                    break;
                                case "protect-sheet":
                                    $e || ($e = new n.ProtectionOptionDialog),
                                        $e.open();
                                    break;
                                case "unprotect-sheet":
                                    n.actions.doAction("protectSheet", lt, !1);
                                    break;
                                case "lock-cells":
                                    n.actions.doAction("LockCells", lt, !0);
                                    break;
                                case "unlock-cells":
                                    n.actions.doAction("LockCells", lt, !1);
                                    break;
                                case "auto-sum":
                                    n.actions.doAction("setAutoFormula", lt, "Sum");
                                    break;
                                case "auto-average":
                                    n.actions.doAction("setAutoFormula", lt, "Average");
                                    break;
                                case "auto-count":
                                    n.actions.doAction("setAutoFormula", lt, "Count");
                                    break;
                                case "auto-max":
                                    n.actions.doAction("setAutoFormula", lt, "Max");
                                    break;
                                case "auto-min":
                                    n.actions.doAction("setAutoFormula", lt, "Min");
                                    break;
                                case "fill-down":
                                    n.actions.doAction("autoFillByDirection", lt, 3);
                                    break;
                                case "fill-right":
                                    n.actions.doAction("autoFillByDirection", lt, 1);
                                    break;
                                case "fill-up":
                                    n.actions.doAction("autoFillByDirection", lt, 2);
                                    break;
                                case "fill-left":
                                    n.actions.doAction("autoFillByDirection", lt, 0);
                                    break;
                                case "fill-series":
                                    k || (k = new n.FillDialog),
                                        k.open();
                                    break;
                                case "clear-all":
                                    n.actions.doAction("clearAll", lt);
                                    break;
                                case "clear-format":
                                    n.actions.doAction("clearFormat", lt);
                                    break;
                                case "clear-content":
                                    n.actions.doAction("clearContent", lt);
                                    break;
                                case "clear-comments":
                                    n.actions.doAction("clearComments", lt);
                                    break;
                                case "sort-AZ":
                                    n.util.isSlicerSelected(ct) ? n.actions.doAction("sortSlicerItems", lt, 1) : n.actions.doAction("sortRange", lt, !0);
                                    break;
                                case "sort-ZA":
                                    n.util.isSlicerSelected(ct) ? n.actions.doAction("sortSlicerItems", lt, 2) : n.actions.doAction("sortRange", lt, !1);
                                    break;
                                case "custom-sort":
                                    R || (R = new n.SortDialog),
                                        R.open();
                                    break;
                                case "set-filter":
                                    n.actions.doAction("setRowFilter", lt, !0);
                                    break;
                                case "clear-filter":
                                    n.actions.doAction("clearRowFilter", lt);
                                    break;
                                case "reapply-filter":
                                    n.actions.doAction("reApplyRowFilter", lt);
                                    break;
                                case "insert-function":
                                    X || (X = new n.InsertFunctionDialog),
                                        X.open();
                                    break;
                                case "calculate-auto":
                                    n.actions.doAction("autoCalculate", lt, !0);
                                    break;
                                case "calculate-manual":
                                    n.actions.doAction("autoCalculate", lt, !1);
                                    break;
                                case "calculate-now":
                                    n.actions.doAction("calculateNow", lt);
                                    break;
                                case "group":
                                    if (f = ct.getSelections(),
                                        f.length > 1)
                                        return void n.MessageBox.show(n.res.NotExecInMultiRanges, n.res.title, 2);
                                    if (1 === (g = n.spreadActions.getSelectionType(lt))) {
                                        n.actions.doAction("groupRows", n.wrapper.spread);
                                        break
                                    }
                                    if (2 === g) {
                                        n.actions.doAction("groupColumns", n.wrapper.spread);
                                        break
                                    }
                                    void 0 === I && (I = new n.GroupDialog),
                                        I.open();
                                    break;
                                case "ungroup":
                                    if (f = ct.getSelections(),
                                        f.length > 1)
                                        return void n.MessageBox.show(n.res.NotExecInMultiRanges, n.res.title, 2);
                                    if (1 === (g = n.spreadActions.getSelectionType(lt))) {
                                        n.actions.doAction("ungroupRows", n.wrapper.spread);
                                        break
                                    }
                                    if (2 === g) {
                                        n.actions.doAction("ungroupColumns", n.wrapper.spread);
                                        break
                                    }
                                    void 0 === D && (D = new n.UnGroupDialog),
                                        D.open();
                                    break;
                                case "template-design-mode":
                                    y = lt.getActiveSheet(),
                                        H = $("#template-design-mode"),
                                        U = H.find("span.ui-button-text"),
                                        q = H.data("checked"),
                                        q = !q,
                                        q ? (at(),
                                            U.addClass("template-design-mode-checked"),
                                            jt(),
                                            K = $(".slider-panel"),
                                            K.sliderpanel("open", "panel1")) : fe(),
                                        H.data("checked", q),
                                        y.repaint();
                                    break;
                                case "clearBindingPath":
                                    Ye();
                                    break;
                                case "loadSchema":
                                    Je();
                                    break;
                                case "saveSchema":
                                    Ze();
                                    break;
                                case "show-detail":
                                    n.actions.doAction("expandGroup", lt);
                                    break;
                                case "hide-detail":
                                    n.actions.doAction("collapseGroup", lt);
                                    break;
                                case "group-direction":
                                    ie || (ie = new n.GroupDirectionDialog),
                                        ie.open();
                                    break;
                                case "showhide-rowheader":
                                    z("showhide-rowheader"),
                                        n.actions.doAction("showHideRowHeader", lt);
                                    break;
                                case "showhide-columnheader":
                                    z("showhide-columnheader"),
                                        n.actions.doAction("showHideColumnHeader", lt);
                                    break;
                                case "showhide-vgridline":
                                    z("showhide-vgridline"),
                                        n.actions.doAction("showHideVGridLine", lt);
                                    break;
                                case "showhide-hgridline":
                                    z("showhide-hgridline"),
                                        n.actions.doAction("showHideHGridLine", lt);
                                    break;
                                case "showhide-tabstrip":
                                    z("showhide-tabstrip"),
                                        n.actions.doAction("showHideTabStrip", lt);
                                    break;
                                case "showhide-newtab":
                                    z("showhide-newtab"),
                                        n.actions.doAction("showHideNewTab", lt);
                                    break;
                                case "zoom":
                                    oe || (oe = new n.ZoomDialog),
                                        oe.open();
                                    break;
                                case "zoom-default":
                                    n.actions.doAction("zoomDefault", lt);
                                    break;
                                case "zoom-selection":
                                    n.actions.doAction("zoomSelection", lt),
                                        setTimeout(function() {
                                            he()
                                        }, 0);
                                    break;
                                case "freeze-panes":
                                    n.actions.doAction("freeze", lt, {
                                        row: lt.getActiveSheet().getActiveRowIndex(),
                                        col: lt.getActiveSheet().getActiveColumnIndex()
                                    });
                                    break;
                                case "freeze-toprow":
                                    n.actions.doAction("freeze", lt, {
                                        row: 1,
                                        col: 0,
                                        trailingRow: 0,
                                        trailingCol: 0
                                    });
                                    break;
                                case "freeze-firstcolumn":
                                    n.actions.doAction("freeze", lt, {
                                        row: 0,
                                        col: 1,
                                        trailingRow: 0,
                                        trailingCol: 0
                                    });
                                    break;
                                case "freeze-bottomrow":
                                    n.actions.doAction("freeze", lt, {
                                        row: 0,
                                        col: 0,
                                        trailingRow: 1,
                                        trailingCol: 0
                                    });
                                    break;
                                case "freeze-lastcolumn":
                                    n.actions.doAction("freeze", lt, {
                                        row: 0,
                                        col: 0,
                                        trailingRow: 0,
                                        trailingCol: 1
                                    });
                                    break;
                                case "unfreeze-panes":
                                    n.actions.doAction("unfreeze", lt);
                                    break;
                                case "fontgroup":
                                    m = n.formatCellDialog,
                                    void 0 === m && (m = new n.FormatDialog,
                                        n.formatCellDialog = m),
                                        m.open("font");
                                    break;
                                case "aligngroup":
                                    m = n.formatCellDialog,
                                    void 0 === m && (m = new n.FormatDialog,
                                        n.formatCellDialog = m),
                                        m.open("alignment");
                                    break;
                                case "format-more":
                                case "numbergroup":
                                    m = n.formatCellDialog,
                                    void 0 === m && (m = new n.FormatDialog,
                                        n.formatCellDialog = m),
                                        m.open("number");
                                    break;
                                case "find":
                                    void 0 === F && (F = new n.FindDialog),
                                        F.open();
                                    break;
                                case "goto":
                                    void 0 === M && (M = new n.GoToDialog),
                                        M.open();
                                    break;
                                case "spark-line":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(0);
                                    break;
                                case "spark-column":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(1);
                                    break;
                                case "spark-winloss":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(2);
                                    break;
                                case "spark-pie":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(0, !0);
                                    break;
                                case "spark-area":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(1, !0);
                                    break;
                                case "spark-scatter":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(2, !0);
                                    break;
                                case "spark-bullet":
                                    ye || (ye = new n.BulletSparklineDialog),
                                        ye.open();
                                    break;
                                case "spark-spread":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(5, !0);
                                    break;
                                case "spark-stacked":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(6, !0);
                                    break;
                                case "spark-hbar":
                                    Ce || (Ce = new n.HbarSparklineDialog),
                                        Ce.open();
                                    break;
                                case "spark-vbar":
                                    Se || (Se = new n.VbarSparklineDialog),
                                        Se.open();
                                    break;
                                case "spark-variance":
                                    ke || (ke = new n.VariSparklineDialog),
                                        ke.open();
                                    break;
                                case "spark-boxplot":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(10, !0);
                                    break;
                                case "spark-cascade":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(11, !0);
                                    break;
                                case "spark-pareto":
                                    ne || (ne = new n.InsertSparkLineDialog),
                                        ne.open(12, !0);
                                    break;
                                case "spark-month":
                                    Ee || (Ee = new n.CalendarSparklineDialog(0)),
                                        Ee.open();
                                    break;
                                case "spark-year":
                                    Ve || (Ve = new n.CalendarSparklineDialog(1)),
                                        Ve.open();
                                    break;
                                case "name-manager":
                                    W || (W = new n.NameManagerDialog),
                                        W.open();
                                    break;
                                case "spread-setting-general":
                                    V || (V = new n.SpreadSettingDialog),
                                        V.open("general");
                                    break;
                                case "spread-setting-scrollbar":
                                    V || (V = new n.SpreadSettingDialog),
                                        V.open("scrollbar");
                                    break;
                                case "spread-setting-tabstrip":
                                    V || (V = new n.SpreadSettingDialog),
                                        V.open("tabstrip");
                                    break;
                                case "sheet-setting-general":
                                    P || (P = new n.SheetSettingDialog),
                                        P.open("general");
                                    break;
                                case "sheet-setting-gridline":
                                    P || (P = new n.SheetSettingDialog),
                                        P.open("gridline");
                                    break;
                                case "sheet-setting-calculation":
                                    P || (P = new n.SheetSettingDialog),
                                        P.open("calculation");
                                    break;
                                case "sheet-setting-headers":
                                    P || (P = new n.SheetSettingDialog),
                                        P.open("headers");
                                    break;
                                case "data-validation":
                                    _ || (_ = new n.DataValidationDialog),
                                        _.open();
                                    break;
                                case "circle-invalid":
                                    n.actions.doAction("circleInvalidData", lt);
                                    break;
                                case "clear-circle":
                                    n.actions.doAction("unCircleInvalidData", lt);
                                    break;
                                case "insert-table":
                                    ce || (ce = new n.CreateTableDialog),
                                        ce.open();
                                    break;
                                case "insert-chart":
                                    if (n.ribbon.selectChartDialog || (n.ribbon.selectChartDialog = new n.SelectChartDialog),
                                        !(Y = ct.getSelections()[0]) || 1 === Y.rowCount && 1 === Y.colCount && null === n.wrapper.spread.getActiveSheet().getValue(Y.row, Y.col))
                                        return void n.MessageBox.show(n.res.selectChartDialog.errorPrompt.emptyDataErrorMsg, n.res.title, 2);
                                    n.ribbon.selectChartDialog.open(n.SelectChartDialog.dialogType.insertChart);
                                    break;
                                case "insert-picture":
                                    De = {
                                        title: n.res.insertPictureDialogTitle,
                                        action: "insertPicture",
                                        filters: "image/*",
                                        nameFilters: [n.res.pictureFormatFilter.png, n.res.pictureFormatFilter.jpeg, n.res.pictureFormatFilter.bmp, n.res.pictureFormatFilter.allFiles]
                                    },
                                        Ge = function(e) {
                                            "cancelled" !== e.status && n.actions.doAction("insertPicture", lt, e.data)
                                        }
                                        ,
                                        p.showOpenDialog(De, Ge);
                                    break;
                                case "sparkline-type-line":
                                    n.actions.doAction("setSparklineType", lt, 0);
                                    break;
                                case "sparkline-type-column":
                                    n.actions.doAction("setSparklineType", lt, 1);
                                    break;
                                case "sparkline-type-winloss":
                                    n.actions.doAction("setSparklineType", lt, 2);
                                    break;
                                case "sparkline-high-point":
                                    z("sparkline-high-point"),
                                        n.actions.doAction("setSparklineSetting", lt, [j("sparkline-high-point"), "showHigh"]);
                                    break;
                                case "sparkline-low-point":
                                    z("sparkline-low-point"),
                                        n.actions.doAction("setSparklineSetting", lt, [j("sparkline-low-point"), "showLow"]);
                                    break;
                                case "sparkline-first-point":
                                    z("sparkline-first-point"),
                                        n.actions.doAction("setSparklineSetting", lt, [j("sparkline-first-point"), "showFirst"]);
                                    break;
                                case "sparkline-last-point":
                                    z("sparkline-last-point"),
                                        n.actions.doAction("setSparklineSetting", lt, [j("sparkline-last-point"), "showLast"]);
                                    break;
                                case "sparkline-negative-point":
                                    z("sparkline-negative-point"),
                                        n.actions.doAction("setSparklineSetting", lt, [j("sparkline-negative-point"), "showNegative"]);
                                    break;
                                case "sparkline-marker-point":
                                    z("sparkline-marker-point"),
                                        n.actions.doAction("setSparklineSetting", lt, [j("sparkline-marker-point"), "showMarkers"]);
                                    break;
                                case "sparkline-group":
                                    n.actions.doAction("groupSparkline", lt);
                                    break;
                                case "sparkline-ungroup":
                                    n.actions.doAction("unGroupSparkline", lt);
                                    break;
                                case "sparkline-clear":
                                    n.actions.doAction("clearSparkline", lt);
                                    break;
                                case "sparkline-clear-group":
                                    n.actions.doAction("clearSparklineGroup", lt);
                                    break;
                                case "sparkline-color":
                                    u || ($("#sparklinecolor-picker").colorpicker({
                                        valueChanged: function(e, t) {
                                            t.name ? n.actions.doAction("setSparklineSetting", n.wrapper.spread, [t.name, "seriesColor"]) : n.actions.doAction("setSparklineSetting", n.wrapper.spread, [t.color, "seriesColor"])
                                        },
                                        choosedColor: function(e, t) {
                                            u.gcuipopup("hide")
                                        },
                                        openColorDialog: function() {
                                            u.gcuipopup("hide")
                                        }
                                    }),
                                        u = $("#sparklinecolor-popup").gcuipopup({
                                            autoHide: !0,
                                            position: {
                                                of: $("#sparkline-color"),
                                                my: "left top",
                                                at: "left bottom"
                                            },
                                            showing: function(e, t) {
                                                $("#sparklinecolor-picker").colorpicker("option", "themeColors", n.wrapper.getThemeColors())
                                            }
                                        })),
                                        u.gcuipopup("show");
                                    break;
                                case "sparkline-marker-color":
                                    se || (se = new n.SparklineMarkerColorDialog),
                                        se.open();
                                    break;
                                case "sparkline-weight-dot25":
                                    n.actions.doAction("setSparklineSetting", lt, [.25, "lineWeight"]);
                                    break;
                                case "sparkline-weight-dot5":
                                    n.actions.doAction("setSparklineSetting", lt, [.5, "lineWeight"]);
                                    break;
                                case "sparkline-weight-dot75":
                                    n.actions.doAction("setSparklineSetting", lt, [.75, "lineWeight"]);
                                    break;
                                case "sparkline-weight-1":
                                    n.actions.doAction("setSparklineSetting", lt, [1, "lineWeight"]);
                                    break;
                                case "sparkline-weight-1dot5":
                                    n.actions.doAction("setSparklineSetting", lt, [1.5, "lineWeight"]);
                                    break;
                                case "sparkline-weight-2dot25":
                                    n.actions.doAction("setSparklineSetting", lt, [2.25, "lineWeight"]);
                                    break;
                                case "sparkline-weight-3":
                                    n.actions.doAction("setSparklineSetting", lt, [3, "lineWeight"]);
                                    break;
                                case "sparkline-weight-4dot5":
                                    n.actions.doAction("setSparklineSetting", lt, [4.5, "lineWeight"]);
                                    break;
                                case "sparkline-weight-6":
                                    n.actions.doAction("setSparklineSetting", lt, [6, "lineWeight"]);
                                    break;
                                case "sparkline-weight-custom":
                                    ae || (ae = new n.SparklineWeightDialog),
                                        ae.open();
                                    break;
                                case "resize-table":
                                    de || (de = new n.ResizeTableDialog),
                                        de.open();
                                    break;
                                case "table-header-row":
                                    z("table-header-row"),
                                        n.actions.doAction("setTableHeaderRow", lt, j("table-header-row"));
                                    break;
                                case "table-total-row":
                                    z("table-total-row"),
                                        n.actions.doAction("setTableTotalRow", lt, j("table-total-row"));
                                    break;
                                case "table-banded-rows":
                                    z("table-banded-rows"),
                                        n.actions.doAction("setTableBandedRows", lt, j("table-banded-rows"));
                                    break;
                                case "table-first-column":
                                    z("table-first-column"),
                                        n.actions.doAction("setTableFirstColumn", lt, j("table-first-column"));
                                    break;
                                case "table-last-column":
                                    z("table-last-column"),
                                        n.actions.doAction("setTableLastColumn", lt, j("table-last-column"));
                                    break;
                                case "table-banded-columns":
                                    z("table-banded-columns"),
                                        n.actions.doAction("setTableBandedColumns", lt, j("table-banded-columns"));
                                    break;
                                case "table-filter-button":
                                    z("table-filter-button"),
                                        n.actions.doAction("setTableFilterButton", lt, j("table-filter-button"));
                                    break;
                                case "table-styles":
                                    le || (je(),
                                        le = $("#format-table-popup").gcuipopup({
                                            autoHide: !0,
                                            showing: function(e, i) {
                                                $("#format-table-popup span.container-span").removeClass("table-format-item-selected"),
                                                t && $("#format-table-popup span.table-format-preview." + t).parent().addClass("table-format-item-selected"),
                                                    gt(),
                                                    $("#format-table-popup").removeClass("hidden")
                                            }
                                        })),
                                        Me(),
                                        le.gcuipopup({
                                            position: {
                                                of: $("#table-styles-button"),
                                                my: "left top",
                                                at: "right top"
                                            }
                                        }),
                                        le.gcuipopup("show");
                                    break;
                                case "format-table":
                                    le || (je(),
                                        le = $("#format-table-popup").gcuipopup({
                                            autoHide: !0,
                                            position: {
                                                of: $("#format-table-button"),
                                                my: "left top",
                                                at: "left bottom"
                                            },
                                            showing: function(e, t) {
                                                gt()
                                            }
                                        })),
                                        Me(),
                                        le.gcuipopup({
                                            position: {
                                                of: $("#format-table-button"),
                                                my: "left top",
                                                at: "left bottom"
                                            }
                                        }),
                                        le.gcuipopup("show");
                                    break;
                                case "cell-styles":
                                    pe || (pe = $("#cell-styles-popup").gcuipopup({
                                        autoHide: !0,
                                        position: {
                                            of: $("#cell-styles-button"),
                                            my: "left top",
                                            at: "left bottom"
                                        },
                                        showing: function(e, t) {
                                            $("#cell-styles-popup").removeClass("hidden")
                                        }
                                    })),
                                        ge(),
                                        pe.gcuipopup("show");
                                    break;
                                case "formulaSparkline-setting":
                                    if (He = ct.getActiveRowIndex(),
                                            Ue = ct.getActiveColumnIndex(),
                                            !(We = n.util.parseFormulaSparkline(He, Ue)))
                                        break;
                                    if (_e = n.wrapper.spread.getSparklineEx(We.functionName),
                                            qe = {
                                                row: He,
                                                col: Ue
                                            },
                                            _e)
                                        if (_e instanceof o.Sparklines.PieSparkline)
                                            ue || (ue = new n.PieSparklineDialog),
                                                ue.open(qe);
                                        else if (_e instanceof o.Sparklines.AreaSparkline)
                                            me || (me = new n.AreaSparklineDialog),
                                                me.open(qe);
                                        else if (_e instanceof o.Sparklines.ScatterSparkline)
                                            be || (be = new n.ScatterSparklineDialog),
                                                be.open(qe);
                                        else if (_e instanceof o.Sparklines.LineSparkline || _e instanceof o.Sparklines.ColumnSparkline || _e instanceof o.Sparklines.WinlossSparkline)
                                            ve || (ve = new n.CompatibleSparklineDialog),
                                                ve.open(qe);
                                        else if (_e instanceof o.Sparklines.BulletSparkline)
                                            ye || (ye = new n.BulletSparklineDialog),
                                                ye.open();
                                        else if (_e instanceof o.Sparklines.SpreadSparkline)
                                            xe || (xe = new n.SpreadSparklineDialog),
                                                xe.open();
                                        else if (_e instanceof o.Sparklines.StackedSparkline)
                                            we || (we = new n.StackedSparklineDialog),
                                                we.open();
                                        else if (_e instanceof o.Sparklines.HBarSparkline)
                                            Ce || (Ce = new n.HbarSparklineDialog),
                                                Ce.open();
                                        else if (_e instanceof o.Sparklines.VBarSparkline)
                                            Se || (Se = new n.VbarSparklineDialog),
                                                Se.open();
                                        else if (_e instanceof o.Sparklines.VariSparkline)
                                            ke || (ke = new n.VariSparklineDialog),
                                                ke.open();
                                        else if (_e instanceof o.Sparklines.BoxPlotSparkline)
                                            Te || (Te = new n.BoxPlotSparklineDialog),
                                                Te.open();
                                        else if (_e instanceof o.Sparklines.CascadeSparkline)
                                            Ae || (Ae = new n.CascadeSparklineDialog),
                                                Ae.open();
                                        else if (_e instanceof o.Sparklines.ParetoSparkline)
                                            Ie || (Ie = new n.ParetoSparklineDialog),
                                                Ie.open();
                                        else if (_e instanceof o.Sparklines.MonthSparkline)
                                            Ee || (Ee = new n.CalendarSparklineDialog(0)),
                                                Ee.open(!0);
                                        else if (_e instanceof o.Sparklines.YearSparkline) {
                                            Ve || (Ve = new n.CalendarSparklineDialog(1)),
                                                Ve.open(!0);
                                            break
                                        }
                                    break;
                                case "auto-generate-label":
                                    z("auto-generate-label"),
                                        L = !L;
                                    break;
                                case "insert-slicer":
                                    Ke = ct.tables.find(ct.getActiveRowIndex(), ct.getActiveColumnIndex()),
                                    Ke && (Fe || (Fe = new n.InsertSlicerDialog),
                                        Fe.open(Ke));
                                    break;
                                case "slicer-styles":
                                    Le || (Zt(),
                                        Le = $("#format-slicer-popup").gcuipopup({
                                            autoHide: !0,
                                            showing: function(e, t) {
                                                var i, o;
                                                $("#format-slicer-popup span.container-span").removeClass("slicer-format-item-selected"),
                                                    i = n.util.getSelectedSlicers(ct),
                                                    o = i && i[0] && i[0].style() && i[0].style().name().toLowerCase() || "",
                                                o && (o = o.substr(11),
                                                    $("#format-slicer-popup span.slicer-format-" + o).parent().addClass("slicer-format-item-selected")),
                                                    $("#format-slicer-popup").removeClass("hidden")
                                            }
                                        }));
                                    for (Xe in n.SlicerStyleDialog.customSlicerStyle)
                                        Xe ? (Qe = Xe.substring(0, Xe.indexOf("-")),
                                            $(".custom-format-slicer").css("display", "block"),
                                            et = "slicer-format-" + Qe,
                                            $("." + et).css("display", "inline-block")) : $(".custom-format-slicer").css("display", "none");
                                    Le.gcuipopup({
                                        position: {
                                            of: $("#slicer-styles-button"),
                                            my: "left top",
                                            at: "left bottom"
                                        }
                                    }),
                                        Le.gcuipopup("show");
                                    break;
                                case "slicer-setting":
                                    e.slicerSettingDialog || (e.slicerSettingDialog = new n.SlicerSettingDialog),
                                    n.util.isSlicerSelected(ct) && e.slicerSettingDialog.open();
                                    break;
                                case "quick-layout":
                                    dt && (s.getChartGroupString(dt.chartType()) === s.chartTypeDict[50].chartGroup ? tt = s.chartTypeDict[50].chartGroup : dt.series().get(0) && (tt = s.getChartGroupString(dt.series().get(0).chartType)),
                                    Re || (Re = $("#ribbon-chart-layout-list-popup").gcuipopup({
                                        autoHide: !0,
                                        position: {
                                            of: $("#quick-layout"),
                                            my: "left top",
                                            at: "left bottom"
                                        }
                                    }),
                                        it = $(".chart-layout-list-container"),
                                        Be = new d(it,tt,function(e, t) {
                                                Re.gcuipopup("hide"),
                                                    n.actions.doAction("setChartLayout", n.wrapper.spread, {
                                                        layouts: t
                                                    })
                                            }
                                        )),
                                        Be._setOption(tt),
                                        Re.gcuipopup("show"));
                                    break;
                                case "change-colors":
                                    a || (ot = N.chartColors,
                                        Pe = new B($("#chart-color-picker"),ut(ot)),
                                        Pe.onSelectedColorChanged = function(e) {
                                            var t = e.group
                                                , i = e.index;
                                            a.gcuipopup("hide"),
                                                n.actions.doAction("changeChartSeriesColor", n.wrapper.spread, {
                                                    group: t,
                                                    index: i
                                                })
                                        }
                                        ,
                                        a = $("#chart-color-popup").gcuipopup({
                                            autoHide: !0
                                        }),
                                        a.gcuipopup({
                                            position: {
                                                of: $("#change-colors"),
                                                my: "left top",
                                                at: "left bottom"
                                            }
                                        })),
                                        a.gcuipopup("show"),
                                        nt = dt.colorAndStyle && dt.colorAndStyle.color,
                                        rt = "colorful",
                                        st = 0,
                                    nt && (rt = nt.group,
                                        st = nt.index),
                                        Pe.setSelectedItem(rt, st);
                                    break;
                                case "change-styles":
                                    Ne || (Ne = $("#ribbon-chart-styles-list-popup").gcuipopup({
                                        autoHide: !0,
                                        position: {
                                            of: $("#chart-styles"),
                                            my: "left top",
                                            at: "left bottom"
                                        }
                                    })),
                                    dt && (J(Ne, dt),
                                        Ne.gcuipopup("show"));
                                    break;
                                case "switch-row-column":
                                    n.actions.doAction("switchChartRowCol", n.wrapper.spread);
                                    break;
                                case "select-data":
                                    e.chartSelectDataDialog || (e.chartSelectDataDialog = new n.ChartSelectDataDialog),
                                        e.chartSelectDataDialog.open(dt);
                                    break;
                                case "change-chart-type":
                                    e.selectChartDialog || (e.selectChartDialog = new n.SelectChartDialog),
                                    dt && e.selectChartDialog.open(n.SelectChartDialog.dialogType.changeChartType, dt);
                                    break;
                                case "move-chart":
                                    e.moveChartDialog || (e.moveChartDialog = new n.MoveChartDialog),
                                        e.moveChartDialog.open();
                                    break;
                                case "add-chart-element":
                                    ze || (ze = new E(document.getElementById("add-chart-element-container")),
                                        ze.On = function() {
                                            Oe.gcuipopup("hide")
                                        }
                                        ,
                                        Oe = $("#add-chart-element-popup").gcuipopup({
                                            autoHide: !0,
                                            position: {
                                                of: $("#add-chart-element"),
                                                my: "left top",
                                                at: "left bottom"
                                            },
                                            collision: "fit fit",
                                            showing: function() {
                                                ze.xn()
                                            },
                                            hiding: function() {
                                                ze.Qn()
                                            }
                                        })),
                                        Oe.gcuipopup("show")
                            }
                            switch (c.commandName) {
                                case "paste-all":
                                case "paste-formulas":
                                case "paste-values":
                                case "paste-formatting":
                                    setTimeout(function() {
                                        $("#paste-options").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-paste"),
                                            $("#paste-options").find(".ui-button-text").text(n.res.ribbon.home.paste).append('<span class="ui-custom-triangle2"></span>')
                                    }, 0);
                                    break;
                                case "freeze-panes":
                                case "freeze-toprow":
                                case "freeze-firstcolumn":
                                case "freeze-bottomrow":
                                case "freeze-lastcolumn":
                                    setTimeout(function() {
                                        $("#freeze-panes").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-freeze"),
                                            $("#freeze-panes").find(".ui-button-text").html(n.res.ribbon.view.freezePane).append('<span class="ui-custom-triangle"></span>')
                                    }, 0);
                                    break;
                                case "format-more":
                                    setTimeout(function() {
                                        $("#number-format").find(".ui-button-text").text(n.res.ribbon.home.general)
                                    }, 0);
                                    break;
                                case "set-rowheight":
                                case "set-columnwidth":
                                case "autofit-rowheight":
                                case "default-rowheight":
                                case "hide-rows":
                                case "unhide-rows":
                                case "autofit-columnwidth":
                                case "default-columnwidth":
                                case "hide-columns":
                                case "unhide-columns":
                                case "protect-sheet":
                                case "unprotect-sheet":
                                case "lock-cells":
                                case "unlock-cells":
                                    setTimeout(function() {
                                        $("#format-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-format"),
                                            $("#format-row-column").find(".ui-button-text").text(n.res.ribbon.home.format).append('<span class="ui-custom-triangle2"></span>')
                                    }, 0);
                                    break;
                                case "find":
                                case "goto":
                                    setTimeout(function() {
                                        $("#find-goto").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-find"),
                                            $("#find-goto").find(".ui-button-text").text(n.res.ribbon.home.find).append('<span class="ui-custom-triangle"></span>')
                                    }, 0);
                                    break;
                                case "sort-AZ":
                                case "sort-ZA":
                                case "custom-sort":
                                case "set-filter":
                                case "clear-filter":
                                case "reapply-filter":
                                    setTimeout(function() {
                                        $("#sort-filter").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-sortfilter"),
                                            $("#sort-filter").find(".ui-button-text").html(n.res.ribbon.home.sortFilter).append('<span class="ui-custom-triangle"></span>')
                                    }, 0);
                                    break;
                                case "insert-cells":
                                case "insert-rows":
                                case "insert-columns":
                                case "insert-sheet":
                                    setTimeout(function() {
                                        $("#insert-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-insert"),
                                            $("#insert-row-column").find(".ui-button-text").text(n.res.ribbon.home.insert).append('<span class="ui-custom-triangle2"></span>')
                                    }, 0);
                                    break;
                                case "delete-cells":
                                case "delete-rows":
                                case "delete-columns":
                                case "delete-sheet":
                                    setTimeout(function() {
                                        $("#delete-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-delete"),
                                            $("#delete-row-column").find(".ui-button-text").text(n.res.ribbon.home.Delete).append('<span class="ui-custom-triangle2"></span>')
                                    }, 0);
                                    break;
                                case "sparkline-weight-dot25":
                                case "sparkline-weight-dot5":
                                case "sparkline-weight-dot75":
                                case "sparkline-weight-1":
                                case "sparkline-weight-1dot5":
                                case "sparkline-weight-2dot25":
                                case "sparkline-weight-3":
                                case "sparkline-weight-4dot5":
                                case "sparkline-weight-6":
                                case "sparkline-weight-custom":
                                    setTimeout(function() {
                                        $("#sparkline-weight").find(".ui-button-text").text(n.res.ribbon.sparkLineDesign.sparklineWeight)
                                    }, 0);
                                    break;
                                case "bottom-border":
                                case "top-border":
                                case "left-border":
                                case "right-border":
                                case "no-border":
                                case "all-border":
                                case "outside-border":
                                case "thickbox-border":
                                case "bottom-double-border":
                                case "thick-bottom-border":
                                case "top-bottom-border":
                                case "top-thick-bottom-border":
                                case "top-double-bottom-border":
                                case "more-border":
                                    setTimeout(function() {
                                        $("#borders").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-bottomborder")
                                    }, 0)
                            }
                            switch (c.commandName) {
                                case "protect-sheet":
                                    $(".ribbon-bar").find("#protect-sheet").addClass("hidden"),
                                        $(".ribbon-bar").find("#unprotect-sheet").removeClass("hidden");
                                    break;
                                case "unprotect-sheet":
                                    $(".ribbon-bar").find("#protect-sheet").removeClass("hidden"),
                                        $(".ribbon-bar").find("#unprotect-sheet").addClass("hidden");
                                    break;
                                case "lock-cells":
                                    $(".ribbon-bar").find("#lock-cells").addClass("hidden"),
                                        $(".ribbon-bar").find("#unlock-cells").removeClass("hidden");
                                    break;
                                case "unlock-cells":
                                    $(".ribbon-bar").find("#lock-cells").removeClass("hidden"),
                                        $(".ribbon-bar").find("#unlock-cells").addClass("hidden")
                            }
                        }
                    }),
                        $("#rotate-text-popup-menu").addClass("hidden");
                    function ut(e) {
                        var t, i, o, n = {};
                        for (t in e)
                            e.hasOwnProperty(t) && (i = e[t],
                                o = {},
                                o.name = i.name,
                                o.colors = ht(i.colors, 6),
                                n[t] = o);
                        return n
                    }
                    function ht(e, t) {
                        var i = [];
                        return e.forEach(function(e) {
                            var o, n = {};
                            n.tip = e.tip,
                                o = e.items,
                            o instanceof Array || (o = s.getGradientThemeColor(o.startColor, o.stopColor, t)),
                                n.items = ft(o),
                                i.push(n)
                        }),
                            i
                    }
                    function ft(e) {
                        var t = n.wrapper.spread.getActiveSheet().currentTheme();
                        return e.map(function(e) {
                            return l.parse(e, t).color
                        })
                    }
                    function gt() {
                        var e = 18
                            , t = $("#format-table-popup")
                            , i = $(window).height() - $(".ribbon").height();
                        t.height() >= i ? (t.hasClass("scroll") || (t.addClass("scroll"),
                            t.width(t.width() + e)),
                            t.height(i)) : (t.hasClass("scroll") && t.width(t.width() - e),
                            t.removeClass("scroll"))
                    }
                    He = function(e, t) {
                        var i = e.find("ul");
                        return e.gcuipopup({
                            autoHide: !0,
                            position: {
                                of: t,
                                my: "left top",
                                at: "right top"
                            },
                            collision: "fit fit",
                            showing: function(e, t) {
                                i.removeClass("hidden")
                            }
                        })
                    }
                        ,
                        Ue = function(e, t) {
                            var i;
                            void 0 === t ? (i = setTimeout(function() {
                                e.children("ul").addClass("hidden"),
                                    dt.splice(dt.indexOf(i), 1),
                                    Ge = c
                            }, 0),
                                dt.push(i)) : (i = setTimeout(function() {
                                e.children("ul").addClass("hidden"),
                                    dt.splice(dt.indexOf(i), 1),
                                    Ge = c
                            }, t),
                                dt.push(i))
                        }
                        ,
                        We = function(e, t, i) {
                            var o, n;
                            if (!(Ge && Ge.is(e) && Ge.gcuipopup("isVisible"))) {
                                for (Ge && Ue(Ge),
                                         o = 0; o < ct.length; o++)
                                    clearTimeout(ct[o]);
                                ct = [],
                                    void 0 === i ? (n = setTimeout(function() {
                                        e.gcuipopup("show"),
                                            ct.splice(ct.indexOf(n), 1),
                                            Ge = e
                                    }, 0),
                                        ct.push(n)) : (n = setTimeout(function() {
                                        e.gcuipopup("show"),
                                            ct.splice(ct.indexOf(n), 1),
                                            Ge = e
                                    }, i),
                                        ct.push(n))
                            }
                        }
                        ,
                        $("#condition-format-popup button").on("mouseenter", function(e) {
                            var t, i = e.currentTarget, o = $(i).children("span.ui-button-text-big");
                            switch (0 === o.length && (o = $(i).children("span.ui-button-text-small"),
                            0 === o.length && (o = $(i).children("span.icon-button-container"))),
                                $(o).addClass("ui-state-hover"),
                                i.name) {
                                case "highlight-cells-rules":
                                    f || (f = He($("#highlight-cells-rules-popup"), $(i))),
                                        We(f, $(i), Xe);
                                    break;
                                case "top-bottom-rules":
                                    g || (g = He($("#top-bottom-rules-popup"), $(i))),
                                        We(g, $(i), Xe);
                                    break;
                                case "data-bars":
                                    m || (m = He($("#data-bars-popup"), $(i))),
                                        We(m, $(i), Xe);
                                    break;
                                case "color-scales":
                                    b || (b = He($("#color-scales-popup"), $(i))),
                                        We(b, $(i), Xe);
                                    break;
                                case "icon-sets":
                                    v || (v = He($("#icon-sets-popup"), $(i))),
                                        We(v, $(i), Xe);
                                    break;
                                case "clear-rules":
                                    y || (y = He($("#clear-rules-popup"), $(i))),
                                        We(y, $(i), Xe);
                                    break;
                                case "new-rule":
                                case "manage-rules":
                                    for (t = 0; t < ct.length; t++)
                                        clearTimeout(ct[t]);
                                    ct = [],
                                    Ge && Ue(Ge)
                            }
                        }),
                        $("#condition-format-popup button").on("mouseleave", function(e) {
                            var t = e.currentTarget
                                , i = $(t).children("span.ui-button-text-big");
                            0 === i.length && (i = $(t).children("span.ui-button-text-small"),
                            0 === i.length && (i = $(t).children("span.icon-button-container"))),
                                $(i).removeClass("ui-state-hover")
                        }),
                        _e = function(e, t) {
                            var i, o = n.wrapper.spread.getActiveSheet(), r = o.getSelections();
                            i = 0 === arguments.length ? new GC.Spread.Sheets.ConditionalFormatting.DataBarRule : new GC.Spread.Sheets.ConditionalFormatting.DataBarRule(5,"(Automatic)",7,"(Automatic)",e,r),
                                i.gradient(t),
                                n.actions.doAction("addRule", n.wrapper.spread, {
                                    rule: i,
                                    isRemove: !0
                                })
                        }
                        ,
                        qe = function(e, t, i) {
                            var r, a, s = n.wrapper.spread.getActiveSheet(), l = s.getSelections(), c = 2, d = null, p = e, u = 1, h = null, f = t;
                            i ? (a = t,
                                f = i,
                                r = new o.ConditionalFormatting.ScaleRule(11,u,h,f,Qe,et,a,c,d,p,l)) : r = new o.ConditionalFormatting.ScaleRule(10,u,h,f,null,null,null,c,d,p,l),
                                n.actions.doAction("addRule", n.wrapper.spread, {
                                    rule: r,
                                    isRemove: !0
                                })
                        }
                        ,
                        Ke = function(e) {
                            var t = n.wrapper.spread.getActiveSheet()
                                , i = t.getSelections()
                                , r = new o.ConditionalFormatting.IconSetRule(e,i);
                            n.actions.doAction("addRule", n.wrapper.spread, {
                                rule: r,
                                isRemove: !0
                            })
                        }
                        ,
                        $("#condition-format-popup button").on("click", function(e) {
                            var t = e.currentTarget;
                            switch (t.name) {
                                case "highlight-cells-rules":
                                    f || (f = He($("#highlight-cells-rules-popup"), $(t))),
                                        We(f, $(t));
                                    break;
                                case "top-bottom-rules":
                                    g || (g = He($("#top-bottom-rules-popup"), $(t))),
                                        We(g, $(t));
                                    break;
                                case "data-bars":
                                    m || (m = He($("#data-bars-popup"), $(t))),
                                        We(m, $(t));
                                    break;
                                case "color-scales":
                                    b || (b = He($("#color-scales-popup"), $(t))),
                                        We(b, $(t));
                                    break;
                                case "icon-sets":
                                    v || (v = He($("#icon-sets-popup"), $(t))),
                                        We(v, $(t));
                                    break;
                                case "clear-rules":
                                    y || (y = He($("#clear-rules-popup"), $(t))),
                                        We(y, $(t));
                                    break;
                                case "manage-rules":
                                    lt.open(),
                                        pt();
                                    break;
                                case "highlight-cells-rules-greater-than":
                                    tt.open(0),
                                        pt();
                                    break;
                                case "highlight-cells-rules-less-than":
                                    tt.open(1),
                                        pt();
                                    break;
                                case "highlight-cells-rules-between":
                                    tt.open(2),
                                        pt();
                                    break;
                                case "highlight-cells-rules-equal-to":
                                    tt.open(3),
                                        pt();
                                    break;
                                case "highlight-cells-rules-text-contains":
                                    it.open(),
                                        pt();
                                    break;
                                case "highlight-cells-rules-a-date-occurring":
                                    ot.open(),
                                        pt();
                                    break;
                                case "highlight-cells-rules-duplicate-values":
                                    nt.open(),
                                        pt();
                                    break;
                                case "highlight-cells-rules-more-rules":
                                    De || (De = new n.NewFormattingRuleDialog,
                                        $(De).on("dialogClose", function(e, t) {
                                            De = null
                                        })),
                                        De.open(1, !0, void 0, void 0, void 0, 4),
                                        pt();
                                    break;
                                case "top-bottom-rules-top-10-items":
                                    rt.open(4),
                                        pt();
                                    break;
                                case "top-bottom-rules-bottom-10-items":
                                    rt.open(5),
                                        pt();
                                    break;
                                case "top-bottom-rules-above-average":
                                    st.open(6),
                                        pt();
                                    break;
                                case "top-bottom-rules-below-average":
                                    st.open(7),
                                        pt();
                                    break;
                                case "top-bottom-rules-more-rules":
                                    De || (De = new n.NewFormattingRuleDialog,
                                        $(De).on("dialogClose", function(e, t) {
                                            De = null
                                        })),
                                        De.open(2, !0),
                                        pt();
                                    break;
                                case "gradient-fill-blue-data-bar":
                                    _e("blue", !0),
                                        pt();
                                    break;
                                case "gradient-fill-green-data-bar":
                                    _e("green", !0),
                                        pt();
                                    break;
                                case "gradient-fill-red-data-bar":
                                    _e("red", !0),
                                        pt();
                                    break;
                                case "gradient-fill-orange-data-bar":
                                    _e("orange", !0),
                                        pt();
                                    break;
                                case "gradient-fill-lightblue-data-bar":
                                    _e("lightblue", !0),
                                        pt();
                                    break;
                                case "gradient-fill-purple-data-bar":
                                    _e("purple", !0),
                                        pt();
                                    break;
                                case "solid-fill-blue-data-bar":
                                    _e("blue", !1),
                                        pt();
                                    break;
                                case "solid-fill-green-data-bar":
                                    _e("green", !1),
                                        pt();
                                    break;
                                case "solid-fill-red-data-bar":
                                    _e("red", !1),
                                        pt();
                                    break;
                                case "solid-fill-orange-data-bar":
                                    _e("orange", !1),
                                        pt();
                                    break;
                                case "solid-fill-lightblue-data-bar":
                                    _e("lightblue", !1),
                                        pt();
                                    break;
                                case "solid-fill-purple-data-bar":
                                    _e("purple", !1),
                                        pt();
                                    break;
                                case "data-bars-more-rules":
                                    De || (De = new n.NewFormattingRuleDialog,
                                        $(De).on("dialogClose", function(e, t) {
                                            De = null
                                        })),
                                        De.open(0, !0, 2),
                                        pt();
                                    break;
                                case "gyr-color-scale":
                                    qe("green", "yellow", "red"),
                                        pt();
                                    break;
                                case "ryg-color-scale":
                                    qe("red", "yellow", "green"),
                                        pt();
                                    break;
                                case "gwr-color-scale":
                                    qe("green", "white", "red"),
                                        pt();
                                    break;
                                case "rwg-color-scale":
                                    qe("red", "white", "green"),
                                        pt();
                                    break;
                                case "bwr-color-scale":
                                    qe("blue", "white", "red"),
                                        pt();
                                    break;
                                case "rwb-color-scale":
                                    qe("red", "white", "blue"),
                                        pt();
                                    break;
                                case "wr-color-scale":
                                    qe("white", "red"),
                                        pt();
                                    break;
                                case "rw-color-scale":
                                    qe("red", "white"),
                                        pt();
                                    break;
                                case "gw-color-scale":
                                    qe("green", "white"),
                                        pt();
                                    break;
                                case "wg-color-scale":
                                    qe("white", "green"),
                                        pt();
                                    break;
                                case "gy-color-scale":
                                    qe("green", "yellow"),
                                        pt();
                                    break;
                                case "yg-color-scale":
                                    qe("yellow", "green"),
                                        pt();
                                    break;
                                case "new-rule":
                                case "color-scales-more-rules":
                                    De || (De = new n.NewFormattingRuleDialog,
                                        $(De).on("dialogClose", function(e, t) {
                                            De = null
                                        })),
                                        De.open(0, !0, 0),
                                        pt();
                                    break;
                                case "3-arrows-icon-set":
                                    Ke(0),
                                        pt();
                                    break;
                                case "3-arrows-gray-icon-set":
                                    Ke(1),
                                        pt();
                                    break;
                                case "3-triangles-icon-set":
                                    Ke(2),
                                        pt();
                                    break;
                                case "3-traffic-lights-unrimmed-icon-set":
                                    Ke(5),
                                        pt();
                                    break;
                                case "3-traffic-lights-rimmed-icon-set":
                                    Ke(6),
                                        pt();
                                    break;
                                case "3-signs-icon-set":
                                    Ke(7),
                                        pt();
                                    break;
                                case "3-symbols-circled-icon-set":
                                    Ke(8),
                                        pt();
                                    break;
                                case "3-symbols-uncircled-icon-set":
                                    Ke(9),
                                        pt();
                                    break;
                                case "3-flags-icon-set":
                                    Ke(4),
                                        pt();
                                    break;
                                case "3-stars-icon-set":
                                    Ke(3),
                                        pt();
                                    break;
                                case "4-arrows-gray-icon-set":
                                    Ke(11),
                                        pt();
                                    break;
                                case "4-arrows-icon-set":
                                    Ke(10),
                                        pt();
                                    break;
                                case "4-traffic-lights-icon-set":
                                    Ke(14),
                                        pt();
                                    break;
                                case "red-to-black-icon-set":
                                    Ke(12),
                                        pt();
                                    break;
                                case "4-ratings-icon-set":
                                    Ke(13),
                                        pt();
                                    break;
                                case "5-arrows-gray-icon-set":
                                    Ke(16),
                                        pt();
                                    break;
                                case "5-arrows-icon-set":
                                    Ke(15),
                                        pt();
                                    break;
                                case "5-quarters-icon-set":
                                    Ke(18),
                                        pt();
                                    break;
                                case "5-ratings-icon-set":
                                    Ke(17),
                                        pt();
                                    break;
                                case "5-boxes-icon-set":
                                    Ke(19),
                                        pt();
                                    break;
                                case "icon-sets-more-rules":
                                    De || (De = new n.NewFormattingRuleDialog,
                                        $(De).on("dialogClose", function(e, t) {
                                            De = null
                                        })),
                                        De.open(0, !0, 3),
                                        pt();
                                    break;
                                case "clear-rules-from-cells":
                                    n.actions.doAction("clearRule", n.wrapper.spread, !1),
                                        n.actions.isFileModified = !0,
                                        pt();
                                    break;
                                case "clear-rules-from-sheet":
                                    n.actions.doAction("clearRule", n.wrapper.spread, !0),
                                        n.actions.isFileModified = !0,
                                        pt()
                            }
                        }),
                        $(document).on("click", function(e) {
                            if (0 !== $("#condition-format-popup").height() && $("#condition-format-popup").is(":visible")) {
                                var t = e.target;
                                !1 === $.contains($("#condition-format-popup")[0], t) && pt()
                            }
                        }),
                        H(),
                        U(),
                        K(),
                        q(),
                        Gt(),
                        Y()
                }
                function z(e) {
                    $("#" + e).find(".ui-icon").toggleClass("gcui-ribbon-checked").toggleClass("gcui-ribbon-unchecked")
                }
                function j(e) {
                    return $("#" + e).find(".ui-icon").hasClass("gcui-ribbon-checked")
                }
                function M(e, t) {
                    var i = $("#" + e).find(".ui-icon").removeClass("gcui-ribbon-checked").removeClass("gcui-ribbon-unchecked");
                    t ? i.addClass("gcui-ribbon-checked") : i.addClass("gcui-ribbon-unchecked")
                }
                function O() {
                    var e, t = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72], i = $("#font-size").find(".ui-button-text"), o = +i.text();
                    if (!(o >= t[t.length - 1]))
                        for (e = 0; e < t.length; e++) {
                            if (o < t[e])
                                return i.text(t[e]),
                                    t[e];
                            if (o === t[e])
                                return i.text(t[e + 1]),
                                    t[e + 1]
                        }
                }
                function G() {
                    var e, t = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72], i = $("#font-size").find(".ui-button-text"), o = +i.text();
                    if (!(o <= t[0]))
                        for (e = t.length - 1; e > 0; e--) {
                            if (o > t[e])
                                return i.text(t[e]),
                                    t[e];
                            if (o === t[e])
                                return i.text(t[e - 1]),
                                    t[e - 1]
                        }
                }
                function H() {
                    $("#font-family").addClass("gcui-ribbon-fontfamily"),
                        $("#font-size").addClass("gcui-ribbon-fontsize"),
                        $("#number-format").addClass("gcui-ribbon-number"),
                        $("#paste-options").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-paste"),
                        $("#paste-options").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'),
                        $("#freeze-panes").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-freeze"),
                        $("#freeze-panes").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'),
                        $("#find-goto").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-find"),
                        $("#find-goto").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'),
                        $("#sort-filter").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-sortfilter"),
                        $("#sort-filter").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'),
                        $("#condition-format").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-conditionalformat"),
                        $("#insert-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-insert"),
                        $("#insert-row-column").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'),
                        $("#delete-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-delete"),
                        $("#delete-row-column").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'),
                        $("#format-row-column").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-format"),
                        $("#format-row-column").find(".ui-button-text").append('<span class="ui-custom-triangle2"></span>'),
                        $("#calculate-option").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-calculateoption"),
                        $("#calculate-option").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'),
                        $("#borders").find(".ui-icon").removeClass().addClass("ui-button-icon-primary ui-icon gcui-ribbon-bottomborder"),
                        $("#borders").find(".ui-button-text").text("borders"),
                        $(".gcui-ribbon-bigbutton").each(function(e, t) {
                            var i = $(t);
                            i.data("button-size") ? i.width(i.data("button-size")) : i.width(i.width() + 10)
                        }),
                        $(".gcui-ribbon-slicerbigbutton").each(function(e, t) {
                            var i = $(t);
                            i.data("button-size") && i.width(i.data("button-size"))
                        }),
                        $("#showhide-vgridline").parents(".gcui-ribbon-list").addClass("gcui-ribbon-marginright"),
                        $("#showhide-columnheader").parents(".gcui-ribbon-list").addClass("gcui-ribbon-marginright"),
                        $("#add-chart-element").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'),
                        $("#quick-layout").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'),
                        $("#chart-styles").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>'),
                        $("#change-colors").find(".ui-button-text").append('<span class="ui-custom-triangle"></span>')
                }
                function U() {
                    $("a[href='#sparklineTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "sparklineTab", !1)
                }
                function W() {
                    $(".ribbon-bar").gcuiribbon("setTabPageVisible", "sparklineTab", !0),
                        $(".ribbon-bar").gcuitabs("select", "sparklineTab")
                }
                function _() {
                    $(".ribbon-bar").gcuiribbon("setTabPageVisible", "formulaSparklineTab", !0),
                        $(".ribbon-bar").gcuitabs("select", "formulaSparklineTab")
                }
                function q() {
                    $("a[href='#formulaSparklineTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "formulaSparklineTab", !1)
                }
                function K() {
                    $("a[href='#tableTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !1)
                }
                function Y() {
                    $("a[href='#chartTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "chartTab", !1)
                }
                function X() {
                    $(".ribbon-bar").gcuiribbon("setTabPageVisible", "chartTab", !0),
                        $(".ribbon-bar").gcuitabs("select", "chartTab")
                }
                function J(e, t) {
                    var i, o, a, l, c, d, p, u, h, f = $("#chart-styles-list-container"), g = n.wrapper.spread, m = g.getActiveSheet(), b = t.series().get(), v = s.getSeriesWithoutStyle(b), y = t.colorAndStyle, x = new r.Chart(m,"chartForGetDefaultStyle",void 0,20,20,480,288,null);
                    for (x.series().add(v),
                             i = t.colorAndStyle && t.colorAndStyle.color,
                             s.applyChartSeriesTheme(x, i || {}),
                             o = Z(x),
                             a = s.getChartTypeString(t.chartType()),
                             l = s.getActualChartStyle(o, N.chartStyles[a], y),
                         s.getChartGroupString(t.chartType()) === s.chartTypeDict[52].chartGroup && Q(l, t),
                             c = n.chartPreviewer,
                             c.synchronizeData(n.wrapper.spread),
                             d = c.getChartPreviewCharts(l),
                             n.wrapper.spread.focus(),
                             f.empty(),
                             p = 0; p < d.length; p++)
                        (u = d[p]) && u instanceof r.Chart && (h = s.getImageFromChart(u),
                            ee(h, f, p));
                    f.on("click", {
                        actualChartStyle: l
                    }, function(t) {
                        var i, o;
                        e.gcuipopup("hide"),
                            i = $(t.target),
                            $(".chart-style-preview-image").removeClass("chart-style-preview-image-selected"),
                            i.addClass("chart-style-preview-image-selected"),
                            o = i.index(".chart-style-preview-image"),
                            n.actions.doAction("setChartStyle", n.wrapper.spread, {
                                chartStyle: t.data.actualChartStyle[o]
                            })
                    })
                }
                function Q(e, t) {
                    for (var i, o = 0, n = e.length, r = t.chartType(), a = t.dataRange(); o < n; o++)
                        i = e[o],
                            i.chartType = s.getChartTypeString(r),
                            i.category = s.getChartGroupString(r),
                            i.dataFormula = a
                }
                function Z(e) {
                    var t = {};
                    return t.chartArea = e.chartArea(),
                        t.axes = e.axes(),
                        t.dataLabels = e.dataLabels(),
                        t.title = e.title(),
                        t.legend = e.legend(),
                        t.series = e.series().get(),
                        t
                }
                function ee(e, t, i) {
                    var o = $("<span></span>");
                    o.addClass("chart-style-preview-image"),
                        o.attr("title", "Style " + (i + 1)),
                        o.css("background-image", "url('" + e + "')"),
                        o.appendTo(t)
                }
                function te(e) {
                    var t = n.wrapper.spread.getActiveSheet()
                        , i = e || s.getSelectedChart(t);
                    !i || !i.isSelected() || !t.options.protectionOptions.allowEditObjects && t.options.isProtected && i.isLocked() ? Y() : X()
                }
                e.updateChartTab = te;
                function ie() {
                    $(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0),
                        $(".ribbon-bar").gcuitabs("select", "tableTab")
                }
                function oe(e, t) {
                    $(e).button("option", "label", t)
                }
                function ne() {
                    var e = n.wrapper.spread.undoManager();
                    e && (e.canUndo() ? ($(".quick-access-bar").find('[data-action="undo"]').prop("disabled", !1),
                        $(".quick-access-bar").find('[data-action="undo"]').fadeTo("faster", 1)) : ($(".quick-access-bar").find('[data-action="undo"]').prop("disabled", !0),
                        $(".quick-access-bar").find('[data-action="undo"]').fadeTo("faster", .2)),
                        e.canRedo() ? ($(".quick-access-bar").find('[data-action="redo"]').prop("disabled", !1),
                            $(".quick-access-bar").find('[data-action="redo"]').fadeTo("faster", 1)) : ($(".quick-access-bar").find('[data-action="redo"]').prop("disabled", !0),
                            $(".quick-access-bar").find('[data-action="redo"]').fadeTo("faster", .2)))
                }
                e.updateUndoRedo = ne;
                function re() {
                    var e, t, i, o, r, a, s = n.wrapper.spread.getActiveSheet(), l = s.getActualStyle(s.getActiveRowIndex(), s.getActiveColumnIndex());
                    if ($(".ribbon-bar").gcuiribbon("setButtonsChecked", {
                            "font-weight": !1,
                            "font-italic": !1,
                            "font-underline": !1,
                            "font-double-underline": !1
                        }),
                        l && l.font) {
                        if (e = n.util.parseFont(l.font),
                            "normal" !== e.fontWeight && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-weight", !0),
                            "normal" !== e.fontStyle && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-italic", !0),
                            e.fontSize && oe("#font-size", e.fontSize.substring(0, e.fontSize.length - 2)),
                                e.fontFamily) {
                            t = e.fontFamily.split(","),
                                i = t[0],
                            i.match(/^["'].*["']$/) && (i = i.substring(1, i.length - 1)),
                                o = RegExp("^(.*,s*)?[\"']?" + i + "[\"']?s*(,.*)?$");
                            for (r in n.res.ribbon.fontFamilies)
                                if (o.test(n.res.ribbon.fontFamilies[r].name)) {
                                    i = n.res.ribbon.fontFamilies[r].text;
                                    break
                                }
                            a = ae($("#font-family").children(".ui-button-text"), i),
                                oe("#font-family", a)
                        }
                    } else
                        e = n.util.parseFont(n.res.defaultFont),
                            oe("#font-size", e.fontSize.substring(0, e.fontSize.length - 2)),
                            oe("#font-family", e.fontFamily);
                    if (l && l.textDecoration && 1 & l.textDecoration && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-underline", !0),
                        l && l.textDecoration && 8 & l.textDecoration && $(".ribbon-bar").gcuiribbon("setButtonChecked", "font-double-underline", !0),
                            $(".ribbon-bar").gcuiribbon("setButtonsChecked", {
                                "left-align": !1,
                                "center-align": !1,
                                "right-align": !1
                            }),
                        l && void 0 !== l.hAlign)
                        switch (l.hAlign) {
                            case 0:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "left-align", !0);
                                break;
                            case 1:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "center-align", !0);
                                break;
                            case 2:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "right-align", !0)
                        }
                    if ($(".ribbon-bar").gcuiribbon("setButtonsChecked", {
                            "top-align": !1,
                            "middle-align": !1,
                            "bottom-align": !1
                        }),
                        l && void 0 !== l.vAlign)
                        switch (l.vAlign) {
                            case 0:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "top-align", !0);
                                break;
                            case 1:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "middle-align", !0);
                                break;
                            case 2:
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "bottom-align", !0)
                        }
                    l && l.wordWrap ? $(".ribbon-bar").gcuiribbon("setButtonChecked", "wrap-text", !0) : $(".ribbon-bar").gcuiribbon("setButtonChecked", "wrap-text", !1),
                        l && l.isVerticalText ? $(".ribbon-bar").gcuiribbon("setButtonChecked", "vertical-text", !0) : $(".ribbon-bar").gcuiribbon("setButtonChecked", "vertical-text", !1)
                }
                e.updateCellStyle = re;
                function ae(e, t) {
                    return $(".ribbon-bar").gcuiribbon("getDropdownLabelSubstr", t, e, e.width())
                }
                function se() {
                    var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getActualStyle(i.getActiveRowIndex(), i.getActiveColumnIndex());
                    if (o && o.formatter && "general" !== o.formatter) {
                        for (e in n.res.commonFormats)
                            if (t = n.res.commonFormats[e],
                                t.format === o.formatter)
                                return void oe("#number-format", t.label);
                        oe("#number-format", n.res.customFormat)
                    } else
                        oe("#number-format", n.res.generalFormat)
                }
                e.updateFormat = se;
                function le() {
                    var e, t, i = n.wrapper.spread.getActiveSheet(), o = i.getSelections();
                    for (e = 0; e < o.length; e++)
                        if (t = i.getSpans(o[e]),
                            t.length > 0)
                            return void $(".ribbon-bar").gcuiribbon("setButtonChecked", "merge-center", !0);
                    $(".ribbon-bar").gcuiribbon("setButtonChecked", "merge-center", !1)
                }
                e.updateMerge = le;
                function ce() {
                    var e, t, i, r, a, s;
                    if (q(),
                            U(),
                            e = n.wrapper.spread.getActiveSheet(),
                            t = e.getActiveRowIndex(),
                            i = e.getActiveColumnIndex(),
                        !(r = e.getSelections()) || 0 !== r.length)
                        if (e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex())instanceof o.Sparklines.Sparkline) {
                            switch (W(),
                                a = e.getSparkline(e.getActiveRowIndex(), e.getActiveColumnIndex()),
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-line", !1),
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-column", !1),
                                $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-winloss", !1),
                                a.sparklineType()) {
                                case 0:
                                    $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-line", !0);
                                    break;
                                case 1:
                                    $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-column", !0);
                                    break;
                                case 2:
                                    $(".ribbon-bar").gcuiribbon("setButtonChecked", "sparkline-type-winloss", !0)
                            }
                            s = a.setting(),
                                M("sparkline-high-point", s.options.showHigh),
                                M("sparkline-low-point", s.options.showLow),
                                M("sparkline-first-point", s.options.showFirst),
                                M("sparkline-last-point", s.options.showLast),
                                M("sparkline-negative-point", s.options.showNegative),
                                M("sparkline-marker-point", s.options.showMarkers)
                        } else
                            n.util.parseFormulaSparkline(t, i) && _()
                }
                e.updateSparkline = ce;
                function de() {
                    var e, i, r, a = n.wrapper.spread.getActiveSheet(), s = a.getSelections();
                    s && 0 === s.length || (a.tables.find(a.getActiveRowIndex(), a.getActiveColumnIndex())instanceof o.Tables.Table ? (ie(),
                        $(".ribbon-bar").gcuiribbon("setButtonDisabled", "insert-table", !0),
                        e = a.tables.find(a.getActiveRowIndex(), a.getActiveColumnIndex()),
                        M("table-header-row", e.showHeader()),
                        M("table-total-row", e.showFooter()),
                        M("table-banded-rows", e.bandRows()),
                        M("table-first-column", e.highlightFirstColumn()),
                        M("table-last-column", e.highlightLastColumn()),
                        M("table-banded-columns", e.bandColumns()),
                        M("table-filter-button", e.filterButtonVisible()),
                        $(".designer-table-name").val(e.name()),
                        i = e.style(),
                        r = i.name(),
                        t = r && r.toLowerCase() || "") : (K(),
                        $(".ribbon-bar").gcuiribbon("setButtonDisabled", "insert-table", !1)))
                }
                e.updateTable = de;
                function pe() {
                    var e = n.wrapper.spread.getActiveSheet();
                    M("showhide-columnheader", e.options.colHeaderVisible),
                        M("showhide-rowheader", e.options.rowHeaderVisible),
                        M("showhide-hgridline", e.options.gridline.showHorizontalGridline),
                        M("showhide-vgridline", e.options.gridline.showVerticalGridline),
                        M("showhide-tabstrip", n.wrapper.spread.options.tabStripVisible),
                        M("showhide-newtab", n.wrapper.spread.options.newTabVisible)
                }
                e.updateShowHide = pe;
                function ue() {
                    var e = n.wrapper.spread.getActiveSheet();
                    e.options.isProtected ? ($(".ribbon-bar").find("#protect-sheet").addClass("hidden"),
                        $(".ribbon-bar").find("#unprotect-sheet").removeClass("hidden")) : ($(".ribbon-bar").find("#protect-sheet").removeClass("hidden"),
                        $(".ribbon-bar").find("#unprotect-sheet").addClass("hidden")),
                        e.getCell(e.getActiveRowIndex(), e.getActiveColumnIndex()).locked() ? ($(".ribbon-bar").find("#lock-cells").addClass("hidden"),
                            $(".ribbon-bar").find("#unlock-cells").removeClass("hidden")) : ($(".ribbon-bar").find("#lock-cells").removeClass("hidden"),
                            $(".ribbon-bar").find("#unlock-cells").addClass("hidden"))
                }
                e.updateProtectLock = ue;
                function he() {
                    var e = n.wrapper.spread.getActiveSheet();
                    $(".statusBar").find(".statusbar-zoom-value").text(Math.round(100 * e.zoom()) + "%")
                }
                e.updateZoomToStatusBar = he;
                function fe() {
                    var e, t = $("#template-design-mode"), i = t.find("span.ui-button-text"), o = $("#data-binding-setting-indicator"), r = $(".designer-data-binding-icon"), s = $(".slider-panel");
                    st(),
                        i.removeClass("template-design-mode-checked"),
                        o.attr("hidden", "hidden"),
                        r.unbind("click.indicator"),
                    a && (e = n.wrapper.spread.getActiveSheet(),
                        e.setDataSource(a)),
                    s.is(":visible") && s.sliderpanel("close", "panel1"),
                        t.data("checked", !1),
                        qe()
                }
                function ge() {
                    $(".custom-cell-styles-preview").empty(),
                        $e(n.CellStyleDialog.existedCustomCellStyle, $(".custom-cell-styles-preview"), !0),
                        ze()
                }
                function me() {
                    var e, t, i, o, r, a, s, l, c, d = n.wrapper.spread;
                    for ($(".custom-cell-styles-preview").children().remove(),
                             $(".good-bad-style-preview").children().remove(),
                             $(".data-model-style-preview").children().remove(),
                             $(".titles-headings-preview").children().remove(),
                             $(".themed-preview").children().remove(),
                             $(".number-format-preview").children().remove(),
                             n.CellStyleDialog.existedCustomCellStyle = {},
                             n.CellStyleDialog.buildInCellStyle = {},
                             e = be(d),
                             t = ve(d),
                             i = ye(d),
                             o = xe(d),
                             r = we(d),
                             Ce(e, t, i, o, r),
                             a = d.getNamedStyles(),
                             s = 0; s < a.length; s++)
                        (l = a[s].name) && (c = l.toLowerCase(),
                        "__builtin" === c.substr(0, 9) || n.CellStyleDialog.buildInCellStyle.hasOwnProperty(c) || (n.CellStyleDialog.existedCustomCellStyle[c] = a[s]));
                    Fe(n.CellStyleDialog.existedCustomCellStyle) && ($(".cell-style-custom-li").addClass("hidden"),
                        $(".custom-cell-styles-preview").parent().addClass("hidden")),
                        $e(n.res.cellStylesDialog.goodBadAndNeutralContent, $(".good-bad-style-preview"), !1, e),
                        $e(n.res.cellStylesDialog.dataAndModelContent, $(".data-model-style-preview"), !1, t),
                        $e(n.res.cellStylesDialog.titlesAndHeadingsContent, $(".titles-headings-preview"), !1, i),
                        $e(n.res.cellStylesDialog.themedCellStyleContent, $(".themed-preview"), !1, o),
                        $e(n.res.cellStylesDialog.numberFormatContent, $(".number-format-preview"), !1, r),
                        Pe()
                }
                e.resetSpreadNamedStyle = me;
                function be(e) {
                    var t, i, o, n = ["normal", "bad", "good", "neutral"], r = {};
                    for (t = 0; t < n.length; t++)
                        if (i = e.getNamedStyle(n[t]),
                                o = n[t],
                                i)
                            r[o] = i;
                        else
                            switch (o) {
                                case "normal":
                                    r.normal = {
                                        name: "Normal"
                                    };
                                    break;
                                case "bad":
                                    r.bad = {
                                        name: "Bad",
                                        backColor: "#FFC7CE",
                                        foreColor: "#9C0006"
                                    };
                                    break;
                                case "good":
                                    r.good = {
                                        name: "Good",
                                        backColor: "#C6EFCE",
                                        foreColor: "#006100"
                                    };
                                    break;
                                case "neutral":
                                    r.neutral = {
                                        name: "Neutral",
                                        backColor: "#FFEB9C",
                                        foreColor: "#9C6500"
                                    }
                            }
                    return r
                }
                function ve(e) {
                    var t, i, o, n = ["calculation", "check cell", "explanatory text", "input", "linked cell", "note", "output", "warning text"], r = {};
                    for (t = 0; t < n.length; t++)
                        if (i = e.getNamedStyle(n[t]),
                                o = n[t],
                                i)
                            r[o] = i;
                        else
                            switch (o) {
                                case "calculation":
                                    r.calculation = {
                                        name: "Calculation",
                                        backColor: "#F2F2F2",
                                        foreColor: "#FCA957",
                                        border: "thin solid black",
                                        font: "bold 13px Arial"
                                    };
                                    break;
                                case "check cell":
                                    r["check cell"] = {
                                        name: "Check Cell",
                                        backColor: "#A5A5A5",
                                        foreColor: "#FFFFFF",
                                        border: "medium double black",
                                        font: "bold 13px Arial"
                                    };
                                    break;
                                case "explanatory text":
                                    r["explanatory text"] = {
                                        name: "Explanatory Text",
                                        foreColor: "#7F7F7F",
                                        font: "italic bold 13px Arial"
                                    };
                                    break;
                                case "input":
                                    r.input = {
                                        name: "Input",
                                        foreColor: "#3F3F76",
                                        backColor: "#FFCC99",
                                        border: "thin solid black",
                                        font: "bold 13px Arial"
                                    };
                                    break;
                                case "linked cell":
                                    r["linked cell"] = {
                                        name: "Linked Cell",
                                        foreColor: "#FCA957",
                                        borderBottom: "medium double #FDD3A9",
                                        font: "bold 13px Arial"
                                    };
                                    break;
                                case "note":
                                    r.note = {
                                        name: "Note",
                                        backColor: "#FFFFCC",
                                        border: "thin solid black",
                                        font: "13px Arial"
                                    };
                                    break;
                                case "output":
                                    r.output = {
                                        name: "Output",
                                        backColor: "#F2F2F2",
                                        border: "thin solid black",
                                        font: "bold 13px Arial"
                                    };
                                    break;
                                case "warning text":
                                    r["warning text"] = {
                                        name: "Warning Text",
                                        foreColor: "#FF3030",
                                        font: "13px Arial"
                                    }
                            }
                    return r
                }
                function ye(e) {
                    var t, i, o, n = ["heading 1", "heading 2", "heading 3", "heading 4", "title", "total"], r = {};
                    for (t = 0; t < n.length; t++)
                        if (i = e.getNamedStyle(n[t]),
                                o = n[t],
                                i)
                            r[o] = i;
                        else
                            switch (o) {
                                case "heading 1":
                                    r["heading 1"] = {
                                        name: "Heading 1",
                                        foreColor: "#1F497D",
                                        font: "bold 17px Arial",
                                        borderBottom: "medium solid #4F81BD"
                                    };
                                    break;
                                case "heading 2":
                                    r["heading 2"] = {
                                        name: "Heading 2",
                                        foreColor: "#1F497D",
                                        font: "bold 15px Arial",
                                        borderBottom: "medium solid #A4BDDD"
                                    };
                                    break;
                                case "heading 3":
                                    r["heading 3"] = {
                                        name: "Heading 3",
                                        foreColor: "#1F497D",
                                        font: "bold 13px Arial",
                                        borderBottom: "thin solid #93B1D7"
                                    };
                                    break;
                                case "heading 4":
                                    r["heading 4"] = {
                                        name: "Heading 4",
                                        foreColor: "#1F497D",
                                        font: "bold 13px Arial"
                                    };
                                    break;
                                case "title":
                                    r.title = {
                                        name: "Title",
                                        foreColor: "#1F497D",
                                        font: "bold 17px Century"
                                    };
                                    break;
                                case "total":
                                    r.total = {
                                        name: "Total",
                                        font: "bold 13px Arial",
                                        borderTop: "thin solid #1F497D",
                                        borderBottom: "medium double #1F497D"
                                    }
                            }
                    return r
                }
                function xe(e) {
                    var t, i, o, r, a, s, l, c = {}, d = n.res.cellStylesDialog.themedCellStyleContent, p = "black";
                    for (t in d)
                        i = t.toLowerCase(),
                            o = e.getNamedStyle(t),
                            o ? c[i] = o : (a = t.split("-"),
                                1 === a.length ? (s = a[0].substr(a[0].length - 1),
                                    r = "Accent " + s + " 0",
                                    p = "white") : 2 === a.length && (s = a[1].substr(a[1].length - 1),
                                    l = 100 - parseInt(a[0]),
                                    r = "Accent " + s + " " + l + "%",
                                    p = l <= 50 ? "white" : "black"),
                                r = n.ColorHelper.parse(r, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                                c[i] = {
                                    name: t,
                                    backColor: r.color,
                                    foreColor: p
                                });
                    return c
                }
                function we(e) {
                    var t, i, o, n = ["comma", "comma [0]", "currency", "currency [0]", "percent"], r = {};
                    for (t = 0; t < n.length; t++)
                        if (i = e.getNamedStyle(n[t]),
                                o = n[t],
                                i)
                            r[o] = i;
                        else
                            switch (o) {
                                case "comma":
                                    r.comma = {
                                        name: "Comma",
                                        formatter: "_(* #,##0.00_);_(* (#,##0.00);_(*'-'??_);_(@_)"
                                    };
                                    break;
                                case "comma [0]":
                                    r["comma [0]"] = {
                                        name: "Comma [0]",
                                        formatter: "_(* #,##0_);_(* (#,##0);_(*'-'_);_(@_)"
                                    };
                                    break;
                                case "currency":
                                    r.currency = {
                                        name: "Currency",
                                        formatter: "_('$'* #,##0.00_);_('$'* (#,##0.00);_('$'*'-'??_);_(@_)"
                                    };
                                    break;
                                case "currency [0]":
                                    r["currency [0]"] = {
                                        name: "Currency [0]",
                                        formatter: "_('$'* #,##0_);_('$'* (#,##0);_('$'*'-'_);_(@_)"
                                    };
                                    break;
                                case "percent":
                                    r.percent = {
                                        name: "Percent",
                                        formatter: "0%"
                                    }
                            }
                    return r
                }
                function Ce() {
                    var e, t, i, r, a, s, l, c = [];
                    for (e = 0; e < arguments.length - 0; e++)
                        c[e] = arguments[e + 0];
                    for (t = c.length,
                             i = 0; i < t; i++) {
                        r = c[i];
                        for (a in r)
                            s = r[a],
                            s instanceof o.Style || Se(s),
                                l = s.name.toLowerCase(),
                                n.CellStyleDialog.buildInCellStyle[l] = s
                    }
                }
                function Se(e) {
                    e.borderTop && (e.borderTop = ke(e.borderTop)),
                    e.borderBottom && (e.borderBottom = ke(e.borderBottom)),
                    e.borderLeft && (e.borderLeft = ke(e.borderLeft)),
                    e.borderRight && (e.borderRight = ke(e.borderRight)),
                    e.border && (e.borderTop = ke(e.border),
                        e.borderBottom = ke(e.border),
                        e.borderLeft = ke(e.border),
                        e.borderRight = ke(e.border))
                }
                function ke(e) {
                    var t, i, n;
                    if (e)
                        return t = e.split(" "),
                            i = 1,
                            3 === t.length ? ("thin" !== t[0] && "medium" !== t[0] && "thick" !== t[0] || (i = o.LineStyle[t[0]]),
                            "solid" !== t[1] && (i = o.LineStyle[t[1]]),
                                n = t[2],
                                new o.LineBorder(n,i)) : void 0
                }
                function Te(e, t) {
                    return t ? (u || (u = document.createElement("span")),
                        $(u).css("font", e),
                        $(u).css("fontFamily", t),
                        $(u).css("font")) : e
                }
                function Ae(e, t) {
                    var i, r;
                    $.extend(e, t);
                    for (i in t)
                        "backColor" !== i && "foreColor" !== i || !t[i] ? "hAlign" === i && t[i] && (e.textAlign = o.HorizontalPosition[t[i]]) : (r = n.ColorHelper.parse(t[i], n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                            e[i] = r.color);
                    e.font && e.themeFont && (e.font = Te(e.font, n.util.getThemeFont(e.themeFont))),
                    e.borderBottom && (e.borderBottom = Ie(e.borderBottom)),
                    e.borderLeft && (e.borderLeft = Ie(e.borderLeft)),
                    e.borderRight && (e.borderRight = Ie(e.borderRight)),
                    e.borderTop && (e.borderTop = Ie(e.borderTop)),
                    e.textDecoration && (e.textDecoration = n.util.toCSSTextDecoration(e.textDecoration))
                }
                function Ie(e) {
                    var t, i, r, a, s, l;
                    if ("string" == typeof e)
                        return e;
                    if (t = [],
                            i = ["dotted", "solid", "double", "dashed"],
                            r = "",
                            e.style) {
                        for (a in o.LineStyle)
                            if (e.style === o.LineStyle[a])
                                switch (e.style) {
                                    case 0:
                                        r = "empty";
                                        break;
                                    case 1:
                                        r = "thin";
                                        break;
                                    case 2:
                                        r = "medium";
                                        break;
                                    case 3:
                                        r = "dashed";
                                        break;
                                    case 4:
                                        r = "dotted";
                                        break;
                                    case 5:
                                        r = "thick";
                                        break;
                                    case 6:
                                        r = "double";
                                        break;
                                    case 7:
                                        r = "hair";
                                        break;
                                    case 8:
                                        r = "mediumDashed";
                                        break;
                                    case 9:
                                        r = "dashDot";
                                        break;
                                    case 10:
                                        r = "mediumDashDot";
                                        break;
                                    case 11:
                                        r = "dashDotDot";
                                        break;
                                    case 12:
                                        r = "mediumDashDotDot"
                                }
                        for (r = r.toLowerCase(),
                                 t[0] = De(e.style) + "px",
                                 a = 0; a < i.length; a++)
                            -1 !== r.indexOf(i[a]) && (t[1] = i[a]);
                        t[1] || (-1 !== r.indexOf("dot") ? t[1] = "dotted" : -1 !== r.indexOf("dash") ? t[1] = "dashed" : t[1] = "solid")
                    }
                    for (e.color ? (s = n.ColorHelper.parse(e.color, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                        t[2] = s.color) : (s = n.ColorHelper.parse("Text 1", n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                        t[2] = s.color),
                             l = "",
                         "thin" === t[0] && "double" === t[1] && (t[0] = c),
                             a = 0; a < t.length; a++)
                        t[a] && (l = l + t[a] + " ");
                    return l = l.substring(0, l.lastIndexOf(" "))
                }
                function De(e) {
                    switch (e) {
                        case 9:
                        case 1:
                        case 3:
                        case 4:
                        case 7:
                        case 11:
                            return 1;
                        case 2:
                        case 10:
                        case 12:
                        case 8:
                        case 13:
                            return 2;
                        case 5:
                        case 6:
                            return 3
                    }
                    return 0
                }
                function $e(e, t, i, o) {
                    var r, a, s, l, c, d;
                    if (i) {
                        if (!Fe(e)) {
                            $(".cell-style-custom-li").removeClass("hidden"),
                                $(".custom-cell-styles-preview").parent().removeClass("hidden");
                            for (r in e)
                                l = e[r].name,
                                    a = $("<span></span>").attr({
                                        title: l,
                                        "data-name": l
                                    }).addClass("cell-style-outer-span"),
                                    s = $("<div></div>").text(l).addClass("custom-cell-style-symbol").appendTo(a),
                                    a.appendTo(t),
                                    c = {},
                                    Ae(c, e[r]),
                                    Le(c, s),
                                    Ee(l, n.wrapper.spread)
                        }
                    } else
                        for (r in e)
                            d = r.toLowerCase(),
                                a = $("<span></span>").attr({
                                    title: r,
                                    "data-name": r
                                }).addClass("cell-style-outer-span"),
                                s = $("<div></div>").text(e[r]).addClass("cell-style-symbol").appendTo(a),
                                a.appendTo(t),
                            o && Le(o[d], s)
                }
                function Fe(e) {
                    return !e || "object" == typeof e && 0 === Object.keys(e).length
                }
                function Le(e, t) {
                    if (e) {
                        var i;
                        e.backColor && (i = n.ColorHelper.parse(e.backColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                            t.css("background-color", i.color)),
                        e.border && t.css("border", e.border),
                        e.foreColor && (i = n.ColorHelper.parse(e.foreColor, n.wrapper.spread.getActiveSheet().currentTheme().colors()),
                            t.css("color", i.color)),
                        e.font && (e.themeFont && (e.font = Te(e.font, n.util.getThemeFont(e.themeFont))),
                            t.css("font", e.font)),
                        e.borderLeft && t.css("border-left", Ie(e.borderLeft)),
                        e.borderRight && t.css("border-right", Ie(e.borderRight)),
                        e.borderBottom && t.css("border-bottom", Ie(e.borderBottom)),
                        e.borderTop && t.css("border-top", Ie(e.borderTop)),
                        e.textAlign && t.css("text-align", e.textAlign),
                        e.textDecoration && (isNaN(e.textDecoration) ? t.css("text-decoration", e.textDecoration) : t.css("text-decoration", n.util.toCSSTextDecoration(e.textDecoration)))
                    }
                }
                b = function(e, t) {
                    var i = n.wrapper.spread
                        , o = i.getActiveSheet();
                    switch (t.item[0].id) {
                        case "cellstyle-modify":
                            h || (h = new n.FormatDialog),
                                $("#cell-styles-popup").gcuipopup("hide"),
                                Ee(g, n.wrapper.spread),
                                f = i.getNamedStyle(g),
                                h.open("numbers", void 0, f, !0),
                                h.setFormatDirectly(!1),
                                $(h).on("okClicked", function(e, t) {
                                    var r, a, s;
                                    for (n.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(g) ? $.extend(n.CellStyleDialog.existedCustomCellStyle[g], t) : n.CellStyleDialog.buildInCellStyle.hasOwnProperty(g) && $.extend(n.CellStyleDialog.buildInCellStyle[g], t),
                                             r = i.sheets,
                                             a = 0; a < r.length; a++)
                                        r[a].getNamedStyle(g) && $.extend(r[a].getNamedStyle(g), t);
                                    i.getNamedStyle(g) && $.extend(i.getNamedStyle(g), t),
                                        o.repaint(),
                                        s = {},
                                        Ae(s, t),
                                        Le(s, $(m).children()),
                                        n.actions.isFileModified = !0
                                });
                            break;
                        case "cellstyle-delete":
                            $(m).remove(),
                                n.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(g) ? (delete n.CellStyleDialog.existedCustomCellStyle[g],
                                Fe(n.CellStyleDialog.existedCustomCellStyle) && ($(".cell-style-custom-li").addClass("hidden"),
                                    $(".custom-cell-styles-preview").parent().addClass("hidden"))) : n.CellStyleDialog.buildInCellStyle.hasOwnProperty(g) && delete n.CellStyleDialog.buildInCellStyle[g],
                            o.getNamedStyle(g) && o.removeNamedStyle(g),
                            i.getNamedStyle(g) && i.removeNamedStyle(g),
                                n.actions.isFileModified = !0
                    }
                }
                ;
                function Re(e) {
                    var t = e.srcElement || e.target
                        , i = t.parentElement
                        , o = i;
                    $(o).addClass("ui-state-hover")
                }
                function Be(e) {
                    var t = e.srcElement || e.target
                        , i = t.parentElement
                        , o = i;
                    $(o).removeClass("ui-state-hover")
                }
                function Ne(e) {
                    var t, i = e.srcElement || e.target, o = i.parentElement;
                    t = o.title ? o.title : o.innerText,
                        n.actions.doAction("baseDialogCommand", n.wrapper.spread, {
                            value: {
                                styleName: t
                            },
                            execute: n.spreadActions.dialogAction.addAndSetStyleByName
                        }),
                        $("#cell-styles-popup").gcuipopup("hide")
                }
                function Ee(e, t) {
                    var i = e.toLowerCase();
                    t.getNamedStyle(e) || (n.CellStyleDialog.buildInCellStyle.hasOwnProperty(i) ? n.actions.doAction("addNamedStyle", t, n.CellStyleDialog.buildInCellStyle[i]) : n.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(i) && n.actions.doAction("addNamedStyle", t, n.CellStyleDialog.existedCustomCellStyle[i]))
                }
                function Ve(e) {
                    var t = e.srcElement || e.target;
                    m = t.parentElement,
                        g = $(m).attr("data-name").toLowerCase(),
                        $("#cellstyle-menu-container").css({
                            position: "absolute",
                            top: e.offsetY,
                            left: e.offsetX
                        }),
                        $(".cellstyle-menu").removeClass("hidden"),
                        $(".cellstyle-menu").position({
                            my: "left top",
                            of: e
                        }),
                        n.util.cancelDefault(e)
                }
                e.cellStyleDialog;
                function Pe() {
                    $(".new-cell-style-text").unbind(),
                        $(".cell-style-symbol").unbind(),
                        $(".cellstyle-menu").menu({
                            select: b
                        }),
                        $(".cell-style-symbol").bind("mouseenter", Re),
                        $(".cell-style-symbol").bind("mouseout", Be),
                        $(".cell-style-symbol").bind("click", Ne),
                        $(".cell-style-symbol").bind("contextmenu", Ve),
                        $(".new-cell-style-text, .new-cell-style-button").bind("mouseout", function() {
                            $(".new-cell-style-text").removeClass("ui-state-hover")
                        }),
                        $(".new-cell-style-text, .new-cell-style-button").bind("mouseenter", function() {
                            $(".new-cell-style-text").addClass("ui-state-hover")
                        }),
                        $(".new-cell-style-button").bind("click", function() {
                            $("#cell-styles-popup").gcuipopup("hide"),
                            void 0 === e.cellStyleDialog && (e.cellStyleDialog = new n.CellStyleDialog),
                                e.cellStyleDialog.open()
                        }),
                        $(document).bind("mouseup", function(e) {
                            2 === e.button || $(".cellstyle-menu").hasClass("hidden") || $(".cellstyle-menu").addClass("hidden")
                        })
                }
                function ze() {
                    $(".custom-cell-style-symbol").unbind(),
                        $(".custom-cell-style-symbol").bind("mouseenter", Re),
                        $(".custom-cell-style-symbol").bind("mouseout", Be),
                        $(".custom-cell-style-symbol").bind("click", Ne),
                        $(".custom-cell-style-symbol").bind("contextmenu", Ve)
                }
                function je() {
                    var e, t = 21, i = 28, r = 11, a = 7;
                    Ge("custom-preview", "custom", a),
                        Ge("light-preview", "light", t),
                        Ge("medium-preview", "medium", i),
                        Ge("dark-preview", "dark", r),
                        $(".table-format-preview, .table-format-preview-button").mouseenter(function(e) {
                            var t = e.srcElement || e.target
                                , i = $(t).closest("button").find("span.container-span");
                            i.children().hasClass("hiddenCustomStyle") || i.addClass("ui-state-hover")
                        }),
                        $(".table-format-preview, .table-format-preview-button").mouseout(function(e) {
                            var t = e.srcElement || e.target;
                            $(t).closest("button").find("span.container-span").removeClass("ui-state-hover")
                        }),
                        $(".table-format-preview-button").mouseup(function(e) {
                            var t, i, r, a, s = n.wrapper.spread, l = e.srcElement || e.target, c = $(l).closest("button").find("span span")[0], d = c.className, p = "", u = d.split(" ");
                            for (t = 0; t < u.length; t++)
                                if (-1 === u[t].indexOf("table-format")) {
                                    p = u[t];
                                    break
                                }
                            if (-1 === p.indexOf("custom"))
                                n.actions.doAction("formatAsTable", s, o.Tables.TableThemes[p]),
                                    de();
                            else {
                                i = n.FormatTableDialog.customTableStyle;
                                for (r in i)
                                    (a = r.substring(0, r.indexOf("-"))) === p && (n.actions.doAction("formatAsTable", s, i[r]),
                                        de())
                            }
                            $("#format-table-popup").gcuipopup("hide")
                        }),
                        $(".new-table-style").click(function() {
                            $("#format-table-popup").gcuipopup("hide"),
                                void 0 === e ? e = new n.FormatTableDialog : e.refresh(),
                                e.open()
                        }).mouseenter(function() {
                            $(this).css("background", "#DBDBDB")
                        }).mouseleave(function() {
                            $(this).css("background", "white")
                        })
                }
                function Me() {
                    var e, t, i, o = 1;
                    for (e in n.FormatTableDialog.customTableStyle)
                        e ? (t = e.substring(0, e.indexOf("-")),
                            $(".custom-format-table").css("display", "block"),
                            i = "table-format-" + t,
                            $("." + i).css("display", "inline-block").removeClass("hiddenCustomStyle"),
                            Oe(e, o),
                            o++) : $(".custom-format-table").css("display", "none")
                }
                function Oe(e, t) {
                    var i = "custom"
                        , o = "table-format-"
                        , n = o + i + t
                        , r = e.substring(e.indexOf("-") + 1);
                    $("." + n).attr("title", r)
                }
                function Ge(e, t, i) {
                    var o, n, r, a, s = "table-format-", l = "table-format-preview";
                    for (n = 1; n <= i; n++)
                        r = s + t + n,
                            o = "custom" === t ? $("<span></span>").addClass(r + " " + l + " " + t + n).addClass("hiddenCustomStyle") : $("<span></span>").attr("title", t + n).addClass(r + " " + l + " " + t + n),
                            a = $("<span></span>").append(o).addClass(r + "-container container-span"),
                            $("<button></button>").append(a).addClass(r + "-button " + l + "-button").appendTo($("." + e))
                }
                function He() {
                    ne(),
                        re(),
                        se(),
                        le(),
                        ce(),
                        de(),
                        pe(),
                        ue(),
                        Gt(),
                        me(),
                        fe(),
                        R = !1
                }
                e.updateRibbonBarStyle = He;
                function Ue(e) {
                    var t = e.sheet.getValue(e.row, e.col)
                        , i = e.validator
                        , o = i.errorTitle()
                        , r = i.errorMessage();
                    o || (o = n.res.title),
                        i.showErrorMessage() ? (e.validationResult = 0,
                        0 === i.errorStyle() && (r || (r = n.res.dataValidationDialog.errorMessage1),
                            n.MessageBox.show(r, o, 3, 1, function(i, o) {
                                switch (o) {
                                    case 1:
                                        e.sheet.setActiveCell(e.row, e.col),
                                            e.sheet.setValue(e.row, e.col, t),
                                            e.sheet.startEdit(!0);
                                        break;
                                    case 4:
                                        e.sheet.setValue(e.row, e.col, t)
                                }
                            })),
                        1 === i.errorStyle() && (r || (r = n.res.dataValidationDialog.errorMessage2),
                            n.MessageBox.show(r, o, 2, 2, function(i, o) {
                                switch (o) {
                                    case 2:
                                        break;
                                    case 3:
                                        e.sheet.setActiveCell(e.row, e.col),
                                            e.sheet.setValue(e.row, e.col, t),
                                            e.sheet.startEdit(!0);
                                        break;
                                    case 4:
                                        e.sheet.setValue(e.row, e.col, t)
                                }
                            })),
                        2 === i.errorStyle() && (r || (r = n.res.dataValidationDialog.errorMessage1),
                            n.MessageBox.show(r, o, 1, 1, function(i, o) {
                                switch (o) {
                                    case 1:
                                        break;
                                    case 4:
                                        e.sheet.setValue(e.row, e.col, t)
                                }
                            }))) : e.validationResult = 0
                }
                e.validationError = Ue,
                    e.eventAttached = !1;
                function We(t) {
                    var i, r, a, s;
                    function l(e, t) {
                        i = !0,
                            setTimeout(function() {
                                i && (i = !1,
                                    re(),
                                    se(),
                                    ce(),
                                    de(),
                                    te(),
                                    ue(),
                                    Gt(),
                                    ti(),
                                    c())
                            }, 100)
                    }
                    function c() {
                        var e = $(".slider-panel");
                        $(".slider-panel-panel2", e).is(":visible") && e.sliderpanel("close", "panel2")
                    }
                    function d(e, t) {
                        r = !0,
                            setTimeout(function() {
                                r && (r = !1,
                                    le())
                            }, 100)
                    }
                    !t && e.eventAttached || (a = n.wrapper.spread,
                        s = n.wrapper.spreadElement,
                        a.bind(o.Events.EnterCell, l),
                        s.bind(o.Events.EnterCell, l),
                        a.bind(o.Events.SelectionChanged, d),
                        s.bind(o.Events.SelectionChanged, d),
                        ne(),
                        a.bind(o.Events.ActiveSheetChanged, function(e, t) {
                            pe(),
                                he()
                        }),
                        a.bind(o.Events.EditorStatusChanged, function(e, t) {
                            var i = $(".statusBar").find(".statusbar-edit-status");
                            switch (t.newStatus) {
                                case 2:
                                    i.text(n.res.statusBar.edit);
                                    break;
                                case 1:
                                    i.text(n.res.statusBar.enter);
                                    break;
                                case 0:
                                    i.text(n.res.statusBar.ready)
                            }
                        }),
                        a.bind(o.Events.UserZooming, function(e, t) {
                            he()
                        }),
                        a.bind(o.Events.ValidationError, function(e, t) {
                            Ue(t)
                        }),
                        a.bind(GC.Spread.Sheets.Events.SlicerChanged, function(e, t) {
                            _t(t.sheet, t.slicer, t.propertyName)
                        }),
                        a.bind(GC.Spread.Sheets.Events.FloatingObjectChanged, function(e, t) {
                            var i = t.floatingObject;
                            i && i instanceof o.Charts.Chart && qt(t.sheet, i, t.propertyName)
                        }),
                        a.bind(GC.Spread.Sheets.Events.FloatingObjectRemoved, function(e, t) {
                            c()
                        }),
                        a.bind(GC.Spread.Sheets.Events.ChartClicked, Mt),
                    e.eventAttached || ($(n).bind("updateRibbon", function(e, t) {
                        re()
                    }),
                        $(".designer-table-name").blur(function() {
                            n.actions.doAction("setTableName", n.wrapper.spread, $(this).val())
                        })),
                        e.eventAttached = !0,
                        n.util.bindDesignerEvent("chartChanged", function(e, t) {
                            V.refreshSliderPanel(t)
                        }))
                }
                e.attachEvent = We,
                    v = !1,
                    x = {
                        row: 0,
                        col: 0
                    };
                function _e() {
                    var e = o.Events.SelectionChanged + ".bindingPath"
                        , t = "click.indicator"
                        , i = "click.ok"
                        , r = "click.cancel"
                        , a = o.Events.TopRowChanged + ".bindingPath"
                        , s = "click.autoGenetateColumns"
                        , l = "click.dataFieldType"
                        , c = n.wrapper.spread
                        , d = $(".designer-data-binding-icon")
                        , p = $(".ok-table-binding-button")
                        , u = $(".cancel-table-binding-button")
                        , h = n.wrapper.spread.getActiveSheet()
                        , f = $(".auto-generate-columns")
                        , g = $(".data-binding-celltype-button");
                    qe(),
                        g.bind(l, function(e, t) {
                            var i, o, r, a, s, l, c;
                            $(".data-binding-celltype-option").gcuipopup("hide"),
                                o = $.fn.zTree.getZTreeObj("ztree-container"),
                            o && (r = o.getSelectedNodes()) && r.length >= 0 && (i = r[0]),
                            i && (a = $(this).data("datafieldtype"),
                                s = $("#" + i.tId + "_a"),
                            a && s.length > 0 && (s.find("." + A).remove(),
                                i.dataFieldType = a,
                                l = a + "-icon",
                                c = "<span class='button " + A + " " + l + "' title='" + n.res.ribbon.data[a] + "'></span>",
                                s.prepend(c),
                            a !== n.util.DataFieldType.table && a !== n.util.DataFieldType.combox || it("ztree-container", i.children)))
                        }),
                        c.bind(e, function(e, t) {
                            Ke()
                        }),
                        d.bind(t, function(e) {
                            var t, i, o, r, a, s, l, c, d, p, u, h, f, g, m, b, v, x, w, C, S, k = n.wrapper.spread.getActiveSheet();
                            if (k && (t = k.tables.find(k.getActiveRowIndex(), k.getActiveColumnIndex()))) {
                                for (y = t,
                                         i = $("#data-binding-setting-popup"),
                                         i.gcuipopup({
                                             autoHide: !0,
                                             showing: function(e, t) {
                                                 $(".data-binding-path-overlay").removeAttr("hidden"),
                                                     i.removeAttr("hidden")
                                             },
                                             hiding: function(e, t) {
                                                 $(".data-binding-path-overlay").attr("hidden", "hidden"),
                                                     i.attr("hidden", "hidden")
                                             }
                                         }),
                                         i.gcuipopup("show"),
                                         i.offset({
                                             top: $(this).offset().top + 8,
                                             left: $(this).offset().left + 8
                                         }),
                                         o = t.autoGenerateColumns(),
                                         $(".auto-generate-columns").prop("checked", o),
                                         r = $(".table-binding-path-input"),
                                     r.length > 0 && (a = t.bindingPath(),
                                     a || (a = null),
                                         r.val(a)),
                                         s = $(".table-column-data-field"),
                                         s.empty(),
                                         l = $(document.createDocumentFragment()),
                                         c = 0,
                                         d = $.fn.zTree.getZTreeObj("ztree-container"),
                                         p = r.val().split("."),
                                         u = d.getNodeByParam("name", p[p.length - 1]),
                                     u && u.children && u.dataFieldType === n.util.DataFieldType.table && (c = u.children.length),
                                         h = $("<select>").addClass("data-field-select"),
                                         f = 0; f <= c; f++)
                                    u && u.children && (g = u.children[f]) && g.name && $("<option>").val(g.name).text(g.name).appendTo(h),
                                    f === c && $("<option>").val("(empty)").text("(empty)").appendTo(h);
                                if (m = t.range()) {
                                    for (b = m.colCount,
                                             v = 0; v < b; v++)
                                        x = t.getColumnDataField(v),
                                            w = $("<div>").addClass("data-field-container").appendTo(l),
                                            $("<label>").addClass("data-field-block1").text("Column" + v + ": ").appendTo(w),
                                            C = h.clone(),
                                        o && C.attr("disabled", "disabled"),
                                            S = C.find("option[value=" + x + "]"),
                                            0 !== S.length ? S.attr("selected", "selected") : C.find("option[value='(empty)']").attr("selected", "selected"),
                                            C.appendTo(w);
                                    l.appendTo(s)
                                }
                            }
                        }),
                        p.bind(i, function(e) {
                            var t, i, r, a, s, l, c, d, p, u, h, f, g, m, b;
                            if ($("#data-binding-setting-popup").gcuipopup("hide"),
                                    t = $(".data-field-select"),
                                !((i = t.length) <= 0) && (r = y) && (a = n.wrapper.spread.getActiveSheet())) {
                                for (s = [],
                                         l = 0; l < i; l++)
                                    c = new o.Tables.TableColumn(l),
                                        d = $(t[l]).val(),
                                    d && "(empty)" !== d || (d = null),
                                        c.dataField(d),
                                        c.name(d),
                                        s.push(c);
                                if (r.bindColumns(s),
                                        p = $(".auto-generate-columns").prop("checked")) {
                                    if (u = r.endRow() - r.startRow() + 1,
                                            h = r.endColumn() - r.startColumn() + 1,
                                            !(f = $.fn.zTree.getZTreeObj("ztree-container")))
                                        return;
                                    g = $(".table-binding-path-input"),
                                        m = Vt(g.val()),
                                        b = m.length,
                                    b !== h && n.MessageBox.show(n.res.ribbon.data.warningTable, n.res.title, 2, 1, function(e, t) {
                                        if (1 === t) {
                                            for (r.autoGenerateColumns(p),
                                                     s = [],
                                                     l = 0; l < b; l++)
                                                c = new o.Tables.TableColumn(l),
                                                    c.dataField(m[l]),
                                                    c.name(m[l]),
                                                    s.push(c);
                                            return a.tables.resize(r, new o.Range(r.startRow(),r.startColumn(),u,b)),
                                                r.bindColumns(s),
                                                Ke(),
                                                void a.repaint()
                                        }
                                    })
                                }
                                r.autoGenerateColumns(p),
                                    a.repaint()
                            }
                        }),
                        u.bind(r, function(e) {
                            $("#data-binding-setting-popup").gcuipopup("hide")
                        }),
                        h.bind(a, function(e, t) {
                            Ke()
                        }),
                        f.bind(s, function(e, t) {
                            var i, o = $(".data-field-select");
                            o.length <= 0 || (i = $(this).prop("checked"),
                                i ? o.attr("disabled", "disabled") : o.removeAttr("disabled"))
                        })
                }
                function qe() {
                    var e = o.Events.SelectionChanged + ".bindingPath"
                        , t = "click.indicator"
                        , i = "click.ok"
                        , r = "click.cancel"
                        , a = o.Events.TopRowChanged + ".bindingPath"
                        , s = "click.autoGenetateColumns"
                        , l = "click.dataFieldType"
                        , c = n.wrapper.spread
                        , d = $(".designer-data-binding-icon")
                        , p = $(".ok-table-binding-button")
                        , u = $(".cancel-table-binding-button")
                        , h = n.wrapper.spread.getActiveSheet()
                        , f = $(".auto-generate-columns")
                        , g = $(".data-binding-celltype-button");
                    c.unbind(e),
                        d.unbind(t),
                        p.unbind(i),
                        u.unbind(r),
                        h.unbind(a),
                        f.unbind(s),
                        g.unbind(l)
                }
                function Ke() {
                    var e, t, i, r, a, s, l, c, d, p, u, h = n.wrapper.spread.getActiveSheet();
                    if (h) {
                        if (e = $("#data-binding-setting-indicator"),
                                t = h.getActiveRowIndex(),
                                i = h.getActiveColumnIndex(),
                            (r = h.tables.find(t, i)) && null !== (a = r.bindingPath()) && void 0 !== a && "" !== a) {
                            if (s = r.range(),
                                    l = Rt(s),
                                    c = Rt(new o.Range(t,i,1,1)),
                                0 === l.length && e.attr("hidden", "hidden"),
                                0 === c.length)
                                return;
                            for (d = c[0],
                                     p = 0; p < l.length; p++)
                                if (u = l[p],
                                    u.x <= d.x && d.x + d.width <= u.x + u.width && u.y <= d.y && d.y + d.height <= u.y + u.height)
                                    return void e.css({
                                        left: u.x + u.width - e.width(),
                                        top: u.y
                                    }).removeAttr("hidden")
                        }
                        e.attr("hidden", "hidden")
                    }
                }
                function Ye() {
                    var e, t, i, o, r, a, s, l, c, d = n.wrapper.spread.getActiveSheet();
                    if (d)
                        for (e = d.getSelections(),
                                 t = d.getRowCount(),
                                 i = d.getColumnCount(),
                                 o = 0; o < e.length; o++)
                            if (r = e[o],
                                    a = r.row,
                                    s = r.col,
                                -1 === r.col && -1 === r.row)
                                for (l = 0; l < t; l++)
                                    for (c = 0; c < i; c++)
                                        Xe(l, c);
                            else if (-1 === r.row)
                                for (l = 0; l < t; l++)
                                    for (c = s; c < s + r.colCount; c++)
                                        Xe(l, c);
                            else if (-1 === r.col)
                                for (l = a; l < a + r.rowCount; l++)
                                    for (c = 0; c < i; c++)
                                        Xe(l, c);
                            else
                                for (l = a; l < a + r.rowCount; l++)
                                    for (c = s; c < s + r.colCount; c++)
                                        Xe(l, c)
                }
                function Xe(e, t) {
                    var i, o = n.wrapper.spread.getActiveSheet();
                    o && (i = o.tables.find(e, t),
                    i && i.bindingPath() && i.bindingPath(null),
                    o.getBindingPath(e, t) && o.setBindingPath(e, t, null))
                }
                function Je() {
                    var e = {
                        title: n.res.ribbon.data.loadSchema,
                        nameFilters: [n.res.ribbon.data.loadDataSourceFilter.json, n.res.ribbon.data.loadDataSourceFilter.txt]
                    }
                        , t = function(e) {
                        "cancelled" !== e.status && et(e)
                    };
                    p.showOpenDialog(e, t)
                }
                function Qe(e) {
                    $.isArray(e) ? $.each(e, function(e, t) {
                        Qe(t)
                    }) : e.children && $.isArray(e.children) && $.each(e.children, function(e, t) {
                        Qe(t)
                    }),
                    e.isArray && (e.type = "array")
                }
                function Ze() {
                    var e = {
                        title: n.res.ribbon.data.saveSchema,
                        nameFilters: [n.res.ribbon.data.saveDataSourceFilter.json]
                    }
                        , t = function(e) {
                        var t, i, o;
                        "cancelled" !== e.status && (t = $.fn.zTree.getZTreeObj("ztree-container"),
                            i = t.getNodesByParam("level", 0)[0],
                            o = [],
                        i.children && Ft(i.children, o),
                            p.save(e.fileName, JSON.stringify(n.util.saveJSONSchema(o)), function(e) {
                                "failed" === e.status && n.MessageBox.show(e.message, n.res.title, 3)
                            }, !1))
                    };
                    p.showSaveDialog(e, t)
                }
                function et(e) {
                    var t, i, r;
                    if ("failed" === e.status)
                        n.MessageBox.show(e.message, n.res.title, 3);
                    else
                        try {
                            t = JSON.parse(e.data),
                            0 === $("#" + D).length && jt(),
                                i = [],
                                t.$schema ? i = n.util.parseJsonSchema(t) : $.isArray(t) ? tt(t) ? (t.splice(t.length - 1),
                                    Qe(t),
                                    i = t) : Lt(t[0], i) : (Lt(t, i),
                                    a = new o.Bindings.CellBindingSource(t)),
                                r = {
                                    name: "Source"
                                },
                            i.length > 0 && (r.children = i),
                                lt(D, [r], !0),
                                it(D)
                        } catch (e) {
                            n.MessageBox.show(n.res.ribbon.data.loadDataError, n.res.title, 3)
                        }
                }
                function tt(e) {
                    var t, i = e.length;
                    return 0 !== i && (t = e[i - 1],
                        !(!t.designerNativeSchemaMark || 1 !== t.designerNativeSchemaMark))
                }
                function it(e, t) {
                    var i = $.fn.zTree.getZTreeObj(e);
                    i && (i.expandAll(!0),
                        ot(t && t.length > 0 ? t : i.getNodes()))
                }
                function ot(e) {
                    var t, i, o = e.length;
                    for (t = 0; t < o; t++)
                        i = e[t],
                            nt(i),
                        i && i.children && i.children.length > 0 && ot(i.children)
                }
                function nt(e) {
                    var t, i, o, r;
                    e && 0 !== e.level && (!(t = $("#" + e.tId + "_a")) || t.length <= 0 || (t.find("." + A).length > 0 && t.children("." + A).remove(),
                    St(e) || kt(e) || (e.dataFieldType ? i = e.dataFieldType : e.enum ? i = n.util.DataFieldType.combox : e.type && n.util.DefaultTypeDic[e.type] && (i = n.util.DefaultTypeDic[e.type]),
                    i || (i = n.util.DataFieldType.text),
                        o = i + "-icon",
                        r = "<span class='button " + A + " " + o + "' title='" + n.res.ribbon.data[i] + "'></span>",
                        t.prepend(r),
                        e.dataFieldType = i)))
                }
                function rt(e) {
                    return typeof e === n.util.BasicDataType.Object ? null === e ? n.util.BasicDataType.Null : e.constructor === [].constructor ? n.util.BasicDataType.Array : n.util.BasicDataType.Object : typeof e
                }
                w = o.CellTypes.Text.prototype.getText,
                    C = o.CellTypes.CheckBox.prototype.getText,
                    S = o.CellTypes.Button.prototype.getText,
                    k = o.CellTypes.HyperLink.prototype.getText,
                    T = o.CellTypes.ComboBox.prototype.getText;
                function at() {
                    o.CellTypes.Text.prototype.getText = function(e, t) {
                        var i = t.sheet.getBindingPath(t.row, t.col);
                        return i ? "[" + i + "]" : w.apply(this, arguments)
                    }
                        ,
                        o.CellTypes.CheckBox.prototype.getText = function(e, t) {
                            var i = t.sheet.getBindingPath(t.row, t.col);
                            return i ? "[" + i + "]" : C.apply(this, arguments)
                        }
                        ,
                        o.CellTypes.Button.prototype.getText = function(e, t) {
                            var i = t.sheet.getBindingPath(t.row, t.col);
                            return i ? "[" + i + "]" : S.apply(this, arguments)
                        }
                        ,
                        o.CellTypes.HyperLink.prototype.getText = function(e, t) {
                            var i = t.sheet.getBindingPath(t.row, t.col);
                            return i ? "[" + i + "]" : k.apply(this, arguments)
                        }
                        ,
                        o.CellTypes.ComboBox.prototype.getText = function(e, t) {
                            var i = t.sheet.getBindingPath(t.row, t.col);
                            return i ? "[" + i + "]" : T.apply(this, arguments)
                        }
                }
                function st() {
                    o.CellTypes.Text.prototype.getText = w,
                        o.CellTypes.CheckBox.prototype.getText = C,
                        o.CellTypes.Button.prototype.getText = S,
                        o.CellTypes.HyperLink.prototype.getText = k,
                        o.CellTypes.ComboBox.prototype.getText = T
                }
                function lt(e, t, i) {
                    if (null !== $.fn.zTree.getZTreeObj(e)) {
                        if (!i)
                            return;
                        $.fn.zTree.destroy(e)
                    }
                    var o = {
                        view: {
                            showIcon: !1,
                            addHoverDom: function(e, t) {
                                ut(e, t)
                            },
                            removeHoverDom: ft,
                            selectedMulti: !1
                        },
                        edit: {
                            enable: !0,
                            editNameSelectAll: !0,
                            showRemoveBtn: dt,
                            showRenameBtn: pt,
                            removeTitle: n.res.ribbon.data.remove,
                            renameTitle: n.res.ribbon.data.rename
                        },
                        callback: {
                            onDblClick: function(e, t, i) {
                                gt(e, i)
                            },
                            beforeDrop: function(e, t, i, o) {
                                return Dt(e, t, i, o)
                            },
                            onDrop: function(e, t, i, o, n) {
                                $t(e, t, i, o, n)
                            },
                            onMouseDown: function(e, t, i) {
                                mt(e, i)
                            },
                            beforeRemove: function(e, t) {
                                return ct(e, t)
                            }
                        }
                    };
                    $("#" + e).empty(),
                        $.fn.zTree.init($("#" + e), o, t),
                        it(e)
                }
                function ct(e, t) {
                    return !(t && t.children && t.children.length > 0) || (n.MessageBox.show(n.res.ribbon.data.removeNodeWarning, n.res.title, 2, 1, function(e, i) {
                        var o = $.fn.zTree.getZTreeObj("ztree-container");
                        1 === i && o.removeNode(t, !1)
                    }),
                        !1)
                }
                function dt(e, t) {
                    return 0 !== t.level
                }
                function pt(e, t) {
                    return 0 !== t.level
                }
                function ut(e, t) {
                    var i, o, r, a, s, l = $("#" + t.tId + "_span");
                    t.editNameFlag || $("#addBtn_" + t.tId).length > 0 || (i = "<span class='button add' id='addBtn_" + t.tId + "' title='" + n.res.ribbon.data.addNode + "'></span>",
                        l.after(i),
                        o = $("#addBtn_" + t.tId),
                    o && o.bind("click", function() {
                        var i = $.fn.zTree.getZTreeObj(e)
                            , o = i.addNodes(t, [{
                            name: ht(i, t)
                        }]);
                        return i.cancelEditName(),
                            i.editName(o[0]),
                            nt(o[0]),
                            !1
                    }),
                    $("#arrayBtn_" + t.tId).length <= 0 && 0 !== t.level && (r = "<span class='button options' id='arrayBtn_" + t.tId + "' title='" + n.res.ribbon.data.selectOptions + "' onfocus='this.blur();'></span>",
                        a = $("#" + t.tId + "_a"),
                        a.append(r),
                    (s = $("#arrayBtn_" + t.tId)) && s.bind("click", function(i) {
                        var o, n, r = $.fn.zTree.getZTreeObj(e);
                        return r.selectNode(t),
                            o = $(".data-binding-celltype-button"),
                            o.button(),
                            n = $(".data-binding-celltype-option").gcuipopup({
                                autoHide: !0,
                                position: {
                                    of: $(".button.options"),
                                    my: "center top",
                                    at: "center bottom"
                                }
                            }),
                            n.gcuipopup("show"),
                            !1
                    })),
                    (St(t) || kt(t)) && ($("#addBtn_" + t.tId).remove(),
                        $("#arrayBtn_" + t.tId).remove()))
                }
                function ht(e, t) {
                    var i, o = "field-", n = t.children ? t.children.length : 0;
                    if (0 === t.level)
                        o += n;
                    else {
                        for (i = [],
                                 i.push(n); !t || 0 !== t.level; )
                            i.splice(0, 0, e.getNodeIndex(t)),
                                t = t.getParentNode();
                        i.length > 0 && (o += i.join(""))
                    }
                    return o
                }
                function ft(e, t) {
                    $("#addBtn_" + t.tId).unbind().remove(),
                        $("#arrayBtn_" + t.tId).unbind().remove()
                }
                function gt(e, t) {
                    var i, o, r = n.wrapper.spread.getActiveSheet();
                    r && (i = r.getSelections(),
                    i.length <= 0 || t && (o = i[0],
                        wt(t, o.row, o.col, function() {
                            xt(t, o.row, o.col)
                        })))
                }
                function mt(e, t) {
                    bt()
                }
                function bt() {
                    v || ($(document).bind("mousemove.bindingPath", function(e) {
                        vt(e)
                    }).bind("mouseup.bindingPath", function(e) {
                        yt(e)
                    }),
                        v = !0)
                }
                function vt(e) {
                    var t, i, r, a, s, l, c, d, p, u, h = $.fn.zTree.getZTreeObj("ztree-container");
                    h && (t = n.wrapper.spread.getActiveSheet(),
                        i = At(e),
                    isNaN(i.row) || isNaN(i.col) || (r = [],
                        s = t.tables.find(i.row, i.col),
                        l = h.getSelectedNodes()[0],
                        s ? (c = s.range(),
                            d = c.row,
                            p = l.getParentNode(),
                            a = p && It(p) === s.bindingPath() && p.dataFieldType === n.util.DataFieldType.table ? new o.Range(d,i.col,c.rowCount,1) : c,
                            r = Rt(a)) : St(l) ? r = [] : kt(l) && t.getCellType(i.row, i.col).constructor !== o.CellTypes.ComboBox ? r = [] : (u = t.getSelections()) && u.length > 0 && (a = u[0],
                            a.contains(i.row, i.col, 1, 1) ? r = Rt(a) : (a = new o.Range(i.row,i.col,1,1),
                                r = Rt(a))),
                        Nt(r)))
                }
                function yt(e) {
                    var t, i, o, n, r, a;
                    $(document).unbind("mousemove.bindingPath"),
                        $(document).unbind("mouseup.bindingPath"),
                        t = $(".data-binding-decoration"),
                        t.remove(),
                        v = !1,
                        i = At(e),
                        o = i.row,
                        n = i.col,
                    isNaN(o) || isNaN(n) || (r = $.fn.zTree.getZTreeObj("ztree-container")) && (a = r.getSelectedNodes()[0],
                        wt(a, o, n, function() {
                            xt(a, o, n)
                        }))
                }
                function xt(e, t, i) {
                    var r, a, s, l, c, d, p, u, h, f = n.wrapper.spread.getActiveSheet();
                    if (f)
                        if (r = e.getParentNode(),
                                a = f.tables.find(t, i),
                                s = f.getCellType(t, i),
                                l = f.getSelections()[0],
                            e.dataFieldType && e.dataFieldType === n.util.DataFieldType.table)
                            c = It(e),
                                d = Vt(c),
                                a ? Pt(a, c, d) : l.contains(t, i, 1, 1) ? zt(l, c, d) : (p = new o.Range(t,i,1,1),
                                    zt(p, c, d));
                        else if (a && r && It(r) === a.bindingPath() && r.dataFieldType === n.util.DataFieldType.table)
                            u = It(e).split("."),
                                Bt(i - a.range().col, u[u.length - 1], a);
                        else if (s && s.constructor === o.CellTypes.ComboBox && r && r.dataFieldType === n.util.DataFieldType.combox)
                            h = s.items(),
                            -1 === h.indexOf(e.name) && (h.push(e.name),
                                s.items(h));
                        else {
                            if (St(e))
                                return void n.MessageBox.show(n.res.ribbon.data.unallowableTableBindingTip, n.res.title, 2, 0);
                            if (kt(e))
                                return void n.MessageBox.show(n.res.ribbon.data.unallowComboxBindingTip, n.res.title, 2, 0);
                            l.contains(t, i, 1, 1) ? (x.row = l.row,
                                x.col = l.col) : (x.row = t,
                                x.col = i),
                                Tt(e)
                        }
                }
                function wt(e, t, i, r) {
                    var a, s, l, c, d, p, u, h, f, g;
                    if (e && !isNaN(t) && !isNaN(i) && (a = $.fn.zTree.getZTreeObj("ztree-container"))) {
                        for (s = n.wrapper.spread.getActiveSheet(),
                                 l = a.getNodesByFilter(Ct, !1, e),
                                 c = 0,
                                 d = 0; d < l.length; d++)
                            p = l[d].level - e.level,
                                c = Math.max(c, p);
                        for (u = L ? i + c + 1 : i + c,
                                 h = t + l.length,
                                 f = !0,
                                 d = t; d <= h; d++)
                            for (g = i; g <= u; g++)
                                if (s.getCellType(d, g).constructor !== o.CellTypes.Text) {
                                    f = !1;
                                    break
                                }
                        f ? r() : n.MessageBox.show(n.res.ribbon.data.overwriteCellTypeWarning, n.res.title, 2, 1, function(e, t) {
                            1 === t && r()
                        })
                    }
                }
                function Ct(e) {
                    return !(!e || St(e) || kt(e))
                }
                function St(e) {
                    var t = $.extend({}, e.getParentNode());
                    if (!t || $.isEmptyObject(t))
                        return !1;
                    for (; t && t.dataFieldType !== n.util.DataFieldType.table && 0 !== t.level; )
                        t = t.getParentNode();
                    return !t || 0 !== t.level
                }
                function kt(e) {
                    var t = $.extend({}, e.getParentNode());
                    if (!t || $.isEmptyObject(t))
                        return !1;
                    for (; t && t.dataFieldType !== n.util.DataFieldType.combox && 0 !== t.level; )
                        t = t.getParentNode();
                    return !t || 0 !== t.level
                }
                function Tt(e) {
                    var t, i, r, a, s, l, c, d, p, u, h, f, g, m, b = $.fn.zTree.getZTreeObj("ztree-container");
                    if (b) {
                        if (t = b.getSelectedNodes()[0],
                                i = 0,
                                i = 0 === t.level ? e.level - t.level - 1 : e.level - t.level,
                                r = n.wrapper.spread.getActiveSheet(),
                                a = It(e),
                            e.dataFieldType === n.util.DataFieldType.table)
                            return s = Vt(It(e)),
                                l = new o.Range(x.row,x.col + i,1,1),
                                void ((c = zt(l, a, s)) && (x.row += 2));
                        if (e.dataFieldType === n.util.DataFieldType.combox)
                            return d = new o.CellTypes.ComboBox,
                                p = e.enum ? e.enum : Vt(It(e)),
                            p && p.length > 0 && d.items(p),
                                L ? (r.setValue(x.row, x.col + i, e.name),
                                    r.getCell(x.row, x.col + i + 1).bindingPath(a),
                                    r.setCellType(x.row, x.col + i + 1, d)) : (r.getCell(x.row, x.col + i).bindingPath(a),
                                    r.setCellType(x.row, x.col + i, d)),
                                void x.row++;
                        if ((u = e.children) && u.length > 0)
                            for (0 !== e.level && (r.setValue(x.row, x.col + i, e.name),
                                x.row++),
                                     h = 0; h < u.length; h++)
                                Tt(u[h]);
                        else {
                            switch (f = 0,
                                g = 0,
                                L ? (f = x.row,
                                    g = x.col + i + 1,
                                    r.setValue(f, g - 1, e.name),
                                    r.getCell(f, g).bindingPath(a)) : (f = x.row,
                                    g = x.col + i,
                                    r.getCell(f, g).bindingPath(a)),
                                x.row++,
                                e.dataFieldType) {
                                case n.util.DataFieldType.button:
                                    m = new o.CellTypes.Button,
                                        m.text("Button");
                                    break;
                                case n.util.DataFieldType.checkbox:
                                    m = new o.CellTypes.CheckBox,
                                        m.caption("CheckBox");
                                    break;
                                case n.util.DataFieldType.hyperlink:
                                    m = new o.CellTypes.HyperLink,
                                        m.text("Hyperlink")
                            }
                            m && r.setCellType(f, g, m)
                        }
                    }
                }
                function At(e) {
                    var t, i = n.wrapper.spread.getActiveSheet();
                    if (i)
                        return t = $(n.util.getCanvas(n.wrapper.spread)).offset(),
                            i.hitTest(e.pageX - t.left, e.pageY - t.top)
                }
                function It(e) {
                    for (var t = [], i = e; 0 !== i.level; )
                        t.splice(0, 0, i.name),
                            i = i.getParentNode();
                    return t.join(".")
                }
                function Dt(e, t, i, o) {
                    var r, a;
                    return !(null === i || "inner" !== o && !i.parentTId) && (!!Ct(i) && (r = i.dataFieldType,
                        a = n.util.DataFieldType,
                    r !== a.table && r !== a.combox || !t[0].children || !(t[0].children.length > 0)))
                }
                function $t(e, t, i, o, n) {
                    it(t)
                }
                function Ft(e, t) {
                    var i, o, n;
                    if (e)
                        for (i = e.length,
                                 o = 0; o < i; o++)
                            n = {},
                                n.name = e[o].name,
                            e[o].type && (n.type = e[o].type),
                            e[o].dataFieldType && (n.dataFieldType = e[o].dataFieldType),
                            e[o].enum && (n.enum = e[o].enum),
                            e[o].children && e[o].children.length > 0 && (n.children = [],
                                Ft(e[o].children, n.children)),
                                t.push(n)
                }
                e.treeNodeToArray = Ft;
                function Lt(e, t) {
                    $.each(e, function(e, i) {
                        var o = {};
                        o.name = e,
                        "array" === rt(i) && (o.type = "array"),
                        "object" === rt(i) && (o.children = [],
                            Lt(i, o.children)),
                            t.push(o)
                    })
                }
                function Rt(e) {
                    var t, i, r, a, s, l, c, d, p, u, h, f, g = n.wrapper.spread.getActiveSheet();
                    if (g) {
                        for (t = $(n.util.getCanvas(n.wrapper.spread)).offset(),
                                 i = [],
                                 r = 0; r <= 2; r++)
                            for (a = 0; a <= 2; a++)
                                s = g.getViewportLeftColumn(a),
                                    l = g.getViewportRightColumn(a),
                                    c = g.getViewportTopRow(r),
                                    d = g.getViewportBottomRow(r),
                                    p = new o.Range(c,s,d - c + 1,l - s + 1),
                                (u = e.getIntersect(p, Math.max(p.rowCount, e.rowCount), Math.max(p.colCount, e.colCount))) && (h = new o.Rect,
                                    f = g.getRangeRect(r, a, u),
                                    h.x = f.x + t.left,
                                    h.y = f.y + t.top,
                                    h.width = f.width - 2,
                                    h.height = f.height - 2,
                                    i.push(h));
                        return i
                    }
                }
                function Bt(e, t, i) {
                    var o, r = n.wrapper.spread.getActiveSheet();
                    i && t && r && (o = i.autoGenerateColumns(),
                        o ? n.MessageBox.show(n.res.ribbon.data.warningDataField, n.res.title, 2, 1, function(o, n) {
                            4 !== n && (i.autoGenerateColumns(!1),
                                i.setColumnName(e, t),
                                i.setColumnDataField(e, t),
                                r.repaint())
                        }) : (i.setColumnName(e, t),
                            i.setColumnDataField(e, t),
                            r.repaint()))
                }
                function Nt(e) {
                    var t, i, o, n, r = $(".data-binding-decoration-container");
                    if (r.empty(),
                        e && !(e.length <= 0)) {
                        for (t = $(document.createDocumentFragment()),
                                 i = 0; i < e.length; i++)
                            o = $("<div>").addClass("data-binding-decoration").appendTo(t),
                                n = e[i],
                                o.css({
                                    width: n.width,
                                    height: n.height,
                                    display: "inline-block"
                                }),
                                o.offset({
                                    left: n.x,
                                    top: n.y
                                });
                        t.appendTo(r)
                    }
                }
                function Et() {
                    var e, t, i, o, r, a = n.wrapper.spread, s = a.sheets, l = s.length;
                    for (e = 0; e < 1e5; e++)
                        for (t = "gcTable" + e,
                                 i = 0; i < l && (o = s[i],
                            !(r = o.tables.findByName(t))); i++)
                            if (i === l - 1)
                                return t
                }
                function Vt(e) {
                    var t, i, o, n, r, a = [];
                    if (e && (t = $.fn.zTree.getZTreeObj("ztree-container"))) {
                        if (o = e.split("."),
                            o.length > 0 && (i = o[o.length - 1]),
                            (n = t.getNodeByParam("name", i)) && n.children)
                            for (r = 0; r < n.children.length; r++)
                                a.push(n.children[r].name);
                        return a
                    }
                }
                function Pt(e, t, i) {
                    var r, a, s, l, c, d, p, u;
                    if (e && (r = n.wrapper.spread.getActiveSheet())) {
                        if (e.bindingPath(t),
                                e.autoGenerateColumns(!1),
                                a = i ? i.length : 0,
                                s = e.endColumn() - e.startColumn() + 1,
                                l = Math.max(a, s),
                                c = [],
                                e.bindColumns(c),
                            l > 0) {
                            for (d = 0; d < l; d++)
                                p = null,
                                    u = new o.Tables.TableColumn(d),
                                i && i[d] && (p = i[d],
                                    u.name(p)),
                                    u.dataField(p),
                                    c.push(u);
                            e.bindColumns(c)
                        }
                        Ke(),
                            r.repaint()
                    }
                }
                function zt(e, t, i) {
                    var o, r, a, s, l, c, d, p;
                    if (e) {
                        o = n.wrapper.spread.getActiveSheet(),
                            r = i ? i.length : 0,
                            a = Math.max(2, e.rowCount),
                            s = Math.max(r, e.colCount),
                            l = -1 === e.row ? 0 : e.row,
                            c = -1 === e.col ? 0 : e.col,
                            d = null;
                        try {
                            L ? (p = t.split(".").pop(),
                                o.setValue(l, c, p),
                                d = o.tables.add(Et(), l, c + 1, a, s)) : d = o.tables.add(Et(), l, c, a, s),
                                Pt(d, t, i),
                                o.clearSelection(),
                                o.setSelection(l, L ? c + 1 : c, a, s)
                        } catch (e) {
                            return void n.MessageBox.show(e.message, n.res.title, 3, 0)
                        }
                        return d
                    }
                }
                function jt() {
                    var e, t, i, o, r, a, s, l, c, d = n.wrapper.spread.getActiveSheet(), p = $(".slider-panel");
                    p.sliderpanel(),
                        e = p.sliderpanel("getContainer", "panel1"),
                        t = $(".design-mode-panel-header"),
                    t.length <= 0 && (i = $("<div>").css({
                        height: "60px",
                        background: "-webkit-gradient(linear, left top, left bottom, color-stop(15%,#E4E5E8), color-stop(85%, rgb(211, 211, 211)))",
                        color: "rgba(0, 0, 0, 0.6)"
                    }).addClass("design-mode-panel-header").appendTo(e),
                        o = $("<div>").css({
                            padding: "10px 5px"
                        }).appendTo(i),
                        $("<label>").text(n.res.sliderPanel.title).css({
                            font: "Bold 12pt Calibri"
                        }).appendTo(o)),
                        r = $(".design-mode-panel-content"),
                    r.length <= 0 && (a = $("<div>").css({
                        width: "100%",
                        overflow: "auto",
                        position: "absolute",
                        top: "60px",
                        bottom: "0"
                    }).addClass("slider-panel-content design-mode-panel-content").appendTo(e),
                        s = $("#" + I),
                    s.length <= 0 && $("<div>").attr("id", I).addClass("ztree").appendTo(a)),
                        l = {
                            name: "Source"
                        },
                        n.wrapper.spread.designerBindingPathSchema && !R ? (c = n.wrapper.spread.designerBindingPathSchema,
                            c.$schema ? (l.children = n.util.parseJsonSchema(c),
                                lt("ztree-container", [l], !0)) : $.isArray(c) && tt(c) && (c.splice(c.length - 1),
                                Qe(c),
                                l.children = c,
                                lt("ztree-container", l, !0)),
                            R = !0) : lt("ztree-container", [l]),
                    d.getDataSource() && d.setDataSource(null),
                        _e()
                }
                function Mt(e, t) {
                    var i, o, n, r, a, l = s.chartElementType, c = t.options.category, d = t.chart;
                    0 === t.elementType ? (o = t.options.info && t.options.info.index,
                        i = l[t.elementType] + " " + c[o]) : 1 === t.elementType && (n = "x" === (t.options.info && t.options.info.axisType) ? "Category" : "Value",
                        r = t.options.info && t.options.info.axisPosition,
                    s.isBarGroup(d) && (n = "y" === (t.options.info && t.options.info.axisType) ? "Category" : "Value"),
                        i = r + n),
                        a = l[t.elementType],
                        i = i || a,
                        V.initChartSliderPanel(d, a, i, c)
                }
                e.chartClicked = Mt;
                function Ot() {
                    var e = n.wrapper.spread
                        , t = e.getActiveSheet()
                        , i = n.util.getSelectedSlicers(t)[0];
                    K(),
                        Ht(),
                    i && Ut(i)
                }
                e.insertTableSlicer = Ot;
                function Gt() {
                    $("a[href='#slicerTab']").is(":visible") && $(".ribbon-bar").gcuiribbon("setTabPageVisible", "slicerTab", !1)
                }
                function Ht() {
                    var e, t, i, o, n, r, a, s, l;
                    $(".ribbon-bar").gcuiribbon("setTabPageVisible", "slicerTab", !0),
                        $(".ribbon-bar").gcuitabs("select", "slicerTab"),
                        e = $("#slicerTab>ul").find("li:eq(2)"),
                        t = e.find("button:eq(0)").width(),
                        i = e.find("button:eq(1)").width(),
                        o = e.find("button:eq(1)").width(),
                        n = t > i ? t : i,
                        n = n > o ? n : o,
                        r = $("#slicerTab>ul").find("li:eq(3)"),
                        a = r.find("button:eq(0)").width(),
                        s = r.find("button:eq(1)").width(),
                        l = a > s ? a : s,
                        $("#slicerTab>ul").find("li:eq(2)").find("button").width(n),
                        $("#slicerTab>ul").find("li:eq(3)").find("button").width(l),
                        $("#slicerTab>ul").find("li:gt(1)").find("button").find("span:gt(0)").css("text-align", "start")
                }
                e.showSlicerTab = Ht;
                function Ut(e) {
                    if (e) {
                        K(),
                            $(".slicer-ribbon-icon").attr("disabled", !0),
                            $(".slicer-caption-name").val(e.captionName()),
                            $("#slicer-shape-width").val(Math.round(e.width())),
                            $("#slicer-shape-height").val(Math.round(e.height())),
                            $("#slicer-column-count").val(e.columnCount()),
                            $("#slicer-item-height").val(Math.round(e.itemHeight()));
                        var t = n.util.getSlicerItemWidth(e.columnCount(), e.width());
                        $("#slicer-item-width").val(t),
                            Ht(),
                            Yt("caption-name", $(".slicer-caption-name")),
                            Yt("shape-width", $("#slicer-shape-width")),
                            Yt("shape-height", $("#slicer-shape-height")),
                            Yt("column-count", $("#slicer-column-count")),
                            Yt("item-height", $("#slicer-item-height")),
                            Yt("item-width", $("#slicer-item-width"))
                    }
                }
                function Wt() {
                    $(".slicer-caption-name").val(""),
                        $("#slicer-shape-width").val(""),
                        $("#slicer-shape-height").val(""),
                        $("#slicer-column-count").val(""),
                        $("#slicer-item-height").val(""),
                        $("#slicer-item-width").val(""),
                        Gt(),
                        Kt($(".slicer-caption-name")),
                        Kt($("#slicer-shape-width")),
                        Kt($("#slicer-shape-height")),
                        Kt($("#slicer-column-count")),
                        Kt($("#slicer-item-height")),
                        Kt($("#slicer-item-width")),
                        ti()
                }
                e.clearSlicerTab = Wt;
                function _t(e, t, i) {
                    t && ("isSelected" === i ? t.isSelected() ? !e.options.protectionOptions.allowEditObjects && e.options.isProtected && t.isLocked() || (Ut(t),
                        $("#clipboardgroup li:gt(0)").hide()) : Wt() : Jt(t, i))
                }
                function qt(e, t, i) {
                    "isSelected" === i && te(t)
                }
                function Kt(e) {
                    e.unbind("input")
                }
                function Yt(e, t) {
                    var i = n.wrapper.spread;
                    t.bind("input", {
                        spread: i
                    }, function(i) {
                        var o, r, a = i.data && i.data.spread, s = a.getActiveSheet();
                        n.util.isSlicerSelected(s) && (o = n.util.getSelectedSlicers(s),
                            r = t.val(),
                            Xt(e, o, r))
                    })
                }
                function Xt(e, t, i) {
                    var o, r, a, s, l, c, d, p, u;
                    if (t && 0 !== t.length && ($.isNumeric(i) || "caption-name" === e))
                        switch (e) {
                            case "caption-name":
                                a = i,
                                    n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["captionName", a, t]);
                                break;
                            case "shape-width":
                                r = n.util.formatNumber(i),
                                    n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["width", r, t]),
                                t.length > 0 && (o = t[t.length - 1],
                                    $("#slicer-item-width").val(n.util.getSlicerItemWidth(o.columnCount(), o.width())));
                                break;
                            case "shape-height":
                                s = n.util.formatNumber(i),
                                    n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["height", s, t]);
                                break;
                            case "column-count":
                                l = n.util.formatNumber(i),
                                    n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["columnCount", l, t]),
                                t.length > 0 && (o = t[t.length - 1],
                                    $("#slicer-item-width").val(n.util.getSlicerItemWidth(o.columnCount(), o.width())));
                                break;
                            case "item-height":
                                c = n.util.formatNumber(i),
                                    n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["itemHeight", c, t]);
                                break;
                            case "item-width":
                                for (d = n.util.formatNumber(i),
                                         p = [],
                                         u = 0; u < t.length; u++)
                                    o = t[u],
                                        r = n.util.getSlicerWidthFromItem(o.columnCount(), d),
                                        p.push(r);
                                n.actions.doAction("slicerPropertyChanged", n.wrapper.spread, ["width", p, t]),
                                t.length > 0 && $("#slicer-shape-width").val(p[p.length - 1])
                        }
                }
                function Jt(e, t) {
                    if (e)
                        switch (t) {
                            case "width":
                                $("#slicer-shape-width").val(e.width()),
                                    $("#slicer-item-width").val(n.util.getSlicerItemWidth(e.columnCount(), e.width()));
                                break;
                            case "height":
                                $("#slicer-shape-height").val(e.height());
                                break;
                            case "columnCount":
                                $("#slicer-column-count").val(e.columnCount());
                                break;
                            case "itemHeight":
                                $("#slicer-item-height").val(e.itemHeight());
                                break;
                            case "captionName":
                                $(".slicer-caption-name").val(e.captionName())
                        }
                }
                function Qt(e, t) {
                    if (n.util.isSlicerSelected(e)) {
                        var i = null;
                        switch (t) {
                            case "light1":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.light1();
                                break;
                            case "light2":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.light2();
                                break;
                            case "light3":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.light3();
                                break;
                            case "light4":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.light4();
                                break;
                            case "light5":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.light5();
                                break;
                            case "light6":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.light6();
                                break;
                            case "other1":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.other1();
                                break;
                            case "other2":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.other2();
                                break;
                            case "dark1":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.dark1();
                                break;
                            case "dark2":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.dark2();
                                break;
                            case "dark3":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.dark3();
                                break;
                            case "dark4":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.dark4();
                                break;
                            case "dark5":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.dark5();
                                break;
                            case "dark6":
                                i = GC.Spread.Sheets.Slicers.SlicerStyles.dark6()
                        }
                        return i
                    }
                }
                function Zt() {
                    var e, t = 8, i = 8, o = 6;
                    ei("slicer-custom-preview", "custom", t),
                        ei("slicer-light-preview", "light", i),
                        ei("slicer-dark-preview", "dark", o),
                        $(".slicer-format-preview, .slicer-format-preview-button").mouseenter(function(e) {
                            var t = e.srcElement || e.target;
                            $(t).closest("button").find("span.container-span").addClass("ui-state-hover")
                        }),
                        $(".slicer-format-preview, .slicer-format-preview-button").mouseout(function(e) {
                            var t = e.srcElement || e.target;
                            $(t).closest("button").find("span.container-span").removeClass("ui-state-hover")
                        }),
                        $(".slicer-format-preview-button").mouseup(function(e) {
                            var t, i, o, r, a, s, l, c = n.wrapper.spread, d = e.srcElement || e.target, p = $(d).closest("button").find("span span")[0], u = p.className, h = u.split(" "), f = c.getActiveSheet();
                            for (i = 0; i < h.length; i++)
                                if (-1 === h[i].indexOf("slicer-format")) {
                                    t = h[i];
                                    break
                                }
                            if (t && -1 === t.indexOf("custom"))
                                o = Qt(f, t);
                            else {
                                r = n.SlicerStyleDialog.customSlicerStyle;
                                for (a in r)
                                    if ((s = a.substring(0, a.indexOf("-"))) === t) {
                                        o = n.SlicerStyleDialog.customSlicerStyle[a];
                                        break
                                    }
                            }
                            l = {
                                slicerStyle: o
                            },
                                n.actions.doAction("setSlicerStyle", c, l),
                                $("#format-slicer-popup").gcuipopup("hide")
                        }),
                        $(".new-slicer-style").click(function() {
                            $("#format-slicer-popup").gcuipopup("hide"),
                                void 0 === e ? e = new n.SlicerStyleDialog : e.refresh(),
                                e.open()
                        }).mouseenter(function() {
                            $(this).css("background", "#DBDBDB")
                        }).mouseleave(function() {
                            $(this).css("background", "white")
                        })
                }
                function ei(e, t, i) {
                    var o, n, r, a, s, l = "slicer-format-", c = "slicer-format-preview";
                    for (n = 1; n <= i; n++)
                        r = l + t + n,
                            "custom" === t ? o = $("<span></span>").addClass(r + " " + c + " " + t + n) : "light" === t && n > 6 ? (a = n - 6,
                                r = l + F + a,
                                o = $("<span></span>").attr("title", F + a).addClass(r + " " + c + " " + F + a)) : o = $("<span></span>").attr("title", t + n).addClass(r + " " + c + " " + t + n),
                            s = $("<span></span>").append(o).addClass(r + "-container container-span"),
                            $("<button></button>").append(s).addClass(r + "-button " + c + "-button").appendTo($("." + e))
                }
                function ti() {
                    var e = n.wrapper.spread.getActiveSheet()
                        , t = e;
                    t.isPasteFloatingObject() ? $("#clipboardgroup li:gt(0)").hide() : $("#clipboardgroup li:gt(0)").show()
                }
                function ii() {
                    var e, t, i, o, r, a = n.res, s = a.name || "en", l = a.ribbon.fontFamilies, c = s + "ff", d = l[c + "1"];
                    if (d) {
                        for (e = $("#font-family"),
                                 t = e.next("ul"),
                                 i = 1,
                                 o = c + i,
                                 r = []; l[o]; )
                            r.push('<li><input type="radio" id="font-family-{id}" name="font-family" /><label for="font-family-{id}" name="{id}" id="{id}" data-bind="text: res.ribbon.fontFamilies.{id}.text, attr: { title: res.ribbon.fontFamilies.{id}.text, \'data-font\': res.ribbon.fontFamilies.{id}.name }"></label></li>'.replace(/\{id\}/g, o)),
                                i++,
                                o = c + i;
                        t.children().first().before(r.join(""))
                    }
                }
                e.addLocalFonts = ii;
                function oi() {
                    ne(),
                        re(),
                        se(),
                        ce(),
                        de(),
                        te(),
                        ue(),
                        le()
                }
                e.updateRibbonAll = oi,
                    n.loader.ready(function() {
                        P(),
                        n.wrapper.spread.notWorking || We()
                    }),
                    n.ribbon = e
            }(n.ribbon || {})
        }
        , function(e, t, i) {
            var o = GC.Spread.Sheets.Designer
                , n = i(0).app;
            !function(e) {
                "use strict";
                var t, i;
                e.currentFilePath = "";
                function r(e) {
                    var t, i, o = e.split("-");
                    for (t = 1; t < o.length; t++)
                        i = o[t],
                            o[t] = i[0].toUpperCase() + i.slice(1);
                    return o.join("")
                }
                function a(e, t, i) {
                    var n, a, s, l, c;
                    t.suspendPaint();
                    try {
                        o.util.assert("string" == typeof e && "doAction" !== e, "actionName invalid"),
                            e = r(e),
                            n = this[e],
                            a = !1,
                        void 0 === n && (n = o.spreadActions[e],
                            a = !0),
                            o.util.assert(void 0 !== n, 'cannot found the action "' + e + '".'),
                            s = t.getActiveSheet(),
                            a ? (c = {
                                sheet: s,
                                selections: s.getSelections(),
                                options: i,
                                sheetName: s.name()
                            },
                                l = [t, c]) : l = [t, i],
                            n.apply(null, l)
                    } catch (e) {
                        throw t.resumePaint(),
                            e
                    }
                    t.resumePaint(),
                        t.focus(!0)
                }
                e.doAction = a;
                function s(e) {
                    return e.substring(e.lastIndexOf(".") + 1).toLowerCase()
                }
                function l(t, i) {
                    e.currentFilePath ? d(t, e.currentFilePath, null, !1, i) : c(t, null, null, i)
                }
                e.save = l;
                function c(e, t, i, r) {
                    var a, s, l = t;
                    l || (l = {
                        title: o.res.saveFileDialogTitle,
                        fileExtension: ".ssjson",
                        nameFilters: [o.res.spreadFileFilter, o.res.ssJSONToJSFilter, o.res.excelFileFilter]
                    }),
                        a = null === i || void 0 === i ? null : JSON.stringify(i),
                        s = function(t) {
                            "cancelled" !== t.status && d(e, t.fileName, a, !1, r)
                        }
                        ,
                        n.showSaveDialog(l, s)
                }
                e.saveAs = c;
                function d(e, t, i, o, n) {
                    var r = s(t);
                    switch (r) {
                        case "ssjson":
                        case "json":
                            u(e, t, o, n, !1);
                            break;
                        case "js":
                            u(e, t, o, n, !0);
                            break;
                        case "csv":
                        case "pdf":
                        case "xlsx":
                            g(e, t, i, o, n)
                    }
                }
                function p(e, t) {
                    return t || (t = {}),
                        t.includeBindingSource = !0,
                        e.toJSON(t)
                }
                function u(e, t, i, o, n) {
                    f(e);
                    var r = p(e);
                    e.designerBindingPathSchema && (r.designerBindingPathSchema = e.designerBindingPathSchema),
                        h(t, JSON.stringify(r), {
                            saveAsJS: n
                        }, i, o)
                }
                function h(t, i, r, a, s) {
                    n.save(t, i, function(i) {
                        "failed" === i.status ? o.MessageBox.show(i.message, o.res.title, 3) : (a || (e.currentFilePath = t,
                            e.isFileModified = !1,
                            P()),
                            o.fileMenu.closeFileScreen()),
                        s && s.call(null)
                    }, r)
                }
                function f(e) {
                    var t, i, n = $.fn.zTree.getZTreeObj("ztree-container"), r = null;
                    n && (t = [],
                        r = n.getNodes()[0],
                        o.ribbon.treeNodeToArray(r.children, t),
                        i = o.util.saveJSONSchema(t),
                    $.isEmptyObject(i) || (e.designerBindingPathSchema = i))
                }
                function g(e, t, i, n, r) {
                    var a, l, c;
                    if ($(".loading-placeholder").removeClass("hidden"),
                            a = s(t),
                            i)
                        switch (a) {
                            case "xlsx":
                                l = {
                                    spread: p(e, i.excelSaveFlags),
                                    exportFileType: a
                                };
                                break;
                            case "csv":
                                try {
                                    c = e.sheets[i.sheetIndex].getCsv(i.row, i.column, i.rowCount, i.columnCount, i.rowDelimiter, i.columnDelimiter)
                                } catch (e) {
                                    return o.MessageBox.show(e.message, o.res.title, 2, 0),
                                        void $(".loading-placeholder").addClass("hidden")
                                }
                                l = {
                                    spread: c,
                                    exportFileType: a
                                };
                                break;
                            case "pdf":
                                l = {
                                    spread: e,
                                    exportFileType: a
                                }
                        }
                    else
                        l = {
                            spread: p(e),
                            exportFileType: a
                        };
                    h(t, l, i, n, function() {
                        r && r.call(null),
                            $(".loading-placeholder").addClass("hidden")
                    })
                }
                function m(e, t, i) {
                    var r, a = t;
                    a || (a = {
                        title: o.res.exportFileDialogTitle,
                        nameFilters: [o.res.excelFileFilter]
                    }),
                        r = function(t) {
                            "cancelled" !== t.status && d(e, t.fileName, i, !0)
                        }
                        ,
                        n.showSaveDialog(a, r)
                }
                function b(e, t) {
                    var i = {
                        title: o.res.exportFileDialogTitle,
                        fileExtension: ".ssjson",
                        nameFilters: [o.res.spreadFileFilter]
                    };
                    m(e, i, t)
                }
                e.exportJson = b;
                function v(e, t) {
                    var i = {
                        title: o.res.exportFileDialogTitle,
                        fileExtension: ".js",
                        nameFilters: [o.res.ssJSONToJSFilter]
                    };
                    m(e, i, t)
                }
                e.exportJS = v;
                function y(e, t) {
                    var i = {
                        title: o.res.exportFileDialogTitle,
                        fileExtension: ".xlsx",
                        nameFilters: [o.res.excelFileFilter]
                    };
                    m(e, i, t)
                }
                e.exportExcel = y;
                function x(e, t) {
                    var i = {
                        title: o.res.exportFileDialogTitle,
                        fileExtension: ".csv",
                        nameFilters: [o.res.csvFileFilter]
                    };
                    m(e, i, t)
                }
                e.exportCsv = x;
                function w(e, t) {
                    var i = {
                        title: o.res.exportFileDialogTitle,
                        nameFilters: [o.res.pdfFileFilter]
                    };
                    m(e, i, t)
                }
                e.exportPdf = w;
                function C(e, t) {
                    var i, r = t;
                    r || (r = {
                        title: o.res.openFileDialogTitle,
                        nameFilters: [o.res.allSpreadFileFilter, o.res.spreadFileFilter, o.res.excelFileFilter, o.res.csvFileFilter]
                    }),
                        r.action = "open",
                        r.filters = ".ssjson, .xlsx, .csv",
                        i = function(t) {
                            var i, r;
                            if ("cancelled" !== t.status && t.file)
                                switch (i = t.file.name,
                                    r = n.getExtension(i),
                                    r.toLowerCase()) {
                                    case "ssjson":
                                        I(e, i, t);
                                        break;
                                    case "xlsx":
                                    case "csv":
                                        D(e, i, r, t);
                                        break;
                                    default:
                                        return void o.MessageBox.show(o.res.openFileFormatError, o.res.title, 3)
                                }
                        }
                        ,
                        n.showOpenDialog(r, i)
                }
                e.open = C;
                function S(e, t, i) {
                    var r, a = t;
                    a || (a = {
                        title: o.res.importFileDialogTitle,
                        nameFilters: [o.res.spreadFileFilter, o.res.excelFileFilter, o.res.csvFileFilter, o.res.allFileFilter]
                    }),
                        a.action = "import",
                        r = function(t) {
                            var o, r;
                            if ("cancelled" !== t.status)
                                switch (o = t.file.name,
                                    r = n.getExtension(o),
                                    r.toLowerCase()) {
                                    case "ssjson":
                                        I(e, o, t, !0);
                                        break;
                                    case "xlsx":
                                    case "csv":
                                        D(e, o, r, t, i, !0)
                                }
                        }
                        ,
                        n.showOpenDialog(a, r, i)
                }
                e.rB = S;
                function k(e) {
                    o.MessageBox.show(o.res.unsavedWarning, o.res.title, 2, 2, e)
                }
                e.showUnsavedWarning = k;
                function T(t, i) {
                    if ("Blank" === i)
                        return e.reset(),
                            void o.fileMenu.closeFileScreen();
                    var n = function(t) {
                        $.ajax({
                            url: "../resources/templates/" + t + ".ssjson",
                            type: "GET",
                            dataType: "json",
                            success: function(t) {
                                try {
                                    o.wrapper.reset(),
                                        o.wrapper.spread.fromJSON(t),
                                        e.currentFilePath = "",
                                        e.isFileModified = !1,
                                        P(),
                                        o.ribbon.updateRibbonBarStyle(),
                                        o.wrapper.spreadElement.trigger("FileOpened"),
                                        o.fileMenu.closeFileScreen()
                                } catch (e) {
                                    o.fileMenu.closeFileScreen()
                                }
                            },
                            error: function() {
                                return o.MessageBox.show(o.res.requestTempalteFail, o.res.title, 3)
                            }
                        })
                    };
                    e.isFileModified ? k(function(e, o) {
                        switch (o) {
                            case 2:
                                l(t, function() {
                                    n(i)
                                });
                                break;
                            case 3:
                                n(i);
                                break;
                            case 4:
                                return
                        }
                    }) : n(i)
                }
                e.openTemplate = T;
                function A(e) {
                    var t, i, o;
                    if (!e.getActiveSheet()) {
                        if (!(e.getSheetCount() > 0))
                            throw "no sheet";
                        e.setActiveSheetIndex(0)
                    }
                    for (t = 0; t < e.getSheetCount(); t++)
                        i = e.getSheet(t).getActiveColumnIndex(),
                            o = e.getSheet(t).getActiveRowIndex(),
                            void 0 !== i && void 0 !== o ? e.getSheet(t).setActiveCell(o, i) : e.getSheet(t).setActiveCell(0, 0)
                }
                function I(t, i, n, r) {
                    var a = function(t, i) {
                        var n, a, s, l;
                        if ("failed" === i.status)
                            o.MessageBox.show(i.message, o.res.title, 3);
                        else
                            try {
                                n = i.data,
                                    a = n[0],
                                    s = "\ufeff" === a || "FFFE" === a,
                                    l = JSON.parse(s ? n.substr(1) : n),
                                    r ? (t.fromJSON(l),
                                    l.designerBindingPathSchema && (o.wrapper.spread.designerBindingPathSchema = l.designerBindingPathSchema),
                                        A(t),
                                        e.isFileModified = !0) : (o.wrapper.reset(),
                                        o.wrapper.spread.fromJSON(l),
                                    l.designerBindingPathSchema && (o.wrapper.spread.designerBindingPathSchema = l.designerBindingPathSchema),
                                        A(o.wrapper.spread),
                                        e.currentFilePath = i.fileName,
                                        e.isFileModified = !1),
                                    o.fileMenu.closeFileScreen(),
                                    P(),
                                    o.ribbon.updateRibbonBarStyle(),
                                    o.wrapper.spreadElement.trigger("FileOpened")
                            } catch (e) {
                                "no sheet" !== e && -1 === e.message.indexOf("fromJSON") || (o.wrapper.reset(),
                                    o.MessageBox.show(o.res.openFileFormatError, o.res.title, 3))
                            }
                    };
                    e.isFileModified ? k(function(e, i) {
                        switch (i) {
                            case 2:
                                l(t, function() {
                                    a(t, n)
                                });
                                break;
                            case 3:
                                a(t, n);
                                break;
                            case 4:
                                return
                        }
                    }) : a(t, n)
                }
                e.openJson = I;
                function D(i, n, r, a, s, c) {
                    var d = function(i, n) {
                        function l(e) {
                            var t = o.wrapper.spread.getActiveSheet();
                            t.setCsv(0, 0, e, s.rowDelimiter || "\r\n", s.columnDelimiter || ","),
                                o.fileMenu.closeFileScreen(),
                                P(),
                                o.ribbon.updateRibbonBarStyle()
                        }
                        function d(r) {
                            if ("success" === r.status) {
                                var a = r.data;
                                try {
                                    "string" == typeof a && (a = JSON.parse(a))
                                } catch (e) {
                                    return o.fileMenu.closeFileScreen(),
                                        o.MessageBox.show("Parse file data error.", o.res.title, 3),
                                        void $(".loading-placeholder").addClass("hidden")
                                }
                                try {
                                    c ? (i.fromJSON(a, s.excelOpenFlags),
                                        A(i),
                                        e.isFileModified = !0) : (o.wrapper.reset(),
                                        o.wrapper.spread.fromJSON(a),
                                        A(o.wrapper.spread),
                                        e.currentFilePath = n,
                                        e.isFileModified = !1),
                                        o.fileMenu.closeFileScreen(),
                                        P(),
                                        o.ribbon.updateRibbonBarStyle(),
                                        o.wrapper.spreadElement.trigger("FileOpened")
                                } catch (e) {
                                    "no sheet" === e && (o.wrapper.reset(),
                                        o.MessageBox.show(o.res.openFileFormatError, o.res.title, 3))
                                }
                            } else
                                r.errorData ? c ? o.MessageBox.show(r.errorData.errorMessage, o.res.title, 3) : 0 === r.errorData.errorCode || 1 === r.errorData.errorCode ? o.MessageBox.show(r.errorData.errorMessage, o.res.title, 3) : (void 0 === t && (t = new o.PasswordDialog),
                                    t.open(i, n, s, c, r.errorData.errorMessage)) : o.MessageBox.show(r.message, o.res.title, 3);
                            $(".loading-placeholder").addClass("hidden")
                        }
                        $(".loading-placeholder").removeClass("hidden");
                        var p = a.data;
                        setTimeout(function() {
                            switch (r) {
                                case "csv":
                                    l(p);
                                    break;
                                case "xlsx":
                                    d(a)
                            }
                            $(".loading-placeholder").addClass("hidden")
                        }, 400)
                    };
                    e.isFileModified ? k(function(e, t) {
                        switch (t) {
                            case 2:
                                l(i, function() {
                                    d(i, n)
                                });
                                break;
                            case 3:
                                d(i, n);
                                break;
                            case 4:
                                return
                        }
                    }) : d(i, n)
                }
                e.openOtherFormat = D;
                function F(e, t) {
                    var i = {
                        title: o.res.importFileDialogTitle,
                        filters: ".ssjson",
                        nameFilters: [o.res.spreadFileFilter]
                    };
                    S(e, i, t)
                }
                e.importJson = F;
                function L(e, t) {
                    var i = {
                        title: o.res.importFileDialogTitle,
                        filters: ".xlsx",
                        nameFilters: [o.res.excelFileFilter]
                    };
                    S(e, i, t)
                }
                e.importExcel = L;
                function R(e, t) {
                    var i = {
                        title: o.res.importFileDialogTitle,
                        filters: ".csv",
                        nameFilters: [o.res.csvFileFilter]
                    };
                    S(e, i, t)
                }
                e.importCsv = R;
                function B() {
                    var t = function() {
                        o.wrapper.reset(),
                            o.ribbon.updateRibbonBarStyle(),
                            e.currentFilePath = "",
                            e.isFileModified = !1,
                            P()
                    };
                    e.isFileModified ? k(function(e, i) {
                        switch (i) {
                            case 2:
                                l(o.wrapper.spread, t);
                                break;
                            case 3:
                                t();
                                break;
                            case 4:
                                return
                        }
                    }) : t()
                }
                e.reset = B;
                function N(e) {
                    e.undoManager().undo()
                }
                e.undo = N;
                function E(e) {
                    e.undoManager().redo()
                }
                e.redo = E;
                function V() {
                    var e, t, i, n, r, a, s = o.wrapper.spread.getActiveSheet(), l = s.getViewportWidth(1), c = s.getViewportHeight(1), d = s.getSelections();
                    if (!d || 0 === d.length)
                        return null;
                    if (e = d[0],
                            t = 0,
                            i = 0,
                        d.length > 1)
                        for (n = 1; n < d.length; n++)
                            e = e.union(d[n]);
                    for (n = 0; n < e.rowCount; n++)
                        i += s.getRowHeight(e.row + n);
                    for (r = 0; r < e.colCount; r++)
                        t += s.getColumnWidth(e.col + r);
                    return a = Math.min(l / t, c / i),
                        {
                            zoom: a,
                            topRow: e.row,
                            leftCol: e.col
                        }
                }
                e.mv = V,
                    e.isFileModified = !1;
                function P() {
                    var t, r = e.currentFilePath;
                    !0 === e.isFileModified ? "" !== r && $("title").text() !== i && (t = n.getFileInfo(r).fileName,
                        i = "* " + t + " - " + o.res.title,
                        $("title").text(i)) : "" !== r ? (t = n.getFileInfo(r).fileName,
                        $("title").text(t + " - " + o.res.title),
                        o.wrapper.shouldModifiedHandlerExecute = !0) : $("title").text(o.res.title)
                }
                e.updateWindowTitle = P,
                    o.actions = e
            }(o.actions || {})
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e = function() {
                    function e() {}
                    function t() {
                        e.calcService || (e.calcService = i.wrapper.spread.getCalcService())
                    }
                    return e.unparse = function(i, o, n, r) {
                        return t(),
                            e.calcService.unparse(i, o, n, r)
                    }
                        ,
                        e.parse = function(i, o, n, r, a, s) {
                            return t(),
                                e.calcService.parse(i, o, n, r, a, s)
                        }
                        ,
                        e.parseRangeToExpString = function(e, t) {
                            var i = GC.Spread.Sheets.CalcEngine
                                , o = i.RangeReferenceRelative.allRelative;
                            return t && (o = i.RangeReferenceRelative.allAbsolute),
                                i.rangeToFormula(e, 0, 0, o)
                        }
                        ,
                        e.parseExpStringToRanges = function(e, t) {
                            var i, o, n = GC.Spread.Sheets.CalcEngine, r = [], a = e.split(",");
                            try {
                                for (i = 0; i < a.length; i++)
                                    (o = n.formulaToRange(t, a[i])) && r.push(o)
                            } catch (e) {
                                return null
                            }
                            return r
                        }
                        ,
                        e.parseExternalRangeToString = function(t) {
                            var i = "";
                            return t.range && (i += e.parseRangeToExpString(t.range)),
                                i
                        }
                        ,
                        e.parseStringToExternalRanges = function(e, t) {
                            var i, o, n = GC.Spread.Sheets.CalcEngine, r = [], a = e.split(",");
                            try {
                                for (i = 0; i < a.length; i++)
                                    o = n.formulaToRange(t, a[i]),
                                        r.push({
                                            range: o
                                        })
                            } catch (e) {
                                return null
                            }
                            return r
                        }
                        ,
                        e
                }();
                i.CEUtility = e
            }()
        }
        , function(e, t, i) {
            var o = GC.Spread.Sheets.Designer
                , n = void 0
                , r = {}
                , a = GC.Spread.Sheets
                , s = a.Charts
                , l = a.CalcEngine.rangeToFormula
                , c = a.CalcEngine.formulaToRange
                , d = o.util.chartHelper
                , p = d.getSelectedChart
                , u = i(2);
            !function(e) {
                "use strict";
                var t, i, u, h, f, g, m, b, v, y, x, w, C, S, k, T, A, I, D, F, L, R, B, N, E, V, P, z, j, M, O, G, H, U, W, _, q, K, Y, X, J, Q, Z, ee, te, ie, oe, ne, re, ae, se, le, ce, de, pe, ue, he, fe, ge, me, be, ve, ye, xe, we, Ce, Se, ke, Te, Ae, Ie, De, $e, Fe, Le, Re, Be, Ne, Ee, Ve, Pe, ze, je, Me, Oe, Ge, He, Ue, We, _e, qe, Ke, Ye, Xe, Je, Qe, Ze, et, tt, it, ot, nt, rt, at, st, lt, ct, dt, pt, ut, ht, ft, gt, mt, bt, vt, yt, xt, wt, Ct, St, kt, Tt, At, It, Dt, $t, Ft, Lt, Rt, Bt, Nt, Et, Vt, Pt, zt, jt, Mt, Ot, Gt, Ht, Ut, Wt, _t, qt, Kt, Yt, Xt, Jt, Qt, Zt, ei, ti, ii, oi, ni, ri, ai, si, li, ci, di, pi, ui, hi, fi, gi, mi, bi, vi, yi, xi, wi, Ci, Si, ki, Ti, Ai, Ii, Di, $i, Fi, Li, Ri, Bi, Ni, Ei, Vi, Pi, zi, ji, Mi, Oi, Gi, Hi, Ui, Wi, _i, qi, Ki, Yi, Xi, Ji, Qi, Zi, eo, to, io, oo, no, ro, ao, so, lo, co, po, uo, ho, fo, go, mo, bo, vo, yo, xo, wo, Co, So, ko, To, Ao, Io, Do, $o, Fo, Lo, Ro, Bo, No, Eo, Vo, Po, zo, jo, Mo, Oo, Go, Ho, Uo, Wo, _o, qo, Ko, Yo, Xo, Jo, Qo, Zo, en, tn, on, nn, rn, an, sn, ln, cn, dn, pn, un, hn, fn, gn, mn, bn, vn, yn, xn, wn, Cn, Sn, kn, Tn, An, In, Dn, $n, Fn, Ln, Rn, Bn, Nn, En, Vn, Pn, zn, jn, Mn, On, Gn, Hn, Un, Wn, _n;
                o.dialog = {},
                    t = {},
                    i = "designer.",
                    u = "cut",
                    h = "copy",
                    f = "pasteFormatting",
                    g = "pasteValues",
                    m = "pasteFormula",
                    b = "pasteAll",
                    v = "insert_dialog",
                    y = "delete_dialog",
                    x = "protectSheet",
                    w = "confirmProtectSheet",
                    C = "formatCells",
                    S = "customSort",
                    k = "defineName",
                    T = "cellTag",
                    A = "colTag",
                    I = "sheetTag",
                    D = "rowTag",
                    F = "rowHeight",
                    L = "columnWidth",
                    R = "formatComment",
                    B = "slicerSortAscend",
                    N = "slicerSortDescend",
                    E = "slicerProperty",
                    V = "slicerSetting",
                    P = "columnHeaders",
                    z = "rowHeaders",
                    j = "tabColor",
                    M = "changeChartTypeDialog",
                    O = "selectChartDataDialog",
                    G = "moveChartDialog",
                    H = "formatChart",
                    U = "floatingObjectCut",
                    W = "floatingObjectCopy",
                    _ = "resetChartColor";
                function qn(e) {
                    o.util.triggerDesignerEvent("chartChanged", e)
                }
                function Kn(e) {
                    e.register(i + h, t[h], null, !1, !1, !1, !1),
                        e.register(i + u, t[u], null, !1, !1, !1, !1),
                        e.register(i + b, t[b], null, !1, !1, !1, !1),
                        e.register(i + m, t[m], null, !1, !1, !1, !1),
                        e.register(i + f, t[f], null, !1, !1, !1, !1),
                        e.register(i + g, t[g], null, !1, !1, !1, !1),
                        e.register(i + v, t[v], null, !1, !1, !1, !1),
                        e.register(i + y, t[y], null, !1, !1, !1, !1),
                        e.register(i + x, t[x], null, !1, !1, !1, !1),
                        e.register(i + C, t[C], null, !1, !1, !1, !1),
                        e.register(i + S, t[S], null, !1, !1, !1, !1),
                        e.register(i + k, t[k], null, !1, !1, !1, !1),
                        e.register(i + T, t[T], null, !1, !1, !1, !1),
                        e.register(i + A, t[A], null, !1, !1, !1, !1),
                        e.register(i + I, t[I], null, !1, !1, !1, !1),
                        e.register(i + D, t[D], null, !1, !1, !1, !1),
                        e.register(i + F, t[F], null, !1, !1, !1, !1),
                        e.register(i + L, t[L], null, !1, !1, !1, !1),
                        e.register(i + R, t[R], null, !1, !1, !1, !1),
                        e.register(i + E, t[E], null, !1, !1, !1, !1),
                        e.register(i + V, t[V], null, !1, !1, !1, !1),
                        e.register(i + P, t[P], null, !1, !1, !1, !1),
                        e.register(i + z, t[z], null, !1, !1, !1, !1),
                        e.register(i + B, t[B], null, !1, !1, !1, !1),
                        e.register(i + N, t[N], null, !1, !1, !1, !1),
                        e.register(i + j, t[j], null, !1, !1, !1, !1),
                        e.register(i + M, t[M], null, !1, !1, !1, !1),
                        e.register(i + O, t[O], null, !1, !1, !1, !1),
                        e.register(i + G, t[G], null, !1, !1, !1, !1),
                        e.register(i + H, t[H], null, !1, !1, !1, !1),
                        e.register(i + _, t[_], null, !1, !1, !1, !1),
                        e.register(i + W, t[W], null, !1, !1, !1, !1),
                        e.register(i + U, t[U], null, !1, !1, !1, !1)
                }
                e.initDesignerCommands = Kn,
                    q = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this),
                                this.bw = t,
                                this.wv = t.getSheetFromName(i.sheetName),
                                this.sB = i.selections,
                                this.ho = i,
                                this.canUndo = !1
                        }
                        return t.prototype.spread = function() {
                            return this.bw
                        }
                            ,
                            t.prototype.sheet = function() {
                                return this.wv
                            }
                            ,
                            t.prototype.getSelections = function() {
                                return this.sB
                            }
                            ,
                            t.prototype.executeImp = function(e, t, i) {}
                            ,
                            t.prototype.undoImp = function(e, t, i) {
                                return e.suspendPaint(),
                                    GC.Spread.Sheets.Commands.undoTransaction(e, t),
                                    e.resumePaint(),
                                    !0
                            }
                            ,
                            t.prototype.execute = function(e, t, i) {
                                var n, r = this, a = !1;
                                if (i)
                                    a = r.undoImp.call(r, e, t, i);
                                else if (r.canExecute()) {
                                    n = GC.Spread.Sheets.Commands,
                                        n.startTransaction(e, t),
                                        e.suspendPaint();
                                    try {
                                        a = r.executeImp(e, t, i)
                                    } finally {
                                        e.resumePaint(),
                                            n.endTransaction(e, t)
                                    }
                                }
                                return !1 !== a && o.ribbon.updateRibbonAll(),
                                    a
                            }
                            ,
                            t.prototype.execInSelections = function(e, t) {
                                var i, o, n, r, a, s, l, c, d = this.getSelections();
                                for (n = 0; n < d.length; n++)
                                    if (r = d[n],
                                            a = r.col,
                                            s = r.row,
                                            l = r.rowCount,
                                            c = r.colCount,
                                        -1 === a && -1 === s)
                                        t(e, -1, -1);
                                    else if (-1 === s)
                                        for (i = 0; i < c; i++)
                                            t(e, -1, a + i);
                                    else if (-1 === a)
                                        for (i = 0; i < l; i++)
                                            t(e, s + i, -1);
                                    else
                                        for (i = 0; i < l; i++)
                                            for (o = 0; o < c; o++)
                                                t(e, s + i, a + o)
                            }
                            ,
                            t.prototype.execInSelectionsForSetStyle = function(e, t) {
                                var i, o, n, r, a, s, l, c, d, p, u, h = this.getSelections();
                                for (n = 0; n < h.length; n++)
                                    if (r = h[n],
                                            a = r.col,
                                            s = r.row,
                                            l = r.rowCount,
                                            c = r.colCount,
                                        -1 === a || -1 === s) {
                                        if (-1 === a && -1 === s) {
                                            for (p = 0; p < l; p++)
                                                t(e, p, -1);
                                            for (u = 0; u < c; u++)
                                                t(e, -1, u);
                                            for (p = 0; p < l; p++)
                                                for (u = 0; u < c; u++)
                                                    (d = e.getStyle(p, u)) && t(e, p, u)
                                        } else if (-1 === a) {
                                            for (p = 0; p < l; p++)
                                                t(e, p + s, -1);
                                            for (p = 0; p < l; p++)
                                                for (u = 0; u < c; u++)
                                                    (d = e.getStyle(p + s, u)) && t(e, p + s, u)
                                        } else if (-1 === s) {
                                            for (u = 0; u < c; u++)
                                                t(e, -1, u + a);
                                            for (p = 0; p < l; p++)
                                                for (u = 0; u < c; u++)
                                                    (d = e.getStyle(p, u + a)) && t(e, p, u + a)
                                        }
                                    } else
                                        for (i = 0; i < l; i++)
                                            for (o = 0; o < c; o++)
                                                t(e, s + i, a + o)
                            }
                            ,
                            t.prototype.execInSelectionsForRow = function(e, t) {
                                var i, o, n, r, a = this.getSelections();
                                for (i = 0; i < a.length; i++)
                                    for (o = a[i],
                                             n = -1 === o.row ? 0 : o.row,
                                             r = 0; r < o.rowCount; r++)
                                        t(e, n + r)
                            }
                            ,
                            t.prototype.execInSelectionsForCol = function(e, t) {
                                var i, o, n, r, a = this.getSelections();
                                for (i = 0; i < a.length; i++)
                                    for (o = a[i],
                                             n = -1 === o.col ? 0 : o.col,
                                             r = 0; r < o.colCount; r++)
                                        t(e, n + r)
                            }
                            ,
                            t.prototype.execInSelectionsForCell = function(e, t) {
                                var i, o, n, r, a, s, l = this.getSelections();
                                for (i = 0; i < l.length; i++)
                                    for (o = l[i],
                                             n = -1 === o.col ? 0 : o.col,
                                             r = -1 === o.row ? 0 : o.row,
                                             a = 0; a < o.rowCount; a++)
                                        for (s = 0; s < o.colCount; s++)
                                            t(e, r + a, n + s)
                            }
                            ,
                            t.prototype.getActualFont = function(e, t, i) {
                                return e.getActualStyle(t, i).font || o.res.defaultFont
                            }
                            ,
                            t.prototype.clearSpansInSelection = function(e, t) {
                                if (e && t) {
                                    var i = []
                                        , o = t.row
                                        , n = t.col
                                        , r = t.rowCount
                                        , a = t.colCount;
                                    e.getSpans().forEach(function(e) {
                                        e.intersect(o, n, r, a) && i.push(e)
                                    }),
                                        i.forEach(function(t) {
                                            e.removeSpan(t.row, t.col)
                                        })
                                }
                            }
                            ,
                            t.prototype.getKey = function(e, t) {
                                return [e, t].join(",")
                            }
                            ,
                            t.prototype.getPosition = function(e) {
                                var t = e && e.split(",");
                                return t && 2 === t.length ? {
                                    row: +t[0],
                                    column: +t[1]
                                } : null
                            }
                            ,
                            t.prototype.setFontStyle = function(e, t, i, o, n) {
                                var r, a = this, s = a.wv;
                                e.font || (e.font = a.getActualFont(s, o, n)),
                                    r = $("<span></span>"),
                                    r.css("font", e.font),
                                    r.css(t, i),
                                    e.font = r.css("font"),
                                    s.setStyle(o, n, e)
                            }
                            ,
                            t.prototype.undoSetStyle = function(e, t) {
                                var i, o, n, r, a, s, l = this, c = l.wv, d = l.bw, p = t.tB;
                                if (p) {
                                    d.suspendPaint();
                                    for (i in p)
                                        o = l.getPosition(i),
                                            n = p[i],
                                        o && (r = o.row,
                                            a = o.column,
                                            s = c.getStyle(r, a),
                                            s[e] = "backColor" === e ? n || void 0 : n,
                                            c.setStyle(r, a, s));
                                    d.resumePaint()
                                }
                                return !0
                            }
                            ,
                            t.prototype.setStyle = function(e, t, i, o, n, a) {
                                var s = this
                                    , l = s.wv
                                    , c = s.bw;
                                o.tB = {},
                                    c.suspendPaint(),
                                    s.execInSelectionsForSetStyle(l, function(l, c, d) {
                                        var p;
                                        -1 === c || -1 === d ? (p = l.getStyle(c, d)) || (p = new GC.Spread.Sheets.Style) : p = l.getActualStyle(c, d),
                                            o.tB[s.getKey(c, d)] = p && p[t],
                                        n && (i = n.apply(s, [l, c, d, p, i].concat(a || [])),
                                            p[t] = i,
                                            l.setStyle(c, d, p)),
                                            ["font-size", "font-family", "font-weight", "font-style"].indexOf(e) >= 0 ? s.setFontStyle(p, e, i, c, d) : (p[t] = i,
                                                l.setStyle(c, d, p),
                                            "wordWrap" !== t || r[c] || s.wv.defaults.rowHeight !== s.wv.getRowHeight(c) || l.autoFitRow(c))
                                    }),
                                    c.resumePaint()
                            }
                            ,
                            t.prototype.updateRibbon = function() {
                                $(o).trigger("updateRibbon")
                            }
                            ,
                            t.prototype.getTextDecoration = function(e, t, i, o, n, r) {
                                var a, s = this;
                                return o.textDecoration || (o.textDecoration = s.getActualDecoration(e, t, i)),
                                    a = o.textDecoration,
                                    n ? 1 == (1 & a) && 8 == (8 & r) ? (a ^= 1,
                                        a |= 8) : 8 == (8 & a) && 1 == (1 & r) ? (a ^= 8,
                                        a |= 1) : a |= r : a ^= r,
                                    a
                            }
                            ,
                            t.prototype.getActualDecoration = function(e, t, i) {
                                return e.getActualStyle(t, i).textDecoration
                            }
                            ,
                            t
                    }(a.Commands.ActionBase),
                    e.DesignerActionBase = q,
                    K = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r = this.bw, a = t.sheetName, s = {};
                            s.cmd = "copy",
                                s.sheetName = a,
                                s.ignoreClipboard = !0,
                                n = function() {
                                    o.util.clipboard.copyText = s.copyData.copyText,
                                        o.util.clipboard.copyHtml = s.copyData.copyHtml
                                }
                                ,
                                s.callback = n,
                                r.commandManager().execute(s)
                        }
                            ,
                            t
                    }(q),
                    t[h] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new K(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Yn(e, i) {
                    Zn(e, h, t[h], i)
                }
                e.copy = Yn,
                    Y = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r = this.bw, a = t.sheetName, s = {};
                            s.cmd = "cut",
                                s.sheetName = a,
                                s.ignoreClipboard = !0,
                                n = function() {
                                    o.util.clipboard.copyText = s.cutData.copyText,
                                        o.util.clipboard.copyHtml = s.cutData.copyHtml
                                }
                                ,
                                s.callback = n,
                                r.commandManager().execute(s)
                        }
                            ,
                            t
                    }(q),
                    t[u] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Y(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Xn(e, i) {
                    Zn(e, u, t[u], i)
                }
                e.cut = Xn,
                    X = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a, s, l, c, d = this;
                            d._h = t.value,
                                n = d.wv,
                                r = n.options.clipBoardOptions,
                                n.options.clipBoardOptions = d._h,
                                n.isPasteFloatingObject() ? d.bw.commandManager().execute({
                                    cmd: "pasteFloatingObjects",
                                    sheetName: n.name()
                                }) : (a = o.util.clipboard.copyText,
                                    s = o.util.clipboard.copyHtml,
                                    c = function() {
                                        n.options.clipBoardOptions = r
                                    }
                                    ,
                                    e.commandManager().execute({
                                        cmd: "paste",
                                        sheetName: n.name(),
                                        pasteText: a,
                                        pasteHtml: s,
                                        callback: c
                                    }))
                        }
                            ,
                            t
                    }(q),
                    t[b] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new X(e,t)
                                , n = {
                                value: 0,
                                spread: e
                            };
                            return o.execute(e, n, i)
                        }
                    },
                    t[m] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new X(e,t)
                                , n = {
                                value: 3,
                                spread: e
                            };
                            return o.execute(e, n, i)
                        }
                    },
                    t[f] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new X(e,t)
                                , n = {
                                value: 2,
                                spread: e
                            };
                            return o.execute(e, n, i)
                        }
                    },
                    t[g] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new X(e,t)
                                , n = {
                                value: 1,
                                spread: e
                            };
                            return o.execute(e, n, i)
                        }
                    },
                    J = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new X(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Jn(e, t) {
                    Zn(e, "paste", J, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.paste = Jn,
                    Q = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.options.sheetTabColor = t.value
                        }
                            ,
                            t
                    }(q),
                    Z = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Q(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Qn(e, t) {
                    Zn(e, "setSheetTabColor", Z, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setSheetTabColor = Qn,
                    ee = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n = Fa(t.selections);
                            switch (n) {
                                case 0:
                                    o.MessageBox.show(o.res.insertCellInSheet, o.res.title, 2);
                                    break;
                                case 4:
                                    o.MessageBox.show(o.res.insertCellInMixtureRange, o.res.title, 2);
                                    break;
                                case 3:
                                    o && o.dialog && (void 0 === o.dialog.insertCellsDialog && (o.dialog.insertCellsDialog = new o.InsertCellsDialog),
                                        o.dialog.insertCellsDialog.open())
                            }
                        }
                            ,
                            t
                    }(q),
                    t[v] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new ee(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    te = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r = Fa(t.selections);
                            switch (r) {
                                case 0:
                                    return n = e.getSheetFromName(t.sheetName),
                                        void n.clear(0, 0, n.getRowCount(), n.getColumnCount(), 3, 51);
                                case 4:
                                    o.MessageBox.show(o.res.insertCellInMixtureRange, o.res.title, 2);
                                    break;
                                case 3:
                                    o && o.dialog && (void 0 === o.dialog.deleteCellsDialog && (o.dialog.deleteCellsDialog = new o.DeleteCellsDialog),
                                        o.dialog.deleteCellsDialog.open())
                            }
                            return !1
                        }
                            ,
                            t
                    }(q),
                    t[y] = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new te(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    ie = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n = e.getSheetFromName(t.sheetName)
                                , r = n.options.isProtected;
                            o && o.dialog && (r ? (n.options.isProtected = !!t.value,
                                o.actions.isFileModified = !0) : (void 0 === o.dialog.protectionOptionDialog && (o.dialog.protectionOptionDialog = new o.ProtectionOptionDialog),
                                o.dialog.protectionOptionDialog.open()))
                        }
                            ,
                            t
                    }(q),
                    t[x] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new ie(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    oe = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n = e.getSheetFromName(t.sheetName)
                                , r = t.value;
                            n.options.protectionOptions = r,
                                n.options.isProtected = !0,
                                o.wrapper.spread.undoManager().clear()
                        }
                            ,
                            t
                    }(q),
                    t[w] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new oe(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    ne = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            o && o.dialog && (void 0 === o.dialog.formatCellDialog && (o.dialog.formatCellDialog = new o.FormatDialog),
                                o.dialog.formatCellDialog.open("number"))
                        }
                            ,
                            t
                    }(q),
                    t[C] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new ne(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    re = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            o && o.dialog && (o.dialog.sortDialog || (o.dialog.sortDialog = new o.SortDialog),
                                o.dialog.sortDialog.open())
                        }
                            ,
                            t
                    }(q),
                    t[S] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new re(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    ae = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            o && o.dialog && (void 0 === o.dialog.newNameDialog && (o.dialog.newNameDialog = new o.NewNameDialog),
                                o.dialog.newNameDialog.open("new", void 0))
                        }
                            ,
                            t
                    }(q),
                    t[k] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new ae(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    se = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            o && o.dialog && (void 0 === o.dialog.tagDialog && (o.dialog.tagDialog = new o.TagDialog),
                                o.dialog.tagDialog.open(t.type),
                                o.wrapper.spread.focus(!1))
                        }
                            ,
                            t
                    }(q),
                    t[I] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new se(e,t);
                            return t.type = "sheet",
                                o.execute(e, t, i)
                        }
                    },
                    t[T] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new se(e,t);
                            return t.type = "cell",
                                o.execute(e, t, i)
                        }
                    },
                    t[A] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new se(e,t);
                            return t.type = "column",
                                o.execute(e, t, i)
                        }
                    },
                    t[D] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new se(e,t);
                            return t.type = "row",
                                o.execute(e, t, i)
                        }
                    },
                    le = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            o && o.dialog && (void 0 === o.dialog.setRowHeightDialog && (o.dialog.setRowHeightDialog = new o.RowHeightDialog),
                                o.dialog.setRowHeightDialog.open())
                        }
                            ,
                            t
                    }(q),
                    t[F] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new le(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    ce = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            o && o.dialog && (void 0 === o.dialog.setColumnWidthDialog && (o.dialog.setColumnWidthDialog = new o.ColumnWidthDialog),
                                o.dialog.setColumnWidthDialog.open())
                        }
                            ,
                            t
                    }(q),
                    t[L] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new ce(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    de = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a, s, l = e.getSheetFromName(t.sheetName);
                            o && o.dialog && (void 0 === o.dialog.fcDialog && (o.dialog.fcDialog = new o.FormatCommentDialog),
                                n = t.activeRow,
                                r = t.activeCol,
                                a = l.comments.get(n, r),
                                s = {
                                    row: n,
                                    col: r
                                },
                            a && o.dialog.fcDialog.open(s))
                        }
                            ,
                            t
                    }(q),
                    t[R] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new de(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    pe = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n = e.getSheetFromName(t.sheetName);
                            o && o.dialog && (o.dialog.formatSlicerDialog || (o.dialog.formatSlicerDialog = new o.FormatSlicerDialog),
                            o.util.isSlicerSelected(n) && o.dialog.formatSlicerDialog.open())
                        }
                            ,
                            t
                    }(q),
                    t[E] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new pe(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    ue = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n = e.getSheetFromName(t.sheetName);
                            o && (o.ribbon.slicerSettingDialog || (o.ribbon.slicerSettingDialog = new o.SlicerSettingDialog),
                            o.util.isSlicerSelected(n) && o.ribbon.slicerSettingDialog.open())
                        }
                            ,
                            t
                    }(q),
                    t[V] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new ue(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    he = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            o && o.dialog && (void 0 === o.dialog.headerCellsDialog && (o.dialog.headerCellsDialog = new o.HeaderCellsDialog),
                                o.dialog.headerCellsDialog.open(t.type))
                        }
                            ,
                            t
                    }(q),
                    t[P] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new he(e,t);
                            return t.type = "col",
                                o.execute(e, t, i)
                        }
                    },
                    t[z] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new he(e,t);
                            return t.type = "row",
                                o.execute(e, t, i)
                        }
                    },
                    fe = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = t.commandOptions.value;
                            if (!o)
                                return !1;
                            o.name ? Zn(e, "setSheetTabColor", Z, {
                                value: o.name,
                                selections: t.selections,
                                sheetName: t.sheetName
                            }) : Zn(e, "setSheetTabColor", Z, {
                                value: o.color,
                                selections: t.selections,
                                sheetName: t.sheetName
                            })
                        }
                            ,
                            t
                    }(q),
                    t[j] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new fe(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    t[M] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            o.ribbon.selectChartDialog || (o.ribbon.selectChartDialog = new o.SelectChartDialog);
                            var n = d.getSelectedChart(e.getSheetFromName(t.sheetName));
                            o.ribbon.selectChartDialog.open(o.SelectChartDialog.dialogType.changeChartType, n)
                        }
                    },
                    t[O] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            o.ribbon.chartSelectDataDialog || (o.ribbon.chartSelectDataDialog = new o.ChartSelectDataDialog);
                            var n = d.getSelectedChart(e.getSheetFromName(t.sheetName));
                            o.ribbon.chartSelectDataDialog.open(n)
                        }
                    },
                    t[G] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            o.ribbon.moveChartDialog || (o.ribbon.moveChartDialog = new o.MoveChartDialog),
                                o.ribbon.moveChartDialog.open()
                        }
                    },
                    t[H] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var n = e.getSheetFromName(t.sheetName);
                            t.commandOptions.chart = d.getSelectedChart(n),
                                o.ribbon.chartClicked(null, t.commandOptions)
                        }
                    },
                    ge = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this, r = n.wv, a = d.getSelectedChart(r);
                            a && (o = a.colorAndStyle && a.colorAndStyle.color,
                                d.applyChartSeriesTheme(a, o || {}),
                                qn(a))
                        }
                            ,
                            t
                    }(q),
                    t[_] = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ge(e,t);
                            return o.execute(e, t, i)
                        }
                    },
                    t[W] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            e.commandManager().execute({
                                cmd: "copyFloatingObjects",
                                sheetName: t.sheetName
                            })
                        }
                    },
                    t[U] = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            e.commandManager().execute({
                                cmd: "cutFloatingObjects",
                                sheetName: t.sheetName
                            })
                        }
                    };
                function Zn(e, t, i, o) {
                    var n = e.commandManager()
                        , r = "designer." + t;
                    n.getCommand(r) || n.register(r, i, null, !1, !1, !1, !1),
                        o.cmd = r,
                        n.execute(o)
                }
                me = function(e) {
                    o.extends(t, e);
                    function t(t, i) {
                        e.call(this, t, i)
                    }
                    return t.prototype.executeImp = function(e, t, i) {
                        var o = this;
                        o.setStyle("font-family", "font", t.value, t),
                            o.updateRibbon()
                    }
                        ,
                        t
                }(q),
                    be = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new me(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function er(e, t) {
                    Zn(e, "setFontFamily", be, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setFontFamily = er,
                    ve = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("font-size", "font", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    ye = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ve(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function tr(e, t) {
                    Zn(e, "setFontSize", ye, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setFontSize = tr,
                    xe = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("font-weight", "font", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    we = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new xe(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ir(e, t) {
                    Zn(e, "setFontWeight", we, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setFontWeight = ir,
                    Ce = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this
                                , n = GC.Spread.Sheets.TextDecorationType.underline;
                            o.setStyle("textDecoration", "textDecoration", t.value, t, o.getTextDecoration, [n]),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Se = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ce(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function or(e, t) {
                    Zn(e, "setUnderline", Se, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setUnderline = or,
                    ke = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this
                                , n = GC.Spread.Sheets.TextDecorationType.doubleUnderline;
                            o.setStyle("textDecoration", "textDecoration", t.value, t, o.getTextDecoration, [n]),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Te = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ke(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function nr(e, t) {
                    Zn(e, "setDoubleUnderline", Te, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setDoubleUnderline = nr,
                    Ae = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("font-style", "font", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Ie = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ae(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function rr(e, t) {
                    Zn(e, "setFontStyle", Ie, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setFontStyle = rr,
                    De = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("backColor", "backColor", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    $e = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new De(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ar(e, t) {
                    Zn(e, "setBackColor", $e, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setBackColor = ar,
                    Fe = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("foreColor", "foreColor", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Le = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Fe(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function sr(e, t) {
                    Zn(e, "setForeColor", Le, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setForeColor = sr,
                    Re = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("hAlign", "hAlign", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Be = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Re(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function lr(e, t) {
                    Zn(e, "setHAlign", Be, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setHAlign = lr,
                    Ne = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("vAlign", "vAlign", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Ee = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ne(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function cr(e, t) {
                    Zn(e, "setVAlign", Ee, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setVAlign = cr,
                    Ve = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("formatter", "formatter", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Pe = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ve(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function dr(e, t) {
                    Zn(e, "setFormatter", Pe, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setFormatter = dr,
                    ze = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("formatter", t)
                        }
                            ,
                            t.prototype.setStyle = function(e, t) {
                                var i = this, o, n, r, s, l;
                                i.execInSelections(i.wv, function(e, t, c) {
                                    var d, p, u, h, f, g, m, b, v, y, x, w, C, S, k = e.getStyle(t, c);
                                    if (k || (k = new a.Style),
                                            d = i.wv.getCell(i.ho.activeRowIndex, i.ho.activeColIndex),
                                            p = d.value(),
                                            u = d.formatter(),
                                            h = d.text(),
                                            p) {
                                        if (o = null,
                                                n = "0",
                                                r = "#",
                                                s = ".",
                                                l = "0" + s + "0",
                                                g = i.getScientificNotationCheckingFormattter(u),
                                            !u || "General" === u || g && (g.indexOf("E") >= 0 || g.indexOf("e") >= 0)) {
                                            if (!isNaN(p))
                                                if (m = h.split("."),
                                                    1 === m.length)
                                                    o = m[0].indexOf("E") >= 0 || m[0].indexOf("e") >= 0 ? l + "E+00" : l;
                                                else if (2 === m.length) {
                                                    for (m[0] = "0",
                                                             b = !1,
                                                             v = "",
                                                             f = 0; f < m[1].length + 1; f++)
                                                        if (v += "0",
                                                            f < m[1].length && ("e" === m[1].charAt(f) || "E" === m[1].charAt(f))) {
                                                            b = !0;
                                                            break
                                                        }
                                                    b && (v += "E+00"),
                                                    v && (m[1] = "" + v,
                                                        o = m[0] + s + m[1])
                                                }
                                        } else if (o = u) {
                                            for (y = o.split(";"),
                                                     f = 0; f < y.length && f < 2; f++)
                                                y[f] && y[f].indexOf("/") < 0 && y[f].indexOf(":") < 0 && y[f].indexOf("?") < 0 && (x = y[f].lastIndexOf(s),
                                                    -1 !== x ? y[f] = y[f].slice(0, x + 1) + n + y[f].slice(x + 1) : (w = y[f].lastIndexOf(n),
                                                        C = y[f].lastIndexOf(r),
                                                    (S = w > C ? w : C) >= 0 && (y[f] = y[f].slice(0, S + 1) + s + n + y[f].slice(S + 1))));
                                            o = y.join(";")
                                        }
                                        k.formatter = o,
                                            e.setStyle(t, c, k)
                                    }
                                })
                            }
                            ,
                            t.prototype.getScientificNotationCheckingFormattter = function(e) {
                                var t, i, o, n, r;
                                if (!e)
                                    return e;
                                for (t = this,
                                         o = t.getSubStrings(e, "'", "'"),
                                         i = 0; i < o.length; i++)
                                    e = e.replace(o[i], "");
                                for (n = t.getSubStrings(e, '"', '"'),
                                         i = 0; i < n.length; i++)
                                    e = e.replace(n[i], "");
                                for (r = this.getSubStrings(e, "[", "]"),
                                         i = 0; i < r.length; i++)
                                    e = e.replace(r[i], "");
                                return e
                            }
                            ,
                            t.prototype.getSubStrings = function(e, t, i) {
                                var o, n, r, a;
                                if (!e)
                                    return [];
                                for (o = [],
                                         n = "",
                                         r = !1,
                                         a = 0; a < e.length; a++)
                                    r || e[a] !== t ? r && (n += e[a],
                                    e[a] === i && (o.push(n),
                                        n = "",
                                        r = !1)) : (r = !0,
                                        n = e[a]);
                                return o
                            }
                            ,
                            t
                    }(q),
                    je = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ze(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function pr(e, t) {
                    var i = t.sheet
                        , o = i.getActiveRowIndex()
                        , n = i.getActiveColumnIndex();
                    Zn(e, "increaseDecimal", je, {
                        selections: t.selections,
                        activeRowIndex: o,
                        activeColIndex: n,
                        sheetName: t.sheetName
                    })
                }
                e.increaseDecimal = pr,
                    Me = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("formatter", t)
                        }
                            ,
                            t.prototype.setStyle = function(e, t) {
                                var i, o = this;
                                o.execInSelections(o.wv, function(e, t, n) {
                                    var r, s, l, c, d, p, u, h, f, g, m, b, v = e.getStyle(t, n);
                                    if (v || (v = new a.Style),
                                            r = o.wv.getCell(o.ho.activeRowIndex, o.ho.activeColIndex),
                                            s = r.value(),
                                            l = r.formatter(),
                                            c = r.text(),
                                            i = ".",
                                            s) {
                                        if (p = null,
                                            l && "General" !== l) {
                                            for (p = l,
                                                     g = p.split(";"),
                                                     d = 0; d < g.length && d < 2; d++)
                                                g[d] && g[d].indexOf("/") < 0 && g[d].indexOf(":") < 0 && g[d].indexOf("?") < 0 && -1 !== (m = g[d].lastIndexOf(i)) && m + 1 < g[d].length && (g[d] = g[d].slice(0, m + 1) + g[d].slice(m + 2),
                                                "" !== (b = m + 1 < g[d].length ? g[d].substr(m + 1, 1) : "") && "0" === b || (g[d] = g[d].slice(0, m) + g[d].slice(m + 1)));
                                            p = g.join(";")
                                        } else if (!isNaN(s) && (u = c.split("."),
                                            2 === u.length)) {
                                            for (u[0] = "0",
                                                     h = !1,
                                                     f = "",
                                                     d = 0; d < u[1].length - 1; d++) {
                                                if (d + 1 < u[1].length && ("e" === u[1].charAt(d + 1) || "E" === u[1].charAt(d + 1))) {
                                                    h = !0;
                                                    break
                                                }
                                                f += "0"
                                            }
                                            h && (f += "E+00"),
                                                u[1] = "" + f,
                                                p = u[0] + ("" !== u[1] ? i + u[1] : "")
                                        }
                                        v.formatter = p,
                                            e.setStyle(t, n, v)
                                    }
                                })
                            }
                            ,
                            t
                    }(q),
                    Oe = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Me(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ur(e, t) {
                    var i = t.sheet
                        , o = i.getActiveRowIndex()
                        , n = i.getActiveColumnIndex();
                    Zn(e, "decreaseDecimal", Oe, {
                        selections: t.selections,
                        activeRowIndex: o,
                        activeColIndex: n,
                        sheetName: t.sheetName
                    })
                }
                e.decreaseDecimal = ur,
                    Ge = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this, a = r.getSelections();
                            for (o = 0; o < a.length; o++)
                                n = a[o],
                                    r.setRangeBorder(n, t.value)
                        }
                            ,
                            t.prototype.setRangeBorder = function(e, t) {
                                var i = this.wv
                                    , o = e.row
                                    , n = e.col
                                    , r = e.rowCount
                                    , a = e.colCount;
                                i.getRange(o, n, r, a).setBorder(t.lineborder, t.options)
                            }
                            ,
                            t
                    }(q),
                    He = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ge(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function hr(e, t) {
                    Zn(e, "setBorder", He, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setBorder = hr,
                    Ue = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a, s = this, l = s.getSelections();
                            for (o = 0; o < l.length; o++)
                                n = l[o],
                                    r = t.borderType,
                                    a = t.orignalBorder,
                                s.borderLineEquals(r.topLineBorder, a.borderTop) || s.setRangeBorder(n, {
                                    lineborder: r.topLineBorder,
                                    options: {
                                        top: !0
                                    }
                                }),
                                s.borderLineEquals(r.bottomLineBorder, a.borderBottom) || s.setRangeBorder(n, {
                                    lineborder: r.bottomLineBorder,
                                    options: {
                                        bottom: !0
                                    }
                                }),
                                s.borderLineEquals(r.rightLineBorder, a.borderRight) || s.setRangeBorder(n, {
                                    lineborder: r.rightLineBorder,
                                    options: {
                                        right: !0
                                    }
                                }),
                                s.borderLineEquals(r.leftLineBorder, a.borderLeft) || s.setRangeBorder(n, {
                                    lineborder: r.leftLineBorder,
                                    options: {
                                        left: !0
                                    }
                                }),
                                s.borderLineEquals(r.innerHorizontalLineBorder, a.borderHorizontal) || s.setRangeBorder(n, {
                                    lineborder: r.innerHorizontalLineBorder,
                                    options: {
                                        innerHorizontal: !0
                                    }
                                }),
                                s.borderLineEquals(r.innerVerticalLineBorder, a.borderVertical) || s.setRangeBorder(n, {
                                    lineborder: r.innerVerticalLineBorder,
                                    options: {
                                        innerVertical: !0
                                    }
                                }),
                                s.borderLineEquals(r.diagonalUpBorder, a.diagonalUpBorder) || s.setRangeBorder(n, {
                                    lineborder: r.diagonalUpBorder,
                                    options: {
                                        diagonalUp: !0
                                    }
                                }),
                                s.borderLineEquals(r.diagonalDownBorder, a.diagonalDownBorder) || s.setRangeBorder(n, {
                                    lineborder: r.diagonalDownBorder,
                                    options: {
                                        diagonalDown: !0
                                    }
                                })
                        }
                            ,
                            t.prototype.borderLineEquals = function(e, t) {
                                return e === t || !(!e || !t) && (e.style === t.style && e.level === t.level && e.color === t.color)
                            }
                            ,
                            t.prototype.setRangeBorder = function(e, t) {
                                var i = this.wv
                                    , o = e.row
                                    , n = e.col
                                    , r = e.rowCount
                                    , a = e.colCount;
                                i.getRange(o, n, r, a).setBorder(t.lineborder, t.options)
                            }
                            ,
                            t
                    }(q),
                    We = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ue(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function fr(e, t) {
                    Zn(e, "setAllBorder", We, {
                        orignalBorder: t.options.orignalBorder,
                        borderType: t.options.borderType,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setAllBorder = fr,
                    _e = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setIndent(t),
                                o.updateRibbon()
                        }
                            ,
                            t.prototype.setIndent = function(e) {
                                var t = this;
                                t.execInSelections(t.wv, function(t, i, o) {
                                    var n, r, s = t.getStyle(i, o);
                                    s || (s = new a.Style),
                                        n = s.textIndent,
                                    isNaN(n) && (n = 0),
                                        r = n + e.value,
                                    r < 0 && (r = 0),
                                        s.textIndent = r,
                                        t.setStyle(i, o, s)
                                })
                            }
                            ,
                            t
                    }(q),
                    qe = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new _e(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function gr(e, t) {
                    Zn(e, "setIndent", qe, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setIndent = gr,
                    Ke = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("isVerticalText", "isVerticalText", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Ye = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ke(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function mr(e, t) {
                    Zn(e, "setTextVertical", Ye, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTextVertical = mr,
                    Xe = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("wordWrap", "wordWrap", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t
                    }(q),
                    Je = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Xe(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function br(e, t) {
                    Zn(e, "setWordWrap", Je, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setWordWrap = br,
                    Qe = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            var e, t, i = !0, o = this.getSelections(), n = o.length;
                            for (e = 0; e < n; e++) {
                                for (t = e + 1; t < n; t++)
                                    if (o[e].intersect(o[t].row, o[t].col, o[t].rowCount, o[t].colCount)) {
                                        i = !1;
                                        break
                                    }
                                if (!i)
                                    break
                            }
                            return i
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var o, n, r, s, l, c = this, d = c.getSelections();
                                for (o = 0; o < d.length; o++)
                                    n = d[o],
                                        r = -1 === n.row ? 0 : n.row,
                                        s = -1 === n.col ? 0 : n.col,
                                        c.wv.addSpan(r, s, n.rowCount, n.colCount),
                                        l = c.wv.getStyle(r, s),
                                    l || (l = new a.Style),
                                        l.hAlign = 1,
                                        c.wv.setStyle(r, s, l)
                            }
                            ,
                            t
                    }(q),
                    Ze = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Qe(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function vr(e, t) {
                    Zn(e, "mergeCenter", Ze, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.mergeCenter = vr,
                    et = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a, s, l, c, d = this, p = d.getSelections();
                            for (o = 0; o < p.length; o++) {
                                for (n = p[o],
                                         r = -1 === n.row ? 0 : n.row,
                                         a = -1 === n.col ? 0 : n.col,
                                         s = 0; s < n.rowCount; s++)
                                    for (l = 0; l < n.colCount; l++)
                                        d.wv.removeSpan(r + s, a + l);
                                for (c = 0; c < n.rowCount; c++)
                                    d.wv.addSpan(r + c, a, 1, n.colCount)
                            }
                        }
                            ,
                            t
                    }(q),
                    tt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new et(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function yr(e, t) {
                    Zn(e, "mergeAcross", tt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.mergeAcross = yr,
                    it = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a, s = this, l = s.getSelections();
                            for (o = 0; o < l.length; o++)
                                n = l[o],
                                    r = -1 === n.row ? 0 : n.row,
                                    a = -1 === n.col ? 0 : n.col,
                                    s.wv.addSpan(r, a, n.rowCount, n.colCount)
                        }
                            ,
                            t
                    }(q),
                    ot = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new it(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function xr(e, t) {
                    Zn(e, "mergeCells", ot, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.mergeCells = xr,
                    nt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a, s, l, c = this, d = c.getSelections();
                            for (o = 0; o < d.length; o++)
                                for (n = d[o],
                                         r = -1 === n.row ? 0 : n.row,
                                         a = -1 === n.col ? 0 : n.col,
                                         s = 0; s < n.rowCount; s++)
                                    for (l = 0; l < n.colCount; l++)
                                        c.wv.removeSpan(r + s, a + l)
                        }
                            ,
                            t
                    }(q),
                    rt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new nt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function wr(e, t) {
                    Zn(e, "unmergeCells", rt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.unmergeCells = wr,
                    at = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canDoInsertOrDeleteRow = function() {
                            return !0
                        }
                            ,
                            t.prototype.canDoInsertOrDeleteColumn = function() {
                                return !0
                            }
                            ,
                            t.prototype.getSortedRowSelections = function() {
                                var e, t, i, o = this.getSelections();
                                for (e = 0; e < o.length - 1; e++)
                                    for (t = e + 1; t < o.length; t++)
                                        o[e].row < o[t].row && (i = o[e],
                                            o[e] = o[t],
                                            o[t] = i);
                                return o
                            }
                            ,
                            t.prototype.getSortedColumnSelections = function() {
                                var e, t, i, o = this.getSelections();
                                for (e = 0; e < o.length - 1; e++)
                                    for (t = e + 1; t < o.length; t++)
                                        o[e].col < o[t].col && (i = o[e],
                                            o[e] = o[t],
                                            o[t] = i);
                                return o
                            }
                            ,
                            t
                    }(q),
                    e.InsertAndDeleteBase = at,
                    st = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a, s, l, c = this;
                            if (3 === Fa(c.getSelections())) {
                                if (n = c.getSortedColumnSelections(),
                                        r = c.wv.getColumnCount(),
                                        !c.canInsertRight(n))
                                    return o.MessageBox.show(o.res.changePartOfArrayWarning, o.res.title, 2, 0, function() {
                                        $(".fill-content").focus()
                                    }),
                                        !1;
                                for (a = 0; a < n.length; a++)
                                    s = n[a],
                                        l = GC.Spread.Sheets.CopyToOptions.all,
                                        c.wv.addColumns(r, s.colCount),
                                        c.wv.moveTo(s.row, s.col, s.row, s.col + s.colCount, s.rowCount, r - s.col, l)
                            }
                        }
                            ,
                            t.prototype.canInsertRight = function(e) {
                                var t, i, o, n, r, a, s, l, c, d, p, u, h, f, g = this.wv, m = !0;
                                for (t = 0; t < e.length; t++) {
                                    for (i = e[t],
                                             o = [],
                                             n = i.row,
                                             r = i.col,
                                             a = i.row + i.rowCount,
                                             s = i.col + i.colCount,
                                             l = n; l < a; l++)
                                        for (c = r; c < s; c++) {
                                            for (d = 0; d < o.length && !o[d].contains(l, c); d++)
                                                ;
                                            d === o.length && g.getFormulaInformation(l, c).isArrayFormula && o.push(g.getFormulaInformation(l, c).baseRange)
                                        }
                                    if (0 === o.length)
                                        return m;
                                    for (p = o[0].col,
                                             u = o[0].row,
                                             h = o[0].row + o[0].rowCount,
                                             f = 1; f < o.length; f++)
                                        o[f].col < p && (p = o[f].col),
                                        o[f].row < u && (u = o[f].row),
                                        o[f].row + o[f].rowCount < h && (h = o[f].row + o[f].rowCount);
                                    if (p < i.col || u < i.row || h > i.row + i.rowCount) {
                                        m = !1;
                                        break
                                    }
                                }
                                return m
                            }
                            ,
                            t
                    }(at),
                    lt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new st(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Cr(e, t) {
                    Zn(e, "insertRightCells", lt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.insertRightCells = Cr,
                    ct = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a, s, l, c = this;
                            if (3 === Fa(c.getSelections())) {
                                if (n = c.getSortedRowSelections(),
                                        r = c.wv.getRowCount(),
                                        !c.canInsertDown(n))
                                    return o.MessageBox.show(o.res.changePartOfArrayWarning, o.res.title, 2, 0, function() {
                                        $(".fill-content").focus()
                                    }),
                                        !1;
                                for (a = 0; a < n.length; a++)
                                    s = n[a],
                                        l = GC.Spread.Sheets.CopyToOptions.all,
                                        c.wv.addRows(r, s.rowCount),
                                        c.wv.moveTo(s.row, s.col, s.row + s.rowCount, s.col, r - s.row, s.colCount, l)
                            }
                        }
                            ,
                            t.prototype.canInsertDown = function(e) {
                                var t, i, o, n, r, a, s, l, c, d, p, u, h, f, g = this.wv, m = !0;
                                for (t = 0; t < e.length; t++) {
                                    for (i = e[t],
                                             o = [],
                                             n = i.row,
                                             r = i.col,
                                             a = i.row + i.rowCount,
                                             s = i.col + i.colCount,
                                             l = n; l < a; l++)
                                        for (c = r; c < s; c++) {
                                            for (d = 0; d < o.length && !o[d].contains(l, c); d++)
                                                ;
                                            d === o.length && g.getFormulaInformation(l, c).isArrayFormula && o.push(g.getFormulaInformation(l, c).baseRange)
                                        }
                                    if (0 === o.length)
                                        return m;
                                    for (p = o[0].col,
                                             u = o[0].row,
                                             h = o[0].col + o[0].colCount,
                                             f = 1; f < o.length; f++)
                                        o[f].col < p && (p = o[f].col),
                                        o[f].row < u && (u = o[f].row),
                                        o[f].col + o[f].colCount < h && (h = o[f].row + o[f].rowCount);
                                    if (p < i.col || u < i.row || h > i.col + i.colCount) {
                                        m = !1;
                                        break
                                    }
                                }
                                return m
                            }
                            ,
                            t
                    }(at),
                    dt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ct(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Sr(e, t) {
                    Zn(e, "insertDownCells", dt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.insertDownCells = Sr,
                    pt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a = this, s = a.getSortedColumnSelections();
                            for (o = 0; o < s.length; o++)
                                n = s[o],
                                    r = GC.Spread.Sheets.CopyToOptions.all,
                                    a.wv.moveTo(n.row, n.col + n.colCount, n.row, n.col, n.rowCount, a.wv.getColumnCount() - (n.col + n.colCount), r)
                        }
                            ,
                            t
                    }(at),
                    ut = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new pt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function kr(e, t) {
                    Zn(e, "deleteLeftCells", ut, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.deleteLeftCells = kr,
                    ht = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a = this, s = a.getSortedRowSelections();
                            for (o = 0; o < s.length; o++)
                                n = s[o],
                                    r = GC.Spread.Sheets.CopyToOptions.all,
                                    a.wv.moveTo(n.row + n.rowCount, n.col, n.row, n.col, a.wv.getRowCount() - (n.row + n.rowCount), n.colCount, r)
                        }
                            ,
                            t
                    }(at),
                    ft = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ht(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Tr(e, t) {
                    Zn(e, "deleteUpCells", ft, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.deleteUpCells = Tr,
                    gt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            return this.canDoInsertOrDeleteRow()
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var n, r = this, a = r.getSortedRowSelections();
                                for (n = 0; n < a.length; n++)
                                    r.wv.addRows(a[n].row, a[n].rowCount),
                                        o.util.setSpanStyleWhenInsertRowsColumns(r.wv, a[n].row, -1, a[n].rowCount)
                            }
                            ,
                            t
                    }(at),
                    mt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new gt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ar(e, t) {
                    Zn(e, "insertRows", mt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.insertRows = Ar,
                    bt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            return this.canDoInsertOrDeleteRow() && !this.uB()
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var o, n = this, r = n.getSortedRowSelections();
                                for (o = 0; o < r.length; o++)
                                    n.wv.deleteRows(r[o].row, r[o].rowCount)
                            }
                            ,
                            t.prototype.uB = function() {
                                var e, t, i = this, o = i.getSortedRowSelections(), n = i.wv.tables.all();
                                for (e in n)
                                    for (t in o)
                                        if (n[e].headerIndex() === o[t].row)
                                            return !0;
                                return !1
                            }
                            ,
                            t
                    }(at),
                    vt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new bt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ir(e, t) {
                    Zn(e, "deleteRows", vt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.deleteRows = Ir,
                    yt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            return this.canDoInsertOrDeleteColumn()
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var n, r = this, a = r.getSortedColumnSelections();
                                for (n = 0; n < a.length; n++)
                                    r.wv.addColumns(a[n].col, a[n].colCount),
                                        o.util.setSpanStyleWhenInsertRowsColumns(r.wv, -1, a[n].col, a[n].colCount)
                            }
                            ,
                            t
                    }(at),
                    xt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new yt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Dr(e, t) {
                    Zn(e, "insertColumns", xt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.insertColumns = Dr,
                    wt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            return this.canDoInsertOrDeleteColumn()
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var o, n = this, r = n.getSortedColumnSelections();
                                for (o = 0; o < r.length; o++)
                                    n.wv.deleteColumns(r[o].col, r[o].colCount)
                            }
                            ,
                            t
                    }(at),
                    Ct = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new wt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function $r(e, t) {
                    Zn(e, "deleteColumns", Ct, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.deleteColumns = $r,
                    St = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.execute = function(e, t, i) {
                            var n = this;
                            return !!n.canExecute() && (n.spread().addSheet(n.spread().getSheetIndex(n.sheet().name())),
                                o.actions.isFileModified = !0,
                                !0)
                        }
                            ,
                            t
                    }(q),
                    kt = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new St(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Fr(e, t) {
                    Zn(e, "insertSheet", kt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.insertSheet = Fr,
                    Tt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            return this.spread().getSheetCount() > 1
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var n = this;
                                if (!(n.spread().getSheetCount() > 1))
                                    return o.MessageBox.show(o.res.contextMenu.comments, o.res.title, 2, 0),
                                        !1;
                                n.spread().removeSheet(n.spread().getSheetIndex(n.sheet().name())),
                                    o.actions.isFileModified = !0,
                                    n.spread().undoManager().clear()
                            }
                            ,
                            t
                    }(q),
                    At = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Tt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Lr(e, t) {
                    Zn(e, "deleteSheet", At, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.deleteSheet = Lr,
                    It = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.vB = function() {
                            var e, t, i = this, o = i.wv.pictures.all(), n = o.length, r = "", a = [];
                            for (e = 0; e < n; e++)
                                a.push(o[e].name());
                            for (t = 0; t < n; t++)
                                if (r = "picture" + t,
                                    $.inArray(r, a) < 0)
                                    return r;
                            return r = "picture" + n
                        }
                            ,
                            t.prototype.wB = function(e) {
                                var t, i, n = this, r = e.activeRowIndex, a = e.activeColIndex, s = e.rowHeight, l = e.colWidth;
                                try {
                                    t = n.vB(),
                                        i = e.fileName,
                                        n.wv.pictures.add(t, i, a * l, r * s),
                                        o.actions.isFileModified = !0
                                } catch (e) {}
                            }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                this.wB(t)
                            }
                            ,
                            t
                    }(q),
                    Dt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new It(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Rr(e, t) {
                    var i = t.sheet
                        , o = i.getActiveRowIndex()
                        , n = i.getActiveColumnIndex()
                        , r = i.defaults.rowHeight
                        , a = i.defaults.colWidth;
                    Zn(e, "insertPicture", Dt, {
                        selections: t.selections,
                        sheetName: t.sheetName,
                        activeRowIndex: o,
                        activeColIndex: n,
                        fileName: t.options,
                        rowHeight: r,
                        colWidth: a
                    })
                }
                e.insertPicture = Rr,
                    $t = [],
                    Ft = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            var e, t, i = this, n = i.spread().sheets, r = 0;
                            for (e = 0; e < n.length; e++)
                                n[e].visible() && r++;
                            if (t = r >= 2)
                                return t;
                            o.MessageBox.show(o.res.contextMenu.comments, o.res.title, 2, 0)
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var n = this;
                                n.wv && ($t.push(n.wv),
                                    n.wv.visible(!1),
                                    o.wrapper.setFocusToSpread(),
                                    o.actions.isFileModified = !0,
                                    o.wrapper.spread.undoManager().clear())
                            }
                            ,
                            t
                    }(q),
                    Lt = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Ft(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Br(e, t) {
                    Zn(e, "hideSheet", Lt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.hideSheet = Br,
                    Rt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i),
                                this.xB = this.spread().sheets
                        }
                        return t.prototype.canExecute = function() {
                            var e, t = this, i = t.xB.length;
                            for (e = 0; e < i; e++)
                                if (!t.xB[e].visible())
                                    return !0;
                            return !1
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                var n, r, a, s = this, l = s.spread();
                                if (0 === $t.length)
                                    for (n = l.sheets,
                                             r = 0; r < n.length; r++)
                                        n[r].visible() || $t.push(n[r]);
                                $t.length > 0 && (a = $t.pop(),
                                    a.visible(!0),
                                    l.setActiveSheet(a.name()),
                                    o.actions.isFileModified = !0),
                                    o.wrapper.setFocusToSpread()
                            }
                            ,
                            t
                    }(q),
                    Bt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Rt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Nr(e, t) {
                    Zn(e, "unhideSheet", Bt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.unhideSheet = Nr,
                    Nt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForRow(o.wv, function(e, i) {
                                o.wv.setRowHeight(i, t.height),
                                    r[i] = !0
                            })
                        }
                            ,
                            t
                    }(q),
                    Et = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Nt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Er(e, t) {
                    Zn(e, "setRowsHeight", Et, {
                        height: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setRowsHeight = Er,
                    Vt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForRow(o.wv, function(e, t) {
                                o.wv.autoFitRow(t),
                                    r[t] = !1
                            })
                        }
                            ,
                            t
                    }(q),
                    Pt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Vt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Vr(e, t) {
                    Zn(e, "autofitRows", Pt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.autofitRows = Vr,
                    zt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForRow(o.wv, function(e, t) {
                                o.wv.setRowVisible(t, !1)
                            })
                        }
                            ,
                            t
                    }(q),
                    jt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new zt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Pr(e, t) {
                    Zn(e, "hideRows", jt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.hideRows = Pr,
                    Mt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        function i(e, t) {
                            e.setRowVisible(t, !0)
                        }
                        return t.prototype.executeImp = function(e, t, o) {
                            var n, r, a, s = this, l = s.wv, c = s.getSelections();
                            if (1 === c.length && 1 === c[0].rowCount) {
                                for (n = c[0],
                                         r = 0,
                                         a = 0; a <= n.row; a++)
                                    if (l.getRowVisible(a)) {
                                        r = a;
                                        break
                                    }
                                n.row !== r && 0 === r || (l.setRowVisible(r - 1, !0),
                                    l.showRow(r - 1))
                            } else
                                s.execInSelectionsForRow(l, i)
                        }
                            ,
                            t
                    }(q),
                    Ot = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Mt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function zr(e, t) {
                    Zn(e, "unHideRows", Ot, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.unHideRows = zr,
                    Gt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.defaults.rowHeight = t.height
                        }
                            ,
                            t
                    }(q),
                    Ht = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Gt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function jr(e, t) {
                    Zn(e, "defaultRowHeight", Ht, {
                        height: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.defaultRowHeight = jr,
                    Ut = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForCol(o.wv, function(e, i) {
                                o.wv.setColumnWidth(i, t.width)
                            })
                        }
                            ,
                            t
                    }(q),
                    Wt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ut(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Mr(e, t) {
                    Zn(e, "setColumnsWidth", Wt, {
                        width: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setColumnsWidth = Mr,
                    _t = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForCol(o.wv, function(e, t) {
                                o.wv.autoFitColumn(t)
                            })
                        }
                            ,
                            t
                    }(q),
                    qt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new _t(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Or(e, t) {
                    Zn(e, "autofitColumns", qt, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.autofitColumns = Or,
                    Kt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForCol(o.wv, function(e, t) {
                                o.wv.setColumnVisible(t, !1)
                            })
                        }
                            ,
                            t
                    }(q),
                    Yt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Kt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Gr(e, t) {
                    Zn(e, "hideColumns", Yt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.hideColumns = Gr,
                    Xt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        function i(e, t) {
                            e.setColumnVisible(t, !0)
                        }
                        return t.prototype.executeImp = function(e, t, o) {
                            var n, r, a, s = this, l = s.wv, c = s.getSelections();
                            if (1 === c.length && 1 === c[0].colCount) {
                                for (n = c[0],
                                         r = 0,
                                         a = 0; a <= n.col; a++)
                                    if (l.getColumnVisible(a)) {
                                        r = a;
                                        break
                                    }
                                n.col !== r && 0 === r || (l.setColumnVisible(r - 1, !0),
                                    l.showColumn(r - 1))
                            } else
                                s.execInSelectionsForCol(l, i)
                        }
                            ,
                            t
                    }(q),
                    Jt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Xt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Hr(e, t) {
                    Zn(e, "unHideColumns", Jt, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.unHideColumns = Hr,
                    Qt = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.defaults.colWidth = t.width
                        }
                            ,
                            t
                    }(q),
                    Zt = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Qt(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ur(e, t) {
                    Zn(e, "defaultColumnWidth", Zt, {
                        width: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.defaultColumnWidth = Ur;
                function Wr(e, i) {
                    Zn(e, "protectSheet", t[x], {
                        value: i.options,
                        selections: i.selections,
                        sheetName: i.sheetName
                    })
                }
                e.protectSheet = Wr;
                function _r(e, i) {
                    Zn(e, "confirmProtectSheet", t[w], {
                        value: i.options,
                        selections: i.selections,
                        sheetName: i.sheetName
                    })
                }
                e.confirmProtectSheet = _r,
                    ei = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelections(o.wv, function(e, i, o) {
                                var n = e.getStyle(i, o);
                                n || (n = new a.Style),
                                    n.locked = t.value,
                                    e.setStyle(i, o, n)
                            })
                        }
                            ,
                            t
                    }(q),
                    ti = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ei(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function qr(e, t) {
                    Zn(e, "LockCells", ti, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.LockCells = qr,
                    ii = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, s, l, c, d = this, p = d.getSelections();
                            if ($.isArray(t.value))
                                for (n = t.value,
                                         o = 0; o < n.length; o++)
                                    d.sheet().fillAuto(n[o].startRange, n[o].wholeRange, n[o].fillAutoOptions);
                            else
                                for (o = 0; o < p.length; o++) {
                                    switch (r = p[o],
                                        t.value) {
                                        case 3:
                                            s = new a.Range(r.row,r.col,1,r.colCount);
                                            break;
                                        case 2:
                                            l = r.row,
                                                l = -1 === l ? d.wv.getRowCount() - 1 : r.row + r.rowCount - 1,
                                                s = new a.Range(l,r.col,1,r.colCount);
                                            break;
                                        case 1:
                                            s = new a.Range(r.row,r.col,r.rowCount,1);
                                            break;
                                        case 0:
                                            c = r.col,
                                                c = -1 === c ? d.wv.getColumnCount() - 1 : r.col + r.colCount - 1,
                                                s = new a.Range(r.row,c,r.rowCount,1)
                                    }
                                    d.sheet().fillAuto(s, r, {
                                        fillType: 0,
                                        direction: t.value
                                    })
                                }
                        }
                            ,
                            t
                    }(q),
                    oi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ii(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Kr(e, t) {
                    Zn(e, "autoFillByDirection", oi, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.autoFillByDirection = Kr,
                    ni = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this
                                , n = o.sheet();
                            n.clear(0, 0, n.getRowCount(), n.getColumnCount(), 3, 51)
                        }
                            ,
                            t
                    }(q),
                    ri = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ni(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Yr(e, t) {
                    Zn(e, "clearSheetAllCell", ri, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearSheetAllCell = Yr,
                    ai = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this, a = r.getSelections();
                            for (o = 0; o < a.length; o++)
                                n = a[o],
                                    r.sheet().clear(n.row, n.col, n.rowCount, n.colCount, 3, 119),
                                    r.clearSpansInSelection(r.wv, n)
                        }
                            ,
                            t
                    }(q),
                    si = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ai(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Xr(e, t) {
                    Zn(e, "clearAll", si, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearAll = Xr,
                    li = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this, a = r.getSelections();
                            for (o = 0; o < a.length; o++)
                                n = a[o],
                                    r.wv.clear(n.row, n.col, n.rowCount, n.colCount, 3, 2),
                                    r.clearSpansInSelection(r.wv, n)
                        }
                            ,
                            t
                    }(q),
                    ci = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new li(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Jr(e, t) {
                    Zn(e, "clearFormat", ci, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearFormat = Jr,
                    di = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this, a = r.getSelections();
                            for (o = 0; o < a.length; o++)
                                n = a[o],
                                    r.wv.clear(n.row, n.col, n.rowCount, n.colCount, 3, 1)
                        }
                            ,
                            t
                    }(q),
                    pi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new di(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Qr(e, t) {
                    Zn(e, "clearContent", pi, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearContent = Qr,
                    ui = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this, a = r.getSelections();
                            for (o = 0; o < a.length; o++)
                                n = a[o],
                                    r.sheet().clear(n.row, n.col, n.rowCount, n.colCount, 3, 4)
                        }
                            ,
                            t
                    }(q),
                    hi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ui(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Zr(e, t) {
                    Zn(e, "clearComments", hi, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearComments = Zr,
                    fi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r = this, a = r.getSelections();
                            if (a && 0 !== a.length) {
                                if (a.length > 1)
                                    return o.MessageBox.show(o.res.NotExecInMultiRanges, o.res.title, 3),
                                        !1;
                                n = a[0],
                                    r.wv.sortRange(n.row, n.col, n.rowCount, n.colCount, !0, [{
                                        index: -1 === n.col ? 0 : n.col,
                                        ascending: t.value
                                    }])
                            }
                        }
                            ,
                            t
                    }(q),
                    gi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new fi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ea(e, t) {
                    Zn(e, "sortRange", gi, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.sortRange = ea,
                    mi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r = this, s = r.getSelections();
                            return s.length > 1 ? (o.MessageBox.show(o.res.NotExecInMultiRanges, o.res.title, 3),
                                !1) : (n = s[0],
                                r.wv.rowFilter() ? void (t.isRibbonFilter ? (r.wv.rowFilter().unfilter(),
                                    r.wv.rowFilter(null)) : (r.wv.rowFilter().unfilter(),
                                    r.wv.rowFilter(new a.Filter.HideRowFilter(n)))) : void r.wv.rowFilter(new a.Filter.HideRowFilter(n)))
                        }
                            ,
                            t
                    }(q),
                    bi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new mi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ta(e, t) {
                    Zn(e, "setRowFilter", bi, {
                        isRibbonFilter: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setRowFilter = ta,
                    vi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            var e = this;
                            return !(!e.wv.rowFilter() || !e.wv.rowFilter().isFiltered())
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                this.wv.rowFilter().unfilter()
                            }
                            ,
                            t
                    }(q),
                    yi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new vi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ia(e, t) {
                    Zn(e, "clearRowFilter", yi, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearRowFilter = ia,
                    xi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.canExecute = function() {
                            var e = this;
                            return !(!e.wv.rowFilter() || !e.wv.rowFilter().isFiltered())
                        }
                            ,
                            t.prototype.executeImp = function(e, t, i) {
                                this.wv.rowFilter().filter()
                            }
                            ,
                            t
                    }(q),
                    wi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new xi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function oa(e, t) {
                    Zn(e, "reApplyRowFilter(", wi, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.reApplyRowFilter = oa;
                function na(e) {
                    var t, i = e.getActiveSheet(), o = i.name(), n = e.commandManager(), r = i.getSelections();
                    r && 0 !== r.length && (t = r[0],
                        n.execute({
                            cmd: "outlineRow",
                            sheetName: o,
                            index: t.row,
                            count: t.rowCount
                        }))
                }
                e.groupRows = na;
                function ra(e) {
                    var t, i = e.getActiveSheet(), o = i.name(), n = e.commandManager(), r = i.getSelections();
                    r && 0 !== r.length && (t = r[0],
                        n.execute({
                            cmd: "outlineColumn",
                            sheetName: o,
                            index: t.col,
                            count: t.colCount
                        }))
                }
                e.groupColumns = ra;
                function aa(e) {
                    var t, i = e.getActiveSheet(), o = i.name(), n = e.commandManager(), r = i.getSelections();
                    r && 0 !== r.length && (t = r[0],
                        n.execute({
                            cmd: "removeRowOutline",
                            sheetName: o,
                            index: t.row,
                            count: t.rowCount
                        }))
                }
                e.ungroupRows = aa;
                function sa(e) {
                    var t, i = e.getActiveSheet(), o = i.name(), n = e.commandManager(), r = i.getSelections();
                    r && 0 !== r.length && (t = r[0],
                        n.execute({
                            cmd: "removeColumnOutline",
                            sheetName: o,
                            index: t.col,
                            count: t.colCount
                        }))
                }
                e.ungroupColumns = sa,
                    Ci = function(e) {
                        o.extends(i, e);
                        var t;
                        function i(i, o) {
                            e.call(this, i, o),
                                t = this
                        }
                        return i.prototype.expandRowGroup = function(e, i, o) {
                            t.bw.commandManager().execute({
                                cmd: "expandRowOutline",
                                sheetName: t.wv.name(),
                                index: e,
                                level: i,
                                collapsed: o
                            })
                        }
                            ,
                            i.prototype.expandColumnGroup = function(e, i, o) {
                                t.bw.commandManager().execute({
                                    cmd: "expandColumnOutline",
                                    sheetName: t.wv.name(),
                                    index: e,
                                    level: i,
                                    collapsed: o
                                })
                            }
                            ,
                            i.prototype.exec = function(e) {
                                var i, n, r, a, s, l, c;
                                if (this.getSelections().length > 1)
                                    return o.MessageBox.show("The command cannot be used on multiple selections", "Spread Designer", 1, 0),
                                        !1;
                                if (i = this.getSelections()[0]) {
                                    for (l = 0; l < i.rowCount; l++)
                                        if (n = i.row + l,
                                            (r = e ? this.yB(this.wv.rowOutlines, n) : this.zB(this.wv.rowOutlines, n)) >= 0 && null != (a = this.wv.rowOutlines.find(n, r))) {
                                            s = 1 === this.wv.rowOutlines.direction() ? a.end + 1 : a.start - 1,
                                                this.expandRowGroup(s, r, e);
                                            break
                                        }
                                    for (c = 0; c < i.colCount; c++)
                                        if (n = i.col + c,
                                            (r = e ? this.yB(this.wv.columnOutlines, n) : this.zB(this.wv.columnOutlines, n)) >= 0 && null != (a = this.wv.columnOutlines.find(n, r))) {
                                            s = 1 === this.wv.columnOutlines.direction() ? a.end + 1 : a.start - 1,
                                                t.expandColumnGroup(s, r, e);
                                            break
                                        }
                                }
                            }
                            ,
                            i
                    }(q),
                    Si = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            this.exec(!1)
                        }
                            ,
                            t.prototype.zB = function(e, t) {
                                var i, o, n, r = e.getLevel(t);
                                if (r <= 0)
                                    return r;
                                for (i = -1,
                                         o = r; o >= 0; o--)
                                    n = e.find(t, o),
                                    1 === n.state() && (i = o);
                                return i
                            }
                            ,
                            t
                    }(Ci),
                    ki = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Si(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function la(e, t) {
                    Zn(e, "expandGroup", ki, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.expandGroup = la,
                    Ti = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            this.exec(!0)
                        }
                            ,
                            t.prototype.yB = function(e, t) {
                                var i, o, n = e.getLevel(t);
                                if (n <= 0)
                                    return n;
                                for (i = n; i >= 0; i--)
                                    if (o = e.find(t, i),
                                        0 === o.state())
                                        return i;
                                return -1
                            }
                            ,
                            t
                    }(Ci),
                    Ai = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ti(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ca(e, t) {
                    Zn(e, "collapseGroup", Ai, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.collapseGroup = ca,
                    Ii = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.options.rowHeaderVisible = !o.wv.options.rowHeaderVisible
                        }
                            ,
                            t
                    }(q),
                    Di = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Ii(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function da(e, t) {
                    Zn(e, "showHideRowHeader", Di, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.showHideRowHeader = da,
                    $i = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.options.colHeaderVisible = !o.wv.options.colHeaderVisible
                        }
                            ,
                            t
                    }(q),
                    Fi = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new $i(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function pa(e, t) {
                    Zn(e, "showHideColumnHeader", Fi, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.showHideColumnHeader = pa,
                    Li = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.options.gridline.showVerticalGridline = !o.wv.options.gridline.showVerticalGridline
                        }
                            ,
                            t
                    }(q),
                    Ri = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Li(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ua(e, t) {
                    Zn(e, "showHideVGridLine", Ri, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.showHideVGridLine = ua,
                    Bi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.options.gridline.showHorizontalGridline = !o.wv.options.gridline.showHorizontalGridline
                        }
                            ,
                            t
                    }(q),
                    Ni = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Bi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ha(e, t) {
                    Zn(e, "showHideHGridLine", Ni, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.showHideHGridLine = ha,
                    Ei = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.bw.options.tabStripVisible = !o.bw.options.tabStripVisible
                        }
                            ,
                            t
                    }(q),
                    Vi = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Ei(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function fa(e, t) {
                    Zn(e, "showHideTabStrip", Vi, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.showHideTabStrip = fa,
                    Pi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.bw.options.newTabVisible = !o.bw.options.newTabVisible
                        }
                            ,
                            t
                    }(q),
                    zi = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Pi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ga(e, t) {
                    Zn(e, "showHideNewTab", zi, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.showHideNewTab = ga,
                    ji = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n = t.value;
                            this.wv.zoom(n),
                                o.ribbon.updateZoomToStatusBar()
                        }
                            ,
                            t.prototype.undoImp = function(e, t, i) {
                                return e.suspendPaint(),
                                    GC.Spread.Sheets.Commands.undoTransaction(e, t),
                                    e.resumePaint(),
                                    o.ribbon.updateZoomToStatusBar(),
                                    !0
                            }
                            ,
                            t
                    }(q),
                    Mi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ji(e,t);
                            o.execute(e, t, i)
                        }
                    };
                function ma(e, t) {
                    Zn(e, "zoom", Mi, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.zoom = ma;
                function ba(e, t) {
                    Zn(e, "zoom", Mi, {
                        value: 1,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.zoomDefault = ba;
                function va(e, t) {
                    var i = e.getActiveSheet()
                        , n = o.actions.mv();
                    i.showCell(n.topRow, n.leftCol, 0, 0),
                    n && Zn(e, "zoom", Mi, {
                        value: n.zoom,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.zoomSelection = va,
                    Oi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            void 0 !== t.value.row && o.wv.frozenRowCount(+t.value.row),
                            void 0 !== t.value.col && o.wv.frozenColumnCount(+t.value.col),
                            void 0 !== t.value.trailingRow && o.wv.frozenTrailingRowCount(+t.value.trailingRow),
                            void 0 !== t.value.trailingCol && o.wv.frozenTrailingColumnCount(+t.value.trailingCol)
                        }
                            ,
                            t
                    }(q),
                    Gi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Oi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ya(e, t) {
                    Zn(e, "freeze", Gi, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.freeze = ya,
                    Hi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.wv.frozenRowCount(0),
                                o.wv.frozenColumnCount(0),
                                o.wv.frozenTrailingColumnCount(0),
                                o.wv.frozenTrailingRowCount(0)
                        }
                            ,
                            t
                    }(q),
                    Ui = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Hi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function xa(e, t) {
                    Zn(e, "unfreeze", Ui, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.unfreeze = xa;
                function wa(e) {}
                e.calculateNow = wa;
                function Ca(e, t) {}
                e.autoCalculate = Ca,
                    Wi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.setStyle("", t.value, t),
                                o.updateRibbon()
                        }
                            ,
                            t.prototype.setStyle = function(e, t, i) {
                                var o = this
                                    , r = o.wv
                                    , a = o.bw;
                                a.suspendPaint(),
                                    o.execInSelections(r, function(e, i, o) {
                                        var r, a = t.clone(), s = e.getStyle(i, o);
                                        if (s)
                                            for (r in s)
                                                "_id" !== r && a[r] === n && (a[r] = s[r]);
                                        e.setStyle(i, o, a)
                                    }),
                                    a.resumePaint()
                            }
                            ,
                            t
                    }(q),
                    _i = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Wi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Sa(e, t) {
                    Zn(e, "setStyle", _i, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setStyle = Sa,
                    qi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelections(o.wv, function(e, i, o) {
                                e.setStyleName(i, o, t.value)
                            })
                        }
                            ,
                            t
                    }(q),
                    Ki = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new qi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ka(e, t) {
                    Zn(e, "setStyleByName", Ki, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setStyleByName = ka,
                    Yi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            this.spread().addNamedStyle(t.value)
                        }
                            ,
                            t
                    }(q),
                    Xi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Yi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ta(e, t) {
                    Zn(e, "addNameStyle", Xi, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.addNamedStyle = Ta,
                    Ji = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this
                                , n = o.wv
                                , r = t.value;
                            o.sB.forEach(function(e) {
                                n.setDataValidator(e.row, e.col, e.rowCount, e.colCount, r)
                            })
                        }
                            ,
                            t
                    }(q),
                    Qi = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ji(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Aa(e, t) {
                    Zn(e, "setDataValidation", Qi, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setDataValidation = Aa,
                    Zi = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            this.spread().options.highlightInvalidData = !0
                        }
                            ,
                            t
                    }(q),
                    eo = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new Zi(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ia(e, t) {
                    Zn(e, "circleInvalidData", eo, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.circleInvalidData = Ia,
                    to = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            this.spread().options.highlightInvalidData = !1
                        }
                            ,
                            t
                    }(q),
                    io = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new to(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Da(e, t) {
                    Zn(e, "unCircleInvalidData", io, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.unCircleInvalidData = Da,
                    function(t) {
                        t[t.Sheet = 0] = "Sheet",
                            t[t.OnlyRow = 1] = "OnlyRow",
                            t[t.OnlyColumn = 2] = "OnlyColumn",
                            t[t.OnlyCells = 3] = "OnlyCells",
                            t[t.Mixture = 4] = "Mixture",
                            e.SelectionRangeType = t
                    }(e.SelectionRangeType || {});
                function $a(e) {
                    var t = e.getActiveSheet().getSelections();
                    return Fa(t)
                }
                function Fa(e) {
                    var t, i, o;
                    for (i = 0; i < e.length; i++) {
                        if (o = e[i],
                            -1 === o.col && -1 === o.row)
                            return 0;
                        if (-1 === o.row) {
                            if (void 0 === t)
                                t = 2;
                            else if (2 != t)
                                return 4
                        } else if (-1 === o.col) {
                            if (void 0 === t)
                                t = 1;
                            else if (1 != t)
                                return 4
                        } else if (void 0 === t)
                            t = 3;
                        else if (3 != t)
                            return 4
                    }
                    return t
                }
                e.getSelectionType = $a,
                    oo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelections(o.wv, function(e, i, o) {
                                var n = e.getStyle(i, o);
                                n || (n = new a.Style),
                                    n.cellType = t.value,
                                    e.setStyle(i, o, n)
                            })
                        }
                            ,
                            t
                    }(q),
                    no = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new oo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function La(e, t) {
                    Zn(e, "setCellType", no, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setCellType = La,
                    ro = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelections(o.wv, function(e, t, i) {
                                var o = e.getStyle(t, i);
                                o || (o = new a.Style),
                                    o.cellType = n,
                                    e.setStyle(t, i, o)
                            })
                        }
                            ,
                            t
                    }(q),
                    ao = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ro(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ra(e, t) {
                    Zn(e, "clearCellType", ao, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearCellType = Ra,
                    so = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this;
                            if (r.wv.suspendCalcService(),
                                3 === Fa(r.getSelections()))
                                for (o = r.getSelections(),
                                         n = 0; n < o.length; n++)
                                    o[n].row + o[n].rowCount !== r.wv.getRowCount() && r.AB(o[n], t.formulaName);
                            r.wv.resumeCalcService()
                        }
                            ,
                            t.prototype.AB = function(e, t) {
                                var i, o, n = this;
                                for (i = 0; i < e.colCount; i++)
                                    o = l(e, 0, 0, GC.Spread.Sheets.CalcEngine.RangeReferenceRelative.allAbsolute),
                                        o = "=" + t + "(" + o + ")",
                                        n.wv.setFormula(e.row + e.rowCount, e.col + i, o)
                            }
                            ,
                            t
                    }(q),
                    lo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new so(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ba(e, t) {
                    Zn(e, "setAutoFormula", lo, {
                        formulaName: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setAutoFormula = Ba,
                    co = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a = this, s = t.value.locationRange, l = t.value.formula;
                            if (s) {
                                if (1 !== s.rowCount || 1 !== s.colCount)
                                    return o.MessageBox.show(o.res.createSparklineDialog.notSingleCell, o.res.title, 2, 0),
                                        !1;
                                a.wv.setFormula(s.row, s.col, l)
                            } else
                                n = a.ho.activeRowIndex,
                                    r = a.ho.activeColIndex,
                                l && a.wv.setFormula(n, r, l)
                        }
                            ,
                            t
                    }(q),
                    po = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new co(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Na(e, t) {
                    var i = t.sheet
                        , o = i.getActiveRowIndex()
                        , n = i.getActiveColumnIndex();
                    Zn(e, "setFormulaSparklineWithoutDatarange", po, {
                        value: t.options,
                        selections: t.selections,
                        activeRowIndex: o,
                        activeColIndex: n,
                        sheetName: t.sheetName
                    })
                }
                e.setFormulaSparklineWithoutDatarange = Na;
                function Ea(e, t) {
                    var i = a.CalcEngine.formulaToRanges(e, t, 0, 0)
                        , o = i[0]
                        , n = o && o.ranges && o.ranges[0];
                    return n ? {
                        range: n,
                        sheetName: o.sheetName
                    } : null
                }
                uo = function(e) {
                    o.extends(t, e);
                    function t(t, i) {
                        e.call(this, t, i)
                    }
                    return t.prototype.executeImp = function(e, t, i) {
                        var n, r, a, s, l, c, d, p, u, h, f, g, m, b, v = this;
                        if (v._h = t.value,
                                n = t.value.locationRange,
                                r = t.value.type,
                                a = t.value.formula,
                                s = v.wv,
                                !(c = Ea(s, v._h.dataRange)))
                            return o.MessageBox.show(o.res.compatibleSparklineDialog.errorMessage, o.res.title, 2, 0),
                                !1;
                        if (l = c.range,
                                n) {
                            if (3 === r)
                                if (1 === n.colCount && n.rowCount === l.rowCount)
                                    for (b = 0; b < l.rowCount; b++)
                                        s.setFormula(n.row + b, n.col, v.Hx(b));
                                else {
                                    if (1 !== n.rowCount || n.colCount !== l.colCount)
                                        return o.MessageBox.show(o.res.createSparklineDialog.warningText, o.res.title, 2, 0),
                                            !1;
                                    for (b = 0; b < l.colCount; b++)
                                        s.setFormula(n.row, n.col + b, v.Hx(b))
                                }
                            else if (void 0 !== o.MultiRangeFormulaType[o.FormulaSparklineType[r]])
                                v.DB(l, n);
                            else {
                                if (1 !== n.rowCount || 1 !== n.colCount)
                                    return o.MessageBox.show(o.res.createSparklineDialog.notSingleCell, o.res.title, 2, 0),
                                        !1;
                                s.setFormula(n.row, n.col, v.Hx())
                            }
                            s.setSelection(n.row, n.col, n.rowCount, n.colCount)
                        } else if (void 0 !== o.MultiRangeFormulaType[o.FormulaSparklineType[r]]) {
                            if (!(d = v._h.parameterSets))
                                return !1;
                            if ((p = v.getSelections()) && p.length > 0) {
                                if (!(u = v.BB()))
                                    return o.MessageBox.show(o.res.multiCellFormula.warningText, o.res.title, 2, 0),
                                        !1;
                                h = p.length,
                                    f = 1 === h && 1 === p[0].rowCount && 1 === p[0].colCount,
                                    v.execInSelections(s, function(e, t, i) {
                                        var o = v.CB(t, i, r, d, f);
                                        o && e.setFormula(t, i, o)
                                    })
                            }
                        } else {
                            if (g = t.activeRowIndex,
                                    m = t.activeColumnIndex,
                                3 === r && 1 !== l.rowCount && 1 !== l.colCount)
                                return o.MessageBox.show(o.res.createSparklineDialog.notSingleCell, o.res.title, 2, 0),
                                    !1;
                            a && s.setFormula(g, m, a)
                        }
                    }
                        ,
                        t.prototype.EB = function(e) {
                            var t, i, o = e.indexOf("="), n = e.indexOf("(");
                            if (-1 === n)
                                return null;
                            switch (n < o ? (i = 0,
                                t = e.substr(i, n + 1)) : (i = -1 === o ? 0 : 1,
                                t = e.substr(i, n - i)),
                                t = t.toLowerCase()) {
                                case "piesparkline":
                                    return 0;
                                case "areasparkline":
                                    return 1;
                                case "scattersparkline":
                                    return 2;
                                case "linesparkline":
                                case "columnsparkline":
                                case "winlosssparkline":
                                    return 3;
                                case "bulletsparkline":
                                    return 4;
                                case "spreadsparkline":
                                    return 5;
                                case "stackedsparkline":
                                    return 6;
                                case "hbarsparkline":
                                    return 7;
                                case "vbarsparkline":
                                    return 8;
                                case "variancesparkline":
                                    return 9;
                                case "boxplotsparkline":
                                    return 10;
                                case "cascadesparkline":
                                    return 11;
                                case "paretosparkline":
                                    return 12;
                                default:
                                    return null
                            }
                        }
                        ,
                        t.prototype.BB = function() {
                            var e, t, i = this, o = !1;
                            return i.execInSelections(i.wv, function(n, r, a) {
                                var s, l = n.getFormulaInformation(r, a);
                                if (l.hasFormula)
                                    if (o) {
                                        if (s = i.EB(l.formula),
                                            t !== s || e.isArrayFormula !== l.isArrayFormula)
                                            return !1
                                    } else
                                        e = l,
                                            t = i.EB(e.formula),
                                            o = !0
                            }),
                                o
                        }
                        ,
                        t.prototype.CB = function(e, t, i, n, r) {
                            var a, s, l, c, d, p = o.util.parseFormulaSparkline(e, t);
                            if (!p || !p.arguments)
                                return null;
                            if (!(a = p.arguments) || a.length <= 0)
                                return null;
                            switch (s = "",
                                i) {
                                case 11:
                                    s += "CASCADESPARKLINE",
                                    r || (n[1] = o.util.unParseFormula(a[1], e, t));
                                    break;
                                case 12:
                                    s += "PARETOSPARKLINE",
                                    r || (n[1] = o.util.unParseFormula(a[1], e, t))
                            }
                            for (l = "",
                                     c = 0; c < n.length; c++)
                                d = n[c],
                                    l += void 0 !== d && null !== d ? d + "," : ",";
                            return l = this.Ww(l),
                                s += "(" + l + ")"
                        }
                        ,
                        t.prototype.Ww = function(e) {
                            for (var t = e.length; t > 0 && "," === e[t - 1]; )
                                t--;
                            return e.substr(0, t)
                        }
                        ,
                        t.prototype.DB = function(e, t) {
                            var i, o, n, r = this, a = 0, s = 1, l = 0, c = "", d = e.rowCount * e.colCount;
                            if (t.rowCount < t.colCount ? (i = !0,
                                    l = t.col,
                                    a = Math.min(d, t.colCount)) : (i = !1,
                                    l = t.row,
                                    a = Math.min(d, t.rowCount)),
                                    i)
                                for (o = l; o < l + a; o++)
                                    c = this.FB(s, i),
                                        r.wv.setFormula(t.row, o, c),
                                        s++;
                            else
                                for (n = l; n < l + a; n++)
                                    c = this.FB(s, i),
                                        r.wv.setFormula(n, t.col, c),
                                        s++
                        }
                        ,
                        t.prototype.FB = function(e, t) {
                            var i, o = this._h.dataRange, n = this._h.type;
                            switch (n) {
                                case 11:
                                    i = t ? "=CASCADESPARKLINE(" + o + "," + e + ",,,,,,true)" : "=CASCADESPARKLINE(" + o + "," + e + ",,,,,,false)";
                                    break;
                                case 12:
                                    i = t ? "=PARETOSPARKLINE(" + o + "," + e + ",,,,,,true)" : "=PARETOSPARKLINE(" + o + "," + e + ",,,,,,false)"
                            }
                            return i
                        }
                        ,
                        t.prototype.Hx = function(e) {
                            var t, i, n, r, s, l, c, d = this._h.compatibleType, p = this._h.locationRange, u = this._h.dataRange, h = Ea(this.wv, u);
                            if (!h)
                                return null;
                            if (t = h.range,
                                    i = h.sheetName,
                                3 === (n = this._h.type))
                                switch (l = t && 1 === t.colCount ? 0 : 1,
                                t && (1 !== t.colCount && 1 !== t.rowCount && (l = 1 === p.colCount ? 1 : 0),
                                    s = 1 === p.rowCount && 1 !== p.colCount ? new a.Range(t.row,t.col + e,t.rowCount,1) : 1 !== p.rowCount && 1 === p.colCount ? new a.Range(t.row + e,t.col,1,t.colCount) : t),
                                    c = o.CEUtility.parseExternalRangeToString({
                                        range: s
                                    }),
                                i !== this.wv.name() && (c = i + "!" + c),
                                    d) {
                                    case "line":
                                        r = "=LINESPARKLINE(" + c + "," + l + ")";
                                        break;
                                    case "column":
                                        r = "=COLUMNSPARKLINE(" + c + "," + l + ")";
                                        break;
                                    case "winloss":
                                        r = "=WINLOSSSPARKLINE(" + c + "," + l + ")"
                                }
                            else
                                switch (n) {
                                    case 0:
                                        r = "=PIESPARKLINE(" + u + ")";
                                        break;
                                    case 1:
                                        r = "=AREASPARKLINE(" + u + ")";
                                        break;
                                    case 2:
                                        r = "=SCATTERSPARKLINE(" + u + ")";
                                        break;
                                    case 5:
                                        r = "=SPREADSPARKLINE(" + u + ")";
                                        break;
                                    case 6:
                                        r = "=STACKEDSPARKLINE(" + u + ")";
                                        break;
                                    case 10:
                                        r = "=BOXPLOTSPARKLINE(" + u + ")"
                                }
                            return r
                        }
                        ,
                        t
                }(q),
                    ho = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new uo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Va(e, t) {
                    var i = e.getSheetFromName(t.sheetName)
                        , o = i.getActiveRowIndex()
                        , n = i.getActiveColumnIndex();
                    Zn(e, "setFormulaSparkline", ho, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName,
                        activeRowIndex: o,
                        activeColumnIndex: n
                    })
                }
                e.setFormulaSparkline = Va,
                    fo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, s, l, c, d, p, u, h, f, g = this;
                            if (g._h = t.value,
                                    n = [],
                                    r = g._h.dataRange,
                                    l = g.wv.name(),
                                "string" == typeof r) {
                                if (!(c = Ea(g.wv, r)))
                                    return !1;
                                r = c.range,
                                    s = c.sheetName
                            }
                            if (d = g._h.locationRange,
                                    p = g._h.sparklineType,
                                    u = g._h.setting,
                                1 === d.colCount && d.rowCount === r.rowCount)
                                for (h = 0; h < r.rowCount; h++)
                                    f = g.wv.setSparkline(d.row + h, d.col, new a.Range(r.row + h,r.col,1,r.colCount), 1, p, new a.Sparklines.SparklineSetting(u)),
                                    s && s !== l && f.dataSheetName(s),
                                        n.push(f);
                            else {
                                if (1 !== d.rowCount || d.colCount !== r.colCount)
                                    return o.MessageBox.show(o.res.createSparklineDialog.warningText, o.res.title, 2, 0),
                                        !1;
                                for (h = 0; h < r.colCount; h++)
                                    f = g.wv.setSparkline(d.row, d.col + h, new a.Range(r.row,r.col + h,r.rowCount,1), 0, p, new a.Sparklines.SparklineSetting(u)),
                                    s && s !== l && f.dataSheetName(s),
                                        n.push(f)
                            }
                            g.wv.groupSparkline(n),
                                g.wv.setSelection(d.row, d.col, d.rowCount, d.colCount)
                        }
                            ,
                            t
                    }(q),
                    go = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new fo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Pa(e, t) {
                    Zn(e, "setDefaultSparkline", go, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setDefaultSparkline = Pa,
                    mo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.rv = t.sparklineType,
                                o.execInSelectionsForCell(o.wv, function(e, t, i) {
                                    var n = e.getSparkline(t, i);
                                    n && n.sparklineType(o.rv)
                                })
                        }
                            ,
                            t
                    }(q),
                    bo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new mo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function za(e, t) {
                    Zn(e, "setSparklineType", bo, {
                        sparklineType: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setSparklineType = za,
                    vo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForCell(o.wv, function(e, i, o) {
                                var n, r = e.getSparkline(i, o);
                                r && (n = r.setting(),
                                    n.options[t.property] = t.value,
                                    r.setting(n))
                            })
                        }
                            ,
                            t
                    }(q),
                    yo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new vo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ja(e, t) {
                    var i = t.options.length > 0 ? t.options[0] : void 0
                        , o = t.options.length > 1 ? t.options[1] : void 0;
                    Zn(e, "setSparklineSetting", yo, {
                        value: i,
                        property: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setSparklineSetting = ja,
                    xo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this, r = [];
                            n.execInSelectionsForCell(n.wv, function(e, t, i) {
                                (o = e.getSparkline(t, i)) && r.push(o)
                            }),
                            r.length > 1 && n.wv.groupSparkline(r)
                        }
                            ,
                            t
                    }(q),
                    wo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new xo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ma(e, t) {
                    Zn(e, "groupSparkline", wo, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.groupSparkline = Ma,
                    Co = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this, n;
                            o.execInSelectionsForCell(o.wv, function(e, t, i) {
                                (n = e.getSparkline(t, i)) && e.ungroupSparkline(n.group())
                            })
                        }
                            ,
                            t
                    }(q),
                    So = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Co(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Oa(e, t) {
                    Zn(e, "unGroupSparkline", So, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.unGroupSparkline = Oa,
                    ko = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForCell(o.wv, function(e, t, i) {
                                e.removeSparkline(t, i)
                            })
                        }
                            ,
                            t
                    }(q),
                    To = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ko(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ga(e, t) {
                    Zn(e, "clearSparkline", To, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearSparkline = Ga,
                    Ao = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this;
                            o.execInSelectionsForCell(o.wv, function(e, t, i) {
                                var n, r = e.getSparkline(t, i), a = r ? r.group() : null;
                                if (null !== a && a.count() > 1)
                                    for (n = a.all(r); n.length > 0; )
                                        o.wv.removeSparkline(n[n.length - 1].row, n[n.length - 1].column)
                            })
                        }
                            ,
                            t
                    }(q),
                    Io = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ao(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ha(e, t) {
                    Zn(e, "clearSparklineGroup", Io, {
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearSparklineGroup = Ha,
                    Do = function(e) {
                        o.extends(t, e);
                        function t() {
                            e.apply(this, arguments)
                        }
                        return t.prototype.getNewTableName = function() {
                            var e, t, i, o, n, r = 0;
                            for (e = 0; e < this.spread().sheets.length; e++)
                                for (t = this.spread().sheets[e].tables.all(),
                                         i = 0; i < t.length; i++)
                                    (o = t[i].name()) && o.length > 5 && "table" === o.substring(0, 5).toLowerCase() && (n = o.substring(5, o.length),
                                    $.isNumeric(n) && +n >= r && (r = +n));
                            return "Table" + (r + 1)
                        }
                            ,
                            t.prototype.clearMergeInRange = function(e) {
                                var t, i, o = this.wv, n = -1 === e.col ? 0 : e.col, r = -1 === e.row ? 0 : e.row;
                                for (t = 0; t < e.rowCount; t++)
                                    for (i = 0; i < e.colCount; i++)
                                        o.removeSpan(r + t, n + i)
                            }
                            ,
                            t
                    }(q),
                    $o = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this;
                            r.GB = t.range,
                                o = -1 === r.GB.row ? 0 : r.GB.row,
                                n = -1 === r.GB.col ? 0 : r.GB.col,
                                r.clearMergeInRange(r.GB),
                                r.wv.tables.add(r.getNewTableName(), o, n, r.GB.rowCount, r.GB.colCount)
                        }
                            ,
                            t
                    }(Do),
                    Fo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new $o(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ua(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex());
                    Zn(e, "createDefaultTable", Fo, {
                        range: t.options,
                        activeTable: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.createDefaultTable = Ua,
                    Lo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, s, l, c = this;
                            c.zv = t.tableStyle,
                            (o = c.getSelections()[0]) && (n = -1 === o.row ? 0 : o.row,
                                r = -1 === o.col ? 0 : o.col,
                                s = null,
                            t.tableName && (s = c.wv.tables.findByName(t.tableName)),
                                s instanceof a.Tables.Table ? s.style(c.zv) : (c.clearMergeInRange(o),
                                    l = c.wv.tables.add(c.getNewTableName(), n, r, o.rowCount, o.colCount, c.zv),
                                    t.tableName ? l.name(t.tableName) : t.tableName = l.name()))
                        }
                            ,
                            t
                    }(Do),
                    Ro = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Lo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Wa(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex())
                        , n = o ? o.name() : null;
                    Zn(e, "formatAsTable", Ro, {
                        tableStyle: t.options,
                        tableName: n,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.formatAsTable = Wa,
                    Bo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.showHeader(n._h)
                        }
                            ,
                            t
                    }(q),
                    No = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Bo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function _a(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableHeaderRow", No, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableHeaderRow = _a,
                    Eo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.showFooter(n._h)
                        }
                            ,
                            t
                    }(q),
                    Vo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Eo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function qa(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableTotalRow", Vo, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableTotalRow = qa,
                    Po = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.bandRows(n._h)
                        }
                            ,
                            t
                    }(q),
                    zo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Po(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ka(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableBandedRows", zo, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableBandedRows = Ka,
                    jo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.highlightFirstColumn(n._h)
                        }
                            ,
                            t
                    }(q),
                    Mo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new jo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ya(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableFirstColumn", Mo, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableFirstColumn = Ya,
                    Oo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.highlightLastColumn(n._h)
                        }
                            ,
                            t
                    }(q),
                    Go = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Oo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Xa(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableLastColumn", Go, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableLastColumn = Xa,
                    Ho = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.bandColumns(n._h)
                        }
                            ,
                            t
                    }(q),
                    Uo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ho(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Ja(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableBandedColumns", Uo, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableBandedColumns = Ja,
                    Wo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.filterButtonVisible(n._h)
                        }
                            ,
                            t
                    }(q),
                    _o = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Wo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Qa(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableFilterButton", _o, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableFilterButton = Qa,
                    qo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this;
                            n._h = t.value,
                            (o = n.wv.tables.findByName(t.tableName))instanceof a.Tables.Table && o.name(n._h)
                        }
                            ,
                            t
                    }(q),
                    Ko = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new qo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function Za(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "setTableName", Ko, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTableName = Za,
                    Yo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this;
                            r._h = t.value,
                                o = r.wv,
                            (n = o.tables.findByName(t.tableName))instanceof a.Tables.Table && o.tables.resize(n, r._h)
                        }
                            ,
                            t
                    }(q),
                    Xo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Yo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function es(e, t) {
                    var i = t.sheet
                        , o = i.tables.find(i.getActiveRowIndex(), i.getActiveColumnIndex()).name();
                    Zn(e, "resizeTable", Xo, {
                        value: t.options,
                        tableName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.resizeTable = es,
                    Jo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a = this, s = t.value.isRemove, l = a.wv.conditionalFormats;
                            if (s) {
                                for (o = t.value.rule,
                                         n = l.count() - 1; n >= 0; n--)
                                    if (r = l.getRule(n),
                                        r.ruleType() === o.ruleType() && JSON.stringify(r.ranges()) === JSON.stringify(o.ranges())) {
                                        l.removeRule(r);
                                        break
                                    }
                            } else
                                o = t.value;
                            l.addRule(o)
                        }
                            ,
                            t
                    }(q),
                    Qo = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Jo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ts(e, t) {
                    Zn(e, "addRule", Qo, {
                        value: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.addRule = ts,
                    Zo = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this;
                            if (r._h = t.isFromEntireSheet,
                                    o = r.getSelections(),
                                    r._h)
                                r.wv.conditionalFormats.clearRule();
                            else
                                for (n = 0; n < o.length; n++)
                                    r.wv.conditionalFormats.removeRuleByRange(o[n].row, o[n].col, o[n].rowCount, o[n].colCount)
                        }
                            ,
                            t
                    }(q),
                    en = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Zo(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function is(e, t) {
                    Zn(e, "clearRule", en, {
                        isFromEntireSheet: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.clearRule = is;
                function os(e, t) {
                    var i = e.getActiveSheet()
                        , o = i.comments.get(i.getActiveRowIndex(), i.getActiveColumnIndex());
                    o && e.commandManager().execute({
                        cmd: "changeComment",
                        sheetName: i.name(),
                        comment: o,
                        oldValue: t.options.oldValue,
                        newValue: t.options.newValue,
                        propertyName: t.options.propertyName
                    })
                }
                e.setCommentProperty = os;
                function ns(e) {
                    e.commandManager().execute({
                        cmd: "cutFloatingObjects",
                        sheetName: e.getActiveSheet().name()
                    })
                }
                e.floatingObjectCut = ns;
                function rs(e) {
                    e.commandManager().execute({
                        cmd: "copyFloatingObjects",
                        sheetName: e.getActiveSheet().name()
                    })
                }
                e.floatingObjectCopy = rs,
                    tn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = t.value.slicerStyle, a = t.slicersName;
                            if (!a || 0 === a.length)
                                return !1;
                            for (o in a)
                                n = this.sheet().slicers.get(a[o]),
                                    n.style(r)
                        }
                            ,
                            t
                    }(q),
                    on = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new tn(e,t);
                            o.execute(e, t, i)
                        }
                    };
                function as(e, t) {
                    var i, n = t.sheet, r = o.util.getSelectedSlicers(n) || [], a = [];
                    for (i = 0; i < r.length; i++)
                        a.push(r[i].name());
                    Zn(e, "setSlicerStyle", on, {
                        value: t.options,
                        slicersName: a,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setSlicerStyle = as,
                    nn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = t.value, a = t.slicersName;
                            if (!a || 0 === a.length)
                                return !1;
                            for (o in a)
                                n = this.sheet().slicers.get(a[o]),
                                    n.sortState(r)
                        }
                            ,
                            t
                    }(q),
                    rn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new nn(e,t);
                            o.execute(e, t, i)
                        }
                    };
                function ss(e, t) {
                    var i, n = t.sheet, r = o.util.getSelectedSlicers(n) || [], a = [];
                    for (i = 0; i < r.length; i++)
                        a.push(r[i].name());
                    Zn(e, "sortSlicerItems", rn, {
                        value: t.options,
                        slicersName: a,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.sortSlicerItems = ss,
                    an = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a, s, l, c = t.value, d = t.type, p = this.sheet(), u = this.getSelections();
                            switch (d) {
                                case "sheet":
                                    p.tag(c);
                                    break;
                                case "cell":
                                    u.forEach(function(e) {
                                        for (r = -1 !== e.row ? e.row : 0,
                                                 a = -1 !== e.col ? e.col : 0,
                                                 s = r + e.rowCount,
                                                 l = a + e.colCount,
                                                 o = r; o < s; o++)
                                            for (n = a; n < l; n++)
                                                p.setTag(o, n, c)
                                    });
                                    break;
                                case "row":
                                    u.forEach(function(e) {
                                        for (s = e.row + e.rowCount,
                                                 o = e.row; o < s; o++)
                                            p.setTag(o, -1, c)
                                    });
                                    break;
                                case "column":
                                    u.forEach(function(e) {
                                        for (l = e.col + e.colCount,
                                                 n = e.col; n < l; n++)
                                            p.setTag(-1, n, c)
                                    })
                            }
                        }
                            ,
                            t
                    }(q),
                    sn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new an(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ls(e, t) {
                    var i = t.options.length > 0 ? t.options[0] : void 0
                        , o = t.options.length > 1 ? t.options[1] : void 0;
                    Zn(e, "setTag", sn, {
                        value: i,
                        type: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setTag = ls,
                    ln = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a, s, l, c, d, p = [], u = t.slicersName;
                            if (!u || 0 === u.length)
                                return !1;
                            for (o in u)
                                n = this.sheet().slicers.get(u[o]),
                                    p.push(n);
                            for (r = t.property,
                                     a = t.value,
                                     c = a instanceof Array,
                                     d = 0; d < p.length; d++)
                                s = p[d],
                                    l = c ? a[d] : a,
                                s[r] && void 0 !== l && null !== l && s[r](l)
                        }
                            ,
                            t
                    }(q),
                    cn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new ln(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function cs(e, t) {
                    var i, o = t.options.length > 0 ? t.options[0] : void 0, n = t.options.length > 1 ? t.options[1] : void 0, r = t.options.length > 2 ? t.options[2] : [], a = [];
                    for (i = 0; i < r.length; i++)
                        a.push(r[i].name());
                    Zn(e, "slicerPropertyChanged", cn, {
                        property: o,
                        value: n,
                        slicersName: a,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.slicerPropertyChanged = cs,
                    o.loader.ready(function() {
                        if (!o.wrapper.spread.notWorking) {
                            var e = o.wrapper.spread;
                            Kn(e.commandManager())
                        }
                    }),
                    dn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this.getSelections(), a = t.byRows, s = t.sortInfos, l = this.sheet();
                            for (o = 0; o < r.length; o++)
                                n = r[o],
                                    l.sortRange(n.row, n.col, n.rowCount, n.colCount, a, s)
                        }
                            ,
                            t
                    }(q),
                    pn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new dn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ds(e, t) {
                    Zn(e, "sortCustomRange", pn, {
                        byRows: t.options.byRows,
                        sortInfos: t.options.sortInfos,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.sortCustomRange = ds,
                    un = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.undoImp = function(e, t, i) {
                            return e.suspendPaint(),
                                GC.Spread.Sheets.Commands.undoTransaction(e, t),
                            this.isSendEvent() && qn(t.chart),
                                e.resumePaint(),
                                !0
                        }
                            ,
                            t.prototype.isSendEvent = function(e, t, i) {
                                return !0
                            }
                            ,
                            t
                    }(q),
                    hn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a, l, p, u, h, f, g, m, b, v, y, x;
                            try {
                                if (n = this,
                                        r = n.sheet(),
                                        a = t.dataFormula,
                                        l = t.category,
                                        p = s.ChartType[t.chartType],
                                        u = c(r, a),
                                        h = u.row,
                                        f = u.col + u.colCount,
                                        g = n.HB(r, h, f),
                                        m = "",
                                        x = t.dataOrientation,
                                    l === d.chartTypeDict[0].chartGroup)
                                    for (b = r.charts.add(m, s.ChartType.columnClustered, g.x, g.y, 480, 300),
                                             y = b.series(),
                                             v = 0; v < t.series.length; v++)
                                        y.add(t.series[v]);
                                else
                                    b = l === d.chartTypeDict[52].chartGroup || p === s.ChartType.pie ? r.charts.add(m, p, g.x, g.y, 480, 300, a) : r.charts.add(m, p, g.x, g.y, 480, 300, a, x);
                                b.series().get(8) && b.legend({
                                    visible: !1
                                }),
                                    d.resetChartsFocus(r),
                                    b.isSelected(!0)
                            } catch (e) {
                                return o.MessageBox.show(o.res.selectChartDialog.errorPrompt.unexpectedErrorMsg, o.res.title, 2),
                                    !1
                            }
                        }
                            ,
                            t.prototype.isSendEvent = function(e, t, i) {
                                return !1
                            }
                            ,
                            t.prototype.HB = function(e, t, i) {
                                var o, n, r = 20, a = 20;
                                for (o = 0; o < i; o++)
                                    r += e.getColumnWidth(o);
                                for (n = 0; n < t; n++)
                                    a += e.getRowHeight(n);
                                return {
                                    x: r,
                                    y: a
                                }
                            }
                            ,
                            t
                    }(un),
                    fn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new hn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ps(e, t) {
                    Zn(e, "insertChart", fn, {
                        selections: t.selections,
                        sheetName: t.sheetName,
                        category: t.options.category,
                        chartType: t.options.chartType,
                        dataOrientation: t.options.dataOrientation,
                        series: t.options.series,
                        dataFormula: t.options.dataFormula
                    })
                }
                e.insertChart = ps,
                    gn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a, s, l, c, d, p, u, h = e, f = h.commandManager(), g = this.sheet();
                            if (g.name() !== t.targetSheetName) {
                                if ("newSheet" === (n = t.type)) {
                                    for (a = h.sheets,
                                             s = 0,
                                             l = a.length; s < l; s++)
                                        if (t.targetSheetName === a[s].name())
                                            return o.MessageBox.show(o.res.moveChartDialog.errorPrompt.sameSheetNameError, o.res.title, 2),
                                                !1;
                                    r = new GC.Spread.Sheets.Worksheet(t.targetSheetName),
                                        h.addSheet(0, r)
                                }
                                c = f.getCommand("cutFloatingObjects"),
                                    d = f.getCommand("deleteFloatingObjects"),
                                    p = d.canUndo,
                                    d.canUndo = function() {
                                        return !1
                                    }
                                    ,
                                    c.execute(h, {
                                        sheetName: g.name()
                                    }),
                                    d.canUndo = p,
                                    u = f.getCommand("pasteFloatingObjects"),
                                    p = u.canUndo,
                                    u.canUndo = function() {
                                        return !1
                                    }
                                    ,
                                    u.execute(h, {
                                        sheetName: t.targetSheetName
                                    }),
                                    u.canUndo = p,
                                    o.wrapper.spread.undoManager().clear()
                            }
                        }
                            ,
                            t
                    }(un),
                    mn = {
                        canUndo: !1,
                        execute: function(e, t, i) {
                            var o = new gn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function us(e, t) {
                    var i = e.getActiveSheet()
                        , o = p(i);
                    Zn(e, "moveChart", mn, {
                        chart: o,
                        selections: t.selections,
                        sheetName: t.sheetName,
                        targetSheetName: t.options.targetSheetName,
                        type: t.options.type
                    })
                }
                e.moveChart = us,
                    bn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a, l = this.sheet(), c = l.charts.get(t.chartName), p = t.isSwitchDataOrientation, u = t.category, h = s.ChartType[t.chartType];
                            try {
                                if (u !== d.chartTypeDict[0].chartGroup)
                                    c.chartType(h),
                                    p && c.switchDataOrientation();
                                else if (t.series && t.series.length > 0) {
                                    for (n = c.series(),
                                             a = n.get().length,
                                             r = 0; r < a; r++)
                                        n.remove(0);
                                    for (a = t.series.length,
                                             r = 0; r < a; r++)
                                        n.add(t.series[r])
                                }
                                c.colorAndStyle && c.colorAndStyle.color && d.applyChartSeriesTheme(c, c.colorAndStyle.color)
                            } catch (e) {
                                return o.MessageBox.show(o.res.selectData.errorPrompt.unexpectedErrorMsg, o.res.title, 2),
                                    !1
                            }
                            d.resetChartsFocus(l),
                                c.isSelected(!0),
                                qn(c)
                        }
                            ,
                            t
                    }(un),
                    vn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new bn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function hs(e, t) {
                    Zn(e, "changeChartType", vn, {
                        selections: t.selections,
                        sheetName: t.sheetName,
                        chartType: t.options.chartType,
                        isSwitchDataOrientation: t.options.isSwitchDataOrientation,
                        series: t.options.series,
                        dataFormula: t.options.dataFormula,
                        category: t.options.category,
                        chartName: t.options.chart.name()
                    })
                }
                e.changeChartType = hs,
                    yn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a, s, l, c, p;
                            try {
                                o = this.sheet(),
                                    n = o.charts.get(t.chartName),
                                    r = t.chartStyle;
                                for (l in r)
                                    if (r.hasOwnProperty(l))
                                        if ("series" === l)
                                            for (c = 0; c < r[l].length; c++)
                                                p = r[l][c],
                                                    n.series().set(c, p);
                                        else
                                            "chartArea" === l ? a = r[l] : "colorAndStyle" === l ? s = r[l] : n[l](r[l]);
                                a && n.chartArea(a),
                                s && d.applyChartSeriesTheme(n, s.color),
                                    qn(n)
                            } catch (e) {}
                        }
                            ,
                            t
                    }(un),
                    xn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new yn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function fs(e, t) {
                    var i = e.getActiveSheet()
                        , o = p(i).name();
                    Zn(e, "setChartStyle", xn, {
                        chartName: o,
                        selections: t.selections,
                        sheetName: t.sheetName,
                        chartStyle: t.options.chartStyle
                    })
                }
                e.setChartStyle = fs,
                    wn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r = this.sheet(), a = r.charts.get(t.chartName), s = t.layouts;
                            for (o in s)
                                s.hasOwnProperty(o) && (n = s[o],
                                    a[o](n));
                            qn(a)
                        }
                            ,
                            t
                    }(un),
                    Cn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new wn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function gs(e, t) {
                    var i = e.getActiveSheet()
                        , o = p(i).name();
                    Zn(e, "setChartLayout", Cn, {
                        chartName: o,
                        layouts: t.options.layouts,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.setChartLayout = gs,
                    Sn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this.sheet()
                                , n = o.charts.get(t.chartName);
                            n && n.series().set(t.series.index, t.series.value),
                                qn(n)
                        }
                            ,
                            t
                    }(un),
                    kn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Sn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function ms(e, t) {
                    Zn(e, "updateChartSeries", kn, {
                        selections: t.selections,
                        sheetName: t.sheetName,
                        chartName: t.options.chart.name(),
                        series: t.options.element
                    })
                }
                e.updateChartSeries = ms,
                    Tn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var n, r, a = this.sheet(), s = a.charts.get(t.chartName);
                            if (s) {
                                if (d.getChartGroupString(s.chartType()) === d.chartTypeDict[50].chartGroup)
                                    return o.MessageBox.show(o.res.selectData.errorPrompt.cantSwitchRowColumn, o.res.title, 2),
                                        !1;
                                try {
                                    return n = s.switchDataOrientation(),
                                        n ? (r = s.colorAndStyle && s.colorAndStyle.color,
                                        r && d.applyChartSeriesTheme(s, r),
                                            qn(s),
                                            !0) : (o.MessageBox.show(o.res.selectData.errorPrompt.cantSwitchRowColumn, o.res.title, 2),
                                            !1)
                                } catch (e) {
                                    return o.MessageBox.show(o.res.selectData.errorPrompt.cantSwitchRowColumn, o.res.title, 2),
                                        !1
                                }
                            }
                        }
                            ,
                            t
                    }(un),
                    An = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Tn(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function bs(e, t) {
                    var i = e.getActiveSheet()
                        , o = p(i).name();
                    Zn(e, "switchChartRowCol", An, {
                        chartName: o,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.switchChartRowCol = bs,
                    In = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n, r, a = t.seriesArray, s = this.sheet(), l = s.charts.get(t.chartName), c = l.series().get().length;
                            if (0 < c)
                                for (o = c; o > 0; o--)
                                    l.series().remove(o - 1);
                            for (n = 0; n < a.length; n++)
                                r = a[n],
                                    l.series().add(r);
                            qn(l)
                        }
                            ,
                            t
                    }(un),
                    Dn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new In(e,t);
                            return o.execute(e, t, i)
                        }
                    };
                function vs(e, t) {
                    Zn(e, "updateChartAllSeries", Dn, {
                        selections: t.selections,
                        sheetName: t.sheetName,
                        seriesArray: t.options.seriesArray,
                        chartName: t.options.chart.name()
                    })
                }
                e.updateChartAllSeries = vs,
                    $n = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o = this.sheet()
                                , n = o.charts.get(t.chartName);
                            n && (n.colorAndStyle || (n.colorAndStyle = {}),
                                n.colorAndStyle.color = {
                                    group: t.group,
                                    index: t.index
                                },
                                d.applyChartSeriesTheme(n, t),
                            t.ignoreEvent || qn(n))
                        }
                            ,
                            t
                    }(un),
                    Fn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new $n(e,t);
                            o.execute(e, t, i)
                        }
                    };
                function ys(e, t) {
                    var i = e.getActiveSheet()
                        , o = p(i).name();
                    Zn(e, "changeChartSeriesColor", Fn, {
                        sheetName: t.sheetName,
                        selections: t.selections,
                        group: t.options.group,
                        index: t.options.index,
                        type: t.options.type,
                        ignoreEvent: t.options.ignoreEvent,
                        chartName: o
                    })
                }
                e.changeChartSeriesColor = ys;
                function xs(e, t) {
                    var i = t.sheetName
                        , o = e.commandManager()
                        , n = t.options;
                    o.execute({
                        cmd: "resizeFloatingObjects",
                        sheetName: i,
                        floatingObjects: n.name,
                        offsetX: n.x,
                        offsetY: n.y,
                        offsetWidth: n.width,
                        offsetHeight: n.height
                    })
                }
                e.updateChartSize = xs,
                    Ln = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this.sheet(), r = n.charts.get(t.chartName), a = t.elementObj;
                            if (r)
                                for (o in a)
                                    a.hasOwnProperty(o) && r[o](a[o]);
                            qn(r)
                        }
                            ,
                            t
                    }(un),
                    Rn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Ln(e,t);
                            o.execute(e, t, i)
                        }
                    };
                function ws(e, t) {
                    var i = e.getActiveSheet()
                        , o = p(i).name();
                    Zn(e, "changeChartElement", Rn, {
                        chartName: o,
                        elementObj: t.options,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.changeChartElement = ws,
                    Bn = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            var o, n = this.sheet(), r = n.charts.get(t.chartName), a = t.elementObj;
                            if (r)
                                for (o in a)
                                    a.hasOwnProperty(o) && r[o](a[o])
                        }
                            ,
                            t
                    }(un),
                    Nn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new Bn(e,t);
                            o.execute(e, t, i)
                        }
                    };
                function Cs(e, t) {
                    Zn(e, "changeChartFormatProperty", Nn, {
                        chartName: t.options.chart.name(),
                        elementObj: t.options.element,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.changeChartFormatProperty = Cs,
                    En = function(e) {
                        o.extends(t, e);
                        function t(t, i) {
                            e.call(this, t, i)
                        }
                        return t.prototype.executeImp = function(e, t, i) {
                            if (t.execute)
                                return t.execute.call(this, e, t, i)
                        }
                            ,
                            t
                    }(q),
                    Vn = {
                        canUndo: !0,
                        execute: function(e, t, i) {
                            var o = new En(e,t);
                            o.execute(e, t, i)
                        }
                    };
                function Ss(e, t) {
                    Zn(e, "baseDialogCommand", Vn, {
                        execute: t.options.execute,
                        value: t.options.value,
                        selections: t.selections,
                        sheetName: t.sheetName
                    })
                }
                e.baseDialogCommand = Ss,
                    e.dialogAction = {},
                    Pn = function(e, t, i) {
                        var n, r, a, s = t.value.arg, l = t.value.scope, c = t.value.name, d = t.value.commentValue, p = t.value.nameValue, u = t.value.referToValue, h = t.value.sheetIndex, f = t.value.inWorkbook, g = t.value.activeRowIndex, m = t.value.activeColumnIndex;
                        if ("edit" === s)
                            if ("Workbook" === l)
                                o.wrapper.spread.removeCustomName(c);
                            else {
                                for (r = 0; r < o.wrapper.spread.sheets.length; r++)
                                    if (o.wrapper.spread.sheets[r].name() === l) {
                                        n = r;
                                        break
                                    }
                                o.wrapper.spread.sheets[n].removeCustomName(c)
                            }
                        a = ("" + d).replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;"),
                            f ? o.wrapper.spread.addCustomName(p, u, g, m, a) : o.wrapper.spread.sheets[h].addCustomName(p, u, g, m, a)
                    }
                    ,
                    e.dialogAction.newNameDialoagApplySetting = Pn,
                    zn = function(e, t, i) {
                        var o = t.value.txt
                            , n = t.value.activeRowIndex
                            , r = t.value.activeColumnIndex
                            , a = this.sheet();
                        a.setFormula(n, r, o)
                    }
                    ,
                    e.dialogAction.insertFunctionDiaplogApplySetting = zn,
                    jn = function(e, t, i) {
                        var o, n, r = t.value.rowSheet, a = t.value.colSheet, s = this.sheet(), l = function(e, t, i, o, n) {
                            var r, a, l, c, d, p, u, h, f = e.getStyle(t, i, o);
                            s.setStyle(t, i, f, n),
                                r = e.getValue(t, i, o),
                                a = s.getValue(t, i, n),
                            r !== a && s.setValue(t, i, r, n),
                                l = e.getColumnWidth(i, o),
                            void 0 !== l && l >= 0 && s.setColumnWidth(i, l, n),
                                c = e.getRowHeight(t, o),
                            void 0 !== c && c >= 0 && s.setRowHeight(t, c, n),
                                d = e.getColumnVisible(i, o),
                                s.setColumnVisible(i, d, n),
                                p = e.getRowVisible(t, o),
                                s.setRowVisible(t, p, n),
                                u = e.getColumnResizable(i, o),
                                s.setColumnResizable(i, u, n),
                                h = e.getRowResizable(t, o),
                                s.setRowResizable(t, h, n)
                        }, c = function(e, t, i) {
                            var n = s.getSpans(void 0, i);
                            for (o = 0; o < n.length; o++)
                                s.removeSpan(n[o].row, n[o].col, i);
                            if (n = e.getSpans(void 0, t),
                                0 !== n.length)
                                for (o = 0; o < n.length; o++)
                                    s.addSpan(n[o].row, n[o].col, n[o].rowCount, n[o].colCount, i)
                        }, d = function(e, t) {
                            var i = e.getColumnCount(3)
                                , o = t.getColumnCount(3)
                                , n = e.getRowCount(3)
                                , r = t.getRowCount(3);
                            s.setColumnCount(i, 2),
                                s.setRowCount(n, 2),
                                s.setColumnCount(o, 1),
                                s.setRowCount(r, 1)
                        };
                        for (d(r, a),
                                 o = 0; o < r.getRowCount(); o++)
                            for (n = 0; n < r.getColumnCount(); n++)
                                l(r, o, n, 3, 2);
                        for (o = 0; o < a.getRowCount(); o++)
                            for (n = 0; n < a.getColumnCount(); n++)
                                l(a, o, n, 3, 1);
                        for (n = 0; n < r.getColumnCount(); n++)
                            l(r, -1, n, 3, 2);
                        for (n = 0; n < a.getColumnCount(); n++)
                            l(a, -1, n, 3, 1);
                        for (o = 0; o < r.getRowCount(); o++)
                            l(r, o, -1, 3, 2);
                        for (o = 0; o < a.getRowCount(); o++)
                            l(a, o, -1, 3, 1);
                        l(r, -1, -1, 3, 2),
                            l(a, -1, -1, 3, 1),
                            c(r, 3, 2),
                            c(a, 3, 1)
                    }
                    ,
                    e.dialogAction.headerCellsApplySetting = jn,
                    Mn = function(e, t, i) {
                        var o, n, r = t.value.formats, a = t.value.tempFormats;
                        for (r.clearRule(),
                                 o = 0; o < a.count(); o++)
                            n = a.getRule(o),
                            n.condition && delete n.condition,
                            void 0 !== n.style.locked && delete n.style.locked,
                                r.addRule(n)
                    }
                    ,
                    e.dialogAction.managerRulesApplySetting = Mn,
                    On = function(e, t, i) {
                        var n = t.value.styleName
                            , r = this.spread()
                            , a = n.toLowerCase();
                        r.getNamedStyle(n) || (o.CellStyleDialog.buildInCellStyle.hasOwnProperty(a) ? this.spread().addNamedStyle(o.CellStyleDialog.buildInCellStyle[a]) : o.CellStyleDialog.existedCustomCellStyle.hasOwnProperty(a) && this.spread().addNamedStyle(o.CellStyleDialog.existedCustomCellStyle[a])),
                            this.execInSelections(this.sheet(), function(e, t, i) {
                                e.setStyleName(t, i, n)
                            })
                    }
                    ,
                    e.dialogAction.addAndSetStyleByName = On,
                    Gn = function(e, t, i) {
                        var r, a, s, l = t.value.styleInfo, c = t.value.fontInfo, d = t.value.borderInfo, p = t.value.mergeInfo;
                        if (l.watermark || (l.labelOptions = n),
                                l.font = n,
                            l.foreColor || (l.foreColor = n),
                            l.borderTop && (l.borderTop = n),
                            l.borderLeft && (l.borderLeft = n),
                            l.borderBottom && (l.borderBottom = n),
                            l.borderRight && (l.borderRight = n),
                            l.diagonalUp && (l.diagonalUp = n),
                            l.diagonalDown && (l.diagonalDown = n),
                                Zn(e, "setStyle", _i, {
                                    value: l,
                                    selections: t.selections,
                                    sheetName: t.sheetName
                                }),
                            void 0 !== c.fontFamily && Zn(e, "setFontFamily", be, {
                                value: c.fontFamily,
                                selections: t.selections,
                                sheetName: t.sheetName
                            }),
                            void 0 !== c.fontSize && Zn(e, "setFontSize", ye, {
                                value: c.fontSize + "pt",
                                selections: t.selections,
                                sheetName: t.sheetName
                            }),
                            void 0 !== c.fontStyle && Zn(e, "setFontStyle", Ie, {
                                value: c.fontStyle,
                                selections: t.selections,
                                sheetName: t.sheetName
                            }),
                            void 0 !== c.fontWeight && Zn(e, "setFontWeight", we, {
                                value: c.fontWeight,
                                selections: t.selections,
                                sheetName: t.sheetName
                            }),
                            void 0 !== d && Zn(e, "setAllBorder", We, {
                                orignalBorder: d.orignalBorder,
                                borderType: d.borderType,
                                selections: t.selections,
                                sheetName: t.sheetName
                            }),
                            p.merged && p.merged !== o.BaseMetaObject.indeterminateValue) {
                            for (r = t.selections,
                                     a = 0; a < r.length; a++)
                                for (s = a + 1; s < r.length; s++)
                                    if (r[a].intersect(r[s].row, r[s].col, r[s].rowCount, r[s].colCount))
                                        return;
                            Zn(e, "mergeCells", ot, {
                                selections: t.selections,
                                sheetName: t.sheetName
                            })
                        }
                    }
                    ,
                    e.dialogAction.formatDialogApplySetting = Gn,
                    Hn = function(e, t) {
                        var i, o, n = 1, r = t;
                        for (i = 0; i < e.sheets.length; i++)
                            for (o = e.sheets[i]; o.slicers.get(r); )
                                r = t + "_" + n,
                                    n++;
                        return r
                    }
                    ,
                    Un = function(e, t, i) {
                        var o, n, r, a, s = t.value.tableName, l = t.value.columnsChecked, c = this.sheet(), d = c.tables.findByName(s), p = 100, u = 200;
                        for (n = 0; n < l.length; n++)
                            r = d.getColumnName(l[n]),
                                a = Hn(e, r),
                                o = c.slicers.add(a, d.name(), r),
                                o.position(new GC.Spread.Sheets.Point(p,u)),
                                p += 30,
                                u += 30;
                        o && o.isSelected(!0)
                    }
                    ,
                    e.dialogAction.insertSlicerForDialog = Un,
                    Wn = function(e, t, i) {
                        var o, n, r, a = t.value.slicerSettings, s = t.value.selectedSlicers, l = s.length;
                        if (s && 0 !== l)
                            for (o = 0; o < l; o++)
                                n = s[o],
                                    r = a[0],
                                1 === l && n.name(r),
                                    n.showHeader(a[1]),
                                    n.captionName(a[2]),
                                    "ascending" === a[3] ? n.sortState(1) : n.sortState(2),
                                    n.showNoDataItems(!a[4]),
                                    n.visuallyNoDataItems(a[5]),
                                    n.showNoDataItemsInLast(a[6])
                    }
                    ,
                    e.dialogAction.SlicerSettingForDialog = Wn,
                    _n = function(e, t, i) {
                        var n, r, a, s, l, c = t.value.selectedSlicers, d = t.value.formatOption, p = d.horizontal, u = d.vertical, h = d.columnCount, f = d.itemHeight, g = d.slicerHeight, m = d.slicerWidth, b = d.disableResizingAndMoving, v = d.locked, y = d.noMoveSize, x = d.moveNoSize, w = d.moveSize;
                        for (r in c)
                            n = c[r],
                            r && ($.isNumeric(d.horizontal) && $.isNumeric(d.vertical) && (a = parseInt(p),
                                s = parseInt(u),
                                l = new GC.Spread.Sheets.Point(a,s),
                                n.position(l)),
                            $.isNumeric(h) && (h = parseInt(h)) > 0 && n.columnCount(h),
                            $.isNumeric(f) && (f = o.util.formatNumber(f),
                                n.itemHeight(f)),
                            $.isNumeric(g) && (g = o.util.formatNumber(g),
                                n.height(g)),
                            $.isNumeric(m) && (m = o.util.formatNumber(m),
                                n.width(m)),
                                b ? n.disableResizingAndMoving(!0) : n.disableResizingAndMoving(!1),
                                v ? n.isLocked(!0) : n.isLocked(!1),
                            y && (n.dynamicMove(!1),
                                n.dynamicSize(!1)),
                            x && (n.dynamicMove(!0),
                                n.dynamicSize(!1)),
                            w && (n.dynamicMove(!0),
                                n.dynamicSize(!0)))
                    }
                    ,
                    e.dialogAction.FormatSlicerForDialog = _n,
                    o.spreadActions = e
            }(o.spreadActions || {})
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e, t, o, n;
                i.spreadMeta = {
                    style: {
                        properties: {
                            formatter: {
                                type: i.PrimitiveTypes.STRING
                            },
                            backColor: {
                                type: i.PrimitiveTypes.STRING
                            },
                            foreColor: {
                                type: i.PrimitiveTypes.STRING
                            },
                            font: {
                                type: i.PrimitiveTypes.STRING
                            },
                            hAlign: {
                                type: i.PrimitiveTypes.NUMBER,
                                defaultValue: 3
                            },
                            vAlign: {
                                type: i.PrimitiveTypes.NUMBER,
                                defaultValue: 1
                            },
                            textIndent: {
                                type: i.PrimitiveTypes.NUMBER,
                                defaultValue: 0
                            },
                            wordWrap: {
                                type: i.PrimitiveTypes.BOOLEAN,
                                defaultValue: !1
                            },
                            shrinkToFit: {
                                type: i.PrimitiveTypes.BOOLEAN,
                                defaultValue: !1
                            },
                            isVerticalText: {
                                type: i.PrimitiveTypes.BOOLEAN,
                                defaultValue: !1
                            },
                            locked: {
                                type: i.PrimitiveTypes.BOOLEAN,
                                defaultValue: !0
                            },
                            borderTop: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            borderLeft: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            borderRight: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            borderBottom: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            borderVertical: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            borderHorizontal: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            diagonalUp: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            diagonalDown: {
                                type: i.PrimitiveTypes.OBJECT
                            },
                            textDecoration: {
                                type: i.PrimitiveTypes.NUMBER,
                                defaultValue: !0
                            },
                            watermark: {
                                type: i.PrimitiveTypes.STRING
                            },
                            cellPadding: {
                                type: i.PrimitiveTypes.STRING
                            },
                            labelOptions: {
                                type: i.PrimitiveTypes.OBJECT
                            }
                        }
                    }
                },
                    e = GC.Spread.Sheets,
                    t = function(t) {
                        i.extends(o, t);
                        function o(e) {
                            t.call(this, e, i.spreadMeta.style, i.spreadMeta),
                                this.vo = {}
                        }
                        return o.prototype.uo = function(e) {
                            var t = this
                                , o = this.oo.properties[e];
                            return ko.computed({
                                read: function() {
                                    var o = t.vo[e];
                                    return void 0 === o ? (this.vo[e] = t.Ql(e),
                                        this.vo[e]) : o === i.BaseMetaObject.undefinedValue ? void 0 : o
                                },
                                write: function(n) {
                                    var r = n;
                                    void 0 === r ? r = i.BaseMetaObject.undefinedValue : typeof r !== o.type && (r = i.BaseMetaObject.so(r, o.type)),
                                        t.vo[e] = r
                                },
                                owner: this
                            })
                        }
                            ,
                            o.prototype.result = function() {
                                var t = this
                                    , o = new e.Style;
                                return Object.getOwnPropertyNames(this.vo).forEach(function(e) {
                                    var n = t.vo[e];
                                    void 0 !== n && n !== i.BaseMetaObject.indeterminateValue && (n === i.BaseMetaObject.undefinedValue && (n = void 0),
                                        o[e] = n)
                                }),
                                    o
                            }
                            ,
                            o.prototype.Ql = function(e) {}
                            ,
                            o
                    }(i.BaseMetaObject),
                    i.StyleShadowObjectBase = t,
                    o = function(e) {
                        i.extends(t, e);
                        function t(t) {
                            e.call(this, t),
                                this.ws = t,
                                this.to()
                        }
                        return t.prototype.Ql = function(e) {
                            if (void 0 !== this.ws && null !== this.ws)
                                return this.ws[e]
                        }
                            ,
                            t
                    }(t),
                    i.StyleShadowObject = o,
                    n = function(e) {
                        i.extends(t, e);
                        function t(t, i) {
                            e.call(this, t),
                                this.wv = t.getActiveSheet(),
                            void 0 === i && (i = this.wv.getSelections()),
                                this.Gs = i,
                                this.to()
                        }
                        return t.prototype.Ql = function(e) {
                            var t, o, n, r, a, s = i.BaseMetaObject.undefinedValue;
                            for (t = 0; t < this.Gs.length; t++)
                                for (o = this.Gs[t],
                                     -1 === o.col && (o.col = 0),
                                     -1 === o.row && (o.row = 0),
                                         n = 0; n < o.rowCount; n++)
                                    for (r = 0; r < o.colCount; r++)
                                        if (a = this.IB(o.row + n, o.col + r, e),
                                            s === i.BaseMetaObject.undefinedValue)
                                            s = a;
                                        else if (JSON.stringify(s) !== JSON.stringify(a))
                                            return i.BaseMetaObject.indeterminateValue;
                            return s
                        }
                            ,
                            t.prototype.IB = function(e, t, o) {
                                var n, r, a;
                                function s(i) {
                                    var n, r;
                                    "locked" === o && (n = i.conditionalFormats,
                                        r = n.getRules(e, t),
                                        r.forEach(function(e) {
                                            void 0 !== e.style.locked && delete e.style.locked
                                        }))
                                }
                                if (s(this.wv),
                                    void 0 !== (n = this.wv.getActualStyle(e, t)) && null !== n && !("font" === o && n.font && (r = i.util.getFromCache("defaultFont", function() {
                                        return i.util.parseFont(i.res.defaultFont)
                                    }),
                                        a = i.util.parseFont(n.font),
                                    a.fontFamily === r.fontFamily && a.fontSize === r.fontSize && a.fontStyle === r.fontStyle && a.fontWeight === r.fontWeight) || "foreColor" === o && "Text 1" === n.foreColor))
                                    return n[o]
                            }
                            ,
                            t
                    }(t),
                    i.SpreadStyleShadowObject = n
            }()
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e = function() {
                    function e() {}
                    return e.getRangeType = function(e) {
                        return e ? -1 === e.col && -1 === e.row ? 3 : -1 === e.col ? 1 : -1 === e.row ? 0 : 2 : -1
                    }
                        ,
                        e
                }();
                i.SpreadUtility = e,
                    function(e) {
                        e[e.Column = 0] = "Column",
                            e[e.Row = 1] = "Row",
                            e[e.Cell = 2] = "Cell",
                            e[e.Sheet = 3] = "Sheet",
                            i.RangeType = e
                    }(i.RangeType || {})
            }()
        }
        , function(e, t, i) {
            var o = i(0).app
                , n = GC.Spread.Sheets
                , r = GC.Spread.Sheets.Designer;
            !function(e) {
                "use strict";
                e.spread;
                var t;
                e.spreadElement;
                function i() {
                    var t = e.spread.getActiveSheet().currentTheme().colors();
                    return [{
                        name: "Background 1",
                        baseColor: t.getColor("Background 1")
                    }, {
                        name: "Text 1",
                        baseColor: t.getColor("Text 1")
                    }, {
                        name: "Background 2",
                        baseColor: t.getColor("Background 2")
                    }, {
                        name: "Text 2",
                        baseColor: t.getColor("Text 2")
                    }, {
                        name: "Accent 1",
                        baseColor: t.getColor("Accent 1")
                    }, {
                        name: "Accent 2",
                        baseColor: t.getColor("Accent 2")
                    }, {
                        name: "Accent 3",
                        baseColor: t.getColor("Accent 3")
                    }, {
                        name: "Accent 4",
                        baseColor: t.getColor("Accent 4")
                    }, {
                        name: "Accent 5",
                        baseColor: t.getColor("Accent 5")
                    }, {
                        name: "Accent 6",
                        baseColor: t.getColor("Accent 6")
                    }]
                }
                e.getThemeColors = i,
                    e.shouldModifiedHandlerExecute = !0;
                function o(i) {
                    void 0 === i && (i = !1),
                    i || (e.spread.destroy(),
                        t.empty(),
                        e.spread = null);
                    try {
                        e.spread = new n.Workbook(t[0]),
                            e.spread.setSheetCount(2),
                            a(e.spread.getSheet(1)),
                            e.spreadElement = t,
                            r.formulaBar.initFormulaBar(i),
                            r.contextMenu.initContextMenu(),
                            e.spread.commandManager().addListener("z_commandExecuted.designer", r.ribbon.updateUndoRedo)
                    } catch (t) {
                        return void (e.spread.notWorking = !0)
                    }
                    e.shouldModifiedHandlerExecute = !0;
                    var o = function() {
                        r.actions.isFileModified = !0,
                        e.shouldModifiedHandlerExecute && (r.actions.updateWindowTitle(),
                            e.shouldModifiedHandlerExecute = !1)
                    };
                    e.spread.bind(n.Events.CellChanged, o),
                        e.spread.bind(n.Events.RowChanged, o),
                        e.spread.bind(n.Events.ColumnChanged, o),
                        e.spread.bind(n.Events.ActiveSheetChanged, o),
                        e.spread.bind(n.Events.InvalidOperation, function(e, t) {
                            5 === t.invalidType && r.MessageBox.show(t.message, r.res.title, 3)
                        }),
                        e.spread.bind(GC.Spread.Sheets.Events.RangeChanged, function(t, i) {
                            var o = e.spread.getActiveSheet()
                                , n = o.getActiveRowIndex()
                                , a = o.getActiveColumnIndex();
                            if (0 === i.action && r.ribbon.updateRibbonAll(),
                                2 === i.action) {
                                if (s(),
                                        o.tables.find(n, a))
                                    return $(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0),
                                        void $(".ribbon-bar").gcuitabs("select", "tableTab");
                                $(".ribbon-bar").gcuiribbon("setButtonDisabled", "insert-table", !1),
                                    $(".ribbon-bar").gcuiribbon("setTabPageVisible", "homeTab", !0),
                                    $(".ribbon-bar").gcuitabs("select", "homeTab")
                            }
                        }),
                        e.spread.bind(GC.Spread.Sheets.Events.FloatingObjectRemoved, function(t, i) {
                            var o, r, a;
                            i.floatingObject instanceof n.Slicers.Slicer && (s(),
                                o = e.spread.getActiveSheet(),
                                r = o.getActiveRowIndex(),
                                a = o.getActiveColumnIndex(),
                                o.tables.find(r, a) ? ($(".ribbon-bar").gcuiribbon("setTabPageVisible", "tableTab", !0),
                                    $(".ribbon-bar").gcuitabs("select", "tableTab")) : ($(".ribbon-bar").gcuiribbon("setTabPageVisible", "homeTab", !0),
                                    $(".ribbon-bar").gcuitabs("select", "homeTab")))
                        }),
                        l(),
                        r.ribbon.attachEvent(!i),
                        c(),
                        r.ribbon.resetSpreadNamedStyle()
                }
                function a(e) {
                    var t, i, o, n, r, a, s, l, c, d, p, u;
                    e.suspendPaint(),
                        t = "GrapeCity SpreadJS",
                        i = "This SpreadJS spreadsheet demo uses the online version of the SpreadJS Sheets Designer",
                        o = "to showcase several of the features that SpreadJS Sheets offers.",
                        n = "Explore the features and enter sample data directly into the cells to add formulas or charts,",
                        r = "similar to Microsoft Excel. You can also import and export Excel files using the File menu.",
                        a = "Excel imports/exports are handled client-side only and no data is sent to the server.",
                        s = "Note \u2013 the JavaScript source code of this Designer is available separately for purchase,",
                        l = "allowing you to quickly add and offer any of these menu features to your customers.",
                        c = "Contact us.to learn more:",
                        d = "us.sales@grapecity.com",
                        p = "Visit the SpreadJS page:",
                        u = "https://www.grapecity.com/en/spreadjs",
                        e.name("About"),
                        e.setColumnWidth(1, 350),
                        e.setRowHeight(1, 38),
                        e.getCell(1, 1).value(t).font("bold 26.667px Calibri"),
                        e.setRowHeight(3, 24),
                        e.setRowHeight(4, 24),
                        e.getCell(3, 1).value(i).font("18.67px Calibri"),
                        e.getCell(4, 1).value(o).font("18.67px Calibri"),
                        e.setRowHeight(5, 14),
                        e.setRowHeight(6, 24),
                        e.setRowHeight(7, 24),
                        e.setRowHeight(8, 24),
                        e.getCell(6, 1).value(n).font("18.67px Calibri"),
                        e.getCell(7, 1).value(r).font("18.67px Calibri"),
                        e.getCell(8, 1).value(a).font("18.67px Calibri"),
                        e.setRowHeight(9, 14),
                        e.setRowHeight(10, 24),
                        e.setRowHeight(11, 24),
                        e.getCell(10, 1).value(s).font("18.67px Calibri"),
                        e.getCell(11, 1).value(l).font("18.67px Calibri"),
                        e.setRowHeight(13, 24),
                        e.setRowHeight(14, 24),
                        e.setRowHeight(15, 24),
                        e.getCell(14, 1).value(c).font("18.67px Calibri"),
                        e.getCell(15, 1).value(d).font("18.67px Calibri").cellType(new GC.Spread.Sheets.CellTypes.HyperLink),
                        e.setRowHeight(16, 24),
                        e.setRowHeight(17, 24),
                        e.getCell(16, 1).value(p).font("18.67px Calibri"),
                        e.getCell(17, 1).value(u).font("18.67px Calibri").cellType(new GC.Spread.Sheets.CellTypes.HyperLink),
                        e.resumePaint()
                }
                e.reset = o;
                function s() {
                    var e = 6;
                    $(".ribbon-bar>ul").find("li:gt(" + e + ")").css("display", "none"),
                        $(".ribbon-bar>div:gt(" + e + ")").attr("aria-hidden", !0)
                }
                function l() {
                    $(".custom-format-table").css("display", "none"),
                        $(".custom-preview").find(".table-format-preview").css("display", "none"),
                        r.FormatTableDialog.customTableStyle = {},
                        r.FormatTableDialog.currentId = 1,
                        $(".custom-format-slicer").css("display", "none"),
                        $(".slicer-custom-preview").find(".slicer-format-preview").css("display", "none"),
                        r.SlicerStyleDialog.customSlicerStyle = {},
                        r.SlicerStyleDialog.currentId = 1
                }
                function c() {
                    e.spread.getActiveSheet() && e.spread.focus(!0)
                }
                e.setFocusToSpread = c,
                    r.loader.ready(function() {
                        t = $(".spreadWrapper .ss"),
                            o(!0)
                    }),
                    r.wrapper = e
            }(r.wrapper || {})
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function(e) {
                "use strict";
                function t() {
                    $(".statusBar").find(".statusbar-zoom-slider").slider({
                        max: 400,
                        min: 50
                    })
                }
                function o() {
                    $(".statusBar").find(".statusbar-zoom-value").click(function() {
                        var e = new i.ZoomDialog;
                        e.open()
                    }),
                        i.wrapper.spreadElement.bind("FileOpened", function(e, t) {
                            i.ribbon.updateZoomToStatusBar()
                        })
                }
                i.loader.ready(function() {
                    t(),
                    i.wrapper.spread.notWorking || o()
                }),
                    i.statusBar = e
            }(i.statusBar || {})
        }
        , function(e, t) {
            var i = "borderpicker"
                , o = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e = function(e) {
                    o.extends(t, e);
                    function t() {
                        e.apply(this, arguments)
                    }
                    return t.prototype._create = function() {
                        var e, t, i, o;
                        this.element.addClass("gcui-borderpicker"),
                            e = $("<div></div>"),
                            t = $("<label></label>"),
                            t.addClass("gcui-borderpicker-line-style-label").text(this.options.lineStyleTitle).appendTo(e),
                            this.element.append(e),
                            this.JB(this.element),
                            i = $("<div></div>"),
                            o = $("<label></label>"),
                            o.addClass("gcui-borderpicker-line-color-label").text(this.options.borderColorTitle).appendTo(i),
                            this.element.append(i),
                            this.tv(this.element),
                            this.as()
                    }
                        ,
                        t.prototype._setOption = function(e, t) {
                            if ("lineStyle" === e)
                                this.options.lineStyle = t,
                                    this.KB();
                            else if ("borderColor" === e)
                                this.options.borderColor = t,
                                    this.LB(),
                                    this.Yw();
                            else if ("lineStyleTitle" === e)
                                this.options.lineStyleTitle = t,
                                    this.element.find(".gcui-borderpicker-line-style-label").text(t);
                            else if ("borderColorTitle" === e)
                                this.options.lineStyleTitle = t,
                                    this.element.find(".gcui-borderpicker-line-color-label").text(t);
                            else {
                                if ("colorOptions" !== e)
                                    throw "This key doesn't exist.";
                                this.options.colorOptions = t,
                                    this.MB()
                            }
                        }
                        ,
                        t.prototype.as = function() {
                            var e = this;
                            this.element.find(".line-style").on("click.borderpicker", function(t) {
                                var i = t.target || t.srcElement
                                    , o = $(i).data("lineStyle")
                                    , n = GC.Spread.Sheets.LineStyle;
                                e.options.lineStyle = n[o],
                                    e.NB($(i)),
                                    e._trigger("lineStyleChanged", t, e.options.lineStyle)
                            })
                        }
                        ,
                        t.prototype.JB = function(e) {
                            var t = $("<div class='line-style-out-div'></div>")
                                , i = $("<div class='line-style-backcolor-div'></div>")
                                , n = $("<div class='line-style line-style-empty' data-line-style='empty'>None</div>")
                                , r = $("<div class='line-style line-style-dotted' data-line-style='dotted' ></div>")
                                , a = $("<div class='line-style line-style-dashed' data-line-style='dashed' ></div>")
                                , s = $("<div class='line-style line-style-dash-dot-dot' data-line-style='dashDotDot' ></div>")
                                , l = $("<div class='line-style line-style-dash-dot' data-line-style='dashDot' ></div>")
                                , c = $("<div class='line-style line-style-hair' data-line-style='hair' ></div>")
                                , d = $("<div class='line-style line-style-thin' data-line-style='thin' ></div>")
                                , p = $("<div class='line-style line-style-medium-dash-dot-dot' data-line-style='mediumDashDotDot' ></div>")
                                , u = $("<div class='line-style line-style-slanted-dash-dot' data-line-style='slantedDashDot' ></div>")
                                , h = $("<div class='line-style line-style-medium-dash-dot' data-line-style='mediumDashDot' ></div>")
                                , f = $("<div class='line-style line-style-medium-dashed' data-line-style='mediumDashed' ></div>")
                                , g = $("<div class='line-style line-style-medium' data-line-style='medium' ></div>")
                                , m = $("<div class='line-style line-style-thick' data-line-style='thick' ></div>")
                                , b = $("<div class='line-style line-style-double' data-line-style='double' ></div>");
                            n.text(o.res.borderPicker.none),
                                i.append(n).append(r).append(a).append(s).append(l).append(c).append(d).append(p).append(u).append(h).append(f).append(g).append(m).append(b),
                                t.append(i),
                                e.append(t)
                        }
                        ,
                        t.prototype.tv = function(e) {
                            var t, i = this, o = $("<div></div>").addClass("gcui-borderpicker-color"), n = $("<span></span>").appendTo(o);
                            $("<span></span>").addClass("gcui-borderpicker-color-preview").appendTo(n),
                                t = $("<div></div>").addClass("gcui-borderpicker-color-popup").appendTo(o),
                                this.C = $("<div></div>").addClass("gcui-borderpicker-color-picker").colorpicker({
                                    valueChanged: function(e, t) {
                                        void 0 === t.color ? (i.options.borderColor = void 0,
                                            i.OB(e, void 0)) : (i.options.borderColor = t,
                                            i.OB(e, t))
                                    },
                                    choosedColor: function(e, t) {
                                        o.comboframe("close")
                                    },
                                    openColorDialog: function(e, t) {
                                        o.comboframe("close")
                                    }
                                }).appendTo(t),
                                o.comboframe().click(function() {
                                    o.comboframe("open")
                                }),
                                this.C.colorpicker("option", this.options.colorOptions),
                                e.append(o)
                        }
                        ,
                        t.prototype.MB = function() {
                            this.element.find(".gcui-borderpicker-color").remove(),
                                this.tv(this.element)
                        }
                        ,
                        t.prototype.OB = function(e, t) {
                            this.Mv(),
                                this.LB(),
                                this.C.colorpicker("option", "selectedItem", this.options.borderColor),
                                this._trigger("colorChanged", e, t)
                        }
                        ,
                        t.prototype.Mv = function() {
                            this.options.borderColor ? this.element.find(".gcui-borderpicker-color-preview").css("background-color", this.options.borderColor.color) : this.element.find(".gcui-borderpicker-color-preview").css("background-color", "black")
                        }
                        ,
                        t.prototype.Yw = function() {
                            this.Mv(),
                                this.C.colorpicker("option", "selectedItem", this.options.borderColor)
                        }
                        ,
                        t.prototype.LB = function() {
                            this.options.borderColor ? this.element.find(".line-style-backcolor-div").css("background-color", this.options.borderColor.color) : this.element.find(".line-style-backcolor-div").css("background-color", "black")
                        }
                        ,
                        t.prototype.KB = function() {
                            var e = this;
                            this.element.find(".line-style").each(function() {
                                var t, i = $(this).data("lineStyle");
                                switch (e.options.lineStyle) {
                                    case 0:
                                        t = "empty";
                                        break;
                                    case 1:
                                        t = "thin";
                                        break;
                                    case 2:
                                        t = "medium";
                                        break;
                                    case 3:
                                        t = "dashed";
                                        break;
                                    case 4:
                                        t = "dotted";
                                        break;
                                    case 5:
                                        t = "thick";
                                        break;
                                    case 6:
                                        t = "double";
                                        break;
                                    case 7:
                                        t = "hair";
                                        break;
                                    case 8:
                                        t = "mediumDashed";
                                        break;
                                    case 9:
                                        t = "dashDot";
                                        break;
                                    case 10:
                                        t = "mediumDashDot";
                                        break;
                                    case 11:
                                        t = "dashDotDot";
                                        break;
                                    case 12:
                                        t = "mediumDashDotDot"
                                }
                                i === t && e.NB($(this))
                            })
                        }
                        ,
                        t.prototype.PB = function() {
                            this.element.find(".line-style").removeClass("line-style-selected")
                        }
                        ,
                        t.prototype.NB = function(e) {
                            this.PB(),
                                e.addClass("line-style-selected")
                        }
                        ,
                        t.DefaultOptions = {
                            lineStyle: 1,
                            borderColor: {
                                name: "Text 1",
                                baseColor: "#000000",
                                tint: 0,
                                color: "rgb(0,0,0)"
                            },
                            lineStyleTitle: o.res.borderPicker.lineStyleTitle,
                            borderColorTitle: o.res.borderPicker.borderColorTitle,
                            colorOptions: {
                                showNoFill: !1
                            }
                        },
                        t
                }(o.gcui.gcuiWidget);
                o.BorderPicker = e,
                    e.prototype.options = $.extend(!0, {}, o.gcui.gcuiWidget.prototype.options, e.DefaultOptions),
                    $.gcui.registerWidget(i, e.prototype)
            }()
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer
                , o = "colorpicker";
            !function() {
                "use strict";
                var e = function() {
                    function e() {}
                    return e.QB = function(e) {
                        var t = this.RB(e, !1);
                        return t.luminosity / 240
                    }
                        ,
                        e.SB = function(e, t, i) {
                            var o, n, r, a, s;
                            return 0 === i ? o = n = r = parseInt("" + 255 * t / 240, 10) : (s = t <= 120 ? (t * (240 + i) + 120) / 240 : t + i - (t * i + 120) / 240,
                                a = 2 * t - s,
                                o = parseInt("" + (255 * this.TB(a, s, e + 80) + 120) / 240, 10),
                                n = parseInt("" + (255 * this.TB(a, s, e) + 120) / 240, 10),
                                r = parseInt("" + (255 * this.TB(a, s, e - 80) + 120) / 240, 10)),
                                {
                                    a: 255,
                                    r: o,
                                    g: n,
                                    b: r
                                }
                        }
                        ,
                        e.RB = function(e, t) {
                            var i, o, n, r, a, s, l, c, d, p, u, h, f;
                            return t ? (r = e.r,
                                a = e.g,
                                s = e.b) : (r = parseInt(e.substring(1, 3), 16),
                                a = parseInt(e.substring(3, 5), 16),
                                s = parseInt(e.substring(5, 7), 16)),
                                l = Math.max(Math.max(r, a), s),
                                c = Math.min(Math.min(r, a), s),
                                d = l + c,
                                i = parseInt("" + (240 * d + 255) / 510, 10),
                                p = l - c,
                                0 === p ? (o = 0,
                                    n = 160) : (o = i <= 120 ? parseInt("" + (240 * p + d / 2) / d, 10) : parseInt("" + (240 * p + (510 - d) / 2) / (510 - d), 10),
                                    u = (40 * (l - r) + p / 2) / p,
                                    h = (40 * (l - a) + p / 2) / p,
                                    f = (40 * (l - s) + p / 2) / p,
                                    n = r === l ? parseInt("" + (f - h), 10) : a === l ? parseInt("" + (80 + u - f), 10) : parseInt("" + (160 + h - u), 10),
                                n < 0 && (n += 240),
                                n > 240 && (n -= 240)),
                                {
                                    luminosity: i,
                                    saturation: o,
                                    hue: n
                                }
                        }
                        ,
                        e.TB = function(e, t, i) {
                            return i < 0 && (i += 240),
                            i > 240 && (i -= 240),
                                i < 40 ? e + ((t - e) * i + 20) / 40 : i < 120 ? t : i < 160 ? e + ((t - e) * (160 - i) + 20) / 40 : e
                        }
                        ,
                        e
                }()
                    , t = function() {
                    function t() {
                        this.value = ""
                    }
                    return t.prototype.open = function() {
                        this.innerDialog.dialog("open"),
                            "" === this.value ? (this.innerDialog.find(".colordialog-div-currentcolor").css("background", "rgb(0,0,0)"),
                                this.innerDialog.find(".colordialog-div-newcolor").css("background", "rgb(0,0,0)")) : void 0 === this.value ? (this.innerDialog.find(".colordialog-div-currentcolor").css("background", "rgb(255,255,255)"),
                                this.innerDialog.find(".colordialog-div-newcolor").css("background", "rgb(255,255,255)")) : (this.innerDialog.find(".colordialog-div-currentcolor").css("background", this.value),
                                this.innerDialog.find(".colordialog-div-newcolor").css("background", this.value))
                    }
                        ,
                        t.prototype._create = function() {
                            var e, t = this;
                            this.hls = {
                                luminosity: 128,
                                saturation: 0,
                                hue: 0
                            },
                                this.isDragingLum = !1,
                                this.isDragingHueSat = !1,
                                this.innerDialog = $("<div title='Color' class='colordialog-div-container'></div>"),
                                this.innerDialog.dialog({
                                    title: i.res.colorPicker.colorDialogTitle,
                                    autoOpen: !1,
                                    resizable: !1,
                                    width: 280,
                                    modal: !0,
                                    buttons: [{
                                        text: i.res.ok,
                                        click: function(e) {
                                            $(this).dialog("close"),
                                                t.value = "rgb(" + t.innerDialog.find(".colordialog-input-red").val() + "," + t.innerDialog.find(".colordialog-input-green").val() + "," + t.innerDialog.find(".colordialog-input-blue").val() + ")",
                                                t.yq(e, !0)
                                        }
                                    }, {
                                        text: i.res.cancel,
                                        click: function(e) {
                                            $(this).dialog("close"),
                                                t.yq(e, !1)
                                        }
                                    }],
                                    beforeClose: function(e, i) {
                                        e.currentTarget && t.yq(e, !1)
                                    }
                                }).append($("<table><tbody><tr><td><div class='colordialog-div-pickercolor-image'><span class='colordialog-span-pickercolor-mousepointer'></span></div></td><td><div class='colordialog-div-dragcolor-container'><div class='colordialog-div-dragcolor'></div><span class='colordialog-span-dragcolor-arrow'></span></div></td></tr><tr><td><table><tbody><tr><td class='red-input-label'>Red:</td><td><input class='colordialog-rgb colordialog-input-red'></input></td></tr><tr><td class='green-input-label'>Green:</td><td><input class='colordialog-rgb colordialog-input-green'></input></td></tr><tr><td class='blue-input-label'>Blue:</td><td><input class='colordialog-rgb colordialog-input-blue'></input></td></tr></tbody></table></td><td><table class='colordialog-table-newcurrentcolor'><tbody><tr><td class='new-label'>New</td></tr><tr><td><div class='colordialog-div-newcolor'></div></td></tr><tr><td><div class='colordialog-div-currentcolor'></div></td></tr><tr><td class='current-label'>Current</td></tr></tbody></table></td></tr></tbody></table>")),
                                this.innerDialog.find(".colordialog-table-newcurrentcolor").attr("cellSpacing", "0px").attr("cellPadding", "0px"),
                                this.innerDialog.find(".red-input-label").text(i.res.colorPicker.red),
                                this.innerDialog.find(".green-input-label").text(i.res.colorPicker.green),
                                this.innerDialog.find(".blue-input-label").text(i.res.colorPicker.blue),
                                this.innerDialog.find(".new-label").text(i.res.colorPicker.newLabel),
                                this.innerDialog.find(".current-label").text(i.res.colorPicker.currentLabel),
                                this.innerDialog.find(".colordialog-rgb").spinner({
                                    max: 255,
                                    min: 0,
                                    change: function() {
                                        t.UB()
                                    },
                                    spin: function() {
                                        t.UB()
                                    }
                                }),
                            "" !== this.value && this.innerDialog.find(".colordialog-div-currentcolor").css("background", this.value),
                                "" === this.value ? (e = this.innerDialog.find(".colordialog-div-dragcolor"),
                                    e.css("background-image", "linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),
                                    e.css("background-image", "-o-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),
                                    e.css("background-image", "-moz-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),
                                    e.css("background-image", "-webkit-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),
                                    e.css("background-image", "-ms-linear-gradient(to bottom, rgb(255,  255, 255), rgb(0, 0, 0))"),
                                    e.css("background-image", "-webkit-gradient(linear, left top, left bottom, color-stop(0, rgb(255,  255, 255)),  color-stop(1, rgb(0, 0, 0)))"),
                                    this.innerDialog.find(".colordialog-input-red").spinner().spinner("value", 0),
                                    this.innerDialog.find(".colordialog-input-green").spinner().spinner("value", 0),
                                    this.innerDialog.find(".colordialog-input-blue").spinner().spinner("value", 0)) : this.gA(!0, this.value),
                                this.VB()
                        }
                        ,
                        t.prototype.UB = function() {
                            var t, i, o, n, r, a, s = this;
                            s.isDragingLum || ("" === s.innerDialog.find(".colordialog-input-red").val() && s.innerDialog.find(".colordialog-input-red").spinner().spinner("value", 0),
                            "" === s.innerDialog.find(".colordialog-input-green").val() && s.innerDialog.find(".colordialog-input-green").spinner().spinner("value", 0),
                            "" === s.innerDialog.find(".colordialog-input-blue").val() && s.innerDialog.find(".colordialog-input-blue").spinner().spinner("value", 0),
                                t = parseInt(s.innerDialog.find(".colordialog-input-red").val()),
                                i = parseInt(s.innerDialog.find(".colordialog-input-green").val()),
                                o = parseInt(s.innerDialog.find(".colordialog-input-blue").val()),
                            "" + t == "NaN" && (t = 0),
                            "" + i == "NaN" && (i = 0),
                            "" + o == "NaN" && (o = 0),
                                n = "rgb(" + t + "," + i + "," + o + ")",
                                s.gA(!0, n),
                                r = {
                                    a: 255,
                                    r: t,
                                    g: i,
                                    b: o
                                },
                                a = e.RB(r, !0),
                                s.hls.hue = Math.floor(a.hue / 240 * 255),
                                s.hls.luminosity = Math.floor(a.luminosity / 240 * 255),
                                s.hls.saturation = Math.floor(a.saturation / 240 * 255),
                            s.isDragingLum || s.isDragingHueSat || s.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display", "block").css("top", 160 - s.hls.luminosity / 255 * 160 + 4),
                                s.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display", "block").css("left", s.hls.hue / 255 * 190 - 5).css("top", 160 - s.hls.saturation / 255 * 160 - 5))
                        }
                        ,
                        t.prototype.VB = function() {
                            var e, t, i, o = this;
                            this.innerDialog.find(".colordialog-div-pickercolor-image").mousedown(function(e) {
                                var t, i, n, r, a, s, l;
                                o.isDragingHueSat = !0,
                                    t = e.target || e.srcElement,
                                    i = t,
                                    -1 !== i.className.indexOf("colordialog-span-pickercolor-mousepointer") ? (a = i,
                                        n = e.offsetX + parseInt(a.style.left),
                                        r = e.offsetY + parseInt(a.style.top)) : (n = e.offsetX,
                                        r = e.offsetY),
                                    s = 190,
                                    l = 160,
                                    o.hls.saturation = (l - r) / l * 255,
                                    o.hls.hue = n / s * 255,
                                    o.gA(!1, void 0),
                                    o.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display", "block").css("left", n - 5).css("top", r - 5)
                            }),
                                $(document).mouseup(function(e) {
                                    o.isDragingHueSat = !1,
                                        o.isDragingLum = !1
                                }),
                                this.innerDialog.find(".colordialog-div-pickercolor-image").mousemove(function(e) {
                                    var t, i, n, r, a, s, l;
                                    o.isDragingHueSat && (t = e.target || e.srcElement,
                                        i = t,
                                        -1 !== i.className.indexOf("colordialog-span-pickercolor-mousepointer") ? (a = i,
                                            n = e.offsetX + parseInt(a.style.left),
                                            r = e.offsetY + parseInt(a.style.top)) : (n = e.offsetX,
                                            r = e.offsetY),
                                        s = 190,
                                        l = 160,
                                        o.hls.saturation = (l - r) / l * 255,
                                        o.hls.hue = n / s * 255,
                                        o.gA(!1, void 0),
                                        o.innerDialog.find(".colordialog-span-pickercolor-mousepointer").css("display", "block").css("left", n - 5).css("top", r - 5))
                                }),
                                i = function(i) {
                                    var n, r;
                                    o.isDragingLum && (n = i.clientY - t + e,
                                    n > 160 && (n = 160),
                                    n < 0 && (n = 0),
                                        o.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display", "block").css("top", n + 4),
                                        r = 160,
                                        o.hls.luminosity = (160 - n) / r * 255,
                                        o.gA(!1, void 0))
                                }
                                ,
                                this.innerDialog.find(".colordialog-div-dragcolor-container").mousedown(function(n) {
                                    var r, a, s, l, c;
                                    o.isDragingLum = !0,
                                        r = n.target || n.srcElement,
                                        a = r,
                                        -1 !== a.className.indexOf("colordialog-span-dragcolor-arrow") ? (l = a,
                                            s = n.offsetY + parseInt(l.style.top) - 8) : s = n.offsetY,
                                    s > 160 && (s = 160),
                                    s < 0 && (s = 0),
                                        o.innerDialog.find(".colordialog-span-dragcolor-arrow").css("display", "block").css("top", s + 4),
                                        c = 160,
                                        o.hls.luminosity = (160 - s) / c * 255,
                                        o.gA(!1, void 0),
                                        e = s,
                                        t = n.clientY,
                                        $(document).on("mousemove", i)
                                })
                        }
                        ,
                        t.prototype.yq = function(e, t) {
                            $(this).trigger("dialogClose", t)
                        }
                        ,
                        t.prototype.gA = function(t, i) {
                            var o, n, r, a, s, l, c, d, p, u, h, f;
                            i ? (r = i.split(","),
                                a = r[0].split("("),
                                s = r[2].split(")"),
                                l = a[1],
                                c = r[1],
                                d = s[0],
                                o = {
                                    a: 255,
                                    r: parseInt(l),
                                    g: parseInt(c),
                                    b: parseInt(d)
                                },
                            t && (p = e.RB(o, !0),
                                n = e.SB(Math.floor(p.hue / 255 * 240), Math.floor(128 / 255 * 240), Math.floor(p.saturation / 255 * 240)))) : (o = 0 === this.hls.luminosity ? {
                                a: 255,
                                r: 0,
                                g: 0,
                                b: 0
                            } : 255 === this.hls.luminosity ? {
                                a: 255,
                                r: 255,
                                g: 255,
                                b: 255
                            } : e.SB(Math.floor(this.hls.hue / 255 * 240), Math.floor(this.hls.luminosity / 255 * 240), Math.floor(this.hls.saturation / 255 * 240)),
                            (t || 0 === this.hls.luminosity || 255 === this.hls.luminosity) && (n = e.SB(Math.floor(this.hls.hue / 255 * 240), Math.floor(128 / 255 * 240), Math.floor(this.hls.saturation / 255 * 240)))),
                                o.r = parseInt("" + o.r, 10),
                                o.g = parseInt("" + o.g, 10),
                                o.b = parseInt("" + o.b, 10),
                                this.innerDialog.find(".colordialog-input-red").spinner().spinner("value", "" + o.r),
                                this.innerDialog.find(".colordialog-input-green").spinner().spinner("value", "" + o.g),
                                this.innerDialog.find(".colordialog-input-blue").spinner().spinner("value", "" + o.b),
                                u = "rgb(" + o.r + ", " + o.g + ", " + o.b + ")",
                                this.innerDialog.find(".colordialog-div-newcolor").css("background", u),
                            (t || 0 === this.hls.luminosity || 255 === this.hls.luminosity) && n && (n.r = parseInt("" + n.r, 10),
                                n.g = parseInt("" + n.g, 10),
                                n.b = parseInt("" + n.b, 10),
                                h = "rgb(" + n.r + ", " + n.g + ", " + n.b + ")",
                                f = this.innerDialog.find(".colordialog-div-dragcolor"),
                                f.css("background-image", "linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"),
                                f.css("background-image", "-o-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"),
                                f.css("background-image", "-moz-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"),
                                f.css("background-image", "-webkit-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"),
                                f.css("background-image", "-ms-linear-gradient(to bottom, rgb(255,  255, 255)," + h + ", rgb(0, 0, 0))"),
                                f.css("background-image", "-webkit-gradient(linear, left top, left bottom, color-stop(0, rgb(255,  255, 255)), color-stop(0.5, " + h + "), color-stop(1, rgb(0, 0, 0)))"))
                        }
                        ,
                        t.prototype.destroy = function() {
                            this.innerDialog && (this.innerDialog.dialog("destroy"),
                                this.innerDialog.remove())
                        }
                        ,
                        t
                }()
                    , n = function(o) {
                    i.extends(n, o);
                    function n() {
                        o.apply(this, arguments)
                    }
                    return n.prototype._create = function() {
                        var e, i, o, n, r, a, s, l, c, d = this.options;
                        this.colorItems = [],
                            e = $("<div class='colorpicker-outDiv'></div>"),
                            i = this.WB(),
                            o = this.XB(),
                        d.showThemeColorTitle || (r = i.find("tr").get(0),
                            $(r).css("display", "none")),
                        d.showStandardColorTitle || (a = o.find("tr").get(0),
                            $(a).css("display", "none"),
                            n = $("<span class='colorpicker-horizontalseparator'></span>"),
                            $(n).css("margin", "5px"),
                            i.append(n),
                            $(i).find(".colorpicker-colorcell").css("margin", "1px")),
                        d.showOutline || e.css("border", "0px"),
                            e.append(i, o),
                        d.showNoFill && (s = this.YB(),
                            e.append(s)),
                        d.showMoreColors && (n = $("<span class='colorpicker-horizontalseparator'></span>"),
                            l = this.ZB(),
                            e.append(n, l)),
                            e.appendTo(this.element),
                            e.bind("selectstart", function() {
                                return !1
                            }),
                            this.as(),
                        null !== this.dialog && void 0 !== this.dialog || (this.dialog = new t,
                            this.dialog._create(),
                            c = this,
                            $(this.dialog).on("dialogClose", function(e, t) {
                                if (t) {
                                    var i;
                                    i = {
                                        color: c.dialog.value,
                                        isSetColorDirectly: !0
                                    },
                                        c.$B(),
                                        c._B(c.dialog.value),
                                        c.options.value = c.dialog.value,
                                        c.options.selectedItem = {
                                            name: "",
                                            baseColor: "",
                                            tint: 0,
                                            color: c.dialog.value
                                        },
                                        c.fo(e, i)
                                }
                            }))
                    }
                        ,
                        n.prototype.WB = function() {
                            var e, t, i, o, n, r = this.aC(this.options.themeColors), a = $("<div></div>"), s = $("<table class='colorpicker-colortable' cellspacing= 0 cellpadding= 0></table>"), l = $("<tbody></tbody>"), c = $("<tr></tr>"), d = $("<td></td>");
                            for (d.attr("colspan", "10"),
                                     d.append($("<div class='colorpicker-title colorpicker-div-themecolor-title'></div>").text(this.options.themeColorsTitle)),
                                     c.append(d),
                                     l.append(c),
                                     e = 0; e < 6; e++) {
                                for (t = $("<tr></tr>"),
                                         this.colorItems[e] = [],
                                     0 === e && t.addClass("colorpicker-themecolors-firstline"),
                                         i = 0; i < 10; i++)
                                    o = $("<td></td>"),
                                        n = $("<div></div>"),
                                        n.addClass("colorpicker-colorcell"),
                                        0 === e ? (n.css("background", this.options.themeColors[i].baseColor),
                                            n.attr("row", "0"),
                                            n.attr("col", "" + i),
                                            this.colorItems[e][i] = {
                                                name: this.options.themeColors[i].name,
                                                baseColor: this.options.themeColors[i].baseColor,
                                                tint: 0,
                                                color: this.options.themeColors[i].baseColor
                                            }) : (n.css("background", r[5 * i + e - 1].color),
                                            n.attr("row", "" + e),
                                            n.attr("col", "" + i),
                                            this.colorItems[e][i] = {
                                                name: this.options.themeColors[i].name + " " + r[5 * i + e - 1].tint,
                                                baseColor: this.options.themeColors[i].baseColor,
                                                tint: r[5 * i + e - 1].tint,
                                                color: r[5 * i + e - 1].color
                                            }),
                                        n.append($("<div class='colorpicker-div-inner-colorcell'></div>")),
                                        o.append(n),
                                        t.append(o);
                                l.append(t)
                            }
                            return s.append(l),
                                a.append(s),
                                a
                        }
                        ,
                        n.prototype.XB = function() {
                            var e, t, i, o, n, r, a, s, l;
                            for (this.colorItems[6] = [],
                                     e = $("<div></div>"),
                                     t = $("<table class='colorpicker-colortable' cellspacing= 0 cellpadding= 0></table>"),
                                     i = $("<tbody></tbody>"),
                                     o = $("<tr></tr>"),
                                     n = $("<td></td>"),
                                     n.attr("colspan", "10"),
                                     n.append($("<div class='colorpicker-title colorpicker-div-standardcolor-title'></div>").text(this.options.standardColorsTitle)),
                                     o.append(n),
                                     i.append(o),
                                     r = $("<tr></tr>"),
                                     a = 0; a < 10; a++)
                                s = $("<td></td>"),
                                    l = $("<div></div>"),
                                    l.css("background", this.options.standardColors[a].baseColor),
                                    l.attr("row", "6"),
                                    l.attr("col", "" + a),
                                    this.colorItems[6][a] = {
                                        name: this.options.standardColors[a].name,
                                        baseColor: this.options.standardColors[a].baseColor,
                                        tint: 0,
                                        color: this.options.standardColors[a].baseColor
                                    },
                                    l.addClass("colorpicker-colorcell"),
                                    l.append($("<div class='colorpicker-div-inner-colorcell'></div>")),
                                    s.append(l),
                                    r.append(s);
                            return i.append(r),
                                t.append(i),
                                e.append(t),
                                e
                        }
                        ,
                        n.prototype.YB = function() {
                            var e = $("<div class='colorpicker-div-nocolor'></div>");
                            return e.append($("<table class='colorpicker-table-nocolor'><tbody><tr><td class='colorpicker-td-nocolor-image'><div class='colorpicker-div-out-nofill' ><div class='colorpicker-div-nocolor-image'></div></div></td><td><span class='colorpicker-verticalseparator'></span><label class='colorpicker-Labeltext colorpicker-label-nofill-text'>" + this.options.noFillText + "</label></td></tr></tbody></table>")),
                                e
                        }
                        ,
                        n.prototype.ZB = function() {
                            var e = $("<div class='colorpicker-div-morecolors' ></div>");
                            return e.append($("<table class='colorpicker-table-morecolors'><tbody><tr><td class='colorpicker-td-morecolors-image'><div class='colorpicker-div-morecolor-icon'></div></td><td><span class='colorpicker-verticalseparator'></span><label class='colorpicker-Labeltext colorpicker-label-morecolors-text'>" + this.options.moreColorsText + "</label></td></tr></tbody></table>")),
                                e
                        }
                        ,
                        n.prototype.as = function() {
                            var e = this;
                            this.element.find(".colorpicker-colorcell").on("mouseover.colorpicker", function(t) {
                                var i, o = t.target || t.srcElement, n = o;
                                -1 !== n.className.indexOf("colorpicker-div-inner-colorcell") && (n = n.parentElement),
                                "" !== e.options.value && n.style.background === e.options.value || ($(n).addClass("hover"),
                                    i = n.childNodes[0],
                                    $(i).addClass("hover"))
                            }),
                                this.element.find(".colorpicker-colorcell").on("mousedown.colorpicker", function(t) {
                                    var i, o, n, r, a, s, l = t.target || t.srcElement, c = l;
                                    if (-1 !== c.className.indexOf("colorpicker-div-inner-colorcell") && (c = c.parentElement),
                                            i = $(c).attr("col"),
                                            o = $(c).attr("row"),
                                            e.bC(t, e.colorItems[o][i]),
                                            !$(c).hasClass("selected")) {
                                        if ($(c).removeClass("hover").addClass("selected"),
                                                n = c.childNodes[0],
                                                $(n).removeClass("hover").addClass("selected"),
                                            "" !== e.options.value)
                                            if (void 0 === e.options.value)
                                                e.element.find(".colorpicker-div-out-nofill").removeClass("selected");
                                            else
                                                for (r = e.element.find(".colorpicker-colorcell"),
                                                         a = 0; a < r.length; a++)
                                                    r[a].style.background === e.options.value && ($(r[a]).removeClass("selected"),
                                                        s = r[a].childNodes[0],
                                                        $(s).removeClass("selected"));
                                        e.options.value = e.cC(c.style.background),
                                            e.colorItems[o][i].color = e.cC(e.colorItems[o][i].color),
                                            e.options.selectedItem = e.colorItems[o][i],
                                            e.fo(t, e.colorItems[o][i])
                                    }
                                }),
                                this.element.find(".colorpicker-colorcell").on("mouseout.colorpicker", function(t) {
                                    var i, o = t.target || t.srcElement, n = o;
                                    -1 !== n.className.indexOf("colorpicker-div-inner-colorcell") && (n = n.parentElement),
                                    "" !== e.options.value && n.style.background === e.options.value || ($(n).removeClass("hover"),
                                        i = n.childNodes[0],
                                        $(i).removeClass("hover"))
                                }),
                                this.element.find(".colorpicker-div-nocolor,.colorpicker-div-morecolors").on("mouseover.colorpicker", function(t) {
                                    var i = t.target || t.srcElement
                                        , o = i
                                        , n = e.element.find(".colorpicker-div-nocolor")
                                        , r = e.element.find(".colorpicker-div-morecolors");
                                    n.length > 0 && n[0].contains(o) ? n.addClass("hovered") : r.length > 0 && r[0].contains(o) && r.addClass("hovered")
                                }),
                                this.element.find(".colorpicker-div-nocolor").on("mousedown.colorpicker", function(t) {
                                    var i, o, n;
                                    if (e.element.find(".colorpicker-div-out-nofill").addClass("selected"),
                                        "" !== e.options.value)
                                        for (i = e.element.find(".colorpicker-colorcell"),
                                                 o = 0; o < i.length; o++)
                                            if (i[o].style.background === e.options.value) {
                                                $(i[o]).removeClass("selected"),
                                                    n = i[o].childNodes[0],
                                                    $(n).removeClass("selected");
                                                break
                                            }
                                    e.options.value = void 0,
                                        e.options.selectedItem = void 0,
                                        e.fo(t, void 0),
                                        e.bC(t, void 0)
                                }),
                                this.element.find(".colorpicker-div-nocolor,.colorpicker-div-morecolors").on("mouseout.colorpicker", function(t) {
                                    var i = t.target || t.srcElement
                                        , o = i
                                        , n = e.element.find(".colorpicker-div-nocolor")
                                        , r = e.element.find(".colorpicker-div-morecolors");
                                    n.length > 0 && n[0].contains(o) ? n.removeClass("hovered") : r.length > 0 && r[0].contains(o) && r.removeClass("hovered")
                                }),
                                this.element.find(".colorpicker-div-morecolors").on("click.colorpicker", function(t) {
                                    e.dC(t),
                                        e.eC()
                                })
                        }
                        ,
                        n.prototype.Ov = function() {
                            this.element.find(".colorpicker-colorcell,.colorpicker-div-nocolor,.colorpicker-div-morecolors").off(".colorpicker")
                        }
                        ,
                        n.prototype.eC = function() {
                            this.dialog.value = this.options.value,
                                "" === this.dialog.value || void 0 === this.dialog.value ? this.dialog.gA(!0, "rgb(0,0,0)") : this.dialog.gA(!0, this.dialog.value),
                                this.dialog.open()
                        }
                        ,
                        n.prototype.setOption = function(e, t) {
                            this._setOption(e, t)
                        }
                        ,
                        n.prototype._setOption = function(e, t) {
                            "noFillText" === e ? (this.options.noFillText = t,
                            this.options.showNoFill && this.element.find(".colorpicker-label-nofill-text").text(t)) : "moreColorsText" === e ? (this.options.moreColorsText = t,
                            this.options.showMoreColors && this.element.find(".colorpicker-label-morecolors-text").text(t)) : "showNoFill" === e ? (this.options.showNoFill = t,
                                this.fC()) : "showMoreColors" === e ? (this.options.showMoreColors = t,
                                this.fC()) : "themeColorsTitle" === e ? (this.options.themeColorsTitle = t,
                                this.element.find(".colorpicker-div-themecolor-title").text(t)) : "standardColorsTitle" === e ? (this.options.standardColorsTitle = t,
                                this.element.find(".colorpicker-div-standardcolor-title").text(t)) : "themeColors" === e ? (this.options.themeColors = t,
                                this.fC()) : "standardColors" === e ? (this.options.standardColors = t,
                                this.fC()) : "value" === e ? (t = this.cC(t),
                                this._B(t),
                                this.options.value = t,
                                this.options.selectedItem = {
                                    name: "",
                                    baseColor: "",
                                    tint: 0,
                                    color: t
                                }) : "selectedItem" === e ? void 0 === t || null === t ? (this.$B(),
                                this.options.selectedItem = t,
                                this.options.value = t) : (t.color = this.cC(t.color),
                                this.gC(t),
                                this.options.selectedItem = t,
                                this.options.value = this.options.selectedItem.color) : "showThemeColorTitle" === e ? (this.options.showThemeColorTitle = t,
                                this.fC()) : "showStandardColorTitle" === e ? (this.options.showStandardColorTitle = t,
                                this.fC()) : "showOutline" === e && (this.options.showOutline = t,
                                this.fC())
                        }
                        ,
                        n.prototype.fC = function() {
                            this.Ov(),
                                this.element.empty(),
                                this._create()
                        }
                        ,
                        n.prototype.cC = function(e) {
                            return $("<span></span>").css("background-color", e).css("background-color")
                        }
                        ,
                        n.prototype._B = function(e) {
                            var t, i, o, n;
                            if ("" !== this.options.value)
                                if (void 0 === this.options.value)
                                    this.element.find(".colorpicker-div-out-nofill").removeClass("selected");
                                else
                                    for (t = this.element.find(".colorpicker-colorcell"),
                                             i = 0; i < t.length; i++)
                                        if (t[i].style.background === this.options.value) {
                                            $(t[i]).removeClass("selected"),
                                                o = t[i].childNodes[0],
                                                $(o).removeClass("selected");
                                            break
                                        }
                            if ("" !== e)
                                if (void 0 === e)
                                    this.element.find(".colorpicker-div-out-nofill").addClass("selected");
                                else
                                    for (t = this.element.find(".colorpicker-colorcell"),
                                             i = 0; i < t.length; i++)
                                        if (t[i].style.background === e) {
                                            $(t[i]).addClass("selected"),
                                                n = t[i].childNodes[0],
                                                $(n).addClass("selected");
                                            break
                                        }
                        }
                        ,
                        n.prototype.$B = function() {
                            var e, t, i, o, n, r, a;
                            if (null !== this.options.selectedItem)
                                if (void 0 === this.options.selectedItem)
                                    this.element.find(".colorpicker-div-out-nofill").removeClass("selected");
                                else if (e = this.element.find(".colorpicker-colorcell"),
                                    null !== this.options.selectedItem.name && void 0 !== this.options.selectedItem.name) {
                                    for (o = -1,
                                             n = -1,
                                             r = 0; r < this.colorItems.length; r++) {
                                        for (a = 0; a < this.colorItems[r].length; a++)
                                            if (this.colorItems[r][a].name === this.options.selectedItem.name) {
                                                o = r,
                                                    n = a;
                                                break
                                            }
                                        if (-1 !== o && -1 !== n)
                                            break
                                    }
                                    for (t = 0; t < e.length; t++)
                                        if ($(e[t]).attr("row") === "" + o && $(e[t]).attr("col") === "" + n) {
                                            $(e[t]).removeClass("selected"),
                                                i = e[t].childNodes[0],
                                                $(i).removeClass("selected");
                                            break
                                        }
                                } else
                                    for (t = 0; t < e.length; t++)
                                        if (e[t].style.background === this.options.selectedItem.color && $(e[t]).hasClass("selected")) {
                                            $(e[t]).removeClass("selected"),
                                                i = e[t].childNodes[0],
                                                $(i).removeClass("selected");
                                            break
                                        }
                        }
                        ,
                        n.prototype.gC = function(e) {
                            var t, i, o, n, r, a, s;
                            if (this.$B(),
                                "" !== e)
                                if (void 0 === e)
                                    this.element.find(".colorpicker-div-out-nofill").addClass("selected");
                                else if (t = this.element.find(".colorpicker-colorcell"),
                                    null !== e.name && void 0 !== e.name) {
                                    for (n = -1,
                                             r = -1,
                                             a = 0; a < this.colorItems.length; a++) {
                                        for (s = 0; s < this.colorItems[a].length; s++)
                                            if (this.colorItems[a][s].name === e.name) {
                                                n = a,
                                                    r = s;
                                                break
                                            }
                                        if (-1 !== n && -1 !== r)
                                            break
                                    }
                                    for (i = 0; i < t.length; i++)
                                        if ($(t[i]).attr("row") === "" + n && $(t[i]).attr("col") === "" + r) {
                                            $(t[i]).addClass("selected"),
                                                o = t[i].childNodes[0],
                                                $(o).addClass("selected");
                                            break
                                        }
                                } else
                                    for (i = 0; i < t.length; i++)
                                        if (t[i].style.background === e.color) {
                                            $(t[i]).addClass("selected"),
                                                o = t[i].childNodes[0],
                                                $(o).addClass("selected");
                                            break
                                        }
                        }
                        ,
                        n.prototype.fo = function(e, t) {
                            this._trigger("valueChanged", e, t)
                        }
                        ,
                        n.prototype.dC = function(e) {
                            this._trigger("openColorDialog", e)
                        }
                        ,
                        n.prototype.bC = function(e, t) {
                            this._trigger("choosedColor", e, t)
                        }
                        ,
                        n.prototype.aC = function(t) {
                            var i, o, n, r, a, s, l, c, d = [];
                            for (i = 0; i < t.length; i++)
                                d.push(t[i].baseColor);
                            for (o = 5,
                                     n = [],
                                     r = [-5, -15, -25, -35, -50],
                                     a = [-10, -25, -50, -75, -90],
                                     s = [80, 60, 40, -25, -50],
                                     i = 0; i < 10; i++)
                                for (l = e.QB(d[i]),
                                         c = 0; c < 5; c++)
                                    1 === l ? n.push({
                                        color: this.hC(d[i], r[c]),
                                        tint: r[c]
                                    }) : l >= .8 ? n.push({
                                        color: this.hC(d[i], a[c]),
                                        tint: a[c]
                                    }) : 0 === l ? n.push({
                                        color: this.hC(d[i], Math.abs(r[o - c - 1])),
                                        tint: Math.abs(r[o - c - 1])
                                    }) : l <= .2 ? n.push({
                                        color: this.hC(d[i], Math.abs(a[o - c - 1])),
                                        tint: Math.abs(a[o - c - 1])
                                    }) : n.push({
                                        color: this.hC(d[i], s[c]),
                                        tint: s[c]
                                    });
                            return n
                        }
                        ,
                        n.prototype.hC = function(t, i) {
                            var o, n, r;
                            return 0 === (i /= 100) ? t : (o = e.RB(t, !1),
                                n = parseInt("" + (i > 0 ? (240 - o.luminosity) * i : o.luminosity * i), 10),
                                r = e.SB(o.hue, o.luminosity + n, o.saturation),
                            "rgb(" + r.r + ", " + r.g + ", " + r.b + ")")
                        }
                        ,
                        n.prototype.destroy = function() {
                            this.Ov(),
                                this.element.empty(),
                            this.dialog && this.dialog.destroy()
                        }
                        ,
                        n.DefaultOptions = {
                            themeColors: [{
                                name: "text 1",
                                baseColor: "#FFFFFF"
                            }, {
                                name: "background 1",
                                baseColor: "#000000"
                            }, {
                                name: "text 2",
                                baseColor: "#E7E6E6"
                            }, {
                                name: "background 2",
                                baseColor: "#44546A"
                            }, {
                                name: "accent 1",
                                baseColor: "#5B9BD5"
                            }, {
                                name: "accent 2",
                                baseColor: "#ED7D31"
                            }, {
                                name: "accent 3",
                                baseColor: "#8064A2"
                            }, {
                                name: "accent 4",
                                baseColor: "#4BACC6"
                            }, {
                                name: "accent 5",
                                baseColor: "#F79646"
                            }, {
                                name: "accent 6",
                                baseColor: "#0000FF"
                            }],
                            themeColorsTitle: i.res.colorPicker.themeColorsTitle,
                            standardColors: [{
                                baseColor: "#C00000"
                            }, {
                                baseColor: "#FF0000"
                            }, {
                                baseColor: "#FFC000"
                            }, {
                                baseColor: "#FFFF00"
                            }, {
                                baseColor: "#92D050"
                            }, {
                                baseColor: "#00B050"
                            }, {
                                baseColor: "#00B0F0"
                            }, {
                                baseColor: "#0070C0"
                            }, {
                                baseColor: "#002060"
                            }, {
                                baseColor: "#7030A0"
                            }],
                            standardColorsTitle: i.res.colorPicker.standardColorsTitle,
                            showNoFill: !0,
                            noFillText: i.res.colorPicker.noFillText,
                            showMoreColors: !0,
                            moreColorsText: i.res.colorPicker.moreColorsText,
                            value: "",
                            showThemeColorTitle: !0,
                            showStandardColorTitle: !0,
                            showOutline: !0
                        },
                        n
                }(i.gcui.gcuiWidget);
                i.ColorPicker = n,
                    n.prototype.options = $.extend(!0, {}, i.gcui.gcuiWidget.prototype.options, n.DefaultOptions),
                    $.gcui.registerWidget(o, n.prototype),
                    i.ColorDailog = t
            }()
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e = function(e) {
                    i.extends(t, e);
                    function t() {
                        e.apply(this, arguments)
                    }
                    return t.prototype._create = function() {
                        var e, i = this;
                        this.iC = t.jC++,
                            this.element.addClass("gcui-comboframe").addClass("ui-state-default"),
                            e = $(this.element.children()[0]).addClass("gcui-comboframe-content"),
                            this.kC = $(this.element.children()[1]).addClass("gcui-comboframe-dropdown"),
                            this.kC.gcuipopup({
                                autoHide: !0,
                                ensureOutermost: !0,
                                hidden: function() {
                                    i.element.removeClass("ui-state-active"),
                                        i.vq.removeClass("ui-state-active")
                                }
                            }),
                            this.vq = $("<button></button>").addClass("gcui-comboframe-button").appendTo(this.element).button({
                                icons: {
                                    secondary: "ui-icon-triangle-1-s"
                                }
                            }),
                            this.element.on("mouseenter.gcui-comboframe", function() {
                                i.element.addClass("ui-state-hover")
                            }).on("mouseleave.gcui-comboframe", function() {
                                i.element.removeClass("ui-state-hover")
                            }),
                            this.vq.on("click.gcui-comboframe", function() {
                                i.vq.addClass("ui-state-active"),
                                    i.open()
                            }),
                            e.on("focus.gcui-comboframe", function() {
                                i.element.addClass("ui-state-focus")
                            }).on("blur.gcui-comboframe", function() {
                                i.element.removeClass("ui-state-focus")
                            })
                    }
                        ,
                        t.prototype.open = function() {
                            this.kC.gcuipopup("show", {
                                of: this.element,
                                my: "left top",
                                at: "left bottom"
                            }),
                                this.element.addClass("ui-state-active")
                        }
                        ,
                        t.prototype.close = function() {
                            this.kC.gcuipopup("hide")
                        }
                        ,
                        t.widgetName = "comboframe",
                        t.defaultOptions = {},
                        t.jC = 0,
                        t
                }(i.gcui.gcuiWidget);
                i.ComboFrame = e,
                    e.prototype.options = $.extend(!0, {}, i.gcui.gcuiWidget.prototype.options, e.defaultOptions),
                    $.gcui.registerWidget(e.widgetName, e.prototype)
            }()
        }
        , function(e, t) {
            var i = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e = function(e) {
                    i.extends(t, e);
                    function t() {
                        e.apply(this, arguments)
                    }
                    return t.prototype.family = function(e) {
                        return void 0 === e ? this.lC : (this.lC !== e && (this.lC = e,
                            this.mC()),
                            this)
                    }
                        ,
                        t.prototype.size = function(e) {
                            return void 0 === e ? this.iq : (this.iq !== e && (this.iq = e,
                                this.mC()),
                                this)
                        }
                        ,
                        t.prototype.style = function(e) {
                            return void 0 === e ? this.ws : (this.ws !== e && (this.ws = e,
                                this.mC()),
                                this)
                        }
                        ,
                        t.prototype.weight = function(e) {
                            return void 0 === e ? this.nC : (this.nC !== e && (this.nC = e,
                                this.mC()),
                                this)
                        }
                        ,
                        t.prototype.color = function(e) {
                            return void 0 === e ? this.oC : (this.oC = e,
                                this.options.color = e,
                                this.mC(),
                                this)
                        }
                        ,
                        t.prototype.underline = function(e) {
                            return void 0 === e ? this.cA : (this.cA !== e && (this.cA = e,
                                this.mC()),
                                this)
                        }
                        ,
                        t.prototype.doubleUnderline = function(e) {
                            return void 0 === e ? this.dA : (this.dA !== e && (this.dA = e,
                                this.mC()),
                                this)
                        }
                        ,
                        t.prototype.strikethrough = function(e) {
                            return void 0 === e ? this.eA : (this.eA !== e && (this.eA = e,
                                this.mC()),
                                this)
                        }
                        ,
                        t.prototype.colorOption = function(e, t) {
                            return void 0 === t ? this.C.colorpicker("option", e) : (this.C.colorpicker("option", e, t),
                                this)
                        }
                        ,
                        t.prototype._create = function() {
                            this.iC = t.jC++,
                                this.element.addClass("gcui-fontpicker"),
                                this.pC("family", this.options.families, this.options.familyLabelText),
                                this.pC("style", this.options.styles, this.options.styleLabelText),
                                this.pC("size", this.options.size, this.options.sizeLabelText),
                                this.pC("weight", this.options.weights, this.options.weightLabelText);
                            var e = $("<div></div>").addClass("gcui-fontpicker-group-others").addClass("gcui-fontpicker-group");
                            this.options.isColorVisible && ($("<label></label>").addClass("gcui-fontpicker-group-label").text(this.options.colorLabelText).appendTo(e),
                                this.tv(e)),
                                this.qC(e),
                                e.append($('<div class="clear-float"></div>')),
                                this.rC(e),
                                this.sC(e),
                                this.element.append(e)
                        }
                        ,
                        t.prototype._setOption = function(e, t) {
                            if ("customFontStyle" === e) {
                                this.options.customFontStyle = t;
                                for (var i in this.options.customFontStyle)
                                    if ("disabled" === this.options.customFontStyle[i])
                                        switch (i) {
                                            case "family":
                                                $("#gcui-fontpicker-input-family-" + this.iC).attr("disabled", "disabled"),
                                                    $("#gcui-fontpicker-select-family-" + this.iC).attr("disabled", "disabled");
                                                break;
                                            case "size":
                                                $("#gcui-fontpicker-input-size-" + this.iC).attr("disabled", "disabled"),
                                                    $("#gcui-fontpicker-select-size-" + this.iC).attr("disabled", "disabled");
                                                break;
                                            case "weight":
                                                $("#gcui-fontpicker-input-weight-" + this.iC).attr("disabled", "disabled"),
                                                    $("#gcui-fontpicker-select-weight-" + this.iC).attr("disabled", "disabled");
                                                break;
                                            case "style":
                                                $("#gcui-fontpicker-input-style-" + this.iC).attr("disabled", "disabled"),
                                                    $("#gcui-fontpicker-select-style-" + this.iC).attr("disabled", "disabled")
                                        }
                            }
                        }
                        ,
                        t.prototype.pC = function(e, i, o) {
                            var n, r, a, s, l, c = this, d = $("<div></div>").addClass("gcui-fontpicker-group").addClass("gcui-fontpicker-picker-group").addClass("gcui-fontpicker-group-" + e), p = "gcui-fontpicker-input-" + e + "-" + this.iC;
                            if ($("<lable></lable>").attr("for", p).addClass("gcui-fontpicker-group-label").text(o).appendTo(d),
                                    n = $("<input>").attr({
                                        id: p,
                                        name: e,
                                        type: "text"
                                    }).addClass("ui-widget ui-widget-content").addClass("gcui-fontpicker-input-" + e),
                                    d.append(n),
                                    r = "gcui-fontpicker-select-" + e + "-" + this.iC,
                                    a = $("<select></select>").attr({
                                        id: r,
                                        name: e + "-list",
                                        size: 6
                                    }).addClass("ui-widget ui-widget-content").addClass("gcui-fontpicker-select-" + e),
                                "weight" === e && a.attr("size", 8),
                                    Array.isArray(i))
                                for (s = 0; s < i.length; s++)
                                    a.append($("<option></option>").val(i[s]).text(i[s]));
                            else
                                for (l in i)
                                    a.append($("<option></option>").val(l).text(i[l]));
                            a.on("change.gcui-fontpicker", function(o) {
                                var r = a.val();
                                n.val(t.tC(i, r)),
                                c[e]() !== r && (c[e](r),
                                    c.OB(o, e, r))
                            }),
                                n.on("keyup.gcui-fontpicker", function(o) {
                                    var r = t.uC(i, n.val());
                                    void 0 !== r && (a.val(r),
                                    c[e]() !== r && (c[e](r),
                                        c.OB(o, e, r)))
                                }),
                                n.on("blur.gcui-fontpicker", function(o) {
                                    var r = a.val() || "";
                                    n.val(t.tC(i, r)),
                                    c[e]() !== r && (c[e](r),
                                        c.OB(o, e, r))
                                }),
                                d.append(a),
                                this.element.append(d)
                        }
                        ,
                        t.prototype.tv = function(e) {
                            var t, i = this, o = $("<div></div>").addClass("gcui-fontpicker-color"), n = $("<span></span>").appendTo(o);
                            $("<span></span>").addClass("gcui-fontpicker-color-preview").appendTo(n),
                                t = $("<div></div>").addClass("gcui-fontpicker-color-popup").appendTo(o),
                                i.C = $("<div></div>").addClass("gcui-fontpicker-color-picker").colorpicker({
                                    valueChanged: function(e, t) {
                                        void 0 === t.color ? (i.oC = void 0,
                                            i.OB(e, "color", void 0)) : (i.oC = t,
                                            i.OB(e, "color", t))
                                    },
                                    choosedColor: function(e, t) {
                                        o.comboframe("close")
                                    },
                                    openColorDialog: function(e, t) {
                                        o.comboframe("close")
                                    }
                                }).appendTo(t),
                                o.comboframe().click(function() {
                                    o.comboframe("open")
                                }),
                                e.append(o)
                        }
                        ,
                        t.prototype.qC = function(e) {
                            var t = this
                                , i = $("<div></div>").addClass("hidden")
                                , o = "gcui-fontpicker-normal-font-" + this.iC;
                            $("<input>").attr("type", "checkbox").attr("id", o).addClass("gcui-fontpicker-normal-font").click(function(e) {
                                this.checked && (t.lC && (t.lC = null,
                                    t.OB(e, "family", null)),
                                t.ws && (t.ws = null,
                                    t.OB(e, "style", null)),
                                t.iq && (t.iq = null,
                                    t.OB(e, "size", null)),
                                t.nC && (t.nC = null,
                                    t.OB(e, "weight", null)),
                                t.oC && (t.oC = null,
                                    t.OB(e, "color", null)),
                                    t.mC())
                            }).appendTo(i),
                                $("<label></label>").attr("for", o).text(this.options.normalFontLabelText).appendTo(i),
                                e.append(i)
                        }
                        ,
                        t.prototype.sC = function(e) {
                            var t = $("<fieldset></fieldset>").addClass("ui-widget-content");
                            $("<legend></legend>").text(this.options.previewLabelText).appendTo(t),
                                $("<div></div>").addClass("gcui-fontpicker-preview-container").append($("<span></span>").text(this.options.previewText).addClass("gcui-fontpicker-preview")).appendTo(t),
                                e.append(t)
                        }
                        ,
                        t.prototype.rC = function(e) {
                            var t, o, n, r = this, a = "effects-underline", s = "effects-double-underline", l = "effects-strikethrough", c = $("<fieldset></fieldset>").addClass("ui-widget-content");
                            $("<legend></legend>").text(i.res.fontPicker.effects).appendTo(c),
                                t = $("<div></div>").addClass("gcui-fontpicker-effects-container").appendTo(c),
                                o = $("<div></div>"),
                                n = $("<div></div>"),
                                $("<input>").attr({
                                    id: a,
                                    type: "checkbox"
                                }).addClass("effects-underline").click(function(e) {
                                    r.cA = r.element.find(".effects-underline").prop("checked"),
                                        r.OB(e, "underline", r.cA),
                                        r.vC("underline", r.cA),
                                    r.cA && r.dA && (r.dA = !1,
                                        r.OB(e, "doubleUnderline", r.dA),
                                        r.vC("double-underline", r.dA))
                                }).appendTo(o),
                                $("<label>").text(i.res.fontPicker.underline).attr("for", a).appendTo(o),
                                $("<input>").attr({
                                    id: l,
                                    type: "checkbox"
                                }).addClass("effects-strikethrough").click(function(e) {
                                    r.eA = r.element.find(".effects-strikethrough").prop("checked"),
                                        r.OB(e, "strikethrough", r.eA)
                                }).appendTo(o),
                                $("<label>").text(i.res.fontPicker.strikethrough).attr("for", l).appendTo(o),
                                $("<input>").attr({
                                    id: s,
                                    type: "checkbox"
                                }).addClass("effects-double-underline").click(function(e) {
                                    r.dA = r.element.find(".effects-double-underline").prop("checked"),
                                        r.OB(e, "doubleUnderline", r.dA),
                                        r.vC("double-underline", r.dA),
                                    r.cA && r.dA && (r.cA = !1,
                                        r.OB(e, "underline", r.cA),
                                        r.vC("underline", r.cA))
                                }).appendTo(n),
                                $("<label>").text(i.res.fontPicker.doubleUnderline).attr("for", s).appendTo(n),
                                o.appendTo(t),
                                n.appendTo(t),
                                e.append(c)
                        }
                        ,
                        t.prototype.mC = function() {
                            var e = this;
                            e.Mv(),
                            e.options.isColorVisible && e.C.colorpicker("option", "selectedItem", e.oC),
                                e.wC(e.lC),
                                e.xC("style", e.options.styles, e.ws),
                                e.xC("size", e.options.size, e.iq),
                                e.xC("weight", e.options.weights, e.nC),
                                e.vC("underline", e.cA),
                                e.vC("double-underline", e.dA),
                                e.vC("strikethrough", e.eA),
                                e.yC()
                        }
                        ,
                        t.prototype.wC = function(e) {
                            var t, i, o, n;
                            e.match(/^["'].*["']$/) && (e = e.substring(1, e.length - 1)),
                                o = RegExp("^(.*,s*)?[\"']?" + e + "[\"']?s*(,.*)?$");
                            for (n in this.options.families)
                                if (o.test(n)) {
                                    t = this.options.families[n],
                                        i = n;
                                    break
                                }
                            t && i ? (this.element.find(".gcui-fontpicker-input-family").val(t),
                                this.element.find(".gcui-fontpicker-select-family").val(i)) : (this.element.find(".gcui-fontpicker-input-family").val(""),
                                this.element.find(".gcui-fontpicker-select-family").get(0).selectedIndex = -1)
                        }
                        ,
                        t.prototype.vC = function(e, t) {
                            this.element.find(".effects-" + e).prop("checked", t)
                        }
                        ,
                        t.prototype.xC = function(e, i, o) {
                            var n = t.tC(i, o);
                            this.element.find(".gcui-fontpicker-input-" + e).val(n),
                                this.element.find(".gcui-fontpicker-select-" + e).val(o)
                        }
                        ,
                        t.prototype.yC = function() {
                            this.lC || this.ws || this.iq || this.nC || this.oC ? this.element.find(".gcui-fontpicker-normal-font").prop("checked", !1) : this.element.find(".gcui-fontpicker-normal-font").prop("checked", !0)
                        }
                        ,
                        t.prototype.Mv = function() {
                            var e, t, i = this.element.find(".gcui-fontpicker-preview");
                            this.oC ? (this.element.find(".gcui-fontpicker-color-preview").css("background-color", this.oC.color),
                                i.css("color", this.oC.color)) : (this.element.find(".gcui-fontpicker-color-preview").css("background-color", "transparent"),
                                i.css("color", "black")),
                                e = "",
                            this.cA && !this.dA && (e += "underline "),
                            this.eA && (e += "line-through"),
                                i.css("text-decoration", e),
                                this.dA && !this.cA ? i.css("border-bottom", "double") : i.css("border-bottom", "none"),
                                t = "",
                            this.ws && (t += this.ws + " "),
                            this.nC && (t += this.nC + " "),
                                this.iq ? t += this.iq + "pt " : t += this.options.defaultSize + "pt ",
                                this.lC ? t += this.lC + "," + this.options.alternativeFonts : t += this.options.alternativeFonts,
                                i.css("font", t)
                        }
                        ,
                        t.tC = function(e, t) {
                            return Array.isArray(e) ? t : e[t]
                        }
                        ,
                        t.uC = function(e, t) {
                            var i, o, n, r;
                            if (Array.isArray(e))
                                return t;
                            if ("" === t)
                                return t;
                            for (t = t.toLocaleLowerCase(),
                                     i = Object.getOwnPropertyNames(e),
                                     o = 0; o < i.length; o++)
                                if (n = i[o],
                                        r = e[n].toLocaleLowerCase(),
                                    0 === r.indexOf(t))
                                    return n
                        }
                        ,
                        t.prototype.OB = function(e, t, i) {
                            this.Mv(),
                            (this.lC || this.ws || this.iq || this.nC || this.oC || this.cA || this.dA || this.eA) && this.element.find(".gcui-fontpicker-normal-font").prop("checked", !1),
                                this._trigger("changed", e, {
                                    name: t,
                                    value: i
                                })
                        }
                        ,
                        t.widgetName = "fontpicker",
                        t.defaultOptions = {
                            familyLabelText: i.res.fontPicker.familyLabelText,
                            styleLabelText: i.res.fontPicker.styleLabelText,
                            sizeLabelText: i.res.fontPicker.sizeLabelText,
                            weightLabelText: i.res.fontPicker.weightLabelText,
                            colorLabelText: i.res.fontPicker.colorLabelText,
                            normalFontLabelText: i.res.fontPicker.normalFontLabelText,
                            previewLabelText: i.res.fontPicker.previewLabelText,
                            previewText: i.res.fontPicker.previewText,
                            families: i.res.fontPicker.fontFamilies,
                            styles: i.res.fontPicker.fontStyles,
                            size: [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72],
                            weights: i.res.fontPicker.fontWeights,
                            alternativeFonts: i.res.fontPicker.alternativeFonts,
                            defaultSize: i.res.fontPicker.defaultSize,
                            isColorVisible: !0,
                            customFontStyle: {
                                family: !0,
                                style: !0,
                                size: !0,
                                weight: !0
                            }
                        },
                        t.jC = 0,
                        t
                }(i.gcui.gcuiWidget);
                i.FontPicker = e,
                    e.prototype.options = $.extend(!0, {}, i.gcui.gcuiWidget.prototype.options, e.defaultOptions),
                    $.gcui.registerWidget(e.widgetName, e.prototype)
            }()
        }
        , function(e, t) {
            var i = "sliderpanel"
                , o = 30
                , n = GC.Spread.Sheets.Designer;
            !function() {
                "use strict";
                var e = function(e) {
                    n.extends(t, e);
                    function t() {
                        e.apply(this, arguments)
                    }
                    return t.prototype._create = function() {
                        this.zC = n.wrapper.spreadElement,
                            this.AC = $(".slider-panel-handler"),
                            this.BC = "mousedown.resizeStart",
                            this.CC = "mouseup.resizeEnd",
                            this.DC = "mousemove.continueResize",
                            this.EC = !1,
                            this._k = 0,
                            this.FC = 0;
                        var e = this.element;
                        this.HC = $("<div>").addClass("slider-panel-subPanel slider-panel-panel1").appendTo(e),
                            this.IC = $("<div>").addClass("slider-panel-subPanel-spliter").appendTo(e),
                            this.JC = $("<div>").addClass("slider-panel-subPanel slider-panel-panel2").appendTo(e),
                            this.KC = $("<div>").addClass("slider-panel-guidesline").appendTo(e),
                            this.as(),
                            this.HC.hide(),
                            this.IC.hide(),
                            this.JC.hide()
                    }
                        ,
                        t.prototype._setOption = function(e, t) {}
                        ,
                        t.prototype.as = function() {
                            var e = this;
                            this.AC.bind(this.BC, function(t) {
                                e.FC = t.pageX,
                                e.EC || ($(document).bind(e.DC, function(t) {
                                    var i = $(n.util.getCanvas(n.wrapper.spread)).offset();
                                    e.KC.css("display", "inline-block"),
                                        e.KC.offset({
                                            left: t.pageX,
                                            top: i.top
                                        })
                                }).bind(e.CC, function(t) {
                                    $(document).unbind(e.DC),
                                        $(document).unbind(e.CC),
                                        e.KC.css("display", "none"),
                                        e.FC = t.pageX - e.FC,
                                        e.LC(e.FC),
                                        e.EC = !1
                                }),
                                    e.EC = !0)
                            }),
                                $(n).bind("layoutChanged", function() {
                                    e.LC()
                                })
                        }
                        ,
                        t.prototype.LC = function(e) {
                            var t, i, r, a, s = $(".content"), l = this.element, c = $(".content").children(".fill-spread-content").height(), d = this.HC, p = this.JC, u = this.IC, h = l.is(":visible"), f = d.is(":visible"), g = p.is(":visible"), m = u.is(":visible");
                            if (h) {
                                if (e || (e = 0),
                                        t = parseInt(l.css("width")),
                                        isNaN(t))
                                    return;
                                t -= e,
                                    i = 0,
                                g && (i = p.width()),
                                t < i && (t = i),
                                    r = $(window).width() - t - this._k,
                                r < o && (r = o,
                                    t = $(window).width() - r - this._k),
                                    s.css("width", r),
                                    n.wrapper.spreadElement.css("width", r),
                                    l.css("width", t),
                                    a = 0,
                                m && (a = 2 * parseInt(u.css("border-left-width"))),
                                    g && f ? d.width(t - p.width() - a) : f && d.width(t),
                                    n.wrapper.spread.refresh()
                            }
                            s.css("height", c)
                        }
                        ,
                        t.prototype.MC = function() {
                            var e, t, i, o = 0, r = this.HC, a = this.JC, s = this.AC, l = this.IC;
                            r.is(":visible") && (o += r.width()),
                            a.is(":visible") && (o += a.width()),
                            l.is(":visible") && (o += 2 * parseInt(l.css("border-left-width"))),
                            (e = $(window).width()) && !isNaN(e) && (this._k = 0,
                            s.is(":visible") && (t = parseInt(s.css("border-width")),
                            isNaN(t) || (this._k += 2 * t)),
                                i = 1,
                                this._k += 2 * i,
                                this.zC.css({
                                    display: "inline-block",
                                    width: e - this._k - o + "px"
                                }),
                                n.wrapper.spread.refresh(),
                                this.element.css({
                                    display: "inline-block",
                                    width: o + "px",
                                    border: i + "px solid lightgray"
                                }))
                        }
                        ,
                        t.prototype.open = function(e) {
                            var t = this.HC
                                , i = this.JC;
                            "panel1" === e ? (t.show(),
                                this.AC.show()) : "panel2" === e && (i.show(),
                                this.IC.show()),
                                this.element.show(),
                                this.MC()
                        }
                        ,
                        t.prototype.close = function(e) {
                            var t, i = this.HC, o = this.JC;
                            "panel1" === e ? (i.hide(),
                                this.AC.hide()) : "panel2" === e && (o.hide(),
                                this.IC.hide()),
                                this.MC(),
                            i.is(":visible") || o.is(":visible") || (this.element.hide(),
                                t = $(".content"),
                                t.css("width", "100%"),
                                this.zC.css("width", "100%")),
                                n.wrapper.spread.refresh()
                        }
                        ,
                        t.prototype.getContainer = function(e) {
                            return "panel1" === e ? this.HC : "panel2" === e ? this.JC : void 0
                        }
                        ,
                        t
                }(n.gcui.gcuiWidget);
                n.SliderPanel = e,
                    e.prototype.options = $.extend(!0, {}, n.gcui.gcuiWidget.prototype.options, e.DefaultOptions),
                    $.gcui.registerWidget(i, e.prototype)
            }()
        }
        , function(e, t, i) {
            !function() {
                "use strict";
                i(3),
                    i(8),
                    i(9),
                    i(4),
                    i(7),
                    i(5),
                    i(6)
            }()
        }
    ])
});
